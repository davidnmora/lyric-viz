/*! For license information please see 379.8c83adc758c33898260a.js.LICENSE.txt */
"use strict";(self.webpackChunkscatter_plot_react_app=self.webpackChunkscatter_plot_react_app||[]).push([[379],{379:(t,e,n)=>{var r=n(294),i=n(745),o=n(349),a=n.n(o),s=n(553),l=n(589),u="http://www.w3.org/1999/xhtml";const c={svg:"http://www.w3.org/2000/svg",xhtml:u,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function f(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),c.hasOwnProperty(e)?{space:c[e],local:t}:t}function d(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===u&&e.documentElement.namespaceURI===u?e.createElement(t):e.createElementNS(n,t)}}function h(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function p(t){var e=f(t);return(e.local?h:d)(e)}function _(){}function m(t){return null==t?_:function(){return this.querySelector(t)}}function y(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function b(){return[]}function g(t){return null==t?b:function(){return this.querySelectorAll(t)}}function v(t){return function(){return this.matches(t)}}function w(t){return function(e){return e.matches(t)}}var x=Array.prototype.find;function S(){return this.firstElementChild}var A=Array.prototype.filter;function I(){return Array.from(this.children)}function k(t){return new Array(t.length)}function O(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function T(t){return function(){return t}}function L(t,e,n,r,i,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new O(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function M(t,e,n,r,i,o,a){var s,l,u,c=new Map,f=e.length,d=o.length,h=new Array(f);for(s=0;s<f;++s)(l=e[s])&&(h[s]=u=a.call(l,l.__data__,s,e)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<d;++s)u=a.call(t,o[s],s,o)+"",(l=c.get(u))?(r[s]=l,l.__data__=o[s],c.delete(u)):n[s]=new O(t,o[s]);for(s=0;s<f;++s)(l=e[s])&&c.get(h[s])===l&&(i[s]=l)}function B(t){return t.__data__}function E(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function D(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function j(t){return function(){this.removeAttribute(t)}}function z(t){return function(){this.removeAttributeNS(t.space,t.local)}}function C(t,e){return function(){this.setAttribute(t,e)}}function F(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function N(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function R(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function U(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function P(t){return function(){this.style.removeProperty(t)}}function V(t,e,n){return function(){this.style.setProperty(t,e,n)}}function $(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function W(t,e){return t.style.getPropertyValue(e)||U(t).getComputedStyle(t,null).getPropertyValue(e)}function Y(t){return function(){delete this[t]}}function G(t,e){return function(){this[t]=e}}function q(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function H(t){return t.trim().split(/^|\s+/)}function X(t){return t.classList||new Z(t)}function Z(t){this._node=t,this._names=H(t.getAttribute("class")||"")}function J(t,e){for(var n=X(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function K(t,e){for(var n=X(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Q(t){return function(){J(this,t)}}function tt(t){return function(){K(this,t)}}function et(t,e){return function(){(e.apply(this,arguments)?J:K)(this,t)}}function nt(){this.textContent=""}function rt(t){return function(){this.textContent=t}}function it(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ot(){this.innerHTML=""}function at(t){return function(){this.innerHTML=t}}function st(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function lt(){this.nextSibling&&this.parentNode.appendChild(this)}function ut(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ct(){return null}function ft(){var t=this.parentNode;t&&t.removeChild(this)}function dt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ht(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function pt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function _t(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function mt(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function yt(t,e,n){var r=U(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function bt(t,e){return function(){return yt(this,t,e)}}function gt(t,e){return function(){return yt(this,t,e.apply(this,arguments))}}O.prototype={constructor:O,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Z.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var vt=[null];function wt(t,e){this._groups=t,this._parents=e}function xt(){return new wt([[document.documentElement]],vt)}function St(t){return"string"==typeof t?new wt([[document.querySelector(t)]],[document.documentElement]):new wt([[t]],vt)}function At(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function It(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function kt(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ot(t){let e,n,r;function i(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=It,n=(e,n)=>It(t(e),n),r=(e,n)=>t(e)-n):(e=t===It||t===kt?t:Tt,n=t,r=t),{left:i,center:function(t,e,n=0,o=t.length){const a=i(t,e,n,o-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function Tt(){return 0}wt.prototype=xt.prototype={constructor:wt,select:function(t){"function"!=typeof t&&(t=m(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new wt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return y(t.apply(this,arguments))}}(t):g(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(t.call(a,a.__data__,u,s)),i.push(a));return new wt(r,i)},selectChild:function(t){return this.select(null==t?S:function(t){return function(){return x.call(this.children,t)}}("function"==typeof t?t:w(t)))},selectChildren:function(t){return this.selectAll(null==t?I:function(t){return function(){return A.call(this.children,t)}}("function"==typeof t?t:w(t)))},filter:function(t){"function"!=typeof t&&(t=v(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new wt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,B);var n=e?M:L,r=this._parents,i=this._groups;"function"!=typeof t&&(t=T(t));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],f=i[u],d=f.length,h=E(t.call(c,c&&c.__data__,u,r)),p=h.length,_=s[u]=new Array(p),m=a[u]=new Array(p),y=l[u]=new Array(d);n(c,f,_,m,y,h,e);for(var b,g,v=0,w=0;v<p;++v)if(b=_[v]){for(v>=w&&(w=v+1);!(g=m[w])&&++w<p;);b._next=g||null}}return(a=new wt(a,r))._enter=s,a._exit=l,a},enter:function(){return new wt(this._enter||this._groups.map(k),this._parents)},exit:function(){return new wt(this._exit||this._groups.map(k),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,c=n[l],f=r[l],d=c.length,h=s[l]=new Array(d),p=0;p<d;++p)(u=c[p]||f[p])&&(h[p]=u);for(;l<i;++l)s[l]=n[l];return new wt(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=D);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(e)}return new wt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=f(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?z:j:"function"==typeof e?n.local?R:N:n.local?F:C)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?P:"function"==typeof e?$:V)(t,e,null==n?"":n)):W(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Y:"function"==typeof e?q:G)(t,e)):this.node()[t]},classed:function(t,e){var n=H(t+"");if(arguments.length<2){for(var r=X(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?et:e?Q:tt)(n,e))},text:function(t){return arguments.length?this.each(null==t?nt:("function"==typeof t?it:rt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ot:("function"==typeof t?st:at)(t)):this.node().innerHTML},raise:function(){return this.each(lt)},lower:function(){return this.each(ut)},append:function(t){var e="function"==typeof t?t:p(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:p(t),r=null==e?ct:"function"==typeof e?e:m(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ft)},clone:function(t){return this.select(t?ht:dt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=pt(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?mt:_t,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?gt:bt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};const Lt=Ot(It),Mt=Lt.right,Bt=Lt.left;function Et(t,e){let n,r;if(void 0===e)for(const e of t)null!=e&&(void 0===n?e>=e&&(n=r=e):(n>e&&(n=e),r<e&&(r=e)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}Ot((function(t){return null===t?NaN:+t})).center;class Dt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[n++]=a),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}class jt extends Map{constructor(t,e=Ct){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(zt(this,t))}has(t){return super.has(zt(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(n),t.delete(r)),n}(this,t))}}function zt({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Ct(t){return null!==t&&"object"==typeof t?t.valueOf():t}const Ft=Math.sqrt(50),Nt=Math.sqrt(10),Rt=Math.sqrt(2);function Ut(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Ft?10:o>=Nt?5:o>=Rt?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?Ut(t,e,2*n):[s,l,u]}function Pt(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];const r=e<t,[i,o,a]=r?Ut(e,t,n):Ut(t,e,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let t=0;t<s;++t)l[t]=(o-t)/-a;else for(let t=0;t<s;++t)l[t]=(o-t)*a;else if(a<0)for(let t=0;t<s;++t)l[t]=(i+t)/-a;else for(let t=0;t<s;++t)l[t]=(i+t)*a;return l}function Vt(t,e,n){return Ut(t=+t,e=+e,n=+n)[2]}function $t(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Wt(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Yt(t,e){let n=0,r=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++n,r+=e);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function Gt(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function qt(t){return function(e,n=0,r=e.length){let i=r-(n=+n);for(;i;){const r=t()*i--|0,o=e[i+n];e[i+n]=e[r+n],e[r+n]=o}return e}}function Ht(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}var Xt=1e-6,Zt=Math.PI,Jt=2*Zt,Kt=180/Zt,Qt=Zt/180,te=Math.abs,ee=Math.cos,ne=Math.sin,re=Math.sqrt;function ie(){}function oe(t,e){t&&se.hasOwnProperty(t.type)&&se[t.type](t,e)}var ae={Feature:function(t,e){oe(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)oe(n[r].geometry,e)}},se={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){le(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)le(n[r],e,0)},Polygon:function(t,e){ue(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)ue(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)oe(n[r],e)}};function le(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function ue(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)le(t[n],e,1);e.polygonEnd()}function ce(t,e){t&&ae.hasOwnProperty(t.type)?ae[t.type](t,e):oe(t,e)}function fe(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function de(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var he=1e9,pe=-he;function _e(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return te(r[0]-t)<Xt?i>0?0:3:te(r[0]-n)<Xt?i>0?2:1:te(r[1]-e)<Xt?i>0?1:0:i>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var l,u,c,f,d,h,p,_,m,y,b,g,v,w=a,x=(v=[],{point:function(t,e,n){g.push([t,e,n])},lineStart:function(){v.push(g=[])},lineEnd:ie,rejoin:function(){v.length>1&&v.push(v.pop().concat(v.shift()))},result:function(){var t=v;return v=[],g=null,t}}),S={point:A,lineStart:function(){S.point=I,u&&u.push(c=[]),y=!0,m=!1,p=_=NaN},lineEnd:function(){l&&(I(f,d),h&&m&&x.rejoin(),l.push(x.result())),S.point=A,m&&w.lineEnd()},polygonStart:function(){w=x,l=[],u=[],b=!0},polygonEnd:function(){var e,n=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],l=1,c=s.length,f=s[0],d=f[0],h=f[1];l<c;++l)o=d,a=h,d=(f=s[l])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(t-o)&&++e:h<=r&&(d-o)*(r-a)<(h-a)*(t-o)&&--e;return e}(),i=b&&n,f=(e=l,l=Array.from(function*(t){for(const e of t)yield*e}(e))).length;(i||f)&&(a.polygonStart(),i&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),f&&function(t,e,n,r,i){var o,a,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r,a,u=t[0],c=t[e];if(a=c,te((r=u)[0]-a[0])<Xt&&te(r[1]-a[1])<Xt){if(!u[2]&&!c[2]){for(i.lineStart(),o=0;o<e;++o)i.point((u=t[o])[0],u[1]);return void i.lineEnd()}c[0]+=2e-6}s.push(n=new fe(u,t,null,!0)),l.push(n.o=new fe(u,null,n,!1)),s.push(n=new fe(c,t,null,!1)),l.push(n.o=new fe(c,null,n,!0))}})),s.length){for(l.sort(e),de(s),de(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}(l,s,n,o,a),a.polygonEnd()),w=a,l=u=c=null}};function A(t,e){i(t,e)&&w.point(t,e)}function I(o,a){var s=i(o,a);if(u&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(w.lineStart(),w.point(o,a));else if(s&&m)w.point(o,a);else{var l=[p=Math.max(pe,Math.min(he,p)),_=Math.max(pe,Math.min(he,_))],g=[o=Math.max(pe,Math.min(he,o)),a=Math.max(pe,Math.min(he,a))];!function(t,e,n,r,i,o){var a,s=t[0],l=t[1],u=0,c=1,f=e[0]-s,d=e[1]-l;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(t[0]=s+u*f,t[1]=l+u*d),c<1&&(e[0]=s+c*f,e[1]=l+c*d),!0}}}}}(l,g,t,e,n,r)?s&&(w.lineStart(),w.point(o,a),b=!1):(m||(w.lineStart(),w.point(l[0],l[1])),w.point(g[0],g[1]),s||w.lineEnd(),b=!1)}p=o,_=a,m=s}return S}}const me=t=>t;var ye,be,ge,ve,we=new Dt,xe=new Dt,Se={point:ie,lineStart:ie,lineEnd:ie,polygonStart:function(){Se.lineStart=Ae,Se.lineEnd=Oe},polygonEnd:function(){Se.lineStart=Se.lineEnd=Se.point=ie,we.add(te(xe)),xe=new Dt},result:function(){var t=we/2;return we=new Dt,t}};function Ae(){Se.point=Ie}function Ie(t,e){Se.point=ke,ye=ge=t,be=ve=e}function ke(t,e){xe.add(ve*t-ge*e),ge=t,ve=e}function Oe(){ke(ye,be)}const Te=Se;var Le=1/0,Me=Le,Be=-Le,Ee=Be;const De={point:function(t,e){t<Le&&(Le=t),t>Be&&(Be=t),e<Me&&(Me=e),e>Ee&&(Ee=e)},lineStart:ie,lineEnd:ie,polygonStart:ie,polygonEnd:ie,result:function(){var t=[[Le,Me],[Be,Ee]];return Be=Ee=-(Me=Le=1/0),t}};var je,ze,Ce,Fe,Ne=0,Re=0,Ue=0,Pe=0,Ve=0,$e=0,We=0,Ye=0,Ge=0,qe={point:He,lineStart:Xe,lineEnd:Ke,polygonStart:function(){qe.lineStart=Qe,qe.lineEnd=tn},polygonEnd:function(){qe.point=He,qe.lineStart=Xe,qe.lineEnd=Ke},result:function(){var t=Ge?[We/Ge,Ye/Ge]:$e?[Pe/$e,Ve/$e]:Ue?[Ne/Ue,Re/Ue]:[NaN,NaN];return Ne=Re=Ue=Pe=Ve=$e=We=Ye=Ge=0,t}};function He(t,e){Ne+=t,Re+=e,++Ue}function Xe(){qe.point=Ze}function Ze(t,e){qe.point=Je,He(Ce=t,Fe=e)}function Je(t,e){var n=t-Ce,r=e-Fe,i=re(n*n+r*r);Pe+=i*(Ce+t)/2,Ve+=i*(Fe+e)/2,$e+=i,He(Ce=t,Fe=e)}function Ke(){qe.point=He}function Qe(){qe.point=en}function tn(){nn(je,ze)}function en(t,e){qe.point=nn,He(je=Ce=t,ze=Fe=e)}function nn(t,e){var n=t-Ce,r=e-Fe,i=re(n*n+r*r);Pe+=i*(Ce+t)/2,Ve+=i*(Fe+e)/2,$e+=i,We+=(i=Fe*t-Ce*e)*(Ce+t),Ye+=i*(Fe+e),Ge+=3*i,He(Ce=t,Fe=e)}const rn=qe;function on(t){this._context=t}on.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Jt)}},result:ie};var an,sn,ln,un,cn,fn=new Dt,dn={point:ie,lineStart:function(){dn.point=hn},lineEnd:function(){an&&pn(sn,ln),dn.point=ie},polygonStart:function(){an=!0},polygonEnd:function(){an=null},result:function(){var t=+fn;return fn=new Dt,t}};function hn(t,e){dn.point=pn,sn=un=t,ln=cn=e}function pn(t,e){un-=t,cn-=e,fn.add(re(un*un+cn*cn)),un=t,cn=e}const _n=dn;let mn,yn,bn,gn;class vn{constructor(t){this._append=null==t?wn:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return wn;if(e!==mn){const t=10**e;mn=e,yn=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return yn}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append`M${t},${e}`,this._point=1;break;case 1:this._append`L${t},${e}`;break;default:if(this._append`M${t},${e}`,this._radius!==bn||this._append!==yn){const t=this._radius,e=this._;this._="",this._append`m0,${t}a${t},${t} 0 1,1 0,${-2*t}a${t},${t} 0 1,1 0,${2*t}z`,bn=t,yn=this._append,gn=this._,this._=e}this._+=gn}}result(){const t=this._;return this._="",t.length?t:null}}function wn(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function xn(t,e){let n,r,i=3,o=4.5;function a(t){return t&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),ce(t,n(r))),r.result()}return a.area=function(t){return ce(t,n(Te)),Te.result()},a.measure=function(t){return ce(t,n(_n)),_n.result()},a.bounds=function(t){return ce(t,n(De)),De.result()},a.centroid=function(t){return ce(t,n(rn)),rn.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,me):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new vn(i)):new on(e=t),"function"!=typeof o&&r.pointRadius(o),a):e},a.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(r.pointRadius(+t),+t),a):o},a.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);i=e}return null===e&&(r=new vn(i)),a},a.projection(t).digits(i).context(e)}function Sn(){}function An(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),ce(n,t.stream(De)),e(De.result()),null!=r&&t.clipExtent(r),t}function In(t,e,n){return An(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function kn(){var t,e,n,r,i,o,a,s,l=1,u=0,c=0,f=1,d=1,h=0,p=null,_=1,m=1,y=(s={point:function(t,e){var n=v([t,e]);this.stream.point(n[0],n[1])}},function(t){var e=new Sn;for(var n in s)e[n]=s[n];return e.stream=t,e}),b=me;function g(){return _=l*f,m=l*d,o=a=null,v}function v(n){var r=n[0]*_,i=n[1]*m;if(h){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+u,i+c]}return v.invert=function(n){var r=n[0]-u,i=n[1]-c;if(h){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/_,i/m]},v.stream=function(t){return o&&a===t?o:o=y(b(a=t))},v.postclip=function(t){return arguments.length?(b=t,p=n=r=i=null,g()):b},v.clipExtent=function(t){return arguments.length?(b=null==t?(p=n=r=i=null,me):_e(p=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),g()):null==p?null:[[p,n],[r,i]]},v.scale=function(t){return arguments.length?(l=+t,g()):l},v.translate=function(t){return arguments.length?(u=+t[0],c=+t[1],g()):[u,c]},v.angle=function(n){return arguments.length?(e=ne(h=n%360*Qt),t=ee(h),g()):h*Kt},v.reflectX=function(t){return arguments.length?(f=t?-1:1,g()):f<0},v.reflectY=function(t){return arguments.length?(d=t?-1:1,g()):d<0},v.fitExtent=function(t,e){return In(v,t,e)},v.fitSize=function(t,e){return function(t,e,n){return In(t,[[0,0],e],n)}(v,t,e)},v.fitWidth=function(t,e){return function(t,e,n){return An(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}(v,t,e)},v.fitHeight=function(t,e){return function(t,e,n){return An(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}(v,t,e)},v}Sn.prototype={constructor:Sn,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var On="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Tn={};!function(t,e){var n="__lodash_hash_undefined__",r=9007199254740991,i="[object Arguments]",o="[object Function]",a="[object Object]",s=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[i]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u[o]=u["[object Map]"]=u["[object Number]"]=u[a]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1;var c="object"==typeof On&&On&&On.Object===Object&&On,f="object"==typeof self&&self&&self.Object===Object&&self,d=c||f||Function("return this")(),h=e&&!e.nodeType&&e,p=h&&t&&!t.nodeType&&t,_=p&&p.exports===h,m=_&&c.process,y=function(){try{return p&&p.require&&p.require("util").types||m&&m.binding&&m.binding("util")}catch(t){}}(),b=y&&y.isTypedArray;function g(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var v,w,x,S=Array.prototype,A=Function.prototype,I=Object.prototype,k=d["__core-js_shared__"],O=A.toString,T=I.hasOwnProperty,L=(v=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",M=I.toString,B=O.call(Object),E=RegExp("^"+O.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=_?d.Buffer:void 0,j=d.Symbol,z=d.Uint8Array,C=(D&&D.allocUnsafe,w=Object.getPrototypeOf,x=Object,function(t){return w(x(t))}),F=Object.create,N=I.propertyIsEnumerable,R=S.splice,U=j?j.toStringTag:void 0,P=function(){try{var t=st(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),V=D?D.isBuffer:void 0,$=Math.max,W=Date.now,Y=st(d,"Map"),G=st(Object,"create"),q=function(){function t(){}return function(e){if(!gt(e))return{};if(F)return F(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function H(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function X(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Z(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function J(t){var e=this.__data__=new X(t);this.size=e.size}function K(t,e,n){(void 0!==n&&!dt(t[e],n)||void 0===n&&!(e in t))&&et(t,e,n)}function Q(t,e,n){var r=t[e];T.call(t,e)&&dt(r,n)&&(void 0!==n||e in t)||et(t,e,n)}function tt(t,e){for(var n=t.length;n--;)if(dt(t[n][0],e))return n;return-1}function et(t,e,n){"__proto__"==e&&P?P(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}H.prototype.clear=function(){this.__data__=G?G(null):{},this.size=0},H.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},H.prototype.get=function(t){var e=this.__data__;if(G){var r=e[t];return r===n?void 0:r}return T.call(e,t)?e[t]:void 0},H.prototype.has=function(t){var e=this.__data__;return G?void 0!==e[t]:T.call(e,t)},H.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=G&&void 0===e?n:e,this},X.prototype.clear=function(){this.__data__=[],this.size=0},X.prototype.delete=function(t){var e=this.__data__,n=tt(e,t);return!(n<0||(n==e.length-1?e.pop():R.call(e,n,1),--this.size,0))},X.prototype.get=function(t){var e=this.__data__,n=tt(e,t);return n<0?void 0:e[n][1]},X.prototype.has=function(t){return tt(this.__data__,t)>-1},X.prototype.set=function(t,e){var n=this.__data__,r=tt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Z.prototype.clear=function(){this.size=0,this.__data__={hash:new H,map:new(Y||X),string:new H}},Z.prototype.delete=function(t){var e=at(this,t).delete(t);return this.size-=e?1:0,e},Z.prototype.get=function(t){return at(this,t).get(t)},Z.prototype.has=function(t){return at(this,t).has(t)},Z.prototype.set=function(t,e){var n=at(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},J.prototype.clear=function(){this.__data__=new X,this.size=0},J.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},J.prototype.get=function(t){return this.__data__.get(t)},J.prototype.has=function(t){return this.__data__.has(t)},J.prototype.set=function(t,e){var n=this.__data__;if(n instanceof X){var r=n.__data__;if(!Y||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Z(r)}return n.set(t,e),this.size=n.size,this};function nt(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":U&&U in Object(t)?function(t){var e=T.call(t,U),n=t[U];try{t[U]=void 0;var r=!0}catch(t){}var i=M.call(t);return r&&(e?t[U]=n:delete t[U]),i}(t):function(t){return M.call(t)}(t)}function rt(t){return vt(t)&&nt(t)==i}function it(t,e,n,r,i){t!==e&&function(t,e,n){for(var r=-1,i=Object(t),o=n(t),a=o.length;a--;){var s=o[++r];if(!1===e(i[s],s,i))break}}(e,(function(o,s){if(i||(i=new J),gt(o))!function(t,e,n,r,i,o,s){var l=ct(t,n),u=ct(e,n),c=s.get(u);if(c)K(t,n,c);else{var f,d,h,p,_,m=o?o(l,u,n+"",t,e,s):void 0,y=void 0===m;if(y){var b=pt(u),g=!b&&mt(u),v=!b&&!g&&wt(u);m=u,b||g||v?pt(l)?m=l:vt(_=l)&&_t(_)?m=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(l):g?(y=!1,m=function(t,e){return t.slice()}(u)):v?(y=!1,p=new(h=(f=u).buffer).constructor(h.byteLength),new z(p).set(new z(h)),d=p,m=new f.constructor(d,f.byteOffset,f.length)):m=[]:function(t){if(!vt(t)||nt(t)!=a)return!1;var e=C(t);if(null===e)return!0;var n=T.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&O.call(n)==B}(u)||ht(u)?(m=l,ht(l)?m=function(t){return function(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var s=e[o],l=void 0;void 0===l&&(l=t[s]),i?et(n,s,l):Q(n,s,l)}return n}(t,xt(t))}(l):gt(l)&&!yt(l)||(m=function(t){return"function"!=typeof t.constructor||ut(t)?{}:q(C(t))}(u))):y=!1}y&&(s.set(u,m),i(m,u,r,o,s),s.delete(u)),K(t,n,m)}}(t,e,s,n,it,r,i);else{var l=r?r(ct(t,s),o,s+"",t,e,i):void 0;void 0===l&&(l=o),K(t,s,l)}}),xt)}var ot=P?function(t,e){return P(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:It;function at(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function st(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!gt(t)||function(t){return!!L&&L in t}(t))&&(yt(t)?E:s).test(function(t){if(null!=t){try{return O.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}(n)?n:void 0}function lt(t,e){var n=typeof t;return!!(e=null==e?r:e)&&("number"==n||"symbol"!=n&&l.test(t))&&t>-1&&t%1==0&&t<e}function ut(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||I)}function ct(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var ft=function(t){var e=0,n=0;return function(){var r=W(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(ot);function dt(t,e){return t===e||t!=t&&e!=e}var ht=rt(function(){return arguments}())?rt:function(t){return vt(t)&&T.call(t,"callee")&&!N.call(t,"callee")},pt=Array.isArray;function _t(t){return null!=t&&bt(t.length)&&!yt(t)}var mt=V||function(){return!1};function yt(t){if(!gt(t))return!1;var e=nt(t);return e==o||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function bt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}function gt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function vt(t){return null!=t&&"object"==typeof t}var wt=b?function(t){return function(e){return t(e)}}(b):function(t){return vt(t)&&bt(t.length)&&!!u[nt(t)]};function xt(t){return _t(t)?function(t,e){var n=pt(t),r=!n&&ht(t),i=!n&&!r&&mt(t),o=!n&&!r&&!i&&wt(t),a=n||r||i||o,s=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],l=s.length;for(var u in t)!e&&!T.call(t,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||lt(u,l))||s.push(u);return s}(t,!0):function(t){if(!gt(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=ut(t),n=[];for(var r in t)("constructor"!=r||!e&&T.call(t,r))&&n.push(r);return n}(t)}var St,At=(St=function(t,e,n){it(t,e,n)},function(t,e){return ft(function(t,e,n){return e=$(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=$(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=r[i];return s[e]=n(a),g(t,this,s)}}(t,e,It),t+"")}((function(t,e){var n=-1,r=e.length,i=r>1?e[r-1]:void 0,o=r>2?e[2]:void 0;for(i=St.length>3&&"function"==typeof i?(r--,i):void 0,o&&function(t,e,n){if(!gt(n))return!1;var r=typeof e;return!!("number"==r?_t(n)&&lt(e,n.length):"string"==r&&e in n)&&dt(n[e],t)}(e[0],e[1],o)&&(i=r<3?void 0:i,r=1),t=Object(t);++n<r;){var a=e[n];a&&St(t,a,n)}return t})));function It(t){return t}t.exports=At}({get exports(){return Tn},set exports(t){Tn=t}},Tn);var Ln,Mn,Bn=0,En=0,Dn=0,jn=0,zn=0,Cn=0,Fn="object"==typeof performance&&performance.now?performance:Date,Nn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Rn(){return zn||(Nn(Un),zn=Fn.now()+Cn)}function Un(){zn=0}function Pn(){this._call=this._time=this._next=null}function Vn(t,e,n){var r=new Pn;return r.restart(t,e,n),r}function $n(){zn=(jn=Fn.now())+Cn,Bn=En=0;try{!function(){Rn(),++Bn;for(var t,e=Ln;e;)(t=zn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Bn}()}finally{Bn=0,function(){for(var t,e,n=Ln,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ln=e);Mn=t,Yn(r)}(),zn=0}}function Wn(){var t=Fn.now(),e=t-jn;e>1e3&&(Cn-=e,jn=t)}function Yn(t){Bn||(En&&(En=clearTimeout(En)),t-zn>24?(t<1/0&&(En=setTimeout($n,t-Fn.now()-Cn)),Dn&&(Dn=clearInterval(Dn))):(Dn||(jn=Fn.now(),Dn=setInterval(Wn,1e3)),Bn=1,Nn($n)))}function Gn(t,e,n){var r=new Pn;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}Pn.prototype=Vn.prototype={constructor:Pn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Rn():+n)+(null==e?0:+e),this._next||Mn===this||(Mn?Mn._next=this:Ln=this,Mn=this),this._call=t,this._time=n,Yn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yn())}};var qn={value:()=>{}};function Hn(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Xn(r)}function Xn(t){this._=t}function Zn(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Jn(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Kn(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=qn,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Xn.prototype=Hn.prototype={constructor:Xn,on:function(t,e){var n,r=this._,i=Zn(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=Kn(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Kn(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=Jn(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Xn(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const Qn={passive:!1},tr={capture:!0,passive:!1};function er(t){t.stopImmediatePropagation()}function nr(t){t.preventDefault(),t.stopImmediatePropagation()}function rr(t){var e=t.document.documentElement,n=St(t).on("dragstart.drag",nr,tr);"onselectstart"in e?n.on("selectstart.drag",nr,tr):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ir(t,e){var n=t.document.documentElement,r=St(t).on("dragstart.drag",null);e&&(r.on("click.drag",nr,tr),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const or=t=>()=>t;function ar(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:o,x:a,y:s,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}function sr(t){return!t.ctrlKey&&!t.button}function lr(){return this.parentNode}function ur(t,e){return null==e?{x:t.x,y:t.y}:e}function cr(){return navigator.maxTouchPoints||"ontouchstart"in this}function fr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function dr(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function hr(){}ar.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var pr=.7,_r=1/pr,mr="\\s*([+-]?\\d+)\\s*",yr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",br="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gr=/^#([0-9a-f]{3,8})$/,vr=new RegExp(`^rgb\\(${mr},${mr},${mr}\\)$`),wr=new RegExp(`^rgb\\(${br},${br},${br}\\)$`),xr=new RegExp(`^rgba\\(${mr},${mr},${mr},${yr}\\)$`),Sr=new RegExp(`^rgba\\(${br},${br},${br},${yr}\\)$`),Ar=new RegExp(`^hsl\\(${yr},${br},${br}\\)$`),Ir=new RegExp(`^hsla\\(${yr},${br},${br},${yr}\\)$`),kr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Or(){return this.rgb().formatHex()}function Tr(){return this.rgb().formatRgb()}function Lr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=gr.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Mr(e):3===n?new jr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Br(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Br(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=vr.exec(t))?new jr(e[1],e[2],e[3],1):(e=wr.exec(t))?new jr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=xr.exec(t))?Br(e[1],e[2],e[3],e[4]):(e=Sr.exec(t))?Br(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ar.exec(t))?Ur(e[1],e[2]/100,e[3]/100,1):(e=Ir.exec(t))?Ur(e[1],e[2]/100,e[3]/100,e[4]):kr.hasOwnProperty(t)?Mr(kr[t]):"transparent"===t?new jr(NaN,NaN,NaN,0):null}function Mr(t){return new jr(t>>16&255,t>>8&255,255&t,1)}function Br(t,e,n,r){return r<=0&&(t=e=n=NaN),new jr(t,e,n,r)}function Er(t){return t instanceof hr||(t=Lr(t)),t?new jr((t=t.rgb()).r,t.g,t.b,t.opacity):new jr}function Dr(t,e,n,r){return 1===arguments.length?Er(t):new jr(t,e,n,null==r?1:r)}function jr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function zr(){return`#${Rr(this.r)}${Rr(this.g)}${Rr(this.b)}`}function Cr(){const t=Fr(this.opacity);return`${1===t?"rgb(":"rgba("}${Nr(this.r)}, ${Nr(this.g)}, ${Nr(this.b)}${1===t?")":`, ${t})`}`}function Fr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Nr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Rr(t){return((t=Nr(t))<16?"0":"")+t.toString(16)}function Ur(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Vr(t,e,n,r)}function Pr(t){if(t instanceof Vr)return new Vr(t.h,t.s,t.l,t.opacity);if(t instanceof hr||(t=Lr(t)),!t)return new Vr;if(t instanceof Vr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new Vr(a,s,l,t.opacity)}function Vr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function $r(t){return(t=(t||0)%360)<0?t+360:t}function Wr(t){return Math.max(0,Math.min(1,t||0))}function Yr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}fr(hr,Lr,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Or,formatHex:Or,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Pr(this).formatHsl()},formatRgb:Tr,toString:Tr}),fr(jr,Dr,dr(hr,{brighter(t){return t=null==t?_r:Math.pow(_r,t),new jr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?pr:Math.pow(pr,t),new jr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new jr(Nr(this.r),Nr(this.g),Nr(this.b),Fr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zr,formatHex:zr,formatHex8:function(){return`#${Rr(this.r)}${Rr(this.g)}${Rr(this.b)}${Rr(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Cr,toString:Cr})),fr(Vr,(function(t,e,n,r){return 1===arguments.length?Pr(t):new Vr(t,e,n,null==r?1:r)}),dr(hr,{brighter(t){return t=null==t?_r:Math.pow(_r,t),new Vr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?pr:Math.pow(pr,t),new Vr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new jr(Yr(t>=240?t-240:t+120,i,r),Yr(t,i,r),Yr(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Vr($r(this.h),Wr(this.s),Wr(this.l),Fr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Fr(this.opacity);return`${1===t?"hsl(":"hsla("}${$r(this.h)}, ${100*Wr(this.s)}%, ${100*Wr(this.l)}%${1===t?")":`, ${t})`}`}}));const Gr=Math.PI/180,qr=180/Math.PI;var Hr=-.14861,Xr=1.78277,Zr=-.29227,Jr=-.90649,Kr=1.97294,Qr=Kr*Jr,ti=Kr*Xr,ei=Xr*Zr-Jr*Hr;function ni(t){if(t instanceof ii)return new ii(t.h,t.s,t.l,t.opacity);t instanceof jr||(t=Er(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(ei*r+Qr*e-ti*n)/(ei+Qr-ti),o=r-i,a=(Kr*(n-i)-Zr*o)/Jr,s=Math.sqrt(a*a+o*o)/(Kr*i*(1-i)),l=s?Math.atan2(a,o)*qr-120:NaN;return new ii(l<0?l+360:l,s,i,t.opacity)}function ri(t,e,n,r){return 1===arguments.length?ni(t):new ii(t,e,n,null==r?1:r)}function ii(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}fr(ii,ri,dr(hr,{brighter(t){return t=null==t?_r:Math.pow(_r,t),new ii(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?pr:Math.pow(pr,t),new ii(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*Gr,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new jr(255*(e+n*(Hr*r+Xr*i)),255*(e+n*(Zr*r+Jr*i)),255*(e+n*(Kr*r)),this.opacity)}}));const oi=t=>()=>t;function ai(t,e){return function(n){return t+n*e}}function si(t,e){var n=e-t;return n?ai(t,n):oi(isNaN(t)?e:t)}const li=function t(e){var n=function(t){return 1==(t=+t)?si:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):oi(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Dr(t)).r,(e=Dr(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=si(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);var ui,ci=(ui=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return function(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}((n-r/e)*e,a,i,o,s)}},function(t){var e,n,r=t.length,i=new Array(r),o=new Array(r),a=new Array(r);for(e=0;e<r;++e)n=Dr(t[e]),i[e]=n.r||0,o[e]=n.g||0,a[e]=n.b||0;return i=ui(i),o=ui(o),a=ui(a),n.opacity=1,function(t){return n.r=i(t),n.g=o(t),n.b=a(t),n+""}});function fi(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function di(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=gi(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function hi(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function pi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function _i(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=gi(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var mi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yi=new RegExp(mi.source,"g");function bi(t,e){var n,r,i,o=mi.lastIndex=yi.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=mi.exec(t))&&(r=yi.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:pi(n,r)})),o=yi.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function gi(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?oi(e):("number"===i?pi:"string"===i?(n=Lr(e))?(e=n,li):bi:e instanceof Lr?li:e instanceof Date?hi:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?di:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?_i:pi:fi))(t,e)}function vi(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var wi,xi=180/Math.PI,Si={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ai(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*xi,skewX:Math.atan(l)*xi,scaleX:a,scaleY:s}}function Ii(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:pi(t,i)},{i:l-2,x:pi(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:pi(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:pi(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:pi(t,n)},{i:s-2,x:pi(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var ki=Ii((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Si:Ai(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Oi=Ii((function(t){return null==t?Si:(wi||(wi=document.createElementNS("http://www.w3.org/2000/svg","g")),wi.setAttribute("transform",t),(t=wi.transform.baseVal.consolidate())?Ai((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Si)}),", ",")",")");function Ti(t){return((t=Math.exp(t))+1/t)/2}const Li=function t(e,n,r){function i(t,i){var o,a,s=t[0],l=t[1],u=t[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-l,_=h*h+p*p;if(_<1e-12)a=Math.log(d/u)/e,o=function(t){return[s+t*h,l+t*p,u*Math.exp(e*t*a)]};else{var m=Math.sqrt(_),y=(d*d-u*u+r*_)/(2*u*n*m),b=(d*d-u*u-r*_)/(2*d*n*m),g=Math.log(Math.sqrt(y*y+1)-y),v=Math.log(Math.sqrt(b*b+1)-b);a=(v-g)/e,o=function(t){var r,i=t*a,o=Ti(g),c=u/(n*m)*(o*(r=e*i+g,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[s+c*h,l+c*p,u*o/Ti(e*i+g)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function Mi(t){return function e(n){function r(e,r){var i=t((e=ri(e)).h,(r=ri(r)).h),o=si(e.s,r.s),a=si(e.l,r.l),s=si(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Mi((function(t,e){var n=e-t;return n?ai(t,n>180||n<-180?n-360*Math.round(n/360):n):oi(isNaN(t)?e:t)}));var Bi=Mi(si),Ei=Hn("start","end","cancel","interrupt"),Di=[];function ji(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var u,c,f,d;if(1!==n.state)return s();for(u in i)if((d=i[u]).name===n.name){if(3===d.state)return Gn(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(Gn((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),u=0,c=-1;u<f;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Vn((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Ei,tween:Di,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function zi(t,e){var n=Fi(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ci(t,e){var n=Fi(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Fi(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ni(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}function Ri(t,e){var n,r;return function(){var i=Ci(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function Ui(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Ci(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function Pi(t,e,n){var r=t._id;return t.each((function(){var t=Ci(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Fi(t,r).value[e]}}function Vi(t,e){var n;return("number"==typeof e?pi:e instanceof Lr?li:(n=Lr(e))?(e=n,li):bi)(t,e)}function $i(t){return function(){this.removeAttribute(t)}}function Wi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Yi(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function Gi(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function qi(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function Hi(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function Xi(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Zi(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ji(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Zi(t,i)),n}return i._value=e,i}function Ki(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Xi(t,i)),n}return i._value=e,i}function Qi(t,e){return function(){zi(this,t).delay=+e.apply(this,arguments)}}function to(t,e){return e=+e,function(){zi(this,t).delay=e}}function eo(t,e){return function(){Ci(this,t).duration=+e.apply(this,arguments)}}function no(t,e){return e=+e,function(){Ci(this,t).duration=e}}function ro(t,e){if("function"!=typeof e)throw new Error;return function(){Ci(this,t).ease=e}}function io(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?zi:Ci;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var oo=xt.prototype.constructor;function ao(t){return function(){this.style.removeProperty(t)}}function so(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function lo(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&so(t,o,n)),r}return o._value=e,o}function uo(t){return function(e){this.textContent=t.call(this,e)}}function co(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&uo(r)),e}return r._value=t,r}var fo=0;function ho(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function po(){return++fo}var _o=xt.prototype;ho.prototype={constructor:ho,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=m(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=r[a],c=u.length,f=o[a]=new Array(c),d=0;d<c;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),f[d]=l,ji(f[d],e,n,d,f,Fi(s,n)));return new ho(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=g(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,f=0;f<c;++f)if(l=u[f]){for(var d,h=t.call(l,l.__data__,f,u),p=Fi(l,n),_=0,m=h.length;_<m;++_)(d=h[_])&&ji(d,e,n,_,h,p);o.push(h),a.push(l)}return new ho(o,a,e,n)},selectChild:_o.selectChild,selectChildren:_o.selectChildren,filter:function(t){"function"!=typeof t&&(t=v(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new ho(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=e[s],c=n[s],f=u.length,d=a[s]=new Array(f),h=0;h<f;++h)(l=u[h]||c[h])&&(d[h]=l);for(;s<r;++s)a[s]=e[s];return new ho(a,this._parents,this._name,this._id)},selection:function(){return new oo(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=po(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=Fi(a,e);ji(a,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ho(r,this._parents,t,n)},call:_o.call,nodes:_o.nodes,node:_o.node,size:_o.size,empty:_o.empty,each:_o.each,on:function(t,e){var n=this._id;return arguments.length<2?Fi(this.node(),n).on.on(t):this.each(io(n,t,e))},attr:function(t,e){var n=f(t),r="transform"===n?Oi:Vi;return this.attrTween(t,"function"==typeof e?(n.local?Hi:qi)(n,r,Pi(this,"attr."+t,e)):null==e?(n.local?Wi:$i)(n):(n.local?Gi:Yi)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=f(t);return this.tween(n,(r.local?Ji:Ki)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?ki:Vi;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=W(this,t),a=(this.style.removeProperty(t),W(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,ao(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=W(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=W(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,Pi(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=Ci(this,t),u=l.on,c=null==l.value[a]?o||(o=ao(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=W(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,lo(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Pi(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,co(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Fi(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?Ri:Ui)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Qi:to)(e,t)):Fi(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?eo:no)(e,t)):Fi(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(ro(e,t)):Fi(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Ci(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--i&&o()}};n.each((function(){var n=Ci(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:_o[Symbol.iterator]};var mo={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function yo(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}xt.prototype.interrupt=function(t){return this.each((function(){Ni(this,t)}))},xt.prototype.transition=function(t){var e,n;t instanceof ho?(e=t._id,t=t._name):(e=po(),(n=mo).time=Rn(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&ji(a,t,e,u,s,n||yo(a,e));return new ho(r,this._parents,t,e)};const bo=t=>()=>t;function go(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function vo(t,e,n){this.k=t,this.x=e,this.y=n}vo.prototype={constructor:vo,scale:function(t){return 1===t?this:new vo(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new vo(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var wo=new vo(1,0,0);function xo(t){t.stopImmediatePropagation()}function So(t){t.preventDefault(),t.stopImmediatePropagation()}function Ao(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Io(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function ko(){return this.__zoom||wo}function Oo(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function To(){return navigator.maxTouchPoints||"ontouchstart"in this}function Lo(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function Mo(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Bo(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}vo.prototype;const Eo=Symbol("implicit");function Do(){var t=new jt,e=[],n=[],r=Eo;function i(i){let o=t.get(i);if(void 0===o){if(r!==Eo)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new jt;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Do(e,n).unknown(r)},Mo.apply(i,arguments),i}function jo(t){return+t}var zo=[0,1];function Co(t){return t}function Fo(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function No(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Fo(i,r),o=n(a,o)):(r=Fo(r,i),o=n(o,a)),function(t){return o(r(t))}}function Ro(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Fo(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Mt(t,e,1,r)-1;return o[n](i[n](e))}}function Uo(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Po(){var t,e,n,r,i,o,a=zo,s=zo,l=gi,u=Co;function c(){var t,e,n,l=Math.min(a.length,s.length);return u!==Co&&(t=a[0],e=a[l-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=l>2?Ro:No,i=o=null,f}function f(e){return null==e||isNaN(e=+e)?n:(i||(i=r(a.map(t),s,l)))(t(u(e)))}return f.invert=function(n){return u(e((o||(o=r(s,a.map(t),pi)))(n)))},f.domain=function(t){return arguments.length?(a=Array.from(t,jo),c()):a.slice()},f.range=function(t){return arguments.length?(s=Array.from(t),c()):s.slice()},f.rangeRound=function(t){return s=Array.from(t),l=vi,c()},f.clamp=function(t){return arguments.length?(u=!!t||Co,c()):u!==Co},f.interpolate=function(t){return arguments.length?(l=t,c()):l},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,c()}}function Vo(){return Po()(Co,Co)}function $o(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Wo(t){return(t=$o(Math.abs(t)))?t[1]:NaN}var Yo,Go=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qo(t){if(!(e=Go.exec(t)))throw new Error("invalid format: "+t);var e;return new Ho({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Ho(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Xo(t,e){var n=$o(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}qo.prototype=Ho.prototype,Ho.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Zo={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Xo(100*t,e),r:Xo,s:function(t,e){var n=$o(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Yo=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+$o(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Jo(t){return t}var Ko,Qo,ta,ea=Array.prototype.map,na=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ra(t){var e=t.domain;return t.ticks=function(t){var n=e();return Pt(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var i,o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?Vt(e,t,n):Vt(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,e,n);switch((r=qo(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Wo(e)/3)))-Wo(Math.abs(t)))}(o,a))||(r.precision=i),ta(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Wo(e)-Wo(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Wo(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return Qo(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,s=o.length-1,l=o[a],u=o[s],c=10;for(u<l&&(i=l,l=u,u=i,i=a,a=s,s=i);c-- >0;){if((i=Vt(l,u,n))===r)return o[a]=l,o[s]=u,e(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function ia(){var t=Vo();return t.copy=function(){return Uo(t,ia())},Mo.apply(t,arguments),ra(t)}function oa(t){return Math.log(t)}function aa(t){return Math.exp(t)}function sa(t){return-Math.log(-t)}function la(t){return-Math.exp(-t)}function ua(t){return isFinite(t)?+("1e"+t):t<0?0:t}function ca(t){return(e,n)=>-t(-e,n)}function fa(t){const e=t(oa,aa),n=e.domain;let r,i,o=10;function a(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(o),i=function(t){return 10===t?ua:t===Math.E?Math.exp:e=>Math.pow(t,e)}(o),n()[0]<0?(r=ca(r),i=ca(i),t(sa,la)):t(oa,aa),e}return e.base=function(t){return arguments.length?(o=+t,a()):o},e.domain=function(t){return arguments.length?(n(t),a()):n()},e.ticks=t=>{const e=n();let a=e[0],s=e[e.length-1];const l=s<a;l&&([a,s]=[s,a]);let u,c,f=r(a),d=r(s);const h=null==t?10:+t;let p=[];if(!(o%1)&&d-f<h){if(f=Math.floor(f),d=Math.ceil(d),a>0){for(;f<=d;++f)for(u=1;u<o;++u)if(c=f<0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}}else for(;f<=d;++f)for(u=o-1;u>=1;--u)if(c=f>0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}2*p.length<h&&(p=Pt(a,s,h))}else p=Pt(f,d,Math.min(d-f,h)).map(i);return l?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=qo(n)).precision||(n.trim=!0),n=Qo(n)),t===1/0)return n;const a=Math.max(1,o*t/e.ticks().length);return t=>{let e=t/i(Math.round(r(t)));return e*o<o-.5&&(e*=o),e<=a?n(t):""}},e.nice=()=>n(function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}(n(),{floor:t=>i(Math.floor(r(t))),ceil:t=>i(Math.ceil(r(t)))})),e}function da(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function ha(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function pa(t){return t<0?-t*t:t*t}function _a(t){var e=t(Co,Co),n=1;function r(){return 1===n?t(Co,Co):.5===n?t(ha,pa):t(da(n),da(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},ra(e)}function ma(){var t=_a(Po());return t.copy=function(){return Uo(t,ma()).exponent(t.exponent())},Mo.apply(t,arguments),t}function ya(){var t,e,n,r,i,o=0,a=1,s=Co,l=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([o,a]=i,t=r(o=+o),e=r(a=+a),n=t===e?0:1/(e-t),u):[o,a]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=c(gi),u.rangeRound=c(vi),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),u}}function ba(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ga(){var t=ra(ya()(Co));return t.copy=function(){return ba(t,ga())},Bo.apply(t,arguments)}function va(){var t=fa(ya()).domain([1,10]);return t.copy=function(){return ba(t,va()).base(t.base())},Bo.apply(t,arguments)}function wa(){var t=_a(ya());return t.copy=function(){return ba(t,wa()).exponent(t.exponent())},Bo.apply(t,arguments)}Ko=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Jo:(e=ea.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Jo:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ea.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=qo(t)).fill,n=t.align,f=t.sign,d=t.symbol,h=t.zero,p=t.width,_=t.comma,m=t.precision,y=t.trim,b=t.type;"n"===b?(_=!0,b="g"):Zo[b]||(void 0===m&&(m=12),y=!0,b="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var g="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",v="$"===d?o:/[%p]/.test(b)?l:"",w=Zo[b],x=/[defgprs%]/.test(b);function S(t){var i,o,l,d=g,S=v;if("c"===b)S=w(t)+S,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:w(Math.abs(t),m),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0==+t&&"+"!==f&&(A=!1),d=(A?"("===f?f:u:"-"===f||"("===f?"":f)+d,S=("s"===b?na[8+Yo/3]:"")+S+(A&&"("===f?")":""),x)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){S=(46===l?a+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}_&&!h&&(t=r(t,1/0));var I=d.length+t.length+S.length,k=I<p?new Array(p-I+1).join(e):"";switch(_&&h&&(t=r(k+t,k.length?p-S.length:1/0),k=""),n){case"<":t=d+t+S+k;break;case"=":t=d+k+t+S;break;case"^":t=k.slice(0,I=k.length>>1)+d+t+S+k.slice(I);break;default:t=k+d+t+S}return s(t)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),S.toString=function(){return t+""},S}return{format:f,formatPrefix:function(t,e){var n=f(((t=qo(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Wo(e)/3))),i=Math.pow(10,-r),o=na[8+r/3];return function(t){return n(i*t)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),Qo=Ko.format,ta=Ko.formatPrefix;class xa{constructor(t,e,n){this.prefs=e,this.svg_element_selection=St(t),this.width=+this.svg_element_selection.attr("width"),this.height=+this.svg_element_selection.attr("height"),this.renderers=new Map,this.scatterplot=n,this.renderers=new Map}attach_tiles(t){return this.tileSet=t,this.tileSet._zoom=this,this}attach_renderer(t,e){return this.renderers.set(t,e),e.bind_zoom(this),e.zoom.initialize_zoom(),this}zoom_to(t,e=null,n=null,r=4e3){const i=this.scales(),{svg_element_selection:o,zoomer:a,width:s,height:l}=this,u=wo.translate(s/2,l/2).scale(t).translate(-i.x(e),-i.y(n));o.transition().duration(r).call(a.transform,u)}html_annotation(t){const e=this.svg_element_selection.node().parentNode.parentNode;let n=.75;void 0!==this.scatterplot.prefs.tooltip_opacity&&(n=this.scatterplot.prefs.tooltip_opacity),St(e).selectAll("div.tooltip").data(t).join((t=>t.append("div").attr("class","tooltip").style("top",0).style("left",0).style("position","absolute").style("z-index",100).style("border-radius","8px").style("padding","10px").style("background","ivory").style("opacity",n)),(t=>t.html((t=>this.scatterplot.tooltip_html(t.data)))),(t=>t.call((t=>t.remove())))).html((t=>this.scatterplot.tooltip_html(t.data))).style("transform",(t=>`translate(${+t.x+t.dx}px, ${+t.y+t.dy}px)`))}zoom_to_bbox(t,e=4e3,n=1.111){const r=this.scales(),[i,o]=t.x.map(r.x),[a,s]=t.y.map(r.y),{svg_element_selection:l,zoomer:u,width:c,height:f}=this,d=wo.translate(c/2,f/2).scale(1/n/Math.max((o-i)/c,(s-a)/f)).translate(-(i+o)/2,-(a+s)/2);l.transition().duration(e).call(u.transform,d)}initialize_zoom(){const{width:t,height:e,svg_element_selection:n}=this;this.transform=wo;const r=function(){var t,e,n,r=Ao,i=Io,o=Lo,a=Oo,s=To,l=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],c=250,f=Li,d=Hn("start","zoom","end"),h=500,p=0,_=10;function m(t){t.property("__zoom",ko).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",I).filter(s).on("touchstart.zoom",k).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",T).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new vo(e,t.x,t.y)}function b(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new vo(t.k,r,i)}function g(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function v(t,e,n,r){t.on("start.zoom",(function(){w(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){w(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,a=w(t,o).event(r),s=i.apply(t,o),l=null==n?g(s):"function"==typeof n?n.apply(t,o):n,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),c=t.__zoom,d="function"==typeof e?e.apply(t,o):e,h=f(c.invert(l).concat(u/c.k),d.invert(l).concat(u/d.k));return function(t){if(1===t)t=d;else{var e=h(t),n=u/e[2];t=new vo(n,l[0]-e[0]*n,l[1]-e[1]*n)}a.zoom(null,t)}}))}function w(t,e,n){return!n&&t.__zooming||new x(t,e)}function x(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,e),this.taps=0}function S(t,...e){if(r.apply(this,arguments)){var n=w(this,e).event(t),i=this.__zoom,s=Math.max(l[0],Math.min(l[1],i.k*Math.pow(2,a.apply(this,arguments)))),c=At(t);if(n.wheel)n.mouse[0][0]===c[0]&&n.mouse[0][1]===c[1]||(n.mouse[1]=i.invert(n.mouse[0]=c)),clearTimeout(n.wheel);else{if(i.k===s)return;n.mouse=[c,i.invert(c)],Ni(this),n.start()}So(t),n.wheel=setTimeout(f,150),n.zoom("mouse",o(b(y(i,s),n.mouse[0],n.mouse[1]),n.extent,u))}function f(){n.wheel=null,n.end()}}function A(t,...e){if(!n&&r.apply(this,arguments)){var i=t.currentTarget,a=w(this,e,!0).event(t),s=St(t.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",h,!0),l=At(t,i),c=t.clientX,f=t.clientY;rr(t.view),xo(t),a.mouse=[l,this.__zoom.invert(l)],Ni(this),a.start()}function d(t){if(So(t),!a.moved){var e=t.clientX-c,n=t.clientY-f;a.moved=e*e+n*n>p}a.event(t).zoom("mouse",o(b(a.that.__zoom,a.mouse[0]=At(t,i),a.mouse[1]),a.extent,u))}function h(t){s.on("mousemove.zoom mouseup.zoom",null),ir(t.view,a.moved),So(t),a.event(t).end()}}function I(t,...e){if(r.apply(this,arguments)){var n=this.__zoom,a=At(t.changedTouches?t.changedTouches[0]:t,this),s=n.invert(a),l=n.k*(t.shiftKey?.5:2),f=o(b(y(n,l),a,s),i.apply(this,e),u);So(t),c>0?St(this).transition().duration(c).call(v,f,a,t):St(this).call(m.transform,f,a,t)}}function k(n,...i){if(r.apply(this,arguments)){var o,a,s,l,u=n.touches,c=u.length,f=w(this,i,n.changedTouches.length===c).event(n);for(xo(n),a=0;a<c;++a)l=[l=At(s=u[a],this),this.__zoom.invert(l),s.identifier],f.touch0?f.touch1||f.touch0[2]===l[2]||(f.touch1=l,f.taps=0):(f.touch0=l,o=!0,f.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(f.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),h)),Ni(this),f.start())}}function O(t,...e){if(this.__zooming){var n,r,i,a,s=w(this,e).event(t),l=t.changedTouches,c=l.length;for(So(t),n=0;n<c;++n)i=At(r=l[n],this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=i:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=i);if(r=s.that.__zoom,s.touch1){var f=s.touch0[0],d=s.touch0[1],h=s.touch1[0],p=s.touch1[1],_=(_=h[0]-f[0])*_+(_=h[1]-f[1])*_,m=(m=p[0]-d[0])*m+(m=p[1]-d[1])*m;r=y(r,Math.sqrt(_/m)),i=[(f[0]+h[0])/2,(f[1]+h[1])/2],a=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!s.touch0)return;i=s.touch0[0],a=s.touch0[1]}s.zoom("touch",o(b(r,i,a),s.extent,u))}}function T(t,...r){if(this.__zooming){var i,o,a=w(this,r).event(t),s=t.changedTouches,l=s.length;for(xo(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),h),i=0;i<l;++i)o=s[i],a.touch0&&a.touch0[2]===o.identifier?delete a.touch0:a.touch1&&a.touch1[2]===o.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(o=At(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<_)){var u=St(this).on("dblclick.zoom");u&&u.apply(this,arguments)}}}return m.transform=function(t,e,n,r){var i=t.selection?t.selection():t;i.property("__zoom",ko),t!==i?v(t,e,n,r):i.interrupt().each((function(){w(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},m.scaleBy=function(t,e,n,r){m.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),n,r)},m.scaleTo=function(t,e,n,r){m.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,a=null==n?g(t):"function"==typeof n?n.apply(this,arguments):n,s=r.invert(a),l="function"==typeof e?e.apply(this,arguments):e;return o(b(y(r,l),a,s),t,u)}),n,r)},m.translateBy=function(t,e,n,r){m.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),u)}),null,r)},m.translateTo=function(t,e,n,r,a){m.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,s=null==r?g(t):"function"==typeof r?r.apply(this,arguments):r;return o(wo.translate(s[0],s[1]).scale(a.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,u)}),r,a)},x.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=St(this.that).datum();d.call(t,this.that,new go(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:d}),e)}},m.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:bo(+t),m):a},m.filter=function(t){return arguments.length?(r="function"==typeof t?t:bo(!!t),m):r},m.touchable=function(t){return arguments.length?(s="function"==typeof t?t:bo(!!t),m):s},m.extent=function(t){return arguments.length?(i="function"==typeof t?t:bo([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):i},m.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],m):[l[0],l[1]]},m.translateExtent=function(t){return arguments.length?(u[0][0]=+t[0][0],u[1][0]=+t[1][0],u[0][1]=+t[0][1],u[1][1]=+t[1][1],m):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},m.constrain=function(t){return arguments.length?(o=t,m):o},m.duration=function(t){return arguments.length?(c=+t,m):c},m.interpolate=function(t){return arguments.length?(f=t,m):f},m.on=function(){var t=d.on.apply(d,arguments);return t===d?m:t},m.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,m):Math.sqrt(p)},m.tapDistance=function(t){return arguments.length?(_=+t,m):_},m}().scaleExtent([1/3,1e5]).extent([[0,0],[t,e]]).on("zoom",(t=>{var e,n,r;try{document.getElementById("tooltipcircle").remove()}catch(t){}this.transform=t.transform,this.restart_timer(1e4),null==(n=(e=this.scatterplot).on_zoom)||n.call(e,t.transform),null==(r=null==t?void 0:t.sourceEvent)||r.stopPropagation()}));n.call(r),this.add_mouseover(),this.zoomer=r}set_highlit_points(t){const{x_:e,y_:n}=this.scales(),r=this.scatterplot.dim("x"),i=this.scatterplot.dim("y"),o=t.map((t=>({x:e(r.apply(t)),y:n(i.apply(t)),data:t,dx:0,dy:30})));this.html_annotation(o),this.svg_element_selection.select("#mousepoints").selectAll("circle.label").data(t,(t=>t.ix)).join((t=>t.append("circle").attr("id","tooltipcircle").attr("class","label").attr("stroke","#110022").attr("r",12).attr("fill",(t=>this.scatterplot.dim("color").apply(t))).attr("cx",(t=>e(r.apply(t)))).attr("cy",(t=>n(i.apply(t))))),(t=>t.attr("fill",(t=>this.scatterplot.dim("color").apply(t)))),(t=>t.call((t=>{t.remove(),this.prefs.exit_function&&this.prefs.exit_function()})))).on("click",((t,e)=>{this.scatterplot.click_function(e)}))}set_highlit_point(t){this.set_highlit_points([t])}add_mouseover(){let t=0;const e=this.renderers.get("regl");this.svg_element_selection.on("mousemove",(n=>{if(Date.now()-t<75)return;t=Date.now();const r=e.color_pick(n.offsetX,n.offsetY);null===r?this.set_highlit_points([]):this.set_highlit_points([r])}))}current_corners(){const{width:t,height:e}=this,n=this.scales();if(void 0===n)return;const{x_:r,y_:i}=n;return{x:[r.invert(0),r.invert(t)],y:[i.invert(0),i.invert(e)]}}current_center(){const{x:t,y:e}=this.current_corners();return[(t[0]+t[1])/2,(e[0]+e[1])/2]}restart_timer(t=1e4){let e=Date.now()+t;this._timer&&(this._timer.stop_at>e&&(e=this._timer.stop_at),this._timer.stop());const n=Vn(this.tick.bind(this));return this._timer=n,this._timer.stop_at=e,this._timer}data(t){return void 0===t?this.tileSet:(this.tileSet=t,this)}scales(t=!0){if(this._scales)return this._scales.x_=this.transform.rescaleX(this._scales.x),this._scales.y_=this.transform.rescaleY(this._scales.y),this._scales;const{width:e,height:n}=this;if(void 0===this.tileSet)throw new Error("Error--scales created before tileSet present.");const{extent:r}=this.tileSet,i={};if(void 0===r)throw new Error("Error--scales created before extent present.");const o={};for(const[t,i]of[["x",e],["y",n]]){const e=r[t],n=e[1]-e[0];o[t]={limits:e,size_range:n,pixels_per_unit:i/n}}const a=o.x.pixels_per_unit/o.y.pixels_per_unit;let s=0,l=0,u=e,c=n;return a>1?(u=e/a,s=(e-u)/2):(c=n*a,l=(n-c)/2),i.x=ia().domain(o.x.limits).range([s,e-s]),i.y=ia().domain(o.y.limits).range([l,n-l]),i.x_=this.transform.rescaleX(i.x),i.y_=this.transform.rescaleY(i.y),this._scales=i,i}webgl_scale(t=!0){const{x:e,y:n}=this.scales();return function(t,e){function n(t){return t[1]-t[0]}const r=Yt(t.domain()),i=Yt(e.domain()),o=n(t.range())/n(t.domain()),a=n(e.range())/n(e.domain());return[[o,0,-o*r+Yt(t.range())],[0,a,-a*i+Yt(e.range())],[0,0,1]]}(e,n).flat()}tick(t=!1){this._start=this._start||Date.now(),!0!==t&&this._timer&&this._timer.stop_at<=Date.now()&&this._timer.stop()}}var Sa={};({get exports(){return Sa},set exports(t){Sa=t}}).exports=function(){var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var n=Object.keys(e),r=0;r<n.length;++r)t[n[r]]=e[n[r]];return t},n="\n";function r(t){var e=new Error("(regl) "+t);throw console.error(e),e}function i(t,e){t||r(e)}function o(t){return t?": "+t:""}function a(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return void 0===t;case"symbol":return"symbol"==typeof t}}function s(t,e,n){e.indexOf(t)<0&&r("invalid value"+o(n)+". must be one of: "+e)}var l=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function u(t,e){for(t+="";t.length<e;)t=" "+t;return t}function c(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function f(t,e){this.number=t,this.line=e,this.errors=[]}function d(t,e,n){this.file=t,this.line=e,this.message=n}function h(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return r?r[1]:"unknown"}function p(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return r?r[1]:"unknown"}function _(t,e){var n,r=t.split("\n"),i=1,o=0,a={unknown:new c,0:new c};a.unknown.name=a[0].name=e||h(),a.unknown.lines.push(new f(0,""));for(var s=0;s<r.length;++s){var l=r[s],u=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(l);if(u)switch(u[1]){case"line":var d=/(\d+)(\s+\d+)?/.exec(u[2]);d&&(i=0|d[1],d[2]&&((o=0|d[2])in a||(a[o]=new c)));break;case"define":var p=/SHADER_NAME(_B64)?\s+(.*)$/.exec(u[2]);p&&(a[o].name=p[1]?(n=p[2],"undefined"!=typeof atob?atob(n):"base64:"+n):p[2])}a[o].lines.push(new f(i++,l))}return Object.keys(a).forEach((function(t){var e=a[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),a}function m(t){t._commandRef=h()}function y(t,e){var n=p();r(t+" in command "+(e||h())+("unknown"===n?"":" called from "+n))}function b(t,e,n,r){a(t,e)||y("invalid parameter type"+o(n)+". expected "+e+", got "+typeof t,r||h())}var g=33071,v={};function w(t,e){return 32820===t||32819===t||33635===t?2:34042===t?4:v[t]*e}function x(t){return!(t&t-1||!t)}v[5120]=v[5121]=1,v[5122]=v[5123]=v[36193]=v[33635]=v[32819]=v[32820]=2,v[5124]=v[5125]=v[5126]=v[34042]=4;var S=e(i,{optional:function(t){t()},raise:r,commandRaise:y,command:function(t,e,n){t||y(e,n||h())},parameter:function(t,e,n){t in e||r("unknown parameter ("+t+")"+o(n)+". possible values: "+Object.keys(e).join())},commandParameter:function(t,e,n,r){t in e||y("unknown parameter ("+t+")"+o(n)+". possible values: "+Object.keys(e).join(),r||h())},constructor:function(t){Object.keys(t).forEach((function(t){l.indexOf(t)<0&&r('invalid regl constructor argument "'+t+'". must be one of '+l)}))},type:function(t,e,n){a(t,e)||r("invalid parameter type"+o(n)+". expected "+e+", got "+typeof t)},commandType:b,isTypedArray:function(e,n){t(e)||r("invalid parameter type"+o(n)+". must be a typed array")},nni:function(t,e){t>=0&&(0|t)===t||r("invalid parameter type, ("+t+")"+o(e)+". must be a nonnegative integer")},oneOf:s,shaderError:function(t,e,r,o,a){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(e),l=o===t.FRAGMENT_SHADER?"fragment":"vertex";b(r,"string",l+" shader source must be a string",a);var c=_(r,a),f=function(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);n?e.push(new d(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new d("unknown",0,t))}})),e}(s);(function(t,e){e.forEach((function(e){var n=t[e.file];if(n){var r=n.index[e.line];if(r)return r.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))})(c,f),Object.keys(c).forEach((function(t){var e=c[t];if(e.hasErrors){var r=[""],i=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){o(u(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(t.line+n,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(r){var i=r.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(a){var s=a[1];i=a[2],"assign"===s&&(s="="),e=Math.max(t.line.indexOf(s,e),0)}else e=0;o(u("| ",6)),o(u("^^^",e+3)+n,"font-weight:bold"),o(u("| ",6)),o(i+n,"font-weight:bold")})),o(u("| ",6)+n)}else o(u(t.number,4)+"|  "),o(t.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(r.join("")):(i[0]=r.join("%c"),console.log.apply(console,i))}function o(t,e){r.push(t),i.push(e||"")}})),i.raise("Error compiling "+l+" shader, "+c[0].name)}},linkError:function(t,e,r,o,a){if(!t.getProgramParameter(e,t.LINK_STATUS)){var s=t.getProgramInfoLog(e),l=_(r,a),u='Error linking program with vertex shader, "'+_(o,a)[0].name+'", and fragment shader "'+l[0].name+'"';"undefined"!=typeof document?console.log("%c"+u+"\n%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(u+n+s),i.raise(u)}},callSite:p,saveCommandRef:m,saveDrawInfo:function(t,e,n,r){function i(t){return t?r.id(t):0}function o(t,e){Object.keys(e).forEach((function(e){t[r.id(e)]=!0}))}m(t),t._fragId=i(t.static.frag),t._vertId=i(t.static.vert);var a=t._uniformSet={};o(a,e.static),o(a,e.dynamic);var s=t._attributeSet={};o(s,n.static),o(s,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic},framebufferFormat:function(t,e,n){t.texture?s(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):s(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:h,texture2D:function(t,e,n){var r,o=e.width,a=e.height,s=e.channels;i(o>0&&o<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),t.wrapS===g&&t.wrapT===g||i(x(o)&&x(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==o&&1!==a&&i(9984!==t.minFilter&&9986!==t.minFilter&&9985!==t.minFilter&&9987!==t.minFilter,"min filter requires mipmap"):(i(x(o)&&x(a),"texture must be a square power of 2 to support mipmapping"),i(e.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),5126===e.type&&(n.extensions.indexOf("oes_texture_float_linear")<0&&i(9728===t.minFilter&&9728===t.magFilter,"filter not supported, must enable oes_texture_float_linear"),i(!t.genMipmaps,"mipmap generation not supported with float textures"));var l=e.images;for(r=0;r<16;++r)if(l[r]){var u=o>>r,c=a>>r;i(e.mipmask&1<<r,"missing mipmap data");var f=l[r];if(i(f.width===u&&f.height===c,"invalid shape for mip images"),i(f.format===e.format&&f.internalformat===e.internalformat&&f.type===e.type,"incompatible type for mip image"),f.compressed);else if(f.data){var d=Math.ceil(w(f.type,s)*u/f.unpackAlignment)*f.unpackAlignment;i(f.data.byteLength===d*c,"invalid data for image, buffer size is inconsistent with image format")}else f.element||f.copy}else t.genMipmaps||i(0==(e.mipmask&1<<r),"extra mipmap data");e.compressed&&i(!t.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(t,e,n,r){var o=t.width,a=t.height,s=t.channels;i(o>0&&o<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),i(o===a,"cube map must be square"),i(e.wrapS===g&&e.wrapT===g,"wrap mode not supported by cube map");for(var l=0;l<n.length;++l){var u=n[l];i(u.width===o&&u.height===a,"inconsistent cube map face shape"),e.genMipmaps&&(i(!u.compressed,"can not generate mipmap for compressed textures"),i(1===u.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=u.images,f=0;f<16;++f){var d=c[f];if(d){var h=o>>f,p=a>>f;i(u.mipmask&1<<f,"missing mipmap data"),i(d.width===h&&d.height===p,"invalid shape for mip images"),i(d.format===t.format&&d.internalformat===t.internalformat&&d.type===t.type,"incompatible type for mip image"),d.compressed||(d.data?i(d.data.byteLength===h*p*Math.max(w(d.type,s),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}}),A=0;function I(t,e){this.id=A++,this.type=t,this.data=e}function k(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function O(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+k(t.substr(1,t.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(r)return O(t.substr(0,r.index)).concat(O(r[1])).concat(O(t.substr(r.index+r[0].length)));var i=t.split(".");if(1===i.length)return['"'+k(t)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(O(i[a]));return o}function T(t){return"["+O(t).join("][")+"]"}var L={DynamicVariable:I,define:function(t,e){return new I(t,T(e+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof I},unbox:function t(e,n){return"function"==typeof e?new I(0,e):"number"==typeof e||"boolean"==typeof e?new I(5,e):Array.isArray(e)?new I(6,e.map((function(e,r){return t(e,n+"["+r+"]")}))):e instanceof I?e:void S(!1,"invalid option type in uniform "+n)},accessor:T},M={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},B="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function E(t){return"string"==typeof t?t.split():(S(Array.isArray(t),"invalid extension array"),t)}function D(t){return"string"==typeof t?(S("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function j(t){var n,r,i,o,a,s=t||{},l={},u=[],c=[],f="undefined"==typeof window?1:window.devicePixelRatio,d=!1,h=function(t){t&&S.raise(t)},p=function(){};if("string"==typeof s?(S("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),n=document.querySelector(s),S(n,"invalid query string for element")):"object"==typeof s?"string"==typeof(a=s).nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?n=s:function(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}(s)?i=(o=s).canvas:(S.constructor(s),"gl"in s?o=s.gl:"canvas"in s?i=D(s.canvas):"container"in s&&(r=D(s.container)),"attributes"in s&&(l=s.attributes,S.type(l,"object","invalid context attributes")),"extensions"in s&&(u=E(s.extensions)),"optionalExtensions"in s&&(c=E(s.optionalExtensions)),"onDone"in s&&(S.type(s.onDone,"function","invalid or missing onDone callback"),h=s.onDone),"profile"in s&&(d=!!s.profile),"pixelRatio"in s&&(f=+s.pixelRatio,S(f>0,"invalid pixel ratio"))):S.raise("invalid arguments to regl"),n&&("canvas"===n.nodeName.toLowerCase()?i=n:r=n),!o){if(!i){S("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var _=function(t,n,r){var i,o=document.createElement("canvas");function a(){var e=window.innerWidth,n=window.innerHeight;if(t!==document.body){var i=o.getBoundingClientRect();e=i.right-i.left,n=i.bottom-i.top}o.width=r*e,o.height=r*n}return e(o.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),t.appendChild(o),t===document.body&&(o.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(a)}))).observe(t):window.addEventListener("resize",a,!1),a(),{canvas:o,onDestroy:function(){i?i.disconnect():window.removeEventListener("resize",a),t.removeChild(o)}}}(r||document.body,0,f);if(!_)return null;i=_.canvas,p=_.onDestroy}void 0===l.premultipliedAlpha&&(l.premultipliedAlpha=!0),o=function(t,e){function n(n){try{return t.getContext(n,e)}catch(t){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(i,l)}return o?{gl:o,canvas:i,container:r,extensions:u,optionalExtensions:c,pixelRatio:f,profile:d,onDone:h,onDestroy:p}:(p(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function z(t,e){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r);return n}function C(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1}function F(){var t=z(8,(function(){return[]}));function e(e){var n=function(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}(e),r=t[C(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(e){t[C(e.byteLength)>>2].push(e)}return{alloc:e,free:n,allocType:function(t,n){var r=null;switch(t){case 5120:r=new Int8Array(e(n),0,n);break;case 5121:r=new Uint8Array(e(n),0,n);break;case 5122:r=new Int16Array(e(2*n),0,n);break;case 5123:r=new Uint16Array(e(2*n),0,n);break;case 5124:r=new Int32Array(e(4*n),0,n);break;case 5125:r=new Uint32Array(e(4*n),0,n);break;case 5126:r=new Float32Array(e(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(t){n(t.buffer)}}}var N=F();N.zero=F();var R=3553,U=6408,P=5126,V=36160;function $(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var W=function(t){return Object.keys(t).map((function(e){return t[e]}))},Y={shape:function(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e},flatten:function(t,e,n,r){var i=1;if(e.length)for(var o=0;o<e.length;++o)i*=e[o];else i=0;var a=r||N.allocType(n,i);switch(e.length){case 0:break;case 1:!function(t,e,n){for(var r=0;r<e;++r)n[r]=t[r]}(t,e[0],a);break;case 2:!function(t,e,n,r){for(var i=0,o=0;o<e;++o)for(var a=t[o],s=0;s<n;++s)r[i++]=a[s]}(t,e[0],e[1],a);break;case 3:G(t,e[0],e[1],e[2],a,0);break;default:q(t,e,0,a,0)}return a}};function G(t,e,n,r,i,o){for(var a=o,s=0;s<e;++s)for(var l=t[s],u=0;u<n;++u)for(var c=l[u],f=0;f<r;++f)i[a++]=c[f]}function q(t,e,n,r,i){for(var o=1,a=n+1;a<e.length;++a)o*=e[a];var s=e[n];if(e.length-n==4){var l=e[n+1],u=e[n+2],c=e[n+3];for(a=0;a<s;++a)G(t[a],l,u,c,r,i),i+=o}else for(a=0;a<s;++a)q(t[a],e,n+1,r,i),i+=o}var H={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},X={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Z={dynamic:35048,stream:35040,static:35044},J=Y.flatten,K=Y.shape,Q=5121,tt=5126,et=[];function nt(t){return 0|H[Object.prototype.toString.call(t)]}function rt(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function it(t,e,n,r,i,o,a){for(var s=0,l=0;l<n;++l)for(var u=0;u<r;++u)t[s++]=e[i*l+o*u+a]}et[5120]=1,et[5122]=2,et[5124]=4,et[5121]=1,et[5123]=2,et[5125]=4,et[5126]=4;var ot={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},at=5121,st=5123,lt=5125,ut=34963;var ct=new Float32Array(1),ft=new Uint32Array(ct.buffer);function dt(t){for(var e=N.allocType(5123,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{ct[0]=t[n];var r=ft[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)e[n]=i;else if(o<-14){var s=-14-o;e[n]=i+(a+1024>>s)}else e[n]=o>15?i+31744:i+(o+15<<10)+a}return e}function ht(e){return Array.isArray(e)||t(e)}var pt=function(t){return!(t&t-1||!t)},_t=3553,mt=34067,yt=34069,bt=6408,gt=6406,vt=6407,wt=6409,xt=6410,St=32855,At=6402,It=34041,kt=35904,Ot=35906,Tt=36193,Lt=33776,Mt=33777,Bt=33778,Et=33779,Dt=5121,jt=5123,zt=5125,Ct=5126,Ft=33071,Nt=9728,Rt=9984,Ut=9987,Pt=4352,Vt=33984,$t=[Rt,9986,9985,Ut],Wt=[0,wt,xt,vt,bt],Yt={};function Gt(t){return"[object "+t+"]"}Yt[6409]=Yt[6406]=Yt[6402]=1,Yt[34041]=Yt[6410]=2,Yt[6407]=Yt[35904]=3,Yt[6408]=Yt[35906]=4;var qt=Gt("HTMLCanvasElement"),Ht=Gt("OffscreenCanvas"),Xt=Gt("CanvasRenderingContext2D"),Zt=Gt("ImageBitmap"),Jt=Gt("HTMLImageElement"),Kt=Gt("HTMLVideoElement"),Qt=Object.keys(H).concat([qt,Ht,Xt,Zt,Jt,Kt]),te=[];te[5121]=1,te[5126]=4,te[36193]=2,te[5123]=2,te[5125]=4;var ee=[];function ne(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function re(t){return!!Array.isArray(t)&&!(0===t.length||!ht(t[0]))}function ie(t){return Object.prototype.toString.call(t)}function oe(t){return ie(t)===qt}function ae(t){return ie(t)===Ht}function se(t){if(!t)return!1;var e=ie(t);return Qt.indexOf(e)>=0||ne(t)||re(t)||$(t)}function le(t){return 0|H[Object.prototype.toString.call(t)]}function ue(t,e){return N.allocType(t.type===Tt?Ct:t.type,e)}function ce(t,e){t.type===Tt?(t.data=dt(e),N.freeType(e)):t.data=e}function fe(t,e,n,r,i,o){var a;if(a=void 0!==ee[t]?ee[t]:Yt[t]*te[e],o&&(a*=6),i){for(var s=0,l=n;l>=1;)s+=a*l*l,l/=2;return s}return a*n*r}function de(n,r,i,o,a,s,l){var u={"don't care":Pt,"dont care":Pt,nice:4354,fast:4353},c={repeat:10497,clamp:Ft,mirror:33648},f={nearest:Nt,linear:9729},d=e({mipmap:Ut,"nearest mipmap nearest":Rt,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":Ut},f),h={none:0,browser:37444},p={uint8:Dt,rgba4:32819,rgb565:33635,"rgb5 a1":32820},_={alpha:gt,luminance:wt,"luminance alpha":xt,rgb:vt,rgba:bt,rgba4:32854,"rgb5 a1":St,rgb565:36194},m={};r.ext_srgb&&(_.srgb=kt,_.srgba=Ot),r.oes_texture_float&&(p.float32=p.float=Ct),r.oes_texture_half_float&&(p.float16=p["half float"]=Tt),r.webgl_depth_texture&&(e(_,{depth:At,"depth stencil":It}),e(p,{uint16:jt,uint32:zt,"depth stencil":34042})),r.webgl_compressed_texture_s3tc&&e(m,{"rgb s3tc dxt1":Lt,"rgba s3tc dxt1":Mt,"rgba s3tc dxt3":Bt,"rgba s3tc dxt5":Et}),r.webgl_compressed_texture_atc&&e(m,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),r.webgl_compressed_texture_pvrtc&&e(m,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),r.webgl_compressed_texture_etc1&&(m["rgb etc1"]=36196);var y=Array.prototype.slice.call(n.getParameter(34467));Object.keys(m).forEach((function(t){var e=m[t];y.indexOf(e)>=0&&(_[t]=e)}));var b=Object.keys(_);i.textureFormats=b;var g=[];Object.keys(_).forEach((function(t){var e=_[t];g[e]=t}));var v=[];Object.keys(p).forEach((function(t){var e=p[t];v[e]=t}));var w=[];Object.keys(f).forEach((function(t){w[f[t]]=t}));var x=[];Object.keys(d).forEach((function(t){var e=d[t];x[e]=t}));var A=[];Object.keys(c).forEach((function(t){A[c[t]]=t}));var I=b.reduce((function(t,e){var n=_[e];return n===wt||n===gt||n===wt||n===xt||n===At||n===It||r.ext_srgb&&(n===kt||n===Ot)?t[n]=n:n===St||e.indexOf("rgba")>=0?t[n]=bt:t[n]=vt,t}),{});function k(){this.internalformat=bt,this.format=bt,this.type=Dt,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function O(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function T(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(S.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(S.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(S.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(S.parameter(e.colorSpace,h,"invalid colorSpace"),t.colorSpace=h[e.colorSpace]),"type"in e){var n=e.type;S(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),S(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),S(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),S.parameter(n,p,"invalid texture type"),t.type=p[n]}var o=t.width,a=t.height,s=t.channels,l=!1;"shape"in e?(S(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),o=e.shape[0],a=e.shape[1],3===e.shape.length&&(s=e.shape[2],S(s>0&&s<=4,"invalid number of channels"),l=!0),S(o>=0&&o<=i.maxTextureSize,"invalid width"),S(a>=0&&a<=i.maxTextureSize,"invalid height")):("radius"in e&&(o=a=e.radius,S(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in e&&(o=e.width,S(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in e&&(a=e.height,S(a>=0&&a<=i.maxTextureSize,"invalid height")),"channels"in e&&(s=e.channels,S(s>0&&s<=4,"invalid number of channels"),l=!0)),t.width=0|o,t.height=0|a,t.channels=0|s;var u=!1;if("format"in e){var c=e.format;S(r.webgl_depth_texture||!("depth"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),S.parameter(c,_,"invalid texture format");var f=t.internalformat=_[c];t.format=I[f],c in p&&("type"in e||(t.type=p[c])),c in m&&(t.compressed=!0),u=!0}!l&&u?t.channels=Yt[t.format]:l&&!u?t.channels!==Wt[t.format]&&(t.format=t.internalformat=Wt[t.channels]):u&&l&&S(t.channels===Yt[t.format],"number of channels inconsistent with specified format")}}function L(t){n.pixelStorei(37440,t.flipY),n.pixelStorei(37441,t.premultiplyAlpha),n.pixelStorei(37443,t.colorSpace),n.pixelStorei(3317,t.unpackAlignment)}function M(){k.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function B(e,n){var r=null;if(se(n)?r=n:n&&(S.type(n,"object","invalid pixel data type"),T(e,n),"x"in n&&(e.xOffset=0|n.x),"y"in n&&(e.yOffset=0|n.y),se(n.data)&&(r=n.data)),S(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){S(!r,"can not specify copy and data field for the same texture");var o=a.viewportWidth,s=a.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||s-e.yOffset,e.needsCopy=!0,S(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<s&&e.width>0&&e.width<=o&&e.height>0&&e.height<=s,"copy texture read out of bounds")}else if(r){if(t(r))e.channels=e.channels||4,e.data=r,"type"in n||e.type!==Dt||(e.type=le(r));else if(ne(r))e.channels=e.channels||4,function(t,e){var n=e.length;switch(t.type){case Dt:case jt:case zt:case Ct:var r=N.allocType(t.type,n);r.set(e),t.data=r;break;case Tt:t.data=dt(e);break;default:S.raise("unsupported texture type, must specify a typed array")}}(e,r),e.alignment=1,e.needsFree=!0;else if($(r)){var l=r.data;Array.isArray(l)||e.type!==Dt||(e.type=le(l));var u,c,f,d,h,p,_=r.shape,m=r.stride;3===_.length?(f=_[2],p=m[2]):(S(2===_.length,"invalid ndarray pixel data, must be 2 or 3D"),f=1,p=1),u=_[0],c=_[1],d=m[0],h=m[1],e.alignment=1,e.width=u,e.height=c,e.channels=f,e.format=e.internalformat=Wt[f],e.needsFree=!0,function(t,e,n,r,i,o){for(var a=t.width,s=t.height,l=t.channels,u=ue(t,a*s*l),c=0,f=0;f<s;++f)for(var d=0;d<a;++d)for(var h=0;h<l;++h)u[c++]=e[n*d+r*f+i*h+o];ce(t,u)}(e,l,d,h,p,r.offset)}else if(oe(r)||ae(r)||ie(r)===Xt)oe(r)||ae(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(function(t){return ie(t)===Zt}(r))e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(function(t){return ie(t)===Jt}(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(function(t){return ie(t)===Kt}(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(re(r)){var y=e.width||r[0].length,b=e.height||r.length,g=e.channels;g=ht(r[0][0])?g||r[0][0].length:g||1;for(var v=Y.shape(r),w=1,x=0;x<v.length;++x)w*=v[x];var A=ue(e,w);Y.flatten(r,v,"",A),ce(e,A),e.alignment=1,e.width=y,e.height=b,e.channels=g,e.format=e.internalformat=Wt[g],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===Ct?S(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===Tt&&S(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function E(t,e,r){var i=t.element,a=t.data,s=t.internalformat,l=t.format,u=t.type,c=t.width,f=t.height;L(t),i?n.texImage2D(e,r,l,l,u,i):t.compressed?n.compressedTexImage2D(e,r,s,c,f,0,a):t.needsCopy?(o(),n.copyTexImage2D(e,r,l,t.xOffset,t.yOffset,c,f,0)):n.texImage2D(e,r,l,c,f,0,l,u,a||null)}function D(t,e,r,i,a){var s=t.element,l=t.data,u=t.internalformat,c=t.format,f=t.type,d=t.width,h=t.height;L(t),s?n.texSubImage2D(e,a,r,i,c,f,s):t.compressed?n.compressedTexSubImage2D(e,a,r,i,u,d,h,l):t.needsCopy?(o(),n.copyTexSubImage2D(e,a,r,i,t.xOffset,t.yOffset,d,h)):n.texSubImage2D(e,a,r,i,d,h,c,f,l)}var j=[];function z(){return j.pop()||new M}function C(t){t.needsFree&&N.freeType(t.data),M.call(t),j.push(t)}function F(){k.call(this),this.genMipmaps=!1,this.mipmapHint=Pt,this.mipmask=0,this.images=Array(16)}function R(t,e,n){var r=t.images[0]=z();t.mipmask=1,r.width=t.width=e,r.height=t.height=n,r.channels=t.channels=4}function U(t,e){var n=null;if(se(e))O(n=t.images[0]=z(),t),B(n,e),t.mipmask=1;else if(T(t,e),Array.isArray(e.mipmap))for(var r=e.mipmap,i=0;i<r.length;++i)O(n=t.images[i]=z(),t),n.width>>=i,n.height>>=i,B(n,r[i]),t.mipmask|=1<<i;else O(n=t.images[0]=z(),t),B(n,e),t.mipmask=1;O(t,t.images[0]),!t.compressed||t.internalformat!==Lt&&t.internalformat!==Mt&&t.internalformat!==Bt&&t.internalformat!==Et||S(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function P(t,e){for(var n=t.images,r=0;r<n.length;++r){if(!n[r])return;E(n[r],e,r)}}var V=[];function G(){var t=V.pop()||new F;k.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function q(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&C(e[n]),e[n]=null;V.push(t)}function H(){this.minFilter=Nt,this.magFilter=Nt,this.wrapS=Ft,this.wrapT=Ft,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Pt}function X(t,e){if("min"in e){var n=e.min;S.parameter(n,d),t.minFilter=d[n],$t.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var r=e.mag;S.parameter(r,f),t.magFilter=f[r]}var o=t.wrapS,a=t.wrapT;if("wrap"in e){var s=e.wrap;"string"==typeof s?(S.parameter(s,c),o=a=c[s]):Array.isArray(s)&&(S.parameter(s[0],c),S.parameter(s[1],c),o=c[s[0]],a=c[s[1]])}else{if("wrapS"in e){var l=e.wrapS;S.parameter(l,c),o=c[l]}if("wrapT"in e){var h=e.wrapT;S.parameter(h,c),a=c[h]}}if(t.wrapS=o,t.wrapT=a,"anisotropic"in e){var p=e.anisotropic;S("number"==typeof p&&p>=1&&p<=i.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var _=!1;switch(typeof e.mipmap){case"string":S.parameter(e.mipmap,u,"invalid mipmap hint"),t.mipmapHint=u[e.mipmap],t.genMipmaps=!0,_=!0;break;case"boolean":_=t.genMipmaps=e.mipmap;break;case"object":S(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,_=!0;break;default:S.raise("invalid mipmap type")}_&&!("min"in e)&&(t.minFilter=Rt)}}function Z(t,e){n.texParameteri(e,10241,t.minFilter),n.texParameteri(e,10240,t.magFilter),n.texParameteri(e,10242,t.wrapS),n.texParameteri(e,10243,t.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(e,34046,t.anisotropic),t.genMipmaps&&(n.hint(33170,t.mipmapHint),n.generateMipmap(e))}var J=0,K={},Q=i.maxTextureUnits,tt=Array(Q).map((function(){return null}));function et(t){k.call(this),this.mipmask=0,this.internalformat=bt,this.id=J++,this.refCount=1,this.target=t,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,l.profile&&(this.stats={size:0})}function nt(t){n.activeTexture(Vt),n.bindTexture(t.target,t.texture)}function rt(){var t=tt[0];t?n.bindTexture(t.target,t.texture):n.bindTexture(_t,null)}function it(t){var e=t.texture;S(e,"must not double destroy texture");var r=t.unit,i=t.target;r>=0&&(n.activeTexture(Vt+r),n.bindTexture(i,null),tt[r]=null),n.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete K[t.id],s.textureCount--}return e(et.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var r=0;r<Q;++r){var i=tt[r];if(i){if(i.bindCount>0)continue;i.unit=-1}tt[r]=t,e=r;break}e>=Q&&S.raise("insufficient number of texture units"),l.profile&&s.maxTextureUnits<e+1&&(s.maxTextureUnits=e+1),t.unit=e,n.activeTexture(Vt+e),n.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&it(this)}}),l.profile&&(s.getTotalTextureSize=function(){var t=0;return Object.keys(K).forEach((function(e){t+=K[e].stats.size})),t}),{create2D:function(t,e){var r=new et(_t);function o(t,e){var n=r.texInfo;H.call(n);var a=G();return"number"==typeof t?R(a,0|t,"number"==typeof e?0|e:0|t):t?(S.type(t,"object","invalid arguments to regl.texture"),X(n,t),U(a,t)):R(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,O(r,a),S.texture2D(n,a,i),r.internalformat=a.internalformat,o.width=a.width,o.height=a.height,nt(r),P(a,_t),Z(n,_t),rt(),q(a),l.profile&&(r.stats.size=fe(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),o.format=g[r.internalformat],o.type=v[r.type],o.mag=w[n.magFilter],o.min=x[n.minFilter],o.wrapS=A[n.wrapS],o.wrapT=A[n.wrapT],o}return K[r.id]=r,s.textureCount++,o(t,e),o.subimage=function(t,e,n,i){S(!!t,"must specify image data");var a=0|e,s=0|n,l=0|i,u=z();return O(u,r),u.width=0,u.height=0,B(u,t),u.width=u.width||(r.width>>l)-a,u.height=u.height||(r.height>>l)-s,S(r.type===u.type&&r.format===u.format&&r.internalformat===u.internalformat,"incompatible format for texture.subimage"),S(a>=0&&s>=0&&a+u.width<=r.width&&s+u.height<=r.height,"texture.subimage write out of bounds"),S(r.mipmask&1<<l,"missing mipmap data"),S(u.data||u.element||u.needsCopy,"missing image data"),nt(r),D(u,_t,a,s,l),rt(),C(u),o},o.resize=function(t,e){var i=0|t,a=0|e||i;if(i===r.width&&a===r.height)return o;o.width=r.width=i,o.height=r.height=a,nt(r);for(var s=0;r.mipmask>>s;++s){var u=i>>s,c=a>>s;if(!u||!c)break;n.texImage2D(_t,s,r.format,u,c,0,r.format,r.type,null)}return rt(),l.profile&&(r.stats.size=fe(r.internalformat,r.type,i,a,!1,!1)),o},o._reglType="texture2d",o._texture=r,l.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o},createCube:function(t,e,r,o,a,u){var c=new et(mt);K[c.id]=c,s.cubeCount++;var f=new Array(6);function d(t,e,n,r,o,a){var s,u=c.texInfo;for(H.call(u),s=0;s<6;++s)f[s]=G();if("number"!=typeof t&&t)if("object"==typeof t)if(e)U(f[0],t),U(f[1],e),U(f[2],n),U(f[3],r),U(f[4],o),U(f[5],a);else if(X(u,t),T(c,t),"faces"in t){var h=t.faces;for(S(Array.isArray(h)&&6===h.length,"cube faces must be a length 6 array"),s=0;s<6;++s)S("object"==typeof h[s]&&!!h[s],"invalid input for cube map face"),O(f[s],c),U(f[s],h[s])}else for(s=0;s<6;++s)U(f[s],t);else S.raise("invalid arguments to cube map");else{var p=0|t||1;for(s=0;s<6;++s)R(f[s],p,p)}for(O(c,f[0]),S.optional((function(){i.npotTextureCube||S(pt(c.width)&&pt(c.height),"your browser does not support non power or two texture dimensions")})),u.genMipmaps?c.mipmask=(f[0].width<<1)-1:c.mipmask=f[0].mipmask,S.textureCube(c,u,f,i),c.internalformat=f[0].internalformat,d.width=f[0].width,d.height=f[0].height,nt(c),s=0;s<6;++s)P(f[s],yt+s);for(Z(u,mt),rt(),l.profile&&(c.stats.size=fe(c.internalformat,c.type,d.width,d.height,u.genMipmaps,!0)),d.format=g[c.internalformat],d.type=v[c.type],d.mag=w[u.magFilter],d.min=x[u.minFilter],d.wrapS=A[u.wrapS],d.wrapT=A[u.wrapT],s=0;s<6;++s)q(f[s]);return d}return d(t,e,r,o,a,u),d.subimage=function(t,e,n,r,i){S(!!e,"must specify image data"),S("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var o=0|n,a=0|r,s=0|i,l=z();return O(l,c),l.width=0,l.height=0,B(l,e),l.width=l.width||(c.width>>s)-o,l.height=l.height||(c.height>>s)-a,S(c.type===l.type&&c.format===l.format&&c.internalformat===l.internalformat,"incompatible format for texture.subimage"),S(o>=0&&a>=0&&o+l.width<=c.width&&a+l.height<=c.height,"texture.subimage write out of bounds"),S(c.mipmask&1<<s,"missing mipmap data"),S(l.data||l.element||l.needsCopy,"missing image data"),nt(c),D(l,yt+t,o,a,s),rt(),C(l),d},d.resize=function(t){var e=0|t;if(e!==c.width){d.width=c.width=e,d.height=c.height=e,nt(c);for(var r=0;r<6;++r)for(var i=0;c.mipmask>>i;++i)n.texImage2D(yt+r,i,c.format,e>>i,e>>i,0,c.format,c.type,null);return rt(),l.profile&&(c.stats.size=fe(c.internalformat,c.type,d.width,d.height,!1,!0)),d}},d._reglType="textureCube",d._texture=c,l.profile&&(d.stats=c.stats),d.destroy=function(){c.decRef()},d},clear:function(){for(var t=0;t<Q;++t)n.activeTexture(Vt+t),n.bindTexture(_t,null),tt[t]=null;W(K).forEach(it),s.cubeCount=0,s.textureCount=0},getTexture:function(t){return null},restore:function(){for(var t=0;t<Q;++t){var e=tt[t];e&&(e.bindCount=0,e.unit=-1,tt[t]=null)}W(K).forEach((function(t){t.texture=n.createTexture(),n.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!=(t.mipmask&1<<e))if(t.target===_t)n.texImage2D(_t,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)n.texImage2D(yt+r,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);Z(t.texInfo,t.target)}))},refresh:function(){for(var t=0;t<Q;++t){var e=tt[t];e&&(e.bindCount=0,e.unit=-1,tt[t]=null),n.activeTexture(Vt+t),n.bindTexture(_t,null),n.bindTexture(mt,null)}}}}ee[32854]=2,ee[32855]=2,ee[36194]=2,ee[34041]=4,ee[33776]=.5,ee[33777]=.5,ee[33778]=1,ee[33779]=1,ee[35986]=.5,ee[35987]=1,ee[34798]=1,ee[35840]=.5,ee[35841]=.25,ee[35842]=.5,ee[35843]=.25,ee[36196]=.5;var he=36161,pe=32854,_e=[];function me(t,e,n){return _e[t]*e*n}_e[32854]=2,_e[32855]=2,_e[36194]=2,_e[33189]=2,_e[36168]=1,_e[34041]=4,_e[35907]=4,_e[34836]=16,_e[34842]=8,_e[34843]=6;var ye=36160,be=36161,ge=3553,ve=34069,we=[6407,6408],xe=[];xe[6408]=4,xe[6407]=3;var Se=[];Se[5121]=1,Se[5126]=4,Se[36193]=2;var Ae=[32854,32855,36194,35907,34842,34843,34836],Ie={};Ie[36053]="complete",Ie[36054]="incomplete attachment",Ie[36057]="incomplete dimensions",Ie[36055]="incomplete, missing attachment",Ie[36061]="unsupported";var ke=34963,Oe=["attributes","elements","offset","count","primitive","instances"];function Te(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var Le=5121,Me=5126;function Be(e,n,r,i,o,a,s){function l(l){var u;null===n.next?(S(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),u=Le):(S(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),u=n.next.colorAttachments[0].texture._texture.type,S.optional((function(){a.oes_texture_float?(S(u===Le||u===Me,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),u===Me&&S(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):S(u===Le,"Reading from a framebuffer is only allowed for the type 'uint8'")})));var c=0,f=0,d=i.framebufferWidth,h=i.framebufferHeight,p=null;t(l)?p=l:l&&(S.type(l,"object","invalid arguments to regl.read()"),c=0|l.x,f=0|l.y,S(c>=0&&c<i.framebufferWidth,"invalid x offset for regl.read"),S(f>=0&&f<i.framebufferHeight,"invalid y offset for regl.read"),d=0|(l.width||i.framebufferWidth-c),h=0|(l.height||i.framebufferHeight-f),p=l.data||null),p&&(u===Le?S(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):u===Me&&S(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),S(d>0&&d+c<=i.framebufferWidth,"invalid width for read pixels"),S(h>0&&h+f<=i.framebufferHeight,"invalid height for read pixels"),r();var _=d*h*4;return p||(u===Le?p=new Uint8Array(_):u===Me&&(p=p||new Float32Array(_))),S.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),S(p.byteLength>=_,"data buffer for regl.read() too small"),e.pixelStorei(3333,4),e.readPixels(c,f,d,h,6408,u,p),p}return function(t){return t&&"framebuffer"in t?function(t){var e;return n.setFBO({framebuffer:t.framebuffer},(function(){e=l(t)})),e}(t):l(t)}}function Ee(t){return Array.prototype.slice.call(t)}function De(t){return Ee(t).join("")}var je="xyzw".split(""),ze="dither",Ce="blend.enable",Fe="blend.color",Ne="blend.equation",Re="blend.func",Ue="depth.enable",Pe="depth.func",Ve="depth.range",$e="depth.mask",We="colorMask",Ye="cull.enable",Ge="cull.face",qe="frontFace",He="lineWidth",Xe="polygonOffset.enable",Ze="polygonOffset.offset",Je="sample.alpha",Ke="sample.enable",Qe="sample.coverage",tn="stencil.enable",en="stencil.mask",nn="stencil.func",rn="stencil.opFront",on="stencil.opBack",an="scissor.enable",sn="scissor.box",ln="viewport",un="profile",cn="framebuffer",fn="vert",dn="frag",hn="elements",pn="primitive",_n="count",mn="offset",yn="instances",bn="vao",gn="Width",vn="Height",wn=cn+gn,xn=cn+vn,Sn=ln+gn,An=ln+vn,In="drawingBuffer",kn=In+gn,On=In+vn,Tn=[Re,Ne,nn,rn,on,Qe,ln,sn,Ze],Ln=34962,Mn=34963,Bn=5126,En=35664,Dn=35665,jn=35666,zn=5124,Cn=35667,Fn=35668,Nn=35669,Rn=35670,Un=35671,Pn=35672,Vn=35673,$n=35674,Wn=35675,Yn=35676,Gn=35678,qn=35680,Hn=1028,Xn=1029,Zn=2305,Jn=7680,Kn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qn=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],tr={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},er={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},nr={frag:35632,vert:35633},rr={cw:2304,ccw:Zn};function ir(e){return Array.isArray(e)||t(e)||$(e)}function or(t){return t.sort((function(t,e){return t===ln?-1:e===ln?1:t<e?-1:1}))}function ar(t,e,n,r){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=r}function sr(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function lr(t){return new ar(!1,!1,!1,t)}function ur(t,e){var n=t.type;if(0===n){var r=t.data.length;return new ar(!0,r>=1,r>=2,e)}if(4===n){var i=t.data;return new ar(i.thisDep,i.contextDep,i.propDep,e)}if(5===n)return new ar(!1,!1,!1,e);if(6===n){for(var o=!1,a=!1,s=!1,l=0;l<t.data.length;++l){var u=t.data[l];if(1===u.type)s=!0;else if(2===u.type)a=!0;else if(3===u.type)o=!0;else if(0===u.type){o=!0;var c=u.data;c>=1&&(a=!0),c>=2&&(s=!0)}else 4===u.type&&(o=o||u.data.thisDep,a=a||u.data.contextDep,s=s||u.data.propDep)}return new ar(o,a,s,e)}return new ar(3===n,2===n,1===n,e)}var cr=new ar(!1,!1,!1,(function(){}));function fr(t,n,r,i,o,a,s,l,u,c,f,d,h,p,_){var m=c.Record,y={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(y.min=32775,y.max=32776);var b=r.angle_instanced_arrays,g=r.webgl_draw_buffers,v=r.oes_vertex_array_object,w={dirty:!0,profile:_.profile},x={},A=[],I={},k={};function O(t){return t.replace(".","_")}function T(t,e,n){var r=O(t);A.push(t),x[r]=w[r]=!!n,I[r]=e}function M(t,e,n){var r=O(t);A.push(t),Array.isArray(n)?(w[r]=n.slice(),x[r]=n.slice()):w[r]=x[r]=n,k[r]=e}T(ze,3024),T(Ce,3042),M(Fe,"blendColor",[0,0,0,0]),M(Ne,"blendEquationSeparate",[32774,32774]),M(Re,"blendFuncSeparate",[1,0,1,0]),T(Ue,2929,!0),M(Pe,"depthFunc",513),M(Ve,"depthRange",[0,1]),M($e,"depthMask",!0),M(We,We,[!0,!0,!0,!0]),T(Ye,2884),M(Ge,"cullFace",Xn),M(qe,qe,Zn),M(He,He,1),T(Xe,32823),M(Ze,"polygonOffset",[0,0]),T(Je,32926),T(Ke,32928),M(Qe,"sampleCoverage",[1,!1]),T(tn,2960),M(en,"stencilMask",-1),M(nn,"stencilFunc",[519,0,-1]),M(rn,"stencilOpSeparate",[Hn,Jn,Jn,Jn]),M(on,"stencilOpSeparate",[Xn,Jn,Jn,Jn]),T(an,3089),M(sn,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),M(ln,ln,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var B={gl:t,context:h,strings:n,next:x,current:w,draw:d,elements:a,buffer:o,shader:f,attributes:c.state,vao:c,uniforms:u,framebuffer:l,extensions:r,timer:p,isBufferArgs:ir},E={primTypes:ot,compareFuncs:tr,blendFuncs:Kn,blendEquations:y,stencilOps:er,glTypes:X,orientationType:rr};S.optional((function(){B.isArrayLike=ht})),g&&(E.backBuffer=[Xn],E.drawBuffer=z(i.maxDrawbuffers,(function(t){return 0===t?[0]:z(t,(function(t){return 36064+t}))})));var D=0;function j(){var t=function(){var t=0,n=[],r=[];function i(){var n=[],r=[];return e((function(){n.push.apply(n,Ee(arguments))}),{def:function(){var e="v"+t++;return r.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,Ee(arguments)),n.push(";")),e},toString:function(){return De([r.length>0?"var "+r.join(",")+";":"",De(n)])}})}function o(){var t=i(),n=i(),r=t.toString,o=n.toString;function a(e,r){n(e,r,"=",t.def(e,r),";")}return e((function(){t.apply(t,Ee(arguments))}),{def:t.def,entry:t,exit:n,save:a,set:function(e,n,r){a(e,n),t(e,n,"=",r,";")},toString:function(){return r()+o()}})}var a=i(),s={};return{global:a,link:function(e){for(var i=0;i<r.length;++i)if(r[i]===e)return n[i];var o="g"+t++;return n.push(o),r.push(e),o},block:i,proc:function(t,n){var r=[];function i(){var t="a"+r.length;return r.push(t),t}n=n||0;for(var a=0;a<n;++a)i();var l=o(),u=l.toString;return s[t]=e(l,{arg:i,toString:function(){return De(["function(",r.join(),"){",u(),"}"])}})},scope:o,cond:function(){var t=De(arguments),n=o(),r=o(),i=n.toString,a=r.toString;return e(n,{then:function(){return n.apply(n,Ee(arguments)),this},else:function(){return r.apply(r,Ee(arguments)),this},toString:function(){var e=a();return e&&(e="else{"+e+"}"),De(["if(",t,"){",i(),"}",e])}})},compile:function(){var t=['"use strict";',a,"return {"];Object.keys(s).forEach((function(e){t.push('"',e,'":',s[e].toString(),",")})),t.push("}");var e=De(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,r)}}}(),r=t.link,i=t.global;t.id=D++,t.batchId="0";var o=r(B),a=t.shared={props:"a0"};Object.keys(B).forEach((function(t){a[t]=i.def(o,".",t)})),S.optional((function(){t.CHECK=r(S),t.commandStr=S.guessCommand(),t.command=r(t.commandStr),t.assert=function(t,e,n){t("if(!(",e,"))",this.CHECK,".commandRaise(",r(n),",",this.command,");")},E.invalidBlendCombinations=Qn}));var s=t.next={},l=t.current={};Object.keys(k).forEach((function(t){Array.isArray(w[t])&&(s[t]=i.def(a.next,".",t),l[t]=i.def(a.current,".",t))}));var u=t.constants={};Object.keys(E).forEach((function(t){u[t]=i.def(JSON.stringify(E[t]))})),t.invoke=function(e,n){switch(n.type){case 0:var i=["this",a.context,a.props,t.batchId];return e.def(r(n.data),".call(",i.slice(0,Math.max(n.data.length+1,4)),")");case 1:return e.def(a.props,n.data);case 2:return e.def(a.context,n.data);case 3:return e.def("this",n.data);case 4:return n.data.append(t,e),n.data.ref;case 5:return n.data.toString();case 6:return n.data.map((function(n){return t.invoke(e,n)}))}},t.attribCache={};var f={};return t.scopeAttrib=function(t){var e=n.id(t);if(e in f)return f[e];var i=c.scope[e];return i||(i=c.scope[e]=new m),f[e]=r(i)},t}function C(t,e,s,u,d){var h=t.static,p=t.dynamic;S.optional((function(){var t=[cn,fn,dn,hn,pn,mn,_n,yn,un,bn].concat(A);function e(e){Object.keys(e).forEach((function(e){S.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',d.commandStr)}))}e(h),e(p)}));var _=function(t,e){var n=t.static;if("string"==typeof n[dn]&&"string"==typeof n[fn]){if(Object.keys(e.dynamic).length>0)return null;var r=e.static,i=Object.keys(r);if(i.length>0&&"number"==typeof r[i[0]]){for(var o=[],a=0;a<i.length;++a)S("number"==typeof r[i[a]],"must specify all vertex attribute locations when using vaos"),o.push([0|r[i[a]],i[a]]);return o}}return null}(t,e),g=function(t,e){var n=t.static,r=t.dynamic;if(cn in n){var i=n[cn];return i?(i=l.getFramebuffer(i),S.command(i,"invalid framebuffer object"),lr((function(t,e){var n=t.link(i),r=t.shared;e.set(r.framebuffer,".next",n);var o=r.context;return e.set(o,"."+wn,n+".width"),e.set(o,"."+xn,n+".height"),n}))):lr((function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var r=n.context;return e.set(r,"."+wn,r+"."+kn),e.set(r,"."+xn,r+"."+On),"null"}))}if(cn in r){var o=r[cn];return ur(o,(function(t,e){var n=t.invoke(e,o),r=t.shared,i=r.framebuffer,a=e.def(i,".getFramebuffer(",n,")");S.optional((function(){t.assert(e,"!"+n+"||"+a,"invalid framebuffer object")})),e.set(i,".next",a);var s=r.context;return e.set(s,"."+wn,a+"?"+a+".width:"+s+"."+kn),e.set(s,"."+xn,a+"?"+a+".height:"+s+"."+On),a}))}return null}(t),v=function(t,e,n){var r=t.static,i=t.dynamic;function o(t){if(t in r){var o=r[t];S.commandType(o,"object","invalid "+t,n.commandStr);var a,s,l=!0,u=0|o.x,c=0|o.y;return"width"in o?(a=0|o.width,S.command(a>=0,"invalid "+t,n.commandStr)):l=!1,"height"in o?(s=0|o.height,S.command(s>=0,"invalid "+t,n.commandStr)):l=!1,new ar(!l&&e&&e.thisDep,!l&&e&&e.contextDep,!l&&e&&e.propDep,(function(t,e){var n=t.shared.context,r=a;"width"in o||(r=e.def(n,".",wn,"-",u));var i=s;return"height"in o||(i=e.def(n,".",xn,"-",c)),[u,c,r,i]}))}if(t in i){var f=i[t],d=ur(f,(function(e,n){var r=e.invoke(n,f);S.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)}));var i=e.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",wn,"-",o,")"),l=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",xn,"-",a,")");return S.optional((function(){e.assert(n,s+">=0&&"+l+">=0","invalid "+t)})),[o,a,s,l]}));return e&&(d.thisDep=d.thisDep||e.thisDep,d.contextDep=d.contextDep||e.contextDep,d.propDep=d.propDep||e.propDep),d}return e?new ar(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",wn),e.def(n,".",xn)]})):null}var a=o(ln);if(a){var s=a;a=new ar(a.thisDep,a.contextDep,a.propDep,(function(t,e){var n=s.append(t,e),r=t.shared.context;return e.set(r,"."+Sn,n[2]),e.set(r,"."+An,n[3]),n}))}return{viewport:a,scissor_box:o(sn)}}(t,g,d),w=function(t,e){var n=t.static,r=t.dynamic,i={},o=!1,s=function(){if(bn in n){var t=n[bn];return null!==t&&null===c.getVAO(t)&&(t=c.createVAO(t)),o=!0,i.vao=t,lr((function(e){var n=c.getVAO(t);return n?e.link(n):"null"}))}if(bn in r){o=!0;var e=r[bn];return ur(e,(function(t,n){var r=t.invoke(n,e);return n.def(t.shared.vao+".getVAO("+r+")")}))}return null}(),l=!1,u=function(){if(hn in n){var t=n[hn];if(i.elements=t,ir(t)){var u=i.elements=a.create(t,!0);t=a.getElements(u),l=!0}else t&&(t=a.getElements(t),l=!0,S.command(t,"invalid elements",e.commandStr));var c=lr((function(e,n){if(t){var r=e.link(t);return e.ELEMENTS=r,r}return e.ELEMENTS=null,null}));return c.value=t,c}if(hn in r){l=!0;var f=r[hn];return ur(f,(function(t,e){var n=t.shared,r=n.isBufferArgs,i=n.elements,o=t.invoke(e,f),a=e.def("null"),s=e.def(r,"(",o,")"),l=t.cond(s).then(a,"=",i,".createStream(",o,");").else(a,"=",i,".getElements(",o,");");return S.optional((function(){t.assert(l.else,"!"+o+"||"+a,"invalid elements")})),e.entry(l),e.exit(t.cond(s).then(i,".destroyStream(",a,");")),t.ELEMENTS=a,a}))}return o?new ar(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.elements+".getElements("+t.shared.vao+".currentVAO.elements):null")})):null}();function f(t,a){if(t in n){var u=0|n[t];return a?i.offset=u:i.instances=u,S.command(!a||u>=0,"invalid "+t,e.commandStr),lr((function(t,e){return a&&(t.OFFSET=u),u}))}if(t in r){var c=r[t];return ur(c,(function(e,n){var r=e.invoke(n,c);return a&&(e.OFFSET=r,S.optional((function(){e.assert(n,r+">=0","invalid "+t)}))),r}))}if(a){if(l)return lr((function(t,e){return t.OFFSET=0,0}));if(o)return new ar(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.offset:0")}))}else if(o)return new ar(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.instances:-1")}));return null}var d=f(mn,!0),h=function(){if(pn in n){var t=n[pn];return i.primitive=t,S.commandParameter(t,ot,"invalid primitve",e.commandStr),lr((function(e,n){return ot[t]}))}if(pn in r){var a=r[pn];return ur(a,(function(t,e){var n=t.constants.primTypes,r=t.invoke(e,a);return S.optional((function(){t.assert(e,r+" in "+n,"invalid primitive, must be one of "+Object.keys(ot))})),e.def(n,"[",r,"]")}))}return l?sr(u)?u.value?lr((function(t,e){return e.def(t.ELEMENTS,".primType")})):lr((function(){return 4})):new ar(u.thisDep,u.contextDep,u.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",4)})):o?new ar(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.primitive:4")})):null}(),p=function(){if(_n in n){var t=0|n[_n];return i.count=t,S.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),lr((function(){return t}))}if(_n in r){var a=r[_n];return ur(a,(function(t,e){var n=t.invoke(e,a);return S.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(l){if(sr(u)){if(u)return d?new ar(d.thisDep,d.contextDep,d.propDep,(function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return S.optional((function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")})),n})):lr((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var c=lr((function(){return-1}));return S.optional((function(){c.MISSING=!0})),c}var f=new ar(u.thisDep||d.thisDep,u.contextDep||d.contextDep,u.propDep||d.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")}));return S.optional((function(){f.DYNAMIC=!0})),f}return o?new ar(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.shared.vao,".currentVAO?",t.shared.vao,".currentVAO.count:-1")})):null}(),_=f(yn,!1);return{elements:u,primitive:h,count:p,instances:_,offset:d,vao:s,vaoActive:o,elementsActive:l,static:i}}(t,d),x=function(t,e){var n=t.static,r=t.dynamic,o={};return A.forEach((function(t){var a=O(t);function s(e,i){if(t in n){var s=e(n[t]);o[a]=lr((function(){return s}))}else if(t in r){var l=r[t];o[a]=ur(l,(function(t,e){return i(t,e,t.invoke(e,l))}))}}switch(t){case Ye:case Ce:case ze:case tn:case Ue:case an:case Xe:case Je:case Ke:case $e:return s((function(n){return S.commandType(n,"boolean",t,e.commandStr),n}),(function(e,n,r){return S.optional((function(){e.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+t,e.commandStr)})),r}));case Pe:return s((function(n){return S.commandParameter(n,tr,"invalid "+t,e.commandStr),tr[n]}),(function(e,n,r){var i=e.constants.compareFuncs;return S.optional((function(){e.assert(n,r+" in "+i,"invalid "+t+", must be one of "+Object.keys(tr))})),n.def(i,"[",r,"]")}));case Ve:return s((function(t){return S.command(ht(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,n){return S.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[e.def("+",n,"[0]"),e.def("+",n,"[1]")]}));case Re:return s((function(t){S.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,r="srcAlpha"in t?t.srcAlpha:t.src,i="dstRGB"in t?t.dstRGB:t.dst,o="dstAlpha"in t?t.dstAlpha:t.dst;return S.commandParameter(n,Kn,a+".srcRGB",e.commandStr),S.commandParameter(r,Kn,a+".srcAlpha",e.commandStr),S.commandParameter(i,Kn,a+".dstRGB",e.commandStr),S.commandParameter(o,Kn,a+".dstAlpha",e.commandStr),S.command(-1===Qn.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",e.commandStr),[Kn[n],Kn[i],Kn[r],Kn[o]]}),(function(e,n,r){var i=e.constants.blendFuncs;function o(o,a){var s=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return S.optional((function(){e.assert(n,s+" in "+i,"invalid "+t+"."+o+a+", must be one of "+Object.keys(Kn))})),s}S.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var a=o("src","RGB"),s=o("dst","RGB");S.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var l=n.def(i,"[",a,"]"),u=n.def(i,"[",o("src","Alpha"),"]");return[l,n.def(i,"[",s,"]"),u,n.def(i,"[",o("dst","Alpha"),"]")]}));case Ne:return s((function(n){return"string"==typeof n?(S.commandParameter(n,y,"invalid "+t,e.commandStr),[y[n],y[n]]):"object"==typeof n?(S.commandParameter(n.rgb,y,t+".rgb",e.commandStr),S.commandParameter(n.alpha,y,t+".alpha",e.commandStr),[y[n.rgb],y[n.alpha]]):void S.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,n,r){var i=e.constants.blendEquations,o=n.def(),a=n.def(),s=e.cond("typeof ",r,'==="string"');return S.optional((function(){function n(t,n,r){e.assert(t,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(y))}n(s.then,t,r),e.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+t),n(s.else,t+".rgb",r+".rgb"),n(s.else,t+".alpha",r+".alpha")})),s.then(o,"=",a,"=",i,"[",r,"];"),s.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(s),[o,a]}));case Fe:return s((function(t){return S.command(ht(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),z(4,(function(e){return+t[e]}))}),(function(t,e,n){return S.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),z(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case en:return s((function(t){return S.commandType(t,"number",a,e.commandStr),0|t}),(function(t,e,n){return S.optional((function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")})),e.def(n,"|0")}));case nn:return s((function(n){S.commandType(n,"object",a,e.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return S.commandParameter(r,tr,t+".cmp",e.commandStr),S.commandType(i,"number",t+".ref",e.commandStr),S.commandType(o,"number",t+".mask",e.commandStr),[tr[r],i,o]}),(function(t,e,n){var r=t.constants.compareFuncs;return S.optional((function(){function i(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")})),[e.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",Jn),e.def(n,".ref|0"),e.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case rn:case on:return s((function(n){S.commandType(n,"object",a,e.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return S.commandParameter(r,er,t+".fail",e.commandStr),S.commandParameter(i,er,t+".zfail",e.commandStr),S.commandParameter(o,er,t+".zpass",e.commandStr),[t===on?Xn:Hn,er[r],er[i],er[o]]}),(function(e,n,r){var i=e.constants.stencilOps;function o(o){return S.optional((function(){e.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+t+"."+o+", must be one of "+Object.keys(er))})),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",Jn)}return S.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)})),[t===on?Xn:Hn,o("fail"),o("zfail"),o("zpass")]}));case Ze:return s((function(t){S.commandType(t,"object",a,e.commandStr);var n=0|t.factor,r=0|t.units;return S.commandType(n,"number",a+".factor",e.commandStr),S.commandType(r,"number",a+".units",e.commandStr),[n,r]}),(function(e,n,r){return S.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)})),[n.def(r,".factor|0"),n.def(r,".units|0")]}));case Ge:return s((function(t){var n=0;return"front"===t?n=Hn:"back"===t&&(n=Xn),S.command(!!n,a,e.commandStr),n}),(function(t,e,n){return S.optional((function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),e.def(n,'==="front"?',Hn,":",Xn)}));case He:return s((function(t){return S.command("number"==typeof t&&t>=i.lineWidthDims[0]&&t<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],e.commandStr),t}),(function(t,e,n){return S.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")})),n}));case qe:return s((function(t){return S.commandParameter(t,rr,a,e.commandStr),rr[t]}),(function(t,e,n){return S.optional((function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(n+'==="cw"?2304:'+Zn)}));case We:return s((function(t){return S.command(ht(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,n){return S.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),z(4,(function(t){return"!!"+n+"["+t+"]"}))}));case Qe:return s((function(t){S.command("object"==typeof t&&t,a,e.commandStr);var n="value"in t?t.value:1,r=!!t.invert;return S.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,r]}),(function(t,e,n){return S.optional((function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',n,"?+",n,".value:1"),e.def("!!",n,".invert")]}))}})),o}(t,d),I=function(t,e,r){var i=t.static,o=t.dynamic;function a(t){if(t in i){var e=n.id(i[t]);S.optional((function(){f.shader(nr[t],e,S.guessCommand())}));var r=lr((function(){return e}));return r.id=e,r}if(t in o){var a=o[t];return ur(a,(function(e,n){var r=e.invoke(n,a),i=n.def(e.shared.strings,".id(",r,")");return S.optional((function(){n(e.shared.shader,".shader(",nr[t],",",i,",",e.command,");")})),i}))}return null}var s,l=a(dn),u=a(fn),c=null;return sr(l)&&sr(u)?(c=f.program(u.id,l.id,null,r),s=lr((function(t,e){return t.link(c)}))):s=new ar(l&&l.thisDep||u&&u.thisDep,l&&l.contextDep||u&&u.contextDep,l&&l.propDep||u&&u.propDep,(function(t,e){var n,r=t.shared.shader;n=l?l.append(t,e):e.def(r,".",dn);var i=r+".program("+(u?u.append(t,e):e.def(r,".",fn))+","+n;return S.optional((function(){i+=","+t.command})),e.def(i+")")})),{frag:l,vert:u,progVar:s,program:c}}(t,0,_);function k(t){var e=v[t];e&&(x[t]=e)}k(ln),k(O(sn));var T=Object.keys(x).length>0,L={framebuffer:g,draw:w,shader:I,state:x,dirty:T,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(L.profile=function(t){var e,n=t.static,r=t.dynamic;if(un in n){var i=!!n[un];(e=lr((function(t,e){return i}))).enable=i}else if(un in r){var o=r[un];e=ur(o,(function(t,e){return t.invoke(e,o)}))}return e}(t),L.uniforms=function(t,e){var n=t.static,r=t.dynamic,i={};return Object.keys(n).forEach((function(t){var r,o=n[t];if("number"==typeof o||"boolean"==typeof o)r=lr((function(){return o}));else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=lr((function(t){return t.link(o)})):"framebuffer"===a||"framebufferCube"===a?(S.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),r=lr((function(t){return t.link(o.color[0])}))):S.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else ht(o)?r=lr((function(e){return e.global.def("[",z(o.length,(function(n){return S.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+t,e.commandStr),o[n]})),"]")})):S.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);r.value=o,i[t]=r})),Object.keys(r).forEach((function(t){var e=r[t];i[t]=ur(e,(function(t,n){return t.invoke(n,e)}))})),i}(s,d),L.drawVAO=L.scopeVAO=w.vao,!L.drawVAO&&I.program&&!_&&r.angle_instanced_arrays&&w.static.elements){var M=!0,B=I.program.attributes.map((function(t){var n=e.static[t];return M=M&&!!n,n}));if(M&&B.length>0){var E=c.getVAO(c.createVAO({attributes:B,elements:w.static.elements}));L.drawVAO=new ar(null,null,null,(function(t,e){return t.link(E)})),L.useVAO=!0}}return _?L.useVAO=!0:L.attributes=function(t,e){var r=t.static,i=t.dynamic,a={};return Object.keys(r).forEach((function(t){var i=r[t],s=n.id(t),l=new m;if(ir(i))l.state=1,l.buffer=o.getBuffer(o.create(i,Ln,!1,!0)),l.type=0;else{var u=o.getBuffer(i);if(u)l.state=1,l.buffer=u,l.type=0;else if(S.command("object"==typeof i&&i,"invalid data for attribute "+t,e.commandStr),"constant"in i){var c=i.constant;l.buffer="null",l.state=2,"number"==typeof c?l.x=c:(S.command(ht(c)&&c.length>0&&c.length<=4,"invalid constant for attribute "+t,e.commandStr),je.forEach((function(t,e){e<c.length&&(l[t]=c[e])})))}else{u=ir(i.buffer)?o.getBuffer(o.create(i.buffer,Ln,!1,!0)):o.getBuffer(i.buffer),S.command(!!u,'missing buffer for attribute "'+t+'"',e.commandStr);var f=0|i.offset;S.command(f>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var d=0|i.stride;S.command(d>=0&&d<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var h=0|i.size;S.command(!("size"in i)||h>0&&h<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var p=!!i.normalized,_=0;"type"in i&&(S.commandParameter(i.type,X,"invalid type for attribute "+t,e.commandStr),_=X[i.type]);var y=0|i.divisor;S.optional((function(){"divisor"in i&&(S.command(0===y||b,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),S.command(y>=0,'invalid divisor for attribute "'+t+'"',e.commandStr));var n=e.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach((function(e){S.command(r.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+r+")",n)}))})),l.buffer=u,l.state=1,l.size=h,l.normalized=p,l.type=_||u.dtype,l.offset=f,l.stride=d,l.divisor=y}}a[t]=lr((function(t,e){var n=t.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(l).forEach((function(t){r[t]=l[t]})),l.buffer&&(r.buffer=t.link(l.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r}))})),Object.keys(i).forEach((function(t){var e=i[t];a[t]=ur(e,(function(n,r){var i=n.invoke(r,e),o=n.shared,a=n.constants,s=o.isBufferArgs,l=o.buffer;S.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+s+"("+i+")||"+l+".getBuffer("+i+")||"+l+".getBuffer("+i+".buffer)||"+s+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+t+'"')}));var u={isStream:r.def(!1)},c=new m;c.state=1,Object.keys(c).forEach((function(t){u[t]=r.def(""+c[t])}));var f=u.buffer,d=u.type;function h(t){r(u[t],"=",i,".",t,"|0;")}return r("if(",s,"(",i,")){",u.isStream,"=true;",f,"=",l,".createStream(",Ln,",",i,");",d,"=",f,".dtype;","}else{",f,"=",l,".getBuffer(",i,");","if(",f,"){",d,"=",f,".dtype;",'}else if("constant" in ',i,"){",u.state,"=",2,";","if(typeof "+i+'.constant === "number"){',u[je[0]],"=",i,".constant;",je.slice(1).map((function(t){return u[t]})).join("="),"=0;","}else{",je.map((function(t,e){return u[t]+"="+i+".constant.length>"+e+"?"+i+".constant["+e+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",f,"=",l,".createStream(",Ln,",",i,".buffer);","}else{",f,"=",l,".getBuffer(",i,".buffer);","}",d,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",f,".dtype;",u.normalized,"=!!",i,".normalized;"),h("size"),h("offset"),h("stride"),h("divisor"),r("}}"),r.exit("if(",u.isStream,"){",l,".destroyStream(",f,");","}"),u}))})),a}(e,d),L.context=function(t){var e=t.static,n=t.dynamic,r={};return Object.keys(e).forEach((function(t){var n=e[t];r[t]=lr((function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];r[t]=ur(e,(function(t,n){return t.invoke(n,e)}))})),r}(u),L}function F(t,e,n){var r=t.shared.context,i=t.scope();Object.keys(n).forEach((function(o){e.save(r,"."+o);var a=n[o].append(t,e);Array.isArray(a)?i(r,".",o,"=[",a.join(),"];"):i(r,".",o,"=",a,";")})),e(i)}function N(t,e,n,r){var i,o=t.shared,a=o.gl,s=o.framebuffer;g&&(i=e.def(o.extensions,".webgl_draw_buffers"));var l,u=t.constants,c=u.drawBuffer,f=u.backBuffer;l=n?n.append(t,e):e.def(s,".next"),r||e("if(",l,"!==",s,".cur){"),e("if(",l,"){",a,".bindFramebuffer(",36160,",",l,".framebuffer);"),g&&e(i,".drawBuffersWEBGL(",c,"[",l,".colorAttachments.length]);"),e("}else{",a,".bindFramebuffer(",36160,",null);"),g&&e(i,".drawBuffersWEBGL(",f,");"),e("}",s,".cur=",l,";"),r||e("}")}function R(t,e,n){var r=t.shared,i=r.gl,o=t.current,a=t.next,s=r.current,l=r.next,u=t.cond(s,".dirty");A.forEach((function(e){var r,c,f=O(e);if(!(f in n.state))if(f in a){r=a[f],c=o[f];var d=z(w[f].length,(function(t){return u.def(r,"[",t,"]")}));u(t.cond(d.map((function(t,e){return t+"!=="+c+"["+e+"]"})).join("||")).then(i,".",k[f],"(",d,");",d.map((function(t,e){return c+"["+e+"]="+t})).join(";"),";"))}else{r=u.def(l,".",f);var h=t.cond(r,"!==",s,".",f);u(h),f in I?h(t.cond(r).then(i,".enable(",I[f],");").else(i,".disable(",I[f],");"),s,".",f,"=",r,";"):h(i,".",k[f],"(",r,");",s,".",f,"=",r,";")}})),0===Object.keys(n.state).length&&u(s,".dirty=false;"),e(u)}function U(t,e,n,r){var i=t.shared,o=t.current,a=i.current,s=i.gl;or(Object.keys(n)).forEach((function(i){var l=n[i];if(!r||r(l)){var u=l.append(t,e);if(I[i]){var c=I[i];sr(l)?e(s,u?".enable(":".disable(",c,");"):e(t.cond(u).then(s,".enable(",c,");").else(s,".disable(",c,");")),e(a,".",i,"=",u,";")}else if(ht(u)){var f=o[i];e(s,".",k[i],"(",u,");",u.map((function(t,e){return f+"["+e+"]="+t})).join(";"),";")}else e(s,".",k[i],"(",u,");",a,".",i,"=",u,";")}}))}function P(t,e){b&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function V(t,e,n,r,i){var o,a,s,l=t.shared,u=t.stats,c=l.current,f=l.timer,d=n.profile;function h(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function _(t){t(o=e.def(),"=",h(),";"),"string"==typeof i?t(u,".count+=",i,";"):t(u,".count++;"),p&&(r?t(a=e.def(),"=",f,".getNumPendingQueries();"):t(f,".beginQuery(",u,");"))}function m(t){t(u,".cpuTime+=",h(),"-",o,";"),p&&(r?t(f,".pushScopeStats(",a,",",f,".getNumPendingQueries(),",u,");"):t(f,".endQuery();"))}function y(t){var n=e.def(c,".profile");e(c,".profile=",t,";"),e.exit(c,".profile=",n,";")}if(d){if(sr(d))return void(d.enable?(_(e),m(e.exit),y("true")):y("false"));y(s=d.append(t,e))}else s=e.def(c,".profile");var b=t.block();_(b),e("if(",s,"){",b,"}");var g=t.block();m(g),e.exit("if(",s,"){",g,"}")}function $(t,e,n,r,i){var o=t.shared;r.forEach((function(r){var a,s=r.name,l=n.attributes[s];if(l){if(!i(l))return;a=l.append(t,e)}else{if(!i(cr))return;var u=t.scopeAttrib(s);S.optional((function(){t.assert(e,u+".state","missing attribute "+s)})),a={},Object.keys(new m).forEach((function(t){a[t]=e.def(u,".",t)}))}!function(n,r,i){var a=o.gl,s=e.def(n,".location"),l=e.def(o.attributes,"[",s,"]"),u=i.state,c=i.buffer,f=[i.x,i.y,i.z,i.w],d=["buffer","normalized","offset","stride"];function h(){e("if(!",l,".buffer){",a,".enableVertexAttribArray(",s,");}");var n,o=i.type;if(n=i.size?e.def(i.size,"||",r):r,e("if(",l,".type!==",o,"||",l,".size!==",n,"||",d.map((function(t){return l+"."+t+"!=="+i[t]})).join("||"),"){",a,".bindBuffer(",Ln,",",c,".buffer);",a,".vertexAttribPointer(",[s,n,o,i.normalized,i.stride,i.offset],");",l,".type=",o,";",l,".size=",n,";",d.map((function(t){return l+"."+t+"="+i[t]+";"})).join(""),"}"),b){var u=i.divisor;e("if(",l,".divisor!==",u,"){",t.instancing,".vertexAttribDivisorANGLE(",[s,u],");",l,".divisor=",u,";}")}}function p(){e("if(",l,".buffer){",a,".disableVertexAttribArray(",s,");",l,".buffer=null;","}if(",je.map((function(t,e){return l+"."+t+"!=="+f[e]})).join("||"),"){",a,".vertexAttrib4f(",s,",",f,");",je.map((function(t,e){return l+"."+t+"="+f[e]+";"})).join(""),"}")}1===u?h():2===u?p():(e("if(",u,"===",1,"){"),h(),e("}else{"),p(),e("}"))}(t.link(r),function(t){switch(t){case En:case Cn:case Un:return 2;case Dn:case Fn:case Pn:return 3;case jn:case Nn:case Vn:return 4;default:return 1}}(r.info.type),a)}))}function W(t,e,r,i,o,a){for(var s,l=t.shared,u=l.gl,c={},f=0;f<i.length;++f){var d=i[f],h=d.name,p=d.info.type,_=d.info.size,m=r.uniforms[h];if(_>1){if(!m)continue;var y=h.replace("[0]","");if(c[y])continue;c[y]=1}var b,g=t.link(d)+".location";if(m){if(!o(m))continue;if(sr(m)){var v=m.value;if(S.command(null!=v,'missing uniform "'+h+'"',t.commandStr),p===Gn||p===qn){S.command("function"==typeof v&&(p===Gn&&("texture2d"===v._reglType||"framebuffer"===v._reglType)||p===qn&&("textureCube"===v._reglType||"framebufferCube"===v._reglType)),"invalid texture for uniform "+h,t.commandStr);var w=t.link(v._texture||v.color[0]._texture);e(u,".uniform1i(",g,",",w+".bind());"),e.exit(w,".unbind();")}else if(p===$n||p===Wn||p===Yn){S.optional((function(){S.command(ht(v),"invalid matrix for uniform "+h,t.commandStr),S.command(p===$n&&4===v.length||p===Wn&&9===v.length||p===Yn&&16===v.length,"invalid length for matrix uniform "+h,t.commandStr)}));var x=t.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),A=2;p===Wn?A=3:p===Yn&&(A=4),e(u,".uniformMatrix",A,"fv(",g,",false,",x,");")}else{switch(p){case Bn:1===_?S.commandType(v,"number","uniform "+h,t.commandStr):S.command(ht(v)&&v.length===_,"uniform "+h,t.commandStr),s="1f";break;case En:S.command(ht(v)&&v.length&&v.length%2==0&&v.length<=2*_,"uniform "+h,t.commandStr),s="2f";break;case Dn:S.command(ht(v)&&v.length&&v.length%3==0&&v.length<=3*_,"uniform "+h,t.commandStr),s="3f";break;case jn:S.command(ht(v)&&v.length&&v.length%4==0&&v.length<=4*_,"uniform "+h,t.commandStr),s="4f";break;case Rn:1===_?S.commandType(v,"boolean","uniform "+h,t.commandStr):S.command(ht(v)&&v.length===_,"uniform "+h,t.commandStr),s="1i";break;case zn:1===_?S.commandType(v,"number","uniform "+h,t.commandStr):S.command(ht(v)&&v.length===_,"uniform "+h,t.commandStr),s="1i";break;case Un:case Cn:S.command(ht(v)&&v.length&&v.length%2==0&&v.length<=2*_,"uniform "+h,t.commandStr),s="2i";break;case Pn:case Fn:S.command(ht(v)&&v.length&&v.length%3==0&&v.length<=3*_,"uniform "+h,t.commandStr),s="3i";break;case Vn:case Nn:S.command(ht(v)&&v.length&&v.length%4==0&&v.length<=4*_,"uniform "+h,t.commandStr),s="4i"}_>1?(s+="v",v=t.global.def("["+Array.prototype.slice.call(v)+"]")):v=ht(v)?Array.prototype.slice.call(v):v,e(u,".uniform",s,"(",g,",",v,");")}continue}b=m.append(t,e)}else{if(!o(cr))continue;b=e.def(l.uniforms,"[",n.id(h),"]")}p===Gn?(S(!Array.isArray(b),"must specify a scalar prop for textures"),e("if(",b,"&&",b,'._reglType==="framebuffer"){',b,"=",b,".color[0];","}")):p===qn&&(S(!Array.isArray(b),"must specify a scalar prop for cube maps"),e("if(",b,"&&",b,'._reglType==="framebufferCube"){',b,"=",b,".color[0];","}")),S.optional((function(){function n(n,r){t.assert(e,n,'bad data or missing for uniform "'+h+'".  '+r)}function r(t,e){1===e&&S(!Array.isArray(b),"must not specify an array type for uniform"),n("Array.isArray("+b+") && typeof "+b+'[0]===" '+t+'" || typeof '+b+'==="'+t+'"',"invalid type, expected "+t)}function i(e,r,i){Array.isArray(b)?S(b.length&&b.length%e==0&&b.length<=e*i,"must have length of "+(1===i?"":"n * ")+e):n(l.isArrayLike+"("+b+")&&"+b+".length && "+b+".length % "+e+" === 0 && "+b+".length<="+e*i,"invalid vector, should have length of "+(1===i?"":"n * ")+e,t.commandStr)}function o(e){S(!Array.isArray(b),"must not specify a value type"),n("typeof "+b+'==="function"&&'+b+'._reglType==="texture'+(3553===e?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(p){case zn:r("number",_);break;case Cn:i(2,0,_);break;case Fn:i(3,0,_);break;case Nn:i(4,0,_);break;case Bn:r("number",_);break;case En:i(2,0,_);break;case Dn:i(3,0,_);break;case jn:i(4,0,_);break;case Rn:r("boolean",_);break;case Un:i(2,0,_);break;case Pn:i(3,0,_);break;case Vn:case $n:i(4,0,_);break;case Wn:i(9,0,_);break;case Yn:i(16,0,_);break;case Gn:o(3553);break;case qn:o(34067)}}));var I=1;switch(p){case Gn:case qn:var k=e.def(b,"._texture");e(u,".uniform1i(",g,",",k,".bind());"),e.exit(k,".unbind();");continue;case zn:case Rn:s="1i";break;case Cn:case Un:s="2i",I=2;break;case Fn:case Pn:s="3i",I=3;break;case Nn:case Vn:s="4i",I=4;break;case Bn:s="1f";break;case En:s="2f",I=2;break;case Dn:s="3f",I=3;break;case jn:s="4f",I=4;break;case $n:s="Matrix2fv";break;case Wn:s="Matrix3fv";break;case Yn:s="Matrix4fv"}if(-1===s.indexOf("Matrix")&&_>1&&(s+="v",I=1),"M"===s.charAt(0)){e(u,".uniform",s,"(",g,",");var O=Math.pow(p-$n+2,2),T=t.global.def("new Float32Array(",O,")");Array.isArray(b)?e("false,(",z(O,(function(t){return T+"["+t+"]="+b[t]})),",",T,")"):e("false,(Array.isArray(",b,")||",b," instanceof Float32Array)?",b,":(",z(O,(function(t){return T+"["+t+"]="+b+"["+t+"]"})),",",T,")"),e(");")}else if(I>1){for(var L=[],M=[],B=0;B<I;++B)Array.isArray(b)?M.push(b[B]):M.push(e.def(b+"["+B+"]")),a&&L.push(e.def());a&&e("if(!",t.batchId,"||",L.map((function(t,e){return t+"!=="+M[e]})).join("||"),"){",L.map((function(t,e){return t+"="+M[e]+";"})).join("")),e(u,".uniform",s,"(",g,",",M.join(","),");"),a&&e("}")}else{if(S(!Array.isArray(b),"uniform value must not be an array"),a){var E=e.def();e("if(!",t.batchId,"||",E,"!==",b,"){",E,"=",b,";")}e(u,".uniform",s,"(",g,",",b,");"),a&&e("}")}}}function Y(t,e,n,r){var i=t.shared,o=i.gl,a=i.draw,s=r.draw;var l,u,c,f=(u=s.elements,c=e,u?((u.contextDep&&r.contextDynamic||u.propDep)&&(c=n),l=u.append(t,c),s.elementsActive&&c("if("+l+")"+o+".bindBuffer("+Mn+","+l+".buffer.buffer);")):(l=c.def(),c(l,"=",a,".",hn,";","if(",l,"){",o,".bindBuffer(",Mn,",",l,".buffer.buffer);}","else if(",i.vao,".currentVAO){",l,"=",t.shared.elements+".getElements("+i.vao,".currentVAO.elements);",v?"":"if("+l+")"+o+".bindBuffer("+Mn+","+l+".buffer.buffer);","}")),l);function d(i){var o=s[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(t,n):o.append(t,e):e.def(a,".",i)}var h,p,_=d(pn),m=d(mn),y=function(){var i,o=s.count,l=e;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(l=n),i=o.append(t,l),S.optional((function(){o.MISSING&&t.assert(e,"false","missing vertex count"),o.DYNAMIC&&t.assert(l,i+">=0","missing vertex count")}))):(i=l.def(a,".",_n),S.optional((function(){t.assert(l,i+">=0","missing vertex count")}))),i}();if("number"==typeof y){if(0===y)return}else n("if(",y,"){"),n.exit("}");b&&(h=d(yn),p=t.instancing);var g=f+".type",w=s.elements&&sr(s.elements)&&!s.vaoActive;function x(){function t(){n(p,".drawElementsInstancedANGLE(",[_,y,g,m+"<<(("+g+"-5121)>>1)",h],");")}function e(){n(p,".drawArraysInstancedANGLE(",[_,m,y,h],");")}f&&"null"!==f?w?t():(n("if(",f,"){"),t(),n("}else{"),e(),n("}")):e()}function A(){function t(){n(o+".drawElements("+[_,y,g,m+"<<(("+g+"-5121)>>1)"]+");")}function e(){n(o+".drawArrays("+[_,m,y]+");")}f&&"null"!==f?w?t():(n("if(",f,"){"),t(),n("}else{"),e(),n("}")):e()}b&&("number"!=typeof h||h>=0)?"string"==typeof h?(n("if(",h,">0){"),x(),n("}else if(",h,"<0){"),A(),n("}")):x():A()}function G(t,e,n,r,i){var o=j(),a=o.proc("body",i);return S.optional((function(){o.commandStr=e.commandStr,o.command=o.link(e.commandStr)})),b&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),t(o,a,n,r),o.compile().body}function q(t,e,n,r){P(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),$(t,e,n,r.attributes,(function(){return!0}))),W(t,e,n,r.uniforms,(function(){return!0}),!1),Y(t,e,e,n)}function H(t,e,n,r){function i(){return!0}t.batchId="a1",P(t,e),$(t,e,n,r.attributes,i),W(t,e,n,r.uniforms,i,!1),Y(t,e,e,n)}function Z(t,e,n,r){P(t,e);var i=n.contextDep,o=e.def(),a=e.def();t.shared.props=a,t.batchId=o;var s=t.scope(),l=t.scope();function u(t){return t.contextDep&&i||t.propDep}function c(t){return!u(t)}if(e(s.entry,"for(",o,"=0;",o,"<","a1",";++",o,"){",a,"=","a0","[",o,"];",l,"}",s.exit),n.needsContext&&F(t,l,n.context),n.needsFramebuffer&&N(t,l,n.framebuffer),U(t,l,n.state,u),n.profile&&u(n.profile)&&V(t,l,n,!1,!0),r)n.useVAO?n.drawVAO?u(n.drawVAO)?l(t.shared.vao,".setVAO(",n.drawVAO.append(t,l),");"):s(t.shared.vao,".setVAO(",n.drawVAO.append(t,s),");"):s(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(s(t.shared.vao,".setVAO(null);"),$(t,s,n,r.attributes,c),$(t,l,n,r.attributes,u)),W(t,s,n,r.uniforms,c,!1),W(t,l,n,r.uniforms,u,!0),Y(t,s,l,n);else{var f=t.global.def("{}"),d=n.shader.progVar.append(t,l),h=l.def(d,".id"),p=l.def(f,"[",h,"]");l(t.shared.gl,".useProgram(",d,".program);","if(!",p,"){",p,"=",f,"[",h,"]=",t.link((function(e){return G(H,t,n,e,2)})),"(",d,");}",p,".call(this,a0[",o,"],",o,");")}}function J(t,e,n){var r=e.static[n];if(r&&function(t){if("object"==typeof t&&!ht(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(L.isDynamic(t[e[n]]))return!0;return!1}}(r)){var i=t.global,o=Object.keys(r),a=!1,s=!1,l=!1,u=t.global.def("{}");o.forEach((function(e){var n=r[e];if(L.isDynamic(n)){"function"==typeof n&&(n=r[e]=L.unbox(n));var o=ur(n,null);a=a||o.thisDep,l=l||o.propDep,s=s||o.contextDep}else{switch(i(u,".",e,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(t.link(n))}i(";")}})),e.dynamic[n]=new L.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:l,ref:u,append:function(t,e){o.forEach((function(n){var i=r[n];if(L.isDynamic(i)){var o=t.invoke(e,i);e(u,".",n,"=",o,";")}}))}}),delete e.static[n]}}return{next:x,current:w,procs:function(){var t=j(),e=t.proc("poll"),n=t.proc("refresh"),o=t.block();e(o),n(o);var a,s=t.shared,l=s.gl,u=s.next,c=s.current;o(c,".dirty=false;"),N(t,e),N(t,n,null,!0),b&&(a=t.link(b)),r.oes_vertex_array_object&&n(t.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var f=0;f<i.maxAttributes;++f){var d=n.def(s.attributes,"[",f,"]"),h=t.cond(d,".buffer");h.then(l,".enableVertexAttribArray(",f,");",l,".bindBuffer(",Ln,",",d,".buffer.buffer);",l,".vertexAttribPointer(",f,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(l,".disableVertexAttribArray(",f,");",l,".vertexAttrib4f(",f,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),n(h),b&&n(a,".vertexAttribDivisorANGLE(",f,",",d,".divisor);")}return n(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(I).forEach((function(r){var i=I[r],a=o.def(u,".",r),s=t.block();s("if(",a,"){",l,".enable(",i,")}else{",l,".disable(",i,")}",c,".",r,"=",a,";"),n(s),e("if(",a,"!==",c,".",r,"){",s,"}")})),Object.keys(k).forEach((function(r){var i,a,s=k[r],f=w[r],d=t.block();if(d(l,".",s,"("),ht(f)){var h=f.length;i=t.global.def(u,".",r),a=t.global.def(c,".",r),d(z(h,(function(t){return i+"["+t+"]"})),");",z(h,(function(t){return a+"["+t+"]="+i+"["+t+"];"})).join("")),e("if(",z(h,(function(t){return i+"["+t+"]!=="+a+"["+t+"]"})).join("||"),"){",d,"}")}else i=o.def(u,".",r),a=o.def(c,".",r),d(i,");",c,".",r,"=",i,";"),e("if(",i,"!==",a,"){",d,"}");n(d)})),t.compile()}(),compile:function(t,r,i,o,a){var s=j();s.stats=s.link(a),Object.keys(r.static).forEach((function(t){J(s,r,t)})),Tn.forEach((function(e){J(s,t,e)}));var l=C(t,r,i,o,s);return function(t,e){var n=t.proc("draw",1);P(t,n),F(t,n,e.context),N(t,n,e.framebuffer),R(t,n,e),U(t,n,e.state),V(t,n,e,!1,!0);var r=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",r,".program);"),e.shader.program)q(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(t.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",t.link((function(n){return G(q,t,e,n,1)})),"(",r,");",a,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}(s,l),function(t,e){var r=t.proc("scope",3);t.batchId="a2";var i=t.shared,o=i.current;function a(n){var o=e.shader[n];o&&r.set(i.shader,"."+n,o.append(t,r))}F(t,r,e.context),e.framebuffer&&e.framebuffer.append(t,r),or(Object.keys(e.state)).forEach((function(n){var o=e.state[n].append(t,r);ht(o)?o.forEach((function(e,i){r.set(t.next[n],"["+i+"]",e)})):r.set(i.next,"."+n,o)})),V(t,r,e,!0,!0),[hn,mn,_n,yn,pn].forEach((function(n){var o=e.draw[n];o&&r.set(i.draw,"."+n,""+o.append(t,r))})),Object.keys(e.uniforms).forEach((function(o){var a=e.uniforms[o].append(t,r);Array.isArray(a)&&(a="["+a.join()+"]"),r.set(i.uniforms,"["+n.id(o)+"]",a)})),Object.keys(e.attributes).forEach((function(n){var i=e.attributes[n].append(t,r),o=t.scopeAttrib(n);Object.keys(new m).forEach((function(t){r.set(o,"."+t,i[t])}))})),e.scopeVAO&&r.set(i.vao,".targetVAO",e.scopeVAO.append(t,r)),a(fn),a(dn),Object.keys(e.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",t.shared.context,",a0,",t.batchId,");")}(s,l),function(t,e){var n=t.proc("batch",2);t.batchId="0",P(t,n);var r=!1,i=!0;Object.keys(e.context).forEach((function(t){r=r||e.context[t].propDep})),r||(F(t,n,e.context),i=!1);var o=e.framebuffer,a=!1;function s(t){return t.contextDep&&r||t.propDep}o?(o.propDep?r=a=!0:o.contextDep&&r&&(a=!0),a||N(t,n,o)):N(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(r=!0),R(t,n,e),U(t,n,e.state,(function(t){return!s(t)})),e.profile&&s(e.profile)||V(t,n,e,!1,"a1"),e.contextDep=r,e.needsContext=i,e.needsFramebuffer=a;var l=e.shader.progVar;if(l.contextDep&&r||l.propDep)Z(t,n,e,null);else{var u=l.append(t,n);if(n(t.shared.gl,".useProgram(",u,".program);"),e.shader.program)Z(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var c=t.global.def("{}"),f=n.def(u,".id"),d=n.def(c,"[",f,"]");n(t.cond(d).then(d,".call(this,a0,a1);").else(d,"=",c,"[",f,"]=",t.link((function(n){return G(Z,t,e,n,2)})),"(",u,");",d,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}(s,l),e(s.compile(),{destroy:function(){l.shader.program.destroy()}})}}}var dr=function(t,e){if(!e.ext_disjoint_timer_query)return null;var n=[];function r(t){n.push(t)}var i=[];function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var a=[];var s=[];function l(t,e,n){var r=a.pop()||new o;r.startQueryIndex=t,r.endQueryIndex=e,r.sum=0,r.stats=n,s.push(r)}var u=[],c=[];return{beginQuery:function(t){var r=n.pop()||e.ext_disjoint_timer_query.createQueryEXT();e.ext_disjoint_timer_query.beginQueryEXT(35007,r),i.push(r),l(i.length-1,i.length,t)},endQuery:function(){e.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:l,update:function(){var t,n,o,l=i.length;if(0!==l){c.length=Math.max(c.length,l+1),u.length=Math.max(u.length,l+1),u[0]=0,c[0]=0;var f=0;for(t=0,n=0;n<i.length;++n){var d=i[n];e.ext_disjoint_timer_query.getQueryObjectEXT(d,34919)?(f+=e.ext_disjoint_timer_query.getQueryObjectEXT(d,34918),r(d)):i[t++]=d,u[n+1]=f,c[n+1]=t}for(i.length=t,t=0,n=0;n<s.length;++n){var h=s[n],p=h.startQueryIndex,_=h.endQueryIndex;h.sum+=u[_]-u[p];var m=c[p],y=c[_];y===m?(h.stats.gpuTime+=h.sum/1e6,o=h,a.push(o)):(h.startQueryIndex=m,h.endQueryIndex=y,s[t++]=h)}s.length=t}},getNumPendingQueries:function(){return i.length},clear:function(){n.push.apply(n,i);for(var t=0;t<n.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(n[t]);i.length=0,n.length=0},restore:function(){i.length=0,n.length=0}}},hr="webglcontextlost",pr="webglcontextrestored";function _r(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}return function(n){var r=j(n);if(!r)return null;var i=r.gl,o=i.getContextAttributes(),a=i.isContextLost(),s=function(t,e){var n={};function r(e){S.type(e,"string","extension name must be string");var r,i=e.toLowerCase();try{r=n[i]=t.getExtension(i)}catch(t){}return!!r}for(var i=0;i<e.extensions.length;++i){var o=e.extensions[i];if(!r(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!r(t))throw new Error("(regl): error restoring extension "+t)}))}}}(i,r);if(!s)return null;var l,u,c=(l={"":0},u=[""],{id:function(t){var e=l[t];return e||(e=l[t]=u.length,u.push(t),e)},str:function(t){return u[t]}}),f={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},d=s.extensions,h=dr(0,d),p=B(),_=i.drawingBufferWidth,m=i.drawingBufferHeight,y={tick:0,time:0,viewportWidth:_,viewportHeight:m,framebufferWidth:_,framebufferHeight:m,drawingBufferWidth:_,drawingBufferHeight:m,pixelRatio:r.pixelRatio},b={elements:null,primitive:4,count:-1,offset:0,instances:-1},g=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(34047));var r=1,i=1;e.webgl_draw_buffers&&(r=t.getParameter(34852),i=t.getParameter(36063));var o=!!e.oes_texture_float;if(o){var a=t.createTexture();t.bindTexture(R,a),t.texImage2D(R,0,U,1,1,0,U,P,null);var s=t.createFramebuffer();if(t.bindFramebuffer(V,s),t.framebufferTexture2D(V,36064,R,a,0),t.bindTexture(R,null),36053!==t.checkFramebufferStatus(V))o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var l=N.allocType(P,4);t.readPixels(0,0,1,1,U,P,l),t.getError()?o=!1:(t.deleteFramebuffer(s),t.deleteTexture(a),o=1===l[0]),N.freeType(l)}}var u=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var c=t.createTexture(),f=N.allocType(5121,36);t.activeTexture(33984),t.bindTexture(34067,c),t.texImage2D(34069,0,U,3,3,0,U,5121,f),N.freeType(f),t.bindTexture(34067,null),t.deleteTexture(c),u=!t.getError()}return{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:o,npotTextureCube:u}}(i,d),v=function(e,n,r,i){var o=0,a={};function s(t){this.id=o++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=Q,this.persistentData=null,r.profile&&(this.stats={size:0})}s.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){f(this)};var l=[];function u(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function c(e,n,r,i,o,a){var s,l;if(e.usage=r,Array.isArray(n)){if(e.dtype=i||tt,n.length>0)if(Array.isArray(n[0])){s=K(n);for(var c=1,f=1;f<s.length;++f)c*=s[f];e.dimension=c,u(e,l=J(n,s,e.dtype),r),a?e.persistentData=l:N.freeType(l)}else if("number"==typeof n[0]){e.dimension=o;var d=N.allocType(e.dtype,n.length);rt(d,n),u(e,d,r),a?e.persistentData=d:N.freeType(d)}else t(n[0])?(e.dimension=n[0].length,e.dtype=i||nt(n[0])||tt,u(e,l=J(n,[n.length,n[0].length],e.dtype),r),a?e.persistentData=l:N.freeType(l)):S.raise("invalid buffer data")}else if(t(n))e.dtype=i||nt(n),e.dimension=o,u(e,n,r),a&&(e.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if($(n)){s=n.shape;var h=n.stride,p=n.offset,_=0,m=0,y=0,b=0;1===s.length?(_=s[0],m=1,y=h[0],b=0):2===s.length?(_=s[0],m=s[1],y=h[0],b=h[1]):S.raise("invalid shape"),e.dtype=i||nt(n.data)||tt,e.dimension=m;var g=N.allocType(e.dtype,_*m);it(g,n.data,_,m,y,b,p),u(e,g,r),a?e.persistentData=g:N.freeType(g)}else n instanceof ArrayBuffer?(e.dtype=Q,e.dimension=o,u(e,n,r),a&&(e.persistentData=new Uint8Array(new Uint8Array(n)))):S.raise("invalid buffer data")}function f(t){n.bufferCount--,i(t);var r=t.buffer;S(r,"buffer must not be deleted already"),e.deleteBuffer(r),t.buffer=null,delete a[t.id]}return r.profile&&(n.getTotalBufferSize=function(){var t=0;return Object.keys(a).forEach((function(e){t+=a[e].stats.size})),t}),{create:function(i,o,l,u){n.bufferCount++;var d=new s(o);function h(n){var i=35044,o=null,a=0,s=0,l=1;return Array.isArray(n)||t(n)||$(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?a=0|n:n&&(S.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(S(null===o||Array.isArray(o)||t(o)||$(o),"invalid data for buffer"),o=n.data),"usage"in n&&(S.parameter(n.usage,Z,"invalid buffer usage"),i=Z[n.usage]),"type"in n&&(S.parameter(n.type,X,"invalid buffer type"),s=X[n.type]),"dimension"in n&&(S.type(n.dimension,"number","invalid dimension"),l=0|n.dimension),"length"in n&&(S.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),d.bind(),o?c(d,o,i,s,l,u):(a&&e.bufferData(d.type,a,i),d.dtype=s||Q,d.usage=i,d.dimension=l,d.byteLength=a),r.profile&&(d.stats.size=d.byteLength*et[d.dtype]),h}function p(t,n){S(n+t.byteLength<=d.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+d.byteLength),e.bufferSubData(d.type,n,t)}return a[d.id]=d,l||h(i),h._reglType="buffer",h._buffer=d,h.subdata=function(e,n){var r,i=0|(n||0);if(d.bind(),t(e)||e instanceof ArrayBuffer)p(e,i);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var o=N.allocType(d.dtype,e.length);rt(o,e),p(o,i),N.freeType(o)}else if(Array.isArray(e[0])||t(e[0])){r=K(e);var a=J(e,r,d.dtype);p(a,i),N.freeType(a)}else S.raise("invalid buffer data")}else if($(e)){r=e.shape;var s=e.stride,l=0,u=0,c=0,f=0;1===r.length?(l=r[0],u=1,c=s[0],f=0):2===r.length?(l=r[0],u=r[1],c=s[0],f=s[1]):S.raise("invalid shape");var _=Array.isArray(e.data)?d.dtype:nt(e.data),m=N.allocType(_,l*u);it(m,e.data,l,u,c,f,e.offset),p(m,i),N.freeType(m)}else S.raise("invalid data for buffer subdata");return h},r.profile&&(h.stats=d.stats),h.destroy=function(){f(d)},h},createStream:function(t,e){var n=l.pop();return n||(n=new s(t)),n.bind(),c(n,e,35040,0,1,!1),n},destroyStream:function(t){l.push(t)},clear:function(){W(a).forEach(f),l.forEach(f)},getBuffer:function(t){return t&&t._buffer instanceof s?t._buffer:null},restore:function(){W(a).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))},_initBuffer:c}}(i,f,r,(function(t){return x.destroyBuffer(t)})),w=function(e,n,r,i){var o={},a=0,s={uint8:at,uint16:st};function l(t){this.id=a++,o[this.id]=this,this.buffer=t,this.primType=4,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=lt),l.prototype.bind=function(){this.buffer.bind()};var u=[];function c(i,o,a,s,l,u,c){var f;if(i.buffer.bind(),o){var d=c;c||t(o)&&(!$(o)||t(o.data))||(d=n.oes_element_index_uint?lt:st),r._initBuffer(i.buffer,o,a,d,3)}else e.bufferData(ut,u,a),i.buffer.dtype=f||at,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=u;if(f=c,!c){switch(i.buffer.dtype){case at:case 5120:f=at;break;case st:case 5122:f=st;break;case lt:case 5124:f=lt;break;default:S.raise("unsupported type for element array")}i.buffer.dtype=f}i.type=f,S(f!==lt||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var h=l;h<0&&(h=i.buffer.byteLength,f===st?h>>=1:f===lt&&(h>>=2)),i.vertCount=h;var p=s;if(s<0){p=4;var _=i.buffer.dimension;1===_&&(p=0),2===_&&(p=1),3===_&&(p=4)}i.primType=p}function f(t){i.elementsCount--,S(null!==t.buffer,"must not double destroy elements"),delete o[t.id],t.buffer.destroy(),t.buffer=null}return{create:function(e,n){var o=r.create(null,ut,!0),a=new l(o._buffer);function u(e){if(e)if("number"==typeof e)o(e),a.primType=4,a.vertCount=0|e,a.type=at;else{var n=null,r=35044,i=-1,l=-1,f=0,d=0;Array.isArray(e)||t(e)||$(e)?n=e:(S.type(e,"object","invalid arguments for elements"),"data"in e&&(n=e.data,S(Array.isArray(n)||t(n)||$(n),"invalid data for element buffer")),"usage"in e&&(S.parameter(e.usage,Z,"invalid element buffer usage"),r=Z[e.usage]),"primitive"in e&&(S.parameter(e.primitive,ot,"invalid element buffer primitive"),i=ot[e.primitive]),"count"in e&&(S("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),l=0|e.count),"type"in e&&(S.parameter(e.type,s,"invalid buffer type"),d=s[e.type]),"length"in e?f=0|e.length:(f=l,d===st||5122===d?f*=2:d!==lt&&5124!==d||(f*=4))),c(a,n,r,i,l,f,d)}else o(),a.primType=4,a.vertCount=0,a.type=at;return u}return i.elementsCount++,u(e),u._reglType="elements",u._elements=a,u.subdata=function(t,e){return o.subdata(t,e),u},u.destroy=function(){f(a)},u},createStream:function(t){var e=u.pop();return e||(e=new l(r.create(null,ut,!0,!1)._buffer)),c(e,t,35040,-1,-1,0,0),e},destroyStream:function(t){u.push(t)},getElements:function(t){return"function"==typeof t&&t._elements instanceof l?t._elements:null},clear:function(){W(o).forEach(f)}}}(i,d,v,f),x=function(e,n,r,i,o,a,s){for(var l=r.maxAttributes,u=new Array(l),c=0;c<l;++c)u[c]=new Te;var f=0,d={},h={Record:Te,scope:{},state:u,currentVAO:null,targetVAO:null,restore:p()?function(){p()&&W(d).forEach((function(t){t.refresh()}))}:function(){},createVAO:function(e){var r=new m;function s(e){var i;if(Array.isArray(e))i=e,r.elements&&r.ownsElements&&r.elements.destroy(),r.elements=null,r.ownsElements=!1,r.offset=0,r.count=0,r.instances=-1,r.primitive=4;else{if(S("object"==typeof e,"invalid arguments for create vao"),S("attributes"in e,"must specify attributes for vao"),e.elements){var u=e.elements;r.ownsElements?"function"==typeof u&&"elements"===u._reglType?(r.elements.destroy(),r.ownsElements=!1):(r.elements(u),r.ownsElements=!1):a.getElements(e.elements)?(r.elements=e.elements,r.ownsElements=!1):(r.elements=a.create(e.elements),r.ownsElements=!0)}else r.elements=null,r.ownsElements=!1;i=e.attributes,r.offset=0,r.count=-1,r.instances=-1,r.primitive=4,r.elements&&(r.count=r.elements._elements.vertCount,r.primitive=r.elements._elements.primType),"offset"in e&&(r.offset=0|e.offset),"count"in e&&(r.count=0|e.count),"instances"in e&&(r.instances=0|e.instances),"primitive"in e&&(S(e.primitive in ot,"bad primitive type: "+e.primitive),r.primitive=ot[e.primitive]),S.optional((()=>{for(var t=Object.keys(e),n=0;n<t.length;++n)S(Oe.indexOf(t[n])>=0,'invalid option for vao: "'+t[n]+'" valid options are '+Oe)})),S(Array.isArray(i),"attributes must be an array")}S(i.length<l,"too many attributes"),S(i.length>0,"must specify at least one attribute");var c={},f=r.attributes;f.length=i.length;for(var d=0;d<i.length;++d){var h,p=i[d],_=f[d]=new Te,m=p.data||p;Array.isArray(m)||t(m)||$(m)?(r.buffers[d]&&(h=r.buffers[d],t(m)&&h._buffer.byteLength>=m.byteLength?h.subdata(m):(h.destroy(),r.buffers[d]=null)),r.buffers[d]||(h=r.buffers[d]=o.create(p,34962,!1,!0)),_.buffer=o.getBuffer(h),_.size=0|_.buffer.dimension,_.normalized=!1,_.type=_.buffer.dtype,_.offset=0,_.stride=0,_.divisor=0,_.state=1,c[d]=1):o.getBuffer(p)?(_.buffer=o.getBuffer(p),_.size=0|_.buffer.dimension,_.normalized=!1,_.type=_.buffer.dtype,_.offset=0,_.stride=0,_.divisor=0,_.state=1):o.getBuffer(p.buffer)?(_.buffer=o.getBuffer(p.buffer),_.size=0|(+p.size||_.buffer.dimension),_.normalized=!!p.normalized||!1,"type"in p?(S.parameter(p.type,X,"invalid buffer type"),_.type=X[p.type]):_.type=_.buffer.dtype,_.offset=0|(p.offset||0),_.stride=0|(p.stride||0),_.divisor=0|(p.divisor||0),_.state=1,S(_.size>=1&&_.size<=4,"size must be between 1 and 4"),S(_.offset>=0,"invalid offset"),S(_.stride>=0&&_.stride<=255,"stride must be between 0 and 255"),S(_.divisor>=0,"divisor must be positive"),S(!_.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in p?(S(d>0,"first attribute must not be a constant"),_.x=+p.x||0,_.y=+p.y||0,_.z=+p.z||0,_.w=+p.w||0,_.state=2):S(!1,"invalid attribute spec for location "+d)}for(var y=0;y<r.buffers.length;++y)!c[y]&&r.buffers[y]&&(r.buffers[y].destroy(),r.buffers[y]=null);return r.refresh(),s}return i.vaoCount+=1,s.destroy=function(){for(var t=0;t<r.buffers.length;++t)r.buffers[t]&&r.buffers[t].destroy();r.buffers.length=0,r.ownsElements&&(r.elements.destroy(),r.elements=null,r.ownsElements=!1),r.destroy()},s._vao=r,s._reglType="vao",s(e)},getVAO:function(t){return"function"==typeof t&&t._vao?t._vao:null},destroyBuffer:function(t){for(var n=0;n<u.length;++n){var r=u[n];r.buffer===t&&(e.disableVertexAttribArray(n),r.buffer=null)}},setVAO:p()?function(t){if(t!==h.currentVAO){var e=p();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),h.currentVAO=t}}:function(t){if(t!==h.currentVAO){if(t)t.bindAttrs();else{for(var n=_(),r=0;r<u.length;++r){var i=u[r];i.buffer?(e.enableVertexAttribArray(r),i.buffer.bind(),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&i.divisor&&n.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}s.elements?e.bindBuffer(ke,s.elements.buffer.buffer):e.bindBuffer(ke,null)}h.currentVAO=t}},clear:p()?function(){W(d).forEach((function(t){t.destroy()}))}:function(){}};function p(){return n.oes_vertex_array_object}function _(){return n.angle_instanced_arrays}function m(){this.id=++f,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var t=p();this.vao=t?t.createVertexArrayOES():null,d[this.id]=this,this.buffers=[]}return m.prototype.bindAttrs=function(){for(var t=_(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(e.enableVertexAttribArray(r),e.bindBuffer(34962,i.buffer.buffer),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),t&&i.divisor&&t.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var o=n.length;o<l;++o)e.disableVertexAttribArray(o);var s=a.getElements(this.elements);s?e.bindBuffer(ke,s.buffer.buffer):e.bindBuffer(ke,null)},m.prototype.refresh=function(){var t=p();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),h.currentVAO=null,t.bindVertexArrayOES(null))},m.prototype.destroy=function(){if(this.vao){var t=p();this===h.currentVAO&&(h.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),d[this.id]&&(delete d[this.id],i.vaoCount-=1)},h}(i,d,g,f,v,w,b),A=function(t,n,r,i){var o={},a={};function s(t,e,n,r){this.name=t,this.id=e,this.location=n,this.info=r}function l(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function u(e,r,i){var s=35632===e?o:a,l=s[r];if(!l){var u=n.str(r);l=t.createShader(e),t.shaderSource(l,u),t.compileShader(l),S.shaderError(t,l,u,e,i),s[r]=l}return l}var c={},f=[],d=0;function h(t,e){this.id=d++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(e,r,o){var a,c,f=u(35632,e.fragId),d=u(35633,e.vertId),h=e.program=t.createProgram();if(t.attachShader(h,f),t.attachShader(h,d),o)for(a=0;a<o.length;++a){var p=o[a];t.bindAttribLocation(h,p[0],p[1])}t.linkProgram(h),S.linkError(t,h,n.str(e.fragId),n.str(e.vertId),r);var _=t.getProgramParameter(h,35718);i.profile&&(e.stats.uniformsCount=_);var m=e.uniforms;for(a=0;a<_;++a)if(c=t.getActiveUniform(h,a)){if(c.size>1)for(var y=0;y<c.size;++y){var b=c.name.replace("[0]","["+y+"]");l(m,new s(b,n.id(b),t.getUniformLocation(h,b),c))}var g=c.name;c.size>1&&(g=g.replace("[0]","")),l(m,new s(g,n.id(g),t.getUniformLocation(h,g),c))}var v=t.getProgramParameter(h,35721);i.profile&&(e.stats.attributesCount=v);var w=e.attributes;for(a=0;a<v;++a)(c=t.getActiveAttrib(h,a))&&l(w,new s(c.name,n.id(c.name),t.getAttribLocation(h,c.name),c))}return i.profile&&(r.getMaxUniformsCount=function(){var t=0;return f.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},r.getMaxAttributesCount=function(){var t=0;return f.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);W(o).forEach(e),o={},W(a).forEach(e),a={},f.forEach((function(e){t.deleteProgram(e.program)})),f.length=0,c={},r.shaderCount=0},program:function(n,i,s,l){S.command(n>=0,"missing vertex shader",s),S.command(i>=0,"missing fragment shader",s);var u=c[i];u||(u=c[i]={});var d=u[n];if(d&&(d.refCount++,!l))return d;var _=new h(i,n);return r.shaderCount++,p(_,s,l),d||(u[n]=_),f.push(_),e(_,{destroy:function(){if(_.refCount--,_.refCount<=0){t.deleteProgram(_.program);var e=f.indexOf(_);f.splice(e,1),r.shaderCount--}u[_.vertId].refCount<=0&&(t.deleteShader(a[_.vertId]),delete a[_.vertId],delete c[_.fragId][_.vertId]),Object.keys(c[_.fragId]).length||(t.deleteShader(o[_.fragId]),delete o[_.fragId],delete c[_.fragId])}})},restore:function(){o={},a={};for(var t=0;t<f.length;++t)p(f[t],null,f[t].attributes.map((function(t){return[t.location,t.name]})))},shader:u,frag:-1,vert:-1}}(i,c,f,r),I=de(i,d,g,(function(){T.procs.poll()}),y,f,r),k=function(t,e,n,r,i){var o={rgba4:pe,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(o.srgba=35907),e.ext_color_buffer_half_float&&(o.rgba16f=34842,o.rgb16f=34843),e.webgl_color_buffer_float&&(o.rgba32f=34836);var a=[];Object.keys(o).forEach((function(t){var e=o[t];a[e]=t}));var s=0,l={};function u(t){this.id=s++,this.refCount=1,this.renderbuffer=t,this.format=pe,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function c(e){var n=e.renderbuffer;S(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(he,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete l[e.id],r.renderbufferCount--}return u.prototype.decRef=function(){--this.refCount<=0&&c(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var t=0;return Object.keys(l).forEach((function(e){t+=l[e].stats.size})),t}),{create:function(e,s){var c=new u(t.createRenderbuffer());function f(e,r){var s=0,l=0,u=pe;if("object"==typeof e&&e){var d=e;if("shape"in d){var h=d.shape;S(Array.isArray(h)&&h.length>=2,"invalid renderbuffer shape"),s=0|h[0],l=0|h[1]}else"radius"in d&&(s=l=0|d.radius),"width"in d&&(s=0|d.width),"height"in d&&(l=0|d.height);"format"in d&&(S.parameter(d.format,o,"invalid renderbuffer format"),u=o[d.format])}else"number"==typeof e?(s=0|e,l="number"==typeof r?0|r:s):e?S.raise("invalid arguments to renderbuffer constructor"):s=l=1;if(S(s>0&&l>0&&s<=n.maxRenderbufferSize&&l<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==c.width||l!==c.height||u!==c.format)return f.width=c.width=s,f.height=c.height=l,c.format=u,t.bindRenderbuffer(he,c.renderbuffer),t.renderbufferStorage(he,u,s,l),S(0===t.getError(),"invalid render buffer format"),i.profile&&(c.stats.size=me(c.format,c.width,c.height)),f.format=a[c.format],f}return l[c.id]=c,r.renderbufferCount++,f(e,s),f.resize=function(e,r){var o=0|e,a=0|r||o;return o===c.width&&a===c.height||(S(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),f.width=c.width=o,f.height=c.height=a,t.bindRenderbuffer(he,c.renderbuffer),t.renderbufferStorage(he,c.format,o,a),S(0===t.getError(),"invalid render buffer format"),i.profile&&(c.stats.size=me(c.format,c.width,c.height))),f},f._reglType="renderbuffer",f._renderbuffer=c,i.profile&&(f.stats=c.stats),f.destroy=function(){c.decRef()},f},clear:function(){W(l).forEach(c)},restore:function(){W(l).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(he,e.renderbuffer),t.renderbufferStorage(he,e.format,e.width,e.height)})),t.bindRenderbuffer(he,null)}}}(i,d,g,f,r),O=function(t,n,r,i,o,a){var s={cur:null,next:null,dirty:!1,setFBO:null},l=["rgba"],u=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&u.push("srgba"),n.ext_color_buffer_half_float&&u.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&u.push("rgba32f");var c=["uint8"];function f(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var r=0,i=0;e?(r=e.width,i=e.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function d(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function h(t,e,n){if(t)if(t.texture){var r=t.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);S(i===e&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=t.renderbuffer._renderbuffer;S(a.width===e&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function p(e,n){n&&(n.texture?t.framebufferTexture2D(ye,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(ye,e,be,n.renderbuffer._renderbuffer.renderbuffer))}function _(t){var e=ge,n=null,r=null,i=t;"object"==typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),S.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,S(e===ge)):"textureCube"===o?(n=i,S(e>=ve&&e<34075,"invalid cube map target")):"renderbuffer"===o?(r=i,e=be):S.raise("invalid regl object for attachment"),new f(e,n,r)}function m(t,e,n,r,a){if(n){var s=i.create2D({width:t,height:e,format:r,type:a});return s._texture.refCount=0,new f(ge,s,null)}var l=o.create({width:t,height:e,format:r});return l._renderbuffer.refCount=0,new f(be,null,l)}function y(t){return t&&(t.texture||t.renderbuffer)}function b(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}n.oes_texture_half_float&&c.push("half float","float16"),n.oes_texture_float&&c.push("float","float32");var g=0,v={};function w(){this.id=g++,v[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function x(t){t.colorAttachments.forEach(d),d(t.depthAttachment),d(t.stencilAttachment),d(t.depthStencilAttachment)}function A(e){var n=e.framebuffer;S(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,a.framebufferCount--,delete v[e.id]}function I(e){var n;t.bindFramebuffer(ye,e.framebuffer);var i=e.colorAttachments;for(n=0;n<i.length;++n)p(36064+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)t.framebufferTexture2D(ye,36064+n,ge,null,0);t.framebufferTexture2D(ye,33306,ge,null,0),t.framebufferTexture2D(ye,36096,ge,null,0),t.framebufferTexture2D(ye,36128,ge,null,0),p(36096,e.depthAttachment),p(36128,e.stencilAttachment),p(33306,e.depthStencilAttachment);var o=t.checkFramebufferStatus(ye);t.isContextLost()||36053===o||S.raise("framebuffer configuration not supported, status = "+Ie[o]),t.bindFramebuffer(ye,s.next?s.next.framebuffer:null),s.cur=s.next,t.getError()}function k(t,i){var o=new w;function f(t,e){var i;S(s.next!==o,"can not update framebuffer which is currently in use");var a=0,d=0,p=!0,b=!0,g=null,v=!0,w="rgba",A="uint8",k=1,O=null,T=null,L=null,M=!1;if("number"==typeof t)a=0|t,d=0|e||a;else if(t){S.type(t,"object","invalid arguments for framebuffer");var B=t;if("shape"in B){var E=B.shape;S(Array.isArray(E)&&E.length>=2,"invalid shape for framebuffer"),a=E[0],d=E[1]}else"radius"in B&&(a=d=B.radius),"width"in B&&(a=B.width),"height"in B&&(d=B.height);("color"in B||"colors"in B)&&(g=B.color||B.colors,Array.isArray(g)&&S(1===g.length||n.webgl_draw_buffers,"multiple render targets not supported")),g||("colorCount"in B&&(k=0|B.colorCount,S(k>0,"invalid color buffer count")),"colorTexture"in B&&(v=!!B.colorTexture,w="rgba4"),"colorType"in B&&(A=B.colorType,v?(S(n.oes_texture_float||!("float"===A||"float32"===A),"you must enable OES_texture_float in order to use floating point framebuffer objects"),S(n.oes_texture_half_float||!("half float"===A||"float16"===A),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===A||"float16"===A?(S(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):"float"!==A&&"float32"!==A||(S(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),S.oneOf(A,c,"invalid color type")),"colorFormat"in B&&(w=B.colorFormat,l.indexOf(w)>=0?v=!0:u.indexOf(w)>=0?v=!1:S.optional((function(){v?S.oneOf(B.colorFormat,l,"invalid color format for texture"):S.oneOf(B.colorFormat,u,"invalid color format for renderbuffer")})))),("depthTexture"in B||"depthStencilTexture"in B)&&(M=!(!B.depthTexture&&!B.depthStencilTexture),S(!M||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in B&&("boolean"==typeof B.depth?p=B.depth:(O=B.depth,b=!1)),"stencil"in B&&("boolean"==typeof B.stencil?b=B.stencil:(T=B.stencil,p=!1)),"depthStencil"in B&&("boolean"==typeof B.depthStencil?p=b=B.depthStencil:(L=B.depthStencil,p=!1,b=!1))}else a=d=1;var D=null,j=null,z=null,C=null;if(Array.isArray(g))D=g.map(_);else if(g)D=[_(g)];else for(D=new Array(k),i=0;i<k;++i)D[i]=m(a,d,v,w,A);S(n.webgl_draw_buffers||D.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),S(D.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||D[0].width,d=d||D[0].height,O?j=_(O):p&&!b&&(j=m(a,d,M,"depth","uint32")),T?z=_(T):b&&!p&&(z=m(a,d,!1,"stencil","uint8")),L?C=_(L):!O&&!T&&b&&p&&(C=m(a,d,M,"depth stencil","depth stencil")),S(!!O+!!T+!!L<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var F=null;for(i=0;i<D.length;++i)if(h(D[i],a,d),S(!D[i]||D[i].texture&&we.indexOf(D[i].texture._texture.format)>=0||D[i].renderbuffer&&Ae.indexOf(D[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),D[i]&&D[i].texture){var N=xe[D[i].texture._texture.format]*Se[D[i].texture._texture.type];null===F?F=N:S(F===N,"all color attachments much have the same number of bits per pixel.")}return h(j,a,d),S(!j||j.texture&&6402===j.texture._texture.format||j.renderbuffer&&33189===j.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),h(z,a,d),S(!z||z.renderbuffer&&36168===z.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),h(C,a,d),S(!C||C.texture&&34041===C.texture._texture.format||C.renderbuffer&&34041===C.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),x(o),o.width=a,o.height=d,o.colorAttachments=D,o.depthAttachment=j,o.stencilAttachment=z,o.depthStencilAttachment=C,f.color=D.map(y),f.depth=y(j),f.stencil=y(z),f.depthStencil=y(C),f.width=o.width,f.height=o.height,I(o),f}return a.framebufferCount++,f(t,i),e(f,{resize:function(t,e){S(s.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),r=Math.max(0|e||n,1);if(n===o.width&&r===o.height)return f;for(var i=o.colorAttachments,a=0;a<i.length;++a)b(i[a],n,r);return b(o.depthAttachment,n,r),b(o.stencilAttachment,n,r),b(o.depthStencilAttachment,n,r),o.width=f.width=n,o.height=f.height=r,I(o),f},_reglType:"framebuffer",_framebuffer:o,destroy:function(){A(o),x(o)},use:function(t){s.setFBO({framebuffer:f},t)}})}return e(s,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof w)return e}return null},create:k,createCube:function(t){var o=Array(6);function a(t){var r;S(o.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var u,f={color:null},d=0,h=null,p="rgba",_="uint8",m=1;if("number"==typeof t)d=0|t;else if(t){S.type(t,"object","invalid arguments for framebuffer");var y=t;if("shape"in y){var b=y.shape;S(Array.isArray(b)&&b.length>=2,"invalid shape for framebuffer"),S(b[0]===b[1],"cube framebuffer must be square"),d=b[0]}else"radius"in y&&(d=0|y.radius),"width"in y?(d=0|y.width,"height"in y&&S(y.height===d,"must be square")):"height"in y&&(d=0|y.height);("color"in y||"colors"in y)&&(h=y.color||y.colors,Array.isArray(h)&&S(1===h.length||n.webgl_draw_buffers,"multiple render targets not supported")),h||("colorCount"in y&&(m=0|y.colorCount,S(m>0,"invalid color buffer count")),"colorType"in y&&(S.oneOf(y.colorType,c,"invalid color type"),_=y.colorType),"colorFormat"in y&&(p=y.colorFormat,S.oneOf(y.colorFormat,l,"invalid color format for texture"))),"depth"in y&&(f.depth=y.depth),"stencil"in y&&(f.stencil=y.stencil),"depthStencil"in y&&(f.depthStencil=y.depthStencil)}else d=1;if(h)if(Array.isArray(h))for(u=[],r=0;r<h.length;++r)u[r]=h[r];else u=[h];else{u=Array(m);var g={radius:d,format:p,type:_};for(r=0;r<m;++r)u[r]=i.createCube(g)}for(f.color=Array(u.length),r=0;r<u.length;++r){var v=u[r];S("function"==typeof v&&"textureCube"===v._reglType,"invalid cube map"),d=d||v.width,S(v.width===d&&v.height===d,"invalid cube map shape"),f.color[r]={target:ve,data:u[r]}}for(r=0;r<6;++r){for(var w=0;w<u.length;++w)f.color[w].target=ve+r;r>0&&(f.depth=o[0].depth,f.stencil=o[0].stencil,f.depthStencil=o[0].depthStencil),o[r]?o[r](f):o[r]=k(f)}return e(a,{width:d,height:d,color:u})}return a(t),e(a,{faces:o,resize:function(t){var e,n=0|t;if(S(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var i=a.color;for(e=0;e<i.length;++e)i[e].resize(n);for(e=0;e<6;++e)o[e].resize(n);return a.width=a.height=n,a},_reglType:"framebufferCube",destroy:function(){o.forEach((function(t){t.destroy()}))}})},clear:function(){W(v).forEach(A)},restore:function(){s.cur=null,s.next=null,s.dirty=!0,W(v).forEach((function(e){e.framebuffer=t.createFramebuffer(),I(e)}))}})}(i,d,g,I,k,f),T=fr(i,c,d,g,v,w,0,O,{},x,A,b,y,h,r),E=Be(i,O,T.procs.poll,y,o,d,g),D=T.next,z=i.canvas,C=[],F=[],Y=[],G=[r.onDestroy],q=null;function H(){if(0===C.length)return h&&h.update(),void(q=null);q=M.next(H),gt();for(var t=C.length-1;t>=0;--t){var e=C[t];e&&e(y,null,0)}i.flush(),h&&h.update()}function ct(){!q&&C.length>0&&(q=M.next(H))}function ft(){q&&(M.cancel(H),q=null)}function dt(t){t.preventDefault(),a=!0,ft(),F.forEach((function(t){t()}))}function ht(t){i.getError(),a=!1,s.restore(),A.restore(),v.restore(),I.restore(),k.restore(),O.restore(),x.restore(),h&&h.restore(),T.procs.refresh(),ct(),Y.forEach((function(t){t()}))}function pt(t){function n(t,e){var n={},r={};return Object.keys(t).forEach((function(i){var o=t[i];if(L.isDynamic(o))r[i]=L.unbox(o,i);else{if(e&&Array.isArray(o))for(var a=0;a<o.length;++a)if(L.isDynamic(o[a]))return void(r[i]=L.unbox(o,i));n[i]=o}})),{dynamic:r,static:n}}S(!!t,"invalid args to regl({...})"),S.type(t,"object","invalid args to regl({...})");var r=n(t.context||{},!0),i=n(t.uniforms||{},!0),o=n(t.attributes||{},!1),s=n(function(t){var n=e({},t);function r(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach((function(r){n[t+"."+r]=e[r]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in t&&(n.vao=t.vao),n}(t),!1),l={gpuTime:0,cpuTime:0,count:0},u=T.compile(s,o,i,r,l),c=u.draw,f=u.batch,d=u.scope,h=[];return e((function(t,e){var n;if(a&&S.raise("context lost"),"function"==typeof t)return d.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(n=0;n<t;++n)d.call(this,null,e,n);else{if(!Array.isArray(t))return d.call(this,t,e,0);for(n=0;n<t.length;++n)d.call(this,t[n],e,n)}else if("number"==typeof t){if(t>0)return f.call(this,function(t){for(;h.length<t;)h.push(null);return h}(0|t),0|t)}else{if(!Array.isArray(t))return c.call(this,t);if(t.length)return f.call(this,t,t.length)}}),{stats:l,destroy:function(){u.destroy()}})}z&&(z.addEventListener(hr,dt,!1),z.addEventListener(pr,ht,!1));var _t=O.setFBO=pt({framebuffer:L.define.call(null,1,"framebuffer")});function mt(t,e){var n=0;T.procs.poll();var r=e.color;r&&(i.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in e&&(i.clearDepth(+e.depth),n|=256),"stencil"in e&&(i.clearStencil(0|e.stencil),n|=1024),S(!!n,"called regl.clear with no buffer specified"),i.clear(n)}function yt(t){return S.type(t,"function","regl.frame() callback must be a function"),C.push(t),ct(),{cancel:function(){var e=_r(C,t);S(e>=0,"cannot cancel a frame twice"),C[e]=function t(){var e=_r(C,t);C[e]=C[C.length-1],C.length-=1,C.length<=0&&ft()}}}}function bt(){var t=D.viewport,e=D.scissor_box;t[0]=t[1]=e[0]=e[1]=0,y.viewportWidth=y.framebufferWidth=y.drawingBufferWidth=t[2]=e[2]=i.drawingBufferWidth,y.viewportHeight=y.framebufferHeight=y.drawingBufferHeight=t[3]=e[3]=i.drawingBufferHeight}function gt(){y.tick+=1,y.time=wt(),bt(),T.procs.poll()}function vt(){I.refresh(),bt(),T.procs.refresh(),h&&h.update()}function wt(){return(B()-p)/1e3}vt();var xt=e(pt,{clear:function(t){if(S("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var n=0;n<6;++n)_t(e({framebuffer:t.framebuffer.faces[n]},t),mt);else _t(t,mt);else mt(0,t)},prop:L.define.bind(null,1),context:L.define.bind(null,2),this:L.define.bind(null,3),draw:pt({}),buffer:function(t){return v.create(t,34962,!1,!1)},elements:function(t){return w.create(t,!1)},texture:I.create2D,cube:I.createCube,renderbuffer:k.create,framebuffer:O.create,framebufferCube:O.createCube,vao:x.createVAO,attributes:o,frame:yt,on:function(t,e){var n;switch(S.type(e,"function","listener callback must be a function"),t){case"frame":return yt(e);case"lost":n=F;break;case"restore":n=Y;break;case"destroy":n=G;break;default:S.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}},limits:g,hasExtension:function(t){return g.extensions.indexOf(t.toLowerCase())>=0},read:E,destroy:function(){C.length=0,ft(),z&&(z.removeEventListener(hr,dt),z.removeEventListener(pr,ht)),A.clear(),O.clear(),k.clear(),x.clear(),I.clear(),w.clear(),v.clear(),h&&h.clear(),G.forEach((function(t){t()}))},_gl:i,_refresh:vt,poll:function(){gt(),h&&h.update()},now:wt,stats:f});return r.onDone(null,xt),xt}}();var Aa=new Uint8Array(4),Ia=new Float32Array(Aa.buffer);class ka{constructor(t,e="arithmetic"){this.transform="arithmetic",this.transform=e,this.start=t,this.value=t,this.target=t}update(t,e){if(0===e)return this.value=t,void(void 0!==this.timer&&this.timer.stop());this.start=this.value,this.target=t,this.start_timer(e)}start_timer(t){void 0!==this.timer&&this.timer.stop();const e=Vn((n=>{const r=n/t;if(r>=1)return this.value=this.target,void e.stop();const i=1-r,o=r;this.value="geometric"===this.transform?this.start**i*this.target**o:this.start*i+this.target*o}));this.timer=e}}class Oa{constructor(){this.maxPoints=new ka(1e4,"geometric"),this.pointSize=new ka(1,"geometric"),this.targetOpacity=new ka(50),this.foregroundOpacity=new ka(1),this.backgroundOpacity=new ka(.5),this.foregroundSize=new ka(1,"geometric"),this.backgroundSize=new ka(1,"geometric")}apply_prefs(t){const{duration:e}=t;this.maxPoints.update(t.max_points,e),this.targetOpacity.update(t.alpha,e),this.pointSize.update(t.point_size,e),this.foregroundOpacity.update(t.background_options.opacity[1],e),this.backgroundOpacity.update(t.background_options.opacity[0],e),this.foregroundSize.update(t.background_options.size[1],e),this.backgroundSize.update(t.background_options.size[0],e)}get max_points(){return this.maxPoints.value}get alpha(){return this.targetOpacity.value}get point_size(){return this.pointSize.value}get foreground_opacity(){return this.foregroundOpacity.value}get background_opacity(){return this.backgroundOpacity.value}get foreground_size(){return this.foregroundSize.value}get background_size(){return this.backgroundSize.value}}class Ta{constructor(t,e,n){this._use_scale_to_download_tiles=!0,this._initializations=[],this.render_props=new Oa,this.scatterplot=n,this.holder=St(t),this.canvas=St(this.holder.node().firstElementChild).node(),this.dataset=e,this.width=+St(this.canvas).attr("width"),this.height=+St(this.canvas).attr("height"),this.deferred_functions=[],this._use_scale_to_download_tiles=!0}get discard_share(){return 0}get prefs(){const t={...this.scatterplot.prefs};return t.arrow_table=void 0,t.arrow_buffer=void 0,t}get alpha(){return this.render_props.alpha}get optimal_alpha(){var t,e,n,r;const i=null!=(t=this.prefs.zoom_balance)?t:1,{alpha:o,point_size:a,max_ix:s,width:l,discard_share:u,height:c}=this,f=null!=(r=null==(n=null==(e=this.zoom)?void 0:e.transform)?void 0:n.k)?r:1,d=o/100,h=1/f**2,p=window.devicePixelRatio||1,_=l*c/p,m=Wt([s,this.dataset.highest_known_ix||1e10])*(1-u),y=Math.exp(Math.log(f)*i),b=d*_/(m*h*(Math.PI*(y*a/p/2)**2));return b<1/255?1/255:b}get point_size(){return this.render_props.point_size}get max_ix(){const{prefs:t}=this,{max_points:e}=this.render_props;if(!this._use_scale_to_download_tiles)return e;const{k:n}=this.zoom.transform,r=Math.exp(Math.log(n)*t.zoom_balance);return e*n*n/r/r}visible_tiles(){const{max_ix:t}=this,{dataset:e}=this,n="x"==this.aes.dim("x").current.field&&"y"==this.aes.dim("y").current.field&&"x"==this.aes.dim("x").last.field&&"y"==this.aes.dim("y").last.field?e.map((t=>t)).filter((e=>e.is_visible(t,this.zoom.current_corners()))):e.map((t=>t)).filter((t=>t.min_ix<this.max_ix));return n.sort(((t,e)=>t.min_ix-e.min_ix)),n}bind_zoom(t){return this.zoom=t,this}async initialize(){}}function La(t){return void 0!==t.op}function Ma(t){return void 0!==t.lambda}function Ba(t){return void 0!==t.constant}var Ea,Da,ja={};Ea={get exports(){return ja},set exports(t){ja=t}},Da=ja,function(){var t,e="Expected a function",n="__lodash_hash_undefined__",r="__lodash_placeholder__",i=32,o=128,a=1/0,s=9007199254740991,l=NaN,u=4294967295,c=[["ary",o],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",i],["partialRight",64],["rearg",256]],f="[object Arguments]",d="[object Array]",h="[object Boolean]",p="[object Date]",_="[object Error]",m="[object Function]",y="[object GeneratorFunction]",b="[object Map]",g="[object Number]",v="[object Object]",w="[object Promise]",x="[object RegExp]",S="[object Set]",A="[object String]",I="[object Symbol]",k="[object WeakMap]",O="[object ArrayBuffer]",T="[object DataView]",L="[object Float32Array]",M="[object Float64Array]",B="[object Int8Array]",E="[object Int16Array]",D="[object Int32Array]",j="[object Uint8Array]",z="[object Uint8ClampedArray]",C="[object Uint16Array]",F="[object Uint32Array]",N=/\b__p \+= '';/g,R=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,P=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,$=RegExp(P.source),W=RegExp(V.source),Y=/<%-([\s\S]+?)%>/g,G=/<%([\s\S]+?)%>/g,q=/<%=([\s\S]+?)%>/g,H=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,J=/[\\^$.*+?()[\]{}|]/g,K=RegExp(J.source),Q=/^\s+/,tt=/\s/,et=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,nt=/\{\n\/\* \[wrapped with (.+)\] \*/,rt=/,? & /,it=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ot=/[()=,{}\[\]\/\s]/,at=/\\(\\)?/g,st=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,lt=/\w*$/,ut=/^[-+]0x[0-9a-f]+$/i,ct=/^0b[01]+$/i,ft=/^\[object .+?Constructor\]$/,dt=/^0o[0-7]+$/i,ht=/^(?:0|[1-9]\d*)$/,pt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,mt=/['\n\r\u2028\u2029\\]/g,yt="\\ud800-\\udfff",bt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",gt="\\u2700-\\u27bf",vt="a-z\\xdf-\\xf6\\xf8-\\xff",wt="A-Z\\xc0-\\xd6\\xd8-\\xde",xt="\\ufe0e\\ufe0f",St="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",At="["+yt+"]",It="["+St+"]",kt="["+bt+"]",Ot="\\d+",Tt="["+gt+"]",Lt="["+vt+"]",Mt="[^"+yt+St+Ot+gt+vt+wt+"]",Bt="\\ud83c[\\udffb-\\udfff]",Et="[^"+yt+"]",Dt="(?:\\ud83c[\\udde6-\\uddff]){2}",jt="[\\ud800-\\udbff][\\udc00-\\udfff]",zt="["+wt+"]",Ct="\\u200d",Ft="(?:"+Lt+"|"+Mt+")",Nt="(?:"+zt+"|"+Mt+")",Rt="(?:['](?:d|ll|m|re|s|t|ve))?",Ut="(?:['](?:D|LL|M|RE|S|T|VE))?",Pt="(?:"+kt+"|"+Bt+")?",Vt="["+xt+"]?",$t=Vt+Pt+"(?:"+Ct+"(?:"+[Et,Dt,jt].join("|")+")"+Vt+Pt+")*",Wt="(?:"+[Tt,Dt,jt].join("|")+")"+$t,Yt="(?:"+[Et+kt+"?",kt,Dt,jt,At].join("|")+")",Gt=RegExp("[']","g"),qt=RegExp(kt,"g"),Ht=RegExp(Bt+"(?="+Bt+")|"+Yt+$t,"g"),Xt=RegExp([zt+"?"+Lt+"+"+Rt+"(?="+[It,zt,"$"].join("|")+")",Nt+"+"+Ut+"(?="+[It,zt+Ft,"$"].join("|")+")",zt+"?"+Ft+"+"+Rt,zt+"+"+Ut,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ot,Wt].join("|"),"g"),Zt=RegExp("["+Ct+yt+bt+xt+"]"),Jt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Kt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Qt=-1,te={};te[L]=te[M]=te[B]=te[E]=te[D]=te[j]=te[z]=te[C]=te[F]=!0,te[f]=te[d]=te[O]=te[h]=te[T]=te[p]=te[_]=te[m]=te[b]=te[g]=te[v]=te[x]=te[S]=te[A]=te[k]=!1;var ee={};ee[f]=ee[d]=ee[O]=ee[T]=ee[h]=ee[p]=ee[L]=ee[M]=ee[B]=ee[E]=ee[D]=ee[b]=ee[g]=ee[v]=ee[x]=ee[S]=ee[A]=ee[I]=ee[j]=ee[z]=ee[C]=ee[F]=!0,ee[_]=ee[m]=ee[k]=!1;var ne={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},re=parseFloat,ie=parseInt,oe="object"==typeof On&&On&&On.Object===Object&&On,ae="object"==typeof self&&self&&self.Object===Object&&self,se=oe||ae||Function("return this")(),le=Da&&!Da.nodeType&&Da,ue=le&&Ea&&!Ea.nodeType&&Ea,ce=ue&&ue.exports===le,fe=ce&&oe.process,de=function(){try{return ue&&ue.require&&ue.require("util").types||fe&&fe.binding&&fe.binding("util")}catch(t){}}(),he=de&&de.isArrayBuffer,pe=de&&de.isDate,_e=de&&de.isMap,me=de&&de.isRegExp,ye=de&&de.isSet,be=de&&de.isTypedArray;function ge(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ve(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function we(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function xe(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Se(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Ae(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function Ie(t,e){return!(null==t||!t.length)&&ze(t,e,0)>-1}function ke(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Oe(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Te(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Le(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function Me(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function Be(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Ee=Re("length");function De(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function je(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function ze(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):je(t,Fe,n)}function Ce(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function Fe(t){return t!=t}function Ne(t,e){var n=null==t?0:t.length;return n?Ve(t,e)/n:l}function Re(e){return function(n){return null==n?t:n[e]}}function Ue(e){return function(n){return null==e?t:e[n]}}function Pe(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function Ve(e,n){for(var r,i=-1,o=e.length;++i<o;){var a=n(e[i]);a!==t&&(r=r===t?a:r+a)}return r}function $e(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function We(t){return t?t.slice(0,ln(t)+1).replace(Q,""):t}function Ye(t){return function(e){return t(e)}}function Ge(t,e){return Oe(e,(function(e){return t[e]}))}function qe(t,e){return t.has(e)}function He(t,e){for(var n=-1,r=t.length;++n<r&&ze(e,t[n],0)>-1;);return n}function Xe(t,e){for(var n=t.length;n--&&ze(e,t[n],0)>-1;);return n}function Ze(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Je=Ue({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),Ke=Ue({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Qe(t){return"\\"+ne[t]}function tn(t){return Zt.test(t)}function en(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function nn(t,e){return function(n){return t(e(n))}}function rn(t,e){for(var n=-1,i=t.length,o=0,a=[];++n<i;){var s=t[n];s!==e&&s!==r||(t[n]=r,a[o++]=n)}return a}function on(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function an(t){return tn(t)?function(t){for(var e=Ht.lastIndex=0;Ht.test(t);)++e;return e}(t):Ee(t)}function sn(t){return tn(t)?function(t){return t.match(Ht)||[]}(t):function(t){return t.split("")}(t)}function ln(t){for(var e=t.length;e--&&tt.test(t.charAt(e)););return e}var un=Ue({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),cn=function tt(yt){var bt,gt=(yt=null==yt?se:cn.defaults(se.Object(),yt,cn.pick(se,Kt))).Array,vt=yt.Date,wt=yt.Error,xt=yt.Function,St=yt.Math,At=yt.Object,It=yt.RegExp,kt=yt.String,Ot=yt.TypeError,Tt=gt.prototype,Lt=xt.prototype,Mt=At.prototype,Bt=yt["__core-js_shared__"],Et=Lt.toString,Dt=Mt.hasOwnProperty,jt=0,zt=(bt=/[^.]+$/.exec(Bt&&Bt.keys&&Bt.keys.IE_PROTO||""))?"Symbol(src)_1."+bt:"",Ct=Mt.toString,Ft=Et.call(At),Nt=se._,Rt=It("^"+Et.call(Dt).replace(J,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=ce?yt.Buffer:t,Pt=yt.Symbol,Vt=yt.Uint8Array,$t=Ut?Ut.allocUnsafe:t,Wt=nn(At.getPrototypeOf,At),Yt=At.create,Ht=Mt.propertyIsEnumerable,Zt=Tt.splice,ne=Pt?Pt.isConcatSpreadable:t,oe=Pt?Pt.iterator:t,ae=Pt?Pt.toStringTag:t,le=function(){try{var t=lo(At,"defineProperty");return t({},"",{}),t}catch(t){}}(),ue=yt.clearTimeout!==se.clearTimeout&&yt.clearTimeout,fe=vt&&vt.now!==se.Date.now&&vt.now,de=yt.setTimeout!==se.setTimeout&&yt.setTimeout,Ee=St.ceil,Ue=St.floor,fn=At.getOwnPropertySymbols,dn=Ut?Ut.isBuffer:t,hn=yt.isFinite,pn=Tt.join,_n=nn(At.keys,At),mn=St.max,yn=St.min,bn=vt.now,gn=yt.parseInt,vn=St.random,wn=Tt.reverse,xn=lo(yt,"DataView"),Sn=lo(yt,"Map"),An=lo(yt,"Promise"),In=lo(yt,"Set"),kn=lo(yt,"WeakMap"),On=lo(At,"create"),Tn=kn&&new kn,Ln={},Mn=Ro(xn),Bn=Ro(Sn),En=Ro(An),Dn=Ro(In),jn=Ro(kn),zn=Pt?Pt.prototype:t,Cn=zn?zn.valueOf:t,Fn=zn?zn.toString:t;function Nn(t){if(ns(t)&&!Ya(t)&&!(t instanceof Vn)){if(t instanceof Pn)return t;if(Dt.call(t,"__wrapped__"))return Uo(t)}return new Pn(t)}var Rn=function(){function e(){}return function(n){if(!es(n))return{};if(Yt)return Yt(n);e.prototype=n;var r=new e;return e.prototype=t,r}}();function Un(){}function Pn(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}function Vn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=u,this.__views__=[]}function $n(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Wn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Yn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Gn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Yn;++e<n;)this.add(t[e])}function qn(t){var e=this.__data__=new Wn(t);this.size=e.size}function Hn(t,e){var n=Ya(t),r=!n&&Wa(t),i=!n&&!r&&Xa(t),o=!n&&!r&&!i&&cs(t),a=n||r||i||o,s=a?$e(t.length,kt):[],l=s.length;for(var u in t)!e&&!Dt.call(t,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||mo(u,l))||s.push(u);return s}function Xn(e){var n=e.length;return n?e[Yr(0,n-1)]:t}function Zn(t,e){return Do(ki(t),or(e,0,t.length))}function Jn(t){return Do(ki(t))}function Kn(e,n,r){(r!==t&&!Pa(e[n],r)||r===t&&!(n in e))&&rr(e,n,r)}function Qn(e,n,r){var i=e[n];Dt.call(e,n)&&Pa(i,r)&&(r!==t||n in e)||rr(e,n,r)}function tr(t,e){for(var n=t.length;n--;)if(Pa(t[n][0],e))return n;return-1}function er(t,e,n,r){return cr(t,(function(t,i,o){e(r,t,n(t),o)})),r}function nr(t,e){return t&&Oi(e,Es(e),t)}function rr(t,e,n){"__proto__"==e&&le?le(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ir(e,n){for(var r=-1,i=n.length,o=gt(i),a=null==e;++r<i;)o[r]=a?t:Os(e,n[r]);return o}function or(e,n,r){return e==e&&(r!==t&&(e=e<=r?e:r),n!==t&&(e=e>=n?e:n)),e}function ar(e,n,r,i,o,a){var s,l=1&n,u=2&n,c=4&n;if(r&&(s=o?r(e,i,o,a):r(e)),s!==t)return s;if(!es(e))return e;var d=Ya(e);if(d){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Dt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(e),!l)return ki(e,s)}else{var _=fo(e),w=_==m||_==y;if(Xa(e))return vi(e,l);if(_==v||_==f||w&&!o){if(s=u||w?{}:po(e),!l)return u?function(t,e){return Oi(t,co(t),e)}(e,function(t,e){return t&&Oi(e,Ds(e),t)}(s,e)):function(t,e){return Oi(t,uo(t),e)}(e,nr(s,e))}else{if(!ee[_])return o?e:{};s=function(t,e,n){var r,i=t.constructor;switch(e){case O:return wi(t);case h:case p:return new i(+t);case T:return function(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case L:case M:case B:case E:case D:case j:case z:case C:case F:return xi(t,n);case b:return new i;case g:case A:return new i(t);case x:return function(t){var e=new t.constructor(t.source,lt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case S:return new i;case I:return r=t,Cn?At(Cn.call(r)):{}}}(e,_,l)}}a||(a=new qn);var k=a.get(e);if(k)return k;a.set(e,s),ss(e)?e.forEach((function(t){s.add(ar(t,n,r,t,e,a))})):rs(e)&&e.forEach((function(t,i){s.set(i,ar(t,n,r,i,e,a))}));var N=d?t:(c?u?eo:to:u?Ds:Es)(e);return we(N||e,(function(t,i){N&&(t=e[i=t]),Qn(s,i,ar(t,n,r,i,e,a))})),s}function sr(e,n,r){var i=r.length;if(null==e)return!i;for(e=At(e);i--;){var o=r[i],a=n[o],s=e[o];if(s===t&&!(o in e)||!a(s))return!1}return!0}function lr(n,r,i){if("function"!=typeof n)throw new Ot(e);return Lo((function(){n.apply(t,i)}),r)}function ur(t,e,n,r){var i=-1,o=Ie,a=!0,s=t.length,l=[],u=e.length;if(!s)return l;n&&(e=Oe(e,Ye(n))),r?(o=ke,a=!1):e.length>=200&&(o=qe,a=!1,e=new Gn(e));t:for(;++i<s;){var c=t[i],f=null==n?c:n(c);if(c=r||0!==c?c:0,a&&f==f){for(var d=u;d--;)if(e[d]===f)continue t;l.push(c)}else o(e,f,r)||l.push(c)}return l}Nn.templateSettings={escape:Y,evaluate:G,interpolate:q,variable:"",imports:{_:Nn}},Nn.prototype=Un.prototype,Nn.prototype.constructor=Nn,Pn.prototype=Rn(Un.prototype),Pn.prototype.constructor=Pn,Vn.prototype=Rn(Un.prototype),Vn.prototype.constructor=Vn,$n.prototype.clear=function(){this.__data__=On?On(null):{},this.size=0},$n.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},$n.prototype.get=function(e){var r=this.__data__;if(On){var i=r[e];return i===n?t:i}return Dt.call(r,e)?r[e]:t},$n.prototype.has=function(e){var n=this.__data__;return On?n[e]!==t:Dt.call(n,e)},$n.prototype.set=function(e,r){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=On&&r===t?n:r,this},Wn.prototype.clear=function(){this.__data__=[],this.size=0},Wn.prototype.delete=function(t){var e=this.__data__,n=tr(e,t);return!(n<0||(n==e.length-1?e.pop():Zt.call(e,n,1),--this.size,0))},Wn.prototype.get=function(e){var n=this.__data__,r=tr(n,e);return r<0?t:n[r][1]},Wn.prototype.has=function(t){return tr(this.__data__,t)>-1},Wn.prototype.set=function(t,e){var n=this.__data__,r=tr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Yn.prototype.clear=function(){this.size=0,this.__data__={hash:new $n,map:new(Sn||Wn),string:new $n}},Yn.prototype.delete=function(t){var e=ao(this,t).delete(t);return this.size-=e?1:0,e},Yn.prototype.get=function(t){return ao(this,t).get(t)},Yn.prototype.has=function(t){return ao(this,t).has(t)},Yn.prototype.set=function(t,e){var n=ao(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Gn.prototype.add=Gn.prototype.push=function(t){return this.__data__.set(t,n),this},Gn.prototype.has=function(t){return this.__data__.has(t)},qn.prototype.clear=function(){this.__data__=new Wn,this.size=0},qn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},qn.prototype.get=function(t){return this.__data__.get(t)},qn.prototype.has=function(t){return this.__data__.has(t)},qn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Wn){var r=n.__data__;if(!Sn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Yn(r)}return n.set(t,e),this.size=n.size,this};var cr=Mi(br),fr=Mi(gr,!0);function dr(t,e){var n=!0;return cr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function hr(e,n,r){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=n(a);if(null!=s&&(l===t?s==s&&!us(s):r(s,l)))var l=s,u=a}return u}function pr(t,e){var n=[];return cr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function _r(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=_o),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?_r(s,e-1,n,r,i):Te(i,s):r||(i[i.length]=s)}return i}var mr=Bi(),yr=Bi(!0);function br(t,e){return t&&mr(t,e,Es)}function gr(t,e){return t&&yr(t,e,Es)}function vr(t,e){return Ae(e,(function(e){return Ka(t[e])}))}function wr(e,n){for(var r=0,i=(n=mi(n,e)).length;null!=e&&r<i;)e=e[No(n[r++])];return r&&r==i?e:t}function xr(t,e,n){var r=e(t);return Ya(t)?r:Te(r,n(t))}function Sr(e){return null==e?e===t?"[object Undefined]":"[object Null]":ae&&ae in At(e)?function(e){var n=Dt.call(e,ae),r=e[ae];try{e[ae]=t;var i=!0}catch(t){}var o=Ct.call(e);return i&&(n?e[ae]=r:delete e[ae]),o}(e):function(t){return Ct.call(t)}(e)}function Ar(t,e){return t>e}function Ir(t,e){return null!=t&&Dt.call(t,e)}function kr(t,e){return null!=t&&e in At(t)}function Or(e,n,r){for(var i=r?ke:Ie,o=e[0].length,a=e.length,s=a,l=gt(a),u=1/0,c=[];s--;){var f=e[s];s&&n&&(f=Oe(f,Ye(n))),u=yn(f.length,u),l[s]=!r&&(n||o>=120&&f.length>=120)?new Gn(s&&f):t}f=e[0];var d=-1,h=l[0];t:for(;++d<o&&c.length<u;){var p=f[d],_=n?n(p):p;if(p=r||0!==p?p:0,!(h?qe(h,_):i(c,_,r))){for(s=a;--s;){var m=l[s];if(!(m?qe(m,_):i(e[s],_,r)))continue t}h&&h.push(_),c.push(p)}}return c}function Tr(e,n,r){var i=null==(e=Io(e,n=mi(n,e)))?e:e[No(Jo(n))];return null==i?t:ge(i,e,r)}function Lr(t){return ns(t)&&Sr(t)==f}function Mr(e,n,r,i,o){return e===n||(null==e||null==n||!ns(e)&&!ns(n)?e!=e&&n!=n:function(e,n,r,i,o,a){var s=Ya(e),l=Ya(n),u=s?d:fo(e),c=l?d:fo(n),m=(u=u==f?v:u)==v,y=(c=c==f?v:c)==v,w=u==c;if(w&&Xa(e)){if(!Xa(n))return!1;s=!0,m=!1}if(w&&!m)return a||(a=new qn),s||cs(e)?Ki(e,n,r,i,o,a):function(t,e,n,r,i,o,a){switch(n){case T:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!o(new Vt(t),new Vt(e)));case h:case p:case g:return Pa(+t,+e);case _:return t.name==e.name&&t.message==e.message;case x:case A:return t==e+"";case b:var s=en;case S:var l=1&r;if(s||(s=on),t.size!=e.size&&!l)return!1;var u=a.get(t);if(u)return u==e;r|=2,a.set(t,e);var c=Ki(s(t),s(e),r,i,o,a);return a.delete(t),c;case I:if(Cn)return Cn.call(t)==Cn.call(e)}return!1}(e,n,u,r,i,o,a);if(!(1&r)){var k=m&&Dt.call(e,"__wrapped__"),L=y&&Dt.call(n,"__wrapped__");if(k||L){var M=k?e.value():e,B=L?n.value():n;return a||(a=new qn),o(M,B,r,i,a)}}return!!w&&(a||(a=new qn),function(e,n,r,i,o,a){var s=1&r,l=to(e),u=l.length;if(u!=to(n).length&&!s)return!1;for(var c=u;c--;){var f=l[c];if(!(s?f in n:Dt.call(n,f)))return!1}var d=a.get(e),h=a.get(n);if(d&&h)return d==n&&h==e;var p=!0;a.set(e,n),a.set(n,e);for(var _=s;++c<u;){var m=e[f=l[c]],y=n[f];if(i)var b=s?i(y,m,f,n,e,a):i(m,y,f,e,n,a);if(!(b===t?m===y||o(m,y,r,i,a):b)){p=!1;break}_||(_="constructor"==f)}if(p&&!_){var g=e.constructor,v=n.constructor;g==v||!("constructor"in e)||!("constructor"in n)||"function"==typeof g&&g instanceof g&&"function"==typeof v&&v instanceof v||(p=!1)}return a.delete(e),a.delete(n),p}(e,n,r,i,o,a))}(e,n,r,i,Mr,o))}function Br(e,n,r,i){var o=r.length,a=o,s=!i;if(null==e)return!a;for(e=At(e);o--;){var l=r[o];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<a;){var u=(l=r[o])[0],c=e[u],f=l[1];if(s&&l[2]){if(c===t&&!(u in e))return!1}else{var d=new qn;if(i)var h=i(c,f,u,e,n,d);if(!(h===t?Mr(f,c,3,i,d):h))return!1}}return!0}function Er(t){return!(!es(t)||(e=t,zt&&zt in e))&&(Ka(t)?Rt:ft).test(Ro(t));var e}function Dr(t){return"function"==typeof t?t:null==t?il:"object"==typeof t?Ya(t)?Nr(t[0],t[1]):Fr(t):hl(t)}function jr(t){if(!wo(t))return _n(t);var e=[];for(var n in At(t))Dt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function zr(t,e){return t<e}function Cr(t,e){var n=-1,r=qa(t)?gt(t.length):[];return cr(t,(function(t,i,o){r[++n]=e(t,i,o)})),r}function Fr(t){var e=so(t);return 1==e.length&&e[0][2]?So(e[0][0],e[0][1]):function(n){return n===t||Br(n,t,e)}}function Nr(e,n){return bo(e)&&xo(n)?So(No(e),n):function(r){var i=Os(r,e);return i===t&&i===n?Ts(r,e):Mr(n,i,3)}}function Rr(e,n,r,i,o){e!==n&&mr(n,(function(a,s){if(o||(o=new qn),es(a))!function(e,n,r,i,o,a,s){var l=Oo(e,r),u=Oo(n,r),c=s.get(u);if(c)Kn(e,r,c);else{var f=a?a(l,u,r+"",e,n,s):t,d=f===t;if(d){var h=Ya(u),p=!h&&Xa(u),_=!h&&!p&&cs(u);f=u,h||p||_?Ya(l)?f=l:Ha(l)?f=ki(l):p?(d=!1,f=vi(u,!0)):_?(d=!1,f=xi(u,!0)):f=[]:os(u)||Wa(u)?(f=l,Wa(l)?f=bs(l):es(l)&&!Ka(l)||(f=po(u))):d=!1}d&&(s.set(u,f),o(f,u,i,a,s),s.delete(u)),Kn(e,r,f)}}(e,n,s,r,Rr,i,o);else{var l=i?i(Oo(e,s),a,s+"",e,n,o):t;l===t&&(l=a),Kn(e,s,l)}}),Ds)}function Ur(e,n){var r=e.length;if(r)return mo(n+=n<0?r:0,r)?e[n]:t}function Pr(t,e,n){e=e.length?Oe(e,(function(t){return Ya(t)?function(e){return wr(e,1===t.length?t[0]:t)}:t})):[il];var r=-1;return e=Oe(e,Ye(oo())),function(t,e){var r=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;++r<a;){var l=Si(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}));r--;)t[r]=t[r].value;return t}(Cr(t,(function(t,n,i){return{criteria:Oe(e,(function(e){return e(t)})),index:++r,value:t}})))}function Vr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=wr(t,a);n(s,a)&&Zr(o,mi(a,t),s)}return o}function $r(t,e,n,r){var i=r?Ce:ze,o=-1,a=e.length,s=t;for(t===e&&(e=ki(e)),n&&(s=Oe(t,Ye(n)));++o<a;)for(var l=0,u=e[o],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==t&&Zt.call(s,l,1),Zt.call(t,l,1);return t}function Wr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;mo(i)?Zt.call(t,i,1):li(t,i)}}return t}function Yr(t,e){return t+Ue(vn()*(e-t+1))}function Gr(t,e){var n="";if(!t||e<1||e>s)return n;do{e%2&&(n+=t),(e=Ue(e/2))&&(t+=t)}while(e);return n}function qr(t,e){return Mo(Ao(t,e,il),t+"")}function Hr(t){return Xn(Ps(t))}function Xr(t,e){var n=Ps(t);return Do(n,or(e,0,n.length))}function Zr(e,n,r,i){if(!es(e))return e;for(var o=-1,a=(n=mi(n,e)).length,s=a-1,l=e;null!=l&&++o<a;){var u=No(n[o]),c=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=s){var f=l[u];(c=i?i(f,u,l):t)===t&&(c=es(f)?f:mo(n[o+1])?[]:{})}Qn(l,u,c),l=l[u]}return e}var Jr=Tn?function(t,e){return Tn.set(t,e),t}:il,Kr=le?function(t,e){return le(t,"toString",{configurable:!0,enumerable:!1,value:el(e),writable:!0})}:il;function Qr(t){return Do(Ps(t))}function ti(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=gt(i);++r<i;)o[r]=t[r+e];return o}function ei(t,e){var n;return cr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function ni(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!us(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return ri(t,e,il,n)}function ri(e,n,r,i){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(n=r(n))!=n,l=null===n,u=us(n),c=n===t;o<a;){var f=Ue((o+a)/2),d=r(e[f]),h=d!==t,p=null===d,_=d==d,m=us(d);if(s)var y=i||_;else y=c?_&&(i||h):l?_&&h&&(i||!p):u?_&&h&&!p&&(i||!m):!p&&!m&&(i?d<=n:d<n);y?o=f+1:a=f}return yn(a,4294967294)}function ii(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Pa(s,l)){var l=s;o[i++]=0===a?0:a}}return o}function oi(t){return"number"==typeof t?t:us(t)?l:+t}function ai(t){if("string"==typeof t)return t;if(Ya(t))return Oe(t,ai)+"";if(us(t))return Fn?Fn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function si(t,e,n){var r=-1,i=Ie,o=t.length,a=!0,s=[],l=s;if(n)a=!1,i=ke;else if(o>=200){var u=e?null:Gi(t);if(u)return on(u);a=!1,i=qe,l=new Gn}else l=e?[]:s;t:for(;++r<o;){var c=t[r],f=e?e(c):c;if(c=n||0!==c?c:0,a&&f==f){for(var d=l.length;d--;)if(l[d]===f)continue t;e&&l.push(f),s.push(c)}else i(l,f,n)||(l!==s&&l.push(f),s.push(c))}return s}function li(t,e){return null==(t=Io(t,e=mi(e,t)))||delete t[No(Jo(e))]}function ui(t,e,n,r){return Zr(t,e,n(wr(t,e)),r)}function ci(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ti(t,r?0:o,r?o+1:i):ti(t,r?o+1:0,r?i:o)}function fi(t,e){var n=t;return n instanceof Vn&&(n=n.value()),Le(e,(function(t,e){return e.func.apply(e.thisArg,Te([t],e.args))}),n)}function di(t,e,n){var r=t.length;if(r<2)return r?si(t[0]):[];for(var i=-1,o=gt(r);++i<r;)for(var a=t[i],s=-1;++s<r;)s!=i&&(o[i]=ur(o[i]||a,t[s],e,n));return si(_r(o,1),e,n)}function hi(e,n,r){for(var i=-1,o=e.length,a=n.length,s={};++i<o;){var l=i<a?n[i]:t;r(s,e[i],l)}return s}function pi(t){return Ha(t)?t:[]}function _i(t){return"function"==typeof t?t:il}function mi(t,e){return Ya(t)?t:bo(t,e)?[t]:Fo(gs(t))}var yi=qr;function bi(e,n,r){var i=e.length;return r=r===t?i:r,!n&&r>=i?e:ti(e,n,r)}var gi=ue||function(t){return se.clearTimeout(t)};function vi(t,e){if(e)return t.slice();var n=t.length,r=$t?$t(n):new t.constructor(n);return t.copy(r),r}function wi(t){var e=new t.constructor(t.byteLength);return new Vt(e).set(new Vt(t)),e}function xi(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Si(e,n){if(e!==n){var r=e!==t,i=null===e,o=e==e,a=us(e),s=n!==t,l=null===n,u=n==n,c=us(n);if(!l&&!c&&!a&&e>n||a&&s&&u&&!l&&!c||i&&s&&u||!r&&u||!o)return 1;if(!i&&!a&&!c&&e<n||c&&r&&o&&!i&&!a||l&&r&&o||!s&&o||!u)return-1}return 0}function Ai(t,e,n,r){for(var i=-1,o=t.length,a=n.length,s=-1,l=e.length,u=mn(o-a,0),c=gt(l+u),f=!r;++s<l;)c[s]=e[s];for(;++i<a;)(f||i<o)&&(c[n[i]]=t[i]);for(;u--;)c[s++]=t[i++];return c}function Ii(t,e,n,r){for(var i=-1,o=t.length,a=-1,s=n.length,l=-1,u=e.length,c=mn(o-s,0),f=gt(c+u),d=!r;++i<c;)f[i]=t[i];for(var h=i;++l<u;)f[h+l]=e[l];for(;++a<s;)(d||i<o)&&(f[h+n[a]]=t[i++]);return f}function ki(t,e){var n=-1,r=t.length;for(e||(e=gt(r));++n<r;)e[n]=t[n];return e}function Oi(e,n,r,i){var o=!r;r||(r={});for(var a=-1,s=n.length;++a<s;){var l=n[a],u=i?i(r[l],e[l],l,r,e):t;u===t&&(u=e[l]),o?rr(r,l,u):Qn(r,l,u)}return r}function Ti(t,e){return function(n,r){var i=Ya(n)?ve:er,o=e?e():{};return i(n,t,oo(r,2),o)}}function Li(e){return qr((function(n,r){var i=-1,o=r.length,a=o>1?r[o-1]:t,s=o>2?r[2]:t;for(a=e.length>3&&"function"==typeof a?(o--,a):t,s&&yo(r[0],r[1],s)&&(a=o<3?t:a,o=1),n=At(n);++i<o;){var l=r[i];l&&e(n,l,i,a)}return n}))}function Mi(t,e){return function(n,r){if(null==n)return n;if(!qa(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=At(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Bi(t){return function(e,n,r){for(var i=-1,o=At(e),a=r(e),s=a.length;s--;){var l=a[t?s:++i];if(!1===n(o[l],l,o))break}return e}}function Ei(e){return function(n){var r=tn(n=gs(n))?sn(n):t,i=r?r[0]:n.charAt(0),o=r?bi(r,1).join(""):n.slice(1);return i[e]()+o}}function Di(t){return function(e){return Le(Ks(Ws(e).replace(Gt,"")),t,"")}}function ji(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Rn(t.prototype),r=t.apply(n,e);return es(r)?r:n}}function zi(e){return function(n,r,i){var o=At(n);if(!qa(n)){var a=oo(r,3);n=Es(n),r=function(t){return a(o[t],t,o)}}var s=e(n,r,i);return s>-1?o[a?n[s]:s]:t}}function Ci(n){return Qi((function(r){var i=r.length,o=i,a=Pn.prototype.thru;for(n&&r.reverse();o--;){var s=r[o];if("function"!=typeof s)throw new Ot(e);if(a&&!l&&"wrapper"==ro(s))var l=new Pn([],!0)}for(o=l?o:i;++o<i;){var u=ro(s=r[o]),c="wrapper"==u?no(s):t;l=c&&go(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?l[ro(c[0])].apply(l,c[3]):1==s.length&&go(s)?l[u]():l.thru(s)}return function(){var t=arguments,e=t[0];if(l&&1==t.length&&Ya(e))return l.plant(e).value();for(var n=0,o=i?r[n].apply(this,t):e;++n<i;)o=r[n].call(this,o);return o}}))}function Fi(e,n,r,i,a,s,l,u,c,f){var d=n&o,h=1&n,p=2&n,_=24&n,m=512&n,y=p?t:ji(e);return function t(){for(var o=arguments.length,b=gt(o),g=o;g--;)b[g]=arguments[g];if(_)var v=io(t),w=Ze(b,v);if(i&&(b=Ai(b,i,a,_)),s&&(b=Ii(b,s,l,_)),o-=w,_&&o<f){var x=rn(b,v);return Wi(e,n,Fi,t.placeholder,r,b,x,u,c,f-o)}var S=h?r:this,A=p?S[e]:e;return o=b.length,u?b=ko(b,u):m&&o>1&&b.reverse(),d&&c<o&&(b.length=c),this&&this!==se&&this instanceof t&&(A=y||ji(A)),A.apply(S,b)}}function Ni(t,e){return function(n,r){return function(t,e,n,r){return br(t,(function(t,i,o){e(r,n(t),i,o)})),r}(n,t,e(r),{})}}function Ri(e,n){return function(r,i){var o;if(r===t&&i===t)return n;if(r!==t&&(o=r),i!==t){if(o===t)return i;"string"==typeof r||"string"==typeof i?(r=ai(r),i=ai(i)):(r=oi(r),i=oi(i)),o=e(r,i)}return o}}function Ui(t){return Qi((function(e){return e=Oe(e,Ye(oo())),qr((function(n){var r=this;return t(e,(function(t){return ge(t,r,n)}))}))}))}function Pi(e,n){var r=(n=n===t?" ":ai(n)).length;if(r<2)return r?Gr(n,e):n;var i=Gr(n,Ee(e/an(n)));return tn(n)?bi(sn(i),0,e).join(""):i.slice(0,e)}function Vi(e){return function(n,r,i){return i&&"number"!=typeof i&&yo(n,r,i)&&(r=i=t),n=ps(n),r===t?(r=n,n=0):r=ps(r),function(t,e,n,r){for(var i=-1,o=mn(Ee((e-t)/(n||1)),0),a=gt(o);o--;)a[r?o:++i]=t,t+=n;return a}(n,r,i=i===t?n<r?1:-1:ps(i),e)}}function $i(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ys(e),n=ys(n)),t(e,n)}}function Wi(e,n,r,o,a,s,l,u,c,f){var d=8&n;n|=d?i:64,4&(n&=~(d?64:i))||(n&=-4);var h=[e,n,a,d?s:t,d?l:t,d?t:s,d?t:l,u,c,f],p=r.apply(t,h);return go(e)&&To(p,h),p.placeholder=o,Bo(p,e,n)}function Yi(t){var e=St[t];return function(t,n){if(t=ys(t),(n=null==n?0:yn(_s(n),292))&&hn(t)){var r=(gs(t)+"e").split("e");return+((r=(gs(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Gi=In&&1/on(new In([,-0]))[1]==a?function(t){return new In(t)}:ul;function qi(t){return function(e){var n,r,i,o=fo(e);return o==b?en(e):o==S?(n=e,r=-1,i=Array(n.size),n.forEach((function(t){i[++r]=[t,t]})),i):function(t,e){return Oe(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Hi(n,a,s,l,u,c,f,d){var h=2&a;if(!h&&"function"!=typeof n)throw new Ot(e);var p=l?l.length:0;if(p||(a&=-97,l=u=t),f=f===t?f:mn(_s(f),0),d=d===t?d:_s(d),p-=u?u.length:0,64&a){var _=l,m=u;l=u=t}var y=h?t:no(n),b=[n,a,s,l,u,_,m,c,f,d];if(y&&function(t,e){var n=t[1],i=e[1],a=n|i,s=a<131,l=i==o&&8==n||i==o&&256==n&&t[7].length<=e[8]||384==i&&e[7].length<=e[8]&&8==n;if(!s&&!l)return t;1&i&&(t[2]=e[2],a|=1&n?0:4);var u=e[3];if(u){var c=t[3];t[3]=c?Ai(c,u,e[4]):u,t[4]=c?rn(t[3],r):e[4]}(u=e[5])&&(c=t[5],t[5]=c?Ii(c,u,e[6]):u,t[6]=c?rn(t[5],r):e[6]),(u=e[7])&&(t[7]=u),i&o&&(t[8]=null==t[8]?e[8]:yn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=a}(b,y),n=b[0],a=b[1],s=b[2],l=b[3],u=b[4],!(d=b[9]=b[9]===t?h?0:n.length:mn(b[9]-p,0))&&24&a&&(a&=-25),a&&1!=a)g=8==a||16==a?function(e,n,r){var i=ji(e);return function o(){for(var a=arguments.length,s=gt(a),l=a,u=io(o);l--;)s[l]=arguments[l];var c=a<3&&s[0]!==u&&s[a-1]!==u?[]:rn(s,u);return(a-=c.length)<r?Wi(e,n,Fi,o.placeholder,t,s,c,t,t,r-a):ge(this&&this!==se&&this instanceof o?i:e,this,s)}}(n,a,d):a!=i&&33!=a||u.length?Fi.apply(t,b):function(t,e,n,r){var i=1&e,o=ji(t);return function e(){for(var a=-1,s=arguments.length,l=-1,u=r.length,c=gt(u+s),f=this&&this!==se&&this instanceof e?o:t;++l<u;)c[l]=r[l];for(;s--;)c[l++]=arguments[++a];return ge(f,i?n:this,c)}}(n,a,s,l);else var g=function(t,e,n){var r=1&e,i=ji(t);return function e(){return(this&&this!==se&&this instanceof e?i:t).apply(r?n:this,arguments)}}(n,a,s);return Bo((y?Jr:To)(g,b),n,a)}function Xi(e,n,r,i){return e===t||Pa(e,Mt[r])&&!Dt.call(i,r)?n:e}function Zi(e,n,r,i,o,a){return es(e)&&es(n)&&(a.set(n,e),Rr(e,n,t,Zi,a),a.delete(n)),e}function Ji(e){return os(e)?t:e}function Ki(e,n,r,i,o,a){var s=1&r,l=e.length,u=n.length;if(l!=u&&!(s&&u>l))return!1;var c=a.get(e),f=a.get(n);if(c&&f)return c==n&&f==e;var d=-1,h=!0,p=2&r?new Gn:t;for(a.set(e,n),a.set(n,e);++d<l;){var _=e[d],m=n[d];if(i)var y=s?i(m,_,d,n,e,a):i(_,m,d,e,n,a);if(y!==t){if(y)continue;h=!1;break}if(p){if(!Be(n,(function(t,e){if(!qe(p,e)&&(_===t||o(_,t,r,i,a)))return p.push(e)}))){h=!1;break}}else if(_!==m&&!o(_,m,r,i,a)){h=!1;break}}return a.delete(e),a.delete(n),h}function Qi(e){return Mo(Ao(e,t,Go),e+"")}function to(t){return xr(t,Es,uo)}function eo(t){return xr(t,Ds,co)}var no=Tn?function(t){return Tn.get(t)}:ul;function ro(t){for(var e=t.name+"",n=Ln[e],r=Dt.call(Ln,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function io(t){return(Dt.call(Nn,"placeholder")?Nn:t).placeholder}function oo(){var t=Nn.iteratee||ol;return t=t===ol?Dr:t,arguments.length?t(arguments[0],arguments[1]):t}function ao(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function so(t){for(var e=Es(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,xo(i)]}return e}function lo(e,n){var r=function(e,n){return null==e?t:e[n]}(e,n);return Er(r)?r:t}var uo=fn?function(t){return null==t?[]:(t=At(t),Ae(fn(t),(function(e){return Ht.call(t,e)})))}:ml,co=fn?function(t){for(var e=[];t;)Te(e,uo(t)),t=Wt(t);return e}:ml,fo=Sr;function ho(t,e,n){for(var r=-1,i=(e=mi(e,t)).length,o=!1;++r<i;){var a=No(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&ts(i)&&mo(a,i)&&(Ya(t)||Wa(t))}function po(t){return"function"!=typeof t.constructor||wo(t)?{}:Rn(Wt(t))}function _o(t){return Ya(t)||Wa(t)||!!(ne&&t&&t[ne])}function mo(t,e){var n=typeof t;return!!(e=null==e?s:e)&&("number"==n||"symbol"!=n&&ht.test(t))&&t>-1&&t%1==0&&t<e}function yo(t,e,n){if(!es(n))return!1;var r=typeof e;return!!("number"==r?qa(n)&&mo(e,n.length):"string"==r&&e in n)&&Pa(n[e],t)}function bo(t,e){if(Ya(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!us(t))||X.test(t)||!H.test(t)||null!=e&&t in At(e)}function go(t){var e=ro(t),n=Nn[e];if("function"!=typeof n||!(e in Vn.prototype))return!1;if(t===n)return!0;var r=no(n);return!!r&&t===r[0]}(xn&&fo(new xn(new ArrayBuffer(1)))!=T||Sn&&fo(new Sn)!=b||An&&fo(An.resolve())!=w||In&&fo(new In)!=S||kn&&fo(new kn)!=k)&&(fo=function(e){var n=Sr(e),r=n==v?e.constructor:t,i=r?Ro(r):"";if(i)switch(i){case Mn:return T;case Bn:return b;case En:return w;case Dn:return S;case jn:return k}return n});var vo=Bt?Ka:yl;function wo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Mt)}function xo(t){return t==t&&!es(t)}function So(e,n){return function(r){return null!=r&&r[e]===n&&(n!==t||e in At(r))}}function Ao(e,n,r){return n=mn(n===t?e.length-1:n,0),function(){for(var t=arguments,i=-1,o=mn(t.length-n,0),a=gt(o);++i<o;)a[i]=t[n+i];i=-1;for(var s=gt(n+1);++i<n;)s[i]=t[i];return s[n]=r(a),ge(e,this,s)}}function Io(t,e){return e.length<2?t:wr(t,ti(e,0,-1))}function ko(e,n){for(var r=e.length,i=yn(n.length,r),o=ki(e);i--;){var a=n[i];e[i]=mo(a,r)?o[a]:t}return e}function Oo(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var To=Eo(Jr),Lo=de||function(t,e){return se.setTimeout(t,e)},Mo=Eo(Kr);function Bo(t,e,n){var r=e+"";return Mo(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(et,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return we(c,(function(n){var r="_."+n[0];e&n[1]&&!Ie(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(nt);return e?e[1].split(rt):[]}(r),n)))}function Eo(e){var n=0,r=0;return function(){var i=bn(),o=16-(i-r);if(r=i,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(t,arguments)}}function Do(e,n){var r=-1,i=e.length,o=i-1;for(n=n===t?i:n;++r<n;){var a=Yr(r,o),s=e[a];e[a]=e[r],e[r]=s}return e.length=n,e}var jo,zo,Co,Fo=(jo=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Z,(function(t,n,r,i){e.push(r?i.replace(at,"$1"):n||t)})),e},zo=za(jo,(function(t){return 500===Co.size&&Co.clear(),t})),Co=zo.cache,zo);function No(t){if("string"==typeof t||us(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ro(t){if(null!=t){try{return Et.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Uo(t){if(t instanceof Vn)return t.clone();var e=new Pn(t.__wrapped__,t.__chain__);return e.__actions__=ki(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Po=qr((function(t,e){return Ha(t)?ur(t,_r(e,1,Ha,!0)):[]})),Vo=qr((function(e,n){var r=Jo(n);return Ha(r)&&(r=t),Ha(e)?ur(e,_r(n,1,Ha,!0),oo(r,2)):[]})),$o=qr((function(e,n){var r=Jo(n);return Ha(r)&&(r=t),Ha(e)?ur(e,_r(n,1,Ha,!0),t,r):[]}));function Wo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:_s(n);return i<0&&(i=mn(r+i,0)),je(t,oo(e,3),i)}function Yo(e,n,r){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return r!==t&&(o=_s(r),o=r<0?mn(i+o,0):yn(o,i-1)),je(e,oo(n,3),o,!0)}function Go(t){return null!=t&&t.length?_r(t,1):[]}function qo(e){return e&&e.length?e[0]:t}var Ho=qr((function(t){var e=Oe(t,pi);return e.length&&e[0]===t[0]?Or(e):[]})),Xo=qr((function(e){var n=Jo(e),r=Oe(e,pi);return n===Jo(r)?n=t:r.pop(),r.length&&r[0]===e[0]?Or(r,oo(n,2)):[]})),Zo=qr((function(e){var n=Jo(e),r=Oe(e,pi);return(n="function"==typeof n?n:t)&&r.pop(),r.length&&r[0]===e[0]?Or(r,t,n):[]}));function Jo(e){var n=null==e?0:e.length;return n?e[n-1]:t}var Ko=qr(Qo);function Qo(t,e){return t&&t.length&&e&&e.length?$r(t,e):t}var ta=Qi((function(t,e){var n=null==t?0:t.length,r=ir(t,e);return Wr(t,Oe(e,(function(t){return mo(t,n)?+t:t})).sort(Si)),r}));function ea(t){return null==t?t:wn.call(t)}var na=qr((function(t){return si(_r(t,1,Ha,!0))})),ra=qr((function(e){var n=Jo(e);return Ha(n)&&(n=t),si(_r(e,1,Ha,!0),oo(n,2))})),ia=qr((function(e){var n=Jo(e);return n="function"==typeof n?n:t,si(_r(e,1,Ha,!0),t,n)}));function oa(t){if(!t||!t.length)return[];var e=0;return t=Ae(t,(function(t){if(Ha(t))return e=mn(t.length,e),!0})),$e(e,(function(e){return Oe(t,Re(e))}))}function aa(e,n){if(!e||!e.length)return[];var r=oa(e);return null==n?r:Oe(r,(function(e){return ge(n,t,e)}))}var sa=qr((function(t,e){return Ha(t)?ur(t,e):[]})),la=qr((function(t){return di(Ae(t,Ha))})),ua=qr((function(e){var n=Jo(e);return Ha(n)&&(n=t),di(Ae(e,Ha),oo(n,2))})),ca=qr((function(e){var n=Jo(e);return n="function"==typeof n?n:t,di(Ae(e,Ha),t,n)})),fa=qr(oa),da=qr((function(e){var n=e.length,r=n>1?e[n-1]:t;return r="function"==typeof r?(e.pop(),r):t,aa(e,r)}));function ha(t){var e=Nn(t);return e.__chain__=!0,e}function pa(t,e){return e(t)}var _a=Qi((function(e){var n=e.length,r=n?e[0]:0,i=this.__wrapped__,o=function(t){return ir(t,e)};return!(n>1||this.__actions__.length)&&i instanceof Vn&&mo(r)?((i=i.slice(r,+r+(n?1:0))).__actions__.push({func:pa,args:[o],thisArg:t}),new Pn(i,this.__chain__).thru((function(e){return n&&!e.length&&e.push(t),e}))):this.thru(o)})),ma=Ti((function(t,e,n){Dt.call(t,n)?++t[n]:rr(t,n,1)})),ya=zi(Wo),ba=zi(Yo);function ga(t,e){return(Ya(t)?we:cr)(t,oo(e,3))}function va(t,e){return(Ya(t)?xe:fr)(t,oo(e,3))}var wa=Ti((function(t,e,n){Dt.call(t,n)?t[n].push(e):rr(t,n,[e])})),xa=qr((function(t,e,n){var r=-1,i="function"==typeof e,o=qa(t)?gt(t.length):[];return cr(t,(function(t){o[++r]=i?ge(e,t,n):Tr(t,e,n)})),o})),Sa=Ti((function(t,e,n){rr(t,n,e)}));function Aa(t,e){return(Ya(t)?Oe:Cr)(t,oo(e,3))}var Ia=Ti((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),ka=qr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&yo(t,e[0],e[1])?e=[]:n>2&&yo(e[0],e[1],e[2])&&(e=[e[0]]),Pr(t,_r(e,1),[])})),Oa=fe||function(){return se.Date.now()};function Ta(e,n,r){return n=r?t:n,n=e&&null==n?e.length:n,Hi(e,o,t,t,t,t,n)}function La(n,r){var i;if("function"!=typeof r)throw new Ot(e);return n=_s(n),function(){return--n>0&&(i=r.apply(this,arguments)),n<=1&&(r=t),i}}var Ma=qr((function(t,e,n){var r=1;if(n.length){var o=rn(n,io(Ma));r|=i}return Hi(t,r,e,n,o)})),Ba=qr((function(t,e,n){var r=3;if(n.length){var o=rn(n,io(Ba));r|=i}return Hi(e,r,t,n,o)}));function Ea(n,r,i){var o,a,s,l,u,c,f=0,d=!1,h=!1,p=!0;if("function"!=typeof n)throw new Ot(e);function _(e){var r=o,i=a;return o=a=t,f=e,l=n.apply(i,r)}function m(t){return f=t,u=Lo(b,r),d?_(t):l}function y(e){var n=e-c;return c===t||n>=r||n<0||h&&e-f>=s}function b(){var t=Oa();if(y(t))return g(t);u=Lo(b,function(t){var e=r-(t-c);return h?yn(e,s-(t-f)):e}(t))}function g(e){return u=t,p&&o?_(e):(o=a=t,l)}function v(){var e=Oa(),n=y(e);if(o=arguments,a=this,c=e,n){if(u===t)return m(c);if(h)return gi(u),u=Lo(b,r),_(c)}return u===t&&(u=Lo(b,r)),l}return r=ys(r)||0,es(i)&&(d=!!i.leading,s=(h="maxWait"in i)?mn(ys(i.maxWait)||0,r):s,p="trailing"in i?!!i.trailing:p),v.cancel=function(){u!==t&&gi(u),f=0,o=c=a=u=t},v.flush=function(){return u===t?l:g(Oa())},v}var Da=qr((function(t,e){return lr(t,1,e)})),ja=qr((function(t,e,n){return lr(t,ys(e)||0,n)}));function za(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new Ot(e);var r=function(){var e=arguments,i=n?n.apply(this,e):e[0],o=r.cache;if(o.has(i))return o.get(i);var a=t.apply(this,e);return r.cache=o.set(i,a)||o,a};return r.cache=new(za.Cache||Yn),r}function Ca(t){if("function"!=typeof t)throw new Ot(e);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}za.Cache=Yn;var Fa=yi((function(t,e){var n=(e=1==e.length&&Ya(e[0])?Oe(e[0],Ye(oo())):Oe(_r(e,1),Ye(oo()))).length;return qr((function(r){for(var i=-1,o=yn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return ge(t,this,r)}))})),Na=qr((function(e,n){var r=rn(n,io(Na));return Hi(e,i,t,n,r)})),Ra=qr((function(e,n){var r=rn(n,io(Ra));return Hi(e,64,t,n,r)})),Ua=Qi((function(e,n){return Hi(e,256,t,t,t,n)}));function Pa(t,e){return t===e||t!=t&&e!=e}var Va=$i(Ar),$a=$i((function(t,e){return t>=e})),Wa=Lr(function(){return arguments}())?Lr:function(t){return ns(t)&&Dt.call(t,"callee")&&!Ht.call(t,"callee")},Ya=gt.isArray,Ga=he?Ye(he):function(t){return ns(t)&&Sr(t)==O};function qa(t){return null!=t&&ts(t.length)&&!Ka(t)}function Ha(t){return ns(t)&&qa(t)}var Xa=dn||yl,Za=pe?Ye(pe):function(t){return ns(t)&&Sr(t)==p};function Ja(t){if(!ns(t))return!1;var e=Sr(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!os(t)}function Ka(t){if(!es(t))return!1;var e=Sr(t);return e==m||e==y||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qa(t){return"number"==typeof t&&t==_s(t)}function ts(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=s}function es(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ns(t){return null!=t&&"object"==typeof t}var rs=_e?Ye(_e):function(t){return ns(t)&&fo(t)==b};function is(t){return"number"==typeof t||ns(t)&&Sr(t)==g}function os(t){if(!ns(t)||Sr(t)!=v)return!1;var e=Wt(t);if(null===e)return!0;var n=Dt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Et.call(n)==Ft}var as=me?Ye(me):function(t){return ns(t)&&Sr(t)==x},ss=ye?Ye(ye):function(t){return ns(t)&&fo(t)==S};function ls(t){return"string"==typeof t||!Ya(t)&&ns(t)&&Sr(t)==A}function us(t){return"symbol"==typeof t||ns(t)&&Sr(t)==I}var cs=be?Ye(be):function(t){return ns(t)&&ts(t.length)&&!!te[Sr(t)]},fs=$i(zr),ds=$i((function(t,e){return t<=e}));function hs(t){if(!t)return[];if(qa(t))return ls(t)?sn(t):ki(t);if(oe&&t[oe])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[oe]());var e=fo(t);return(e==b?en:e==S?on:Ps)(t)}function ps(t){return t?(t=ys(t))===a||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function _s(t){var e=ps(t),n=e%1;return e==e?n?e-n:e:0}function ms(t){return t?or(_s(t),0,u):0}function ys(t){if("number"==typeof t)return t;if(us(t))return l;if(es(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=es(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=We(t);var n=ct.test(t);return n||dt.test(t)?ie(t.slice(2),n?2:8):ut.test(t)?l:+t}function bs(t){return Oi(t,Ds(t))}function gs(t){return null==t?"":ai(t)}var vs=Li((function(t,e){if(wo(e)||qa(e))Oi(e,Es(e),t);else for(var n in e)Dt.call(e,n)&&Qn(t,n,e[n])})),ws=Li((function(t,e){Oi(e,Ds(e),t)})),xs=Li((function(t,e,n,r){Oi(e,Ds(e),t,r)})),Ss=Li((function(t,e,n,r){Oi(e,Es(e),t,r)})),As=Qi(ir),Is=qr((function(e,n){e=At(e);var r=-1,i=n.length,o=i>2?n[2]:t;for(o&&yo(n[0],n[1],o)&&(i=1);++r<i;)for(var a=n[r],s=Ds(a),l=-1,u=s.length;++l<u;){var c=s[l],f=e[c];(f===t||Pa(f,Mt[c])&&!Dt.call(e,c))&&(e[c]=a[c])}return e})),ks=qr((function(e){return e.push(t,Zi),ge(zs,t,e)}));function Os(e,n,r){var i=null==e?t:wr(e,n);return i===t?r:i}function Ts(t,e){return null!=t&&ho(t,e,kr)}var Ls=Ni((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ct.call(e)),t[e]=n}),el(il)),Ms=Ni((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ct.call(e)),Dt.call(t,e)?t[e].push(n):t[e]=[n]}),oo),Bs=qr(Tr);function Es(t){return qa(t)?Hn(t):jr(t)}function Ds(t){return qa(t)?Hn(t,!0):function(t){if(!es(t))return function(t){var e=[];if(null!=t)for(var n in At(t))e.push(n);return e}(t);var e=wo(t),n=[];for(var r in t)("constructor"!=r||!e&&Dt.call(t,r))&&n.push(r);return n}(t)}var js=Li((function(t,e,n){Rr(t,e,n)})),zs=Li((function(t,e,n,r){Rr(t,e,n,r)})),Cs=Qi((function(t,e){var n={};if(null==t)return n;var r=!1;e=Oe(e,(function(e){return e=mi(e,t),r||(r=e.length>1),e})),Oi(t,eo(t),n),r&&(n=ar(n,7,Ji));for(var i=e.length;i--;)li(n,e[i]);return n})),Fs=Qi((function(t,e){return null==t?{}:function(t,e){return Vr(t,e,(function(e,n){return Ts(t,n)}))}(t,e)}));function Ns(t,e){if(null==t)return{};var n=Oe(eo(t),(function(t){return[t]}));return e=oo(e),Vr(t,n,(function(t,n){return e(t,n[0])}))}var Rs=qi(Es),Us=qi(Ds);function Ps(t){return null==t?[]:Ge(t,Es(t))}var Vs=Di((function(t,e,n){return e=e.toLowerCase(),t+(n?$s(e):e)}));function $s(t){return Js(gs(t).toLowerCase())}function Ws(t){return(t=gs(t))&&t.replace(pt,Je).replace(qt,"")}var Ys=Di((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Gs=Di((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),qs=Ei("toLowerCase"),Hs=Di((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Xs=Di((function(t,e,n){return t+(n?" ":"")+Js(e)})),Zs=Di((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Js=Ei("toUpperCase");function Ks(e,n,r){return e=gs(e),(n=r?t:n)===t?function(t){return Jt.test(t)}(e)?function(t){return t.match(Xt)||[]}(e):function(t){return t.match(it)||[]}(e):e.match(n)||[]}var Qs=qr((function(e,n){try{return ge(e,t,n)}catch(t){return Ja(t)?t:new wt(t)}})),tl=Qi((function(t,e){return we(e,(function(e){e=No(e),rr(t,e,Ma(t[e],t))})),t}));function el(t){return function(){return t}}var nl=Ci(),rl=Ci(!0);function il(t){return t}function ol(t){return Dr("function"==typeof t?t:ar(t,1))}var al=qr((function(t,e){return function(n){return Tr(n,t,e)}})),sl=qr((function(t,e){return function(n){return Tr(t,n,e)}}));function ll(t,e,n){var r=Es(e),i=vr(e,r);null!=n||es(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=vr(e,Es(e)));var o=!(es(n)&&"chain"in n&&!n.chain),a=Ka(t);return we(i,(function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=ki(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Te([this.value()],arguments))})})),t}function ul(){}var cl=Ui(Oe),fl=Ui(Se),dl=Ui(Be);function hl(t){return bo(t)?Re(No(t)):function(t){return function(e){return wr(e,t)}}(t)}var pl=Vi(),_l=Vi(!0);function ml(){return[]}function yl(){return!1}var bl,gl=Ri((function(t,e){return t+e}),0),vl=Yi("ceil"),wl=Ri((function(t,e){return t/e}),1),xl=Yi("floor"),Sl=Ri((function(t,e){return t*e}),1),Al=Yi("round"),Il=Ri((function(t,e){return t-e}),0);return Nn.after=function(t,n){if("function"!=typeof n)throw new Ot(e);return t=_s(t),function(){if(--t<1)return n.apply(this,arguments)}},Nn.ary=Ta,Nn.assign=vs,Nn.assignIn=ws,Nn.assignInWith=xs,Nn.assignWith=Ss,Nn.at=As,Nn.before=La,Nn.bind=Ma,Nn.bindAll=tl,Nn.bindKey=Ba,Nn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ya(t)?t:[t]},Nn.chain=ha,Nn.chunk=function(e,n,r){n=(r?yo(e,n,r):n===t)?1:mn(_s(n),0);var i=null==e?0:e.length;if(!i||n<1)return[];for(var o=0,a=0,s=gt(Ee(i/n));o<i;)s[a++]=ti(e,o,o+=n);return s},Nn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},Nn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=gt(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Te(Ya(n)?ki(n):[n],_r(e,1))},Nn.cond=function(t){var n=null==t?0:t.length,r=oo();return t=n?Oe(t,(function(t){if("function"!=typeof t[1])throw new Ot(e);return[r(t[0]),t[1]]})):[],qr((function(e){for(var r=-1;++r<n;){var i=t[r];if(ge(i[0],this,e))return ge(i[1],this,e)}}))},Nn.conforms=function(t){return function(t){var e=Es(t);return function(n){return sr(n,t,e)}}(ar(t,1))},Nn.constant=el,Nn.countBy=ma,Nn.create=function(t,e){var n=Rn(t);return null==e?n:nr(n,e)},Nn.curry=function e(n,r,i){var o=Hi(n,8,t,t,t,t,t,r=i?t:r);return o.placeholder=e.placeholder,o},Nn.curryRight=function e(n,r,i){var o=Hi(n,16,t,t,t,t,t,r=i?t:r);return o.placeholder=e.placeholder,o},Nn.debounce=Ea,Nn.defaults=Is,Nn.defaultsDeep=ks,Nn.defer=Da,Nn.delay=ja,Nn.difference=Po,Nn.differenceBy=Vo,Nn.differenceWith=$o,Nn.drop=function(e,n,r){var i=null==e?0:e.length;return i?ti(e,(n=r||n===t?1:_s(n))<0?0:n,i):[]},Nn.dropRight=function(e,n,r){var i=null==e?0:e.length;return i?ti(e,0,(n=i-(n=r||n===t?1:_s(n)))<0?0:n):[]},Nn.dropRightWhile=function(t,e){return t&&t.length?ci(t,oo(e,3),!0,!0):[]},Nn.dropWhile=function(t,e){return t&&t.length?ci(t,oo(e,3),!0):[]},Nn.fill=function(e,n,r,i){var o=null==e?0:e.length;return o?(r&&"number"!=typeof r&&yo(e,n,r)&&(r=0,i=o),function(e,n,r,i){var o=e.length;for((r=_s(r))<0&&(r=-r>o?0:o+r),(i=i===t||i>o?o:_s(i))<0&&(i+=o),i=r>i?0:ms(i);r<i;)e[r++]=n;return e}(e,n,r,i)):[]},Nn.filter=function(t,e){return(Ya(t)?Ae:pr)(t,oo(e,3))},Nn.flatMap=function(t,e){return _r(Aa(t,e),1)},Nn.flatMapDeep=function(t,e){return _r(Aa(t,e),a)},Nn.flatMapDepth=function(e,n,r){return r=r===t?1:_s(r),_r(Aa(e,n),r)},Nn.flatten=Go,Nn.flattenDeep=function(t){return null!=t&&t.length?_r(t,a):[]},Nn.flattenDepth=function(e,n){return null!=e&&e.length?_r(e,n=n===t?1:_s(n)):[]},Nn.flip=function(t){return Hi(t,512)},Nn.flow=nl,Nn.flowRight=rl,Nn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Nn.functions=function(t){return null==t?[]:vr(t,Es(t))},Nn.functionsIn=function(t){return null==t?[]:vr(t,Ds(t))},Nn.groupBy=wa,Nn.initial=function(t){return null!=t&&t.length?ti(t,0,-1):[]},Nn.intersection=Ho,Nn.intersectionBy=Xo,Nn.intersectionWith=Zo,Nn.invert=Ls,Nn.invertBy=Ms,Nn.invokeMap=xa,Nn.iteratee=ol,Nn.keyBy=Sa,Nn.keys=Es,Nn.keysIn=Ds,Nn.map=Aa,Nn.mapKeys=function(t,e){var n={};return e=oo(e,3),br(t,(function(t,r,i){rr(n,e(t,r,i),t)})),n},Nn.mapValues=function(t,e){var n={};return e=oo(e,3),br(t,(function(t,r,i){rr(n,r,e(t,r,i))})),n},Nn.matches=function(t){return Fr(ar(t,1))},Nn.matchesProperty=function(t,e){return Nr(t,ar(e,1))},Nn.memoize=za,Nn.merge=js,Nn.mergeWith=zs,Nn.method=al,Nn.methodOf=sl,Nn.mixin=ll,Nn.negate=Ca,Nn.nthArg=function(t){return t=_s(t),qr((function(e){return Ur(e,t)}))},Nn.omit=Cs,Nn.omitBy=function(t,e){return Ns(t,Ca(oo(e)))},Nn.once=function(t){return La(2,t)},Nn.orderBy=function(e,n,r,i){return null==e?[]:(Ya(n)||(n=null==n?[]:[n]),Ya(r=i?t:r)||(r=null==r?[]:[r]),Pr(e,n,r))},Nn.over=cl,Nn.overArgs=Fa,Nn.overEvery=fl,Nn.overSome=dl,Nn.partial=Na,Nn.partialRight=Ra,Nn.partition=Ia,Nn.pick=Fs,Nn.pickBy=Ns,Nn.property=hl,Nn.propertyOf=function(e){return function(n){return null==e?t:wr(e,n)}},Nn.pull=Ko,Nn.pullAll=Qo,Nn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?$r(t,e,oo(n,2)):t},Nn.pullAllWith=function(e,n,r){return e&&e.length&&n&&n.length?$r(e,n,t,r):e},Nn.pullAt=ta,Nn.range=pl,Nn.rangeRight=_l,Nn.rearg=Ua,Nn.reject=function(t,e){return(Ya(t)?Ae:pr)(t,Ca(oo(e,3)))},Nn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=oo(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return Wr(t,i),n},Nn.rest=function(n,r){if("function"!=typeof n)throw new Ot(e);return qr(n,r=r===t?r:_s(r))},Nn.reverse=ea,Nn.sampleSize=function(e,n,r){return n=(r?yo(e,n,r):n===t)?1:_s(n),(Ya(e)?Zn:Xr)(e,n)},Nn.set=function(t,e,n){return null==t?t:Zr(t,e,n)},Nn.setWith=function(e,n,r,i){return i="function"==typeof i?i:t,null==e?e:Zr(e,n,r,i)},Nn.shuffle=function(t){return(Ya(t)?Jn:Qr)(t)},Nn.slice=function(e,n,r){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&yo(e,n,r)?(n=0,r=i):(n=null==n?0:_s(n),r=r===t?i:_s(r)),ti(e,n,r)):[]},Nn.sortBy=ka,Nn.sortedUniq=function(t){return t&&t.length?ii(t):[]},Nn.sortedUniqBy=function(t,e){return t&&t.length?ii(t,oo(e,2)):[]},Nn.split=function(e,n,r){return r&&"number"!=typeof r&&yo(e,n,r)&&(n=r=t),(r=r===t?u:r>>>0)?(e=gs(e))&&("string"==typeof n||null!=n&&!as(n))&&!(n=ai(n))&&tn(e)?bi(sn(e),0,r):e.split(n,r):[]},Nn.spread=function(t,n){if("function"!=typeof t)throw new Ot(e);return n=null==n?0:mn(_s(n),0),qr((function(e){var r=e[n],i=bi(e,0,n);return r&&Te(i,r),ge(t,this,i)}))},Nn.tail=function(t){var e=null==t?0:t.length;return e?ti(t,1,e):[]},Nn.take=function(e,n,r){return e&&e.length?ti(e,0,(n=r||n===t?1:_s(n))<0?0:n):[]},Nn.takeRight=function(e,n,r){var i=null==e?0:e.length;return i?ti(e,(n=i-(n=r||n===t?1:_s(n)))<0?0:n,i):[]},Nn.takeRightWhile=function(t,e){return t&&t.length?ci(t,oo(e,3),!1,!0):[]},Nn.takeWhile=function(t,e){return t&&t.length?ci(t,oo(e,3)):[]},Nn.tap=function(t,e){return e(t),t},Nn.throttle=function(t,n,r){var i=!0,o=!0;if("function"!=typeof t)throw new Ot(e);return es(r)&&(i="leading"in r?!!r.leading:i,o="trailing"in r?!!r.trailing:o),Ea(t,n,{leading:i,maxWait:n,trailing:o})},Nn.thru=pa,Nn.toArray=hs,Nn.toPairs=Rs,Nn.toPairsIn=Us,Nn.toPath=function(t){return Ya(t)?Oe(t,No):us(t)?[t]:ki(Fo(gs(t)))},Nn.toPlainObject=bs,Nn.transform=function(t,e,n){var r=Ya(t),i=r||Xa(t)||cs(t);if(e=oo(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:es(t)&&Ka(o)?Rn(Wt(t)):{}}return(i?we:br)(t,(function(t,r,i){return e(n,t,r,i)})),n},Nn.unary=function(t){return Ta(t,1)},Nn.union=na,Nn.unionBy=ra,Nn.unionWith=ia,Nn.uniq=function(t){return t&&t.length?si(t):[]},Nn.uniqBy=function(t,e){return t&&t.length?si(t,oo(e,2)):[]},Nn.uniqWith=function(e,n){return n="function"==typeof n?n:t,e&&e.length?si(e,t,n):[]},Nn.unset=function(t,e){return null==t||li(t,e)},Nn.unzip=oa,Nn.unzipWith=aa,Nn.update=function(t,e,n){return null==t?t:ui(t,e,_i(n))},Nn.updateWith=function(e,n,r,i){return i="function"==typeof i?i:t,null==e?e:ui(e,n,_i(r),i)},Nn.values=Ps,Nn.valuesIn=function(t){return null==t?[]:Ge(t,Ds(t))},Nn.without=sa,Nn.words=Ks,Nn.wrap=function(t,e){return Na(_i(e),t)},Nn.xor=la,Nn.xorBy=ua,Nn.xorWith=ca,Nn.zip=fa,Nn.zipObject=function(t,e){return hi(t||[],e||[],Qn)},Nn.zipObjectDeep=function(t,e){return hi(t||[],e||[],Zr)},Nn.zipWith=da,Nn.entries=Rs,Nn.entriesIn=Us,Nn.extend=ws,Nn.extendWith=xs,ll(Nn,Nn),Nn.add=gl,Nn.attempt=Qs,Nn.camelCase=Vs,Nn.capitalize=$s,Nn.ceil=vl,Nn.clamp=function(e,n,r){return r===t&&(r=n,n=t),r!==t&&(r=(r=ys(r))==r?r:0),n!==t&&(n=(n=ys(n))==n?n:0),or(ys(e),n,r)},Nn.clone=function(t){return ar(t,4)},Nn.cloneDeep=function(t){return ar(t,5)},Nn.cloneDeepWith=function(e,n){return ar(e,5,n="function"==typeof n?n:t)},Nn.cloneWith=function(e,n){return ar(e,4,n="function"==typeof n?n:t)},Nn.conformsTo=function(t,e){return null==e||sr(t,e,Es(e))},Nn.deburr=Ws,Nn.defaultTo=function(t,e){return null==t||t!=t?e:t},Nn.divide=wl,Nn.endsWith=function(e,n,r){e=gs(e),n=ai(n);var i=e.length,o=r=r===t?i:or(_s(r),0,i);return(r-=n.length)>=0&&e.slice(r,o)==n},Nn.eq=Pa,Nn.escape=function(t){return(t=gs(t))&&W.test(t)?t.replace(V,Ke):t},Nn.escapeRegExp=function(t){return(t=gs(t))&&K.test(t)?t.replace(J,"\\$&"):t},Nn.every=function(e,n,r){var i=Ya(e)?Se:dr;return r&&yo(e,n,r)&&(n=t),i(e,oo(n,3))},Nn.find=ya,Nn.findIndex=Wo,Nn.findKey=function(t,e){return De(t,oo(e,3),br)},Nn.findLast=ba,Nn.findLastIndex=Yo,Nn.findLastKey=function(t,e){return De(t,oo(e,3),gr)},Nn.floor=xl,Nn.forEach=ga,Nn.forEachRight=va,Nn.forIn=function(t,e){return null==t?t:mr(t,oo(e,3),Ds)},Nn.forInRight=function(t,e){return null==t?t:yr(t,oo(e,3),Ds)},Nn.forOwn=function(t,e){return t&&br(t,oo(e,3))},Nn.forOwnRight=function(t,e){return t&&gr(t,oo(e,3))},Nn.get=Os,Nn.gt=Va,Nn.gte=$a,Nn.has=function(t,e){return null!=t&&ho(t,e,Ir)},Nn.hasIn=Ts,Nn.head=qo,Nn.identity=il,Nn.includes=function(t,e,n,r){t=qa(t)?t:Ps(t),n=n&&!r?_s(n):0;var i=t.length;return n<0&&(n=mn(i+n,0)),ls(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&ze(t,e,n)>-1},Nn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:_s(n);return i<0&&(i=mn(r+i,0)),ze(t,e,i)},Nn.inRange=function(e,n,r){return n=ps(n),r===t?(r=n,n=0):r=ps(r),function(t,e,n){return t>=yn(e,n)&&t<mn(e,n)}(e=ys(e),n,r)},Nn.invoke=Bs,Nn.isArguments=Wa,Nn.isArray=Ya,Nn.isArrayBuffer=Ga,Nn.isArrayLike=qa,Nn.isArrayLikeObject=Ha,Nn.isBoolean=function(t){return!0===t||!1===t||ns(t)&&Sr(t)==h},Nn.isBuffer=Xa,Nn.isDate=Za,Nn.isElement=function(t){return ns(t)&&1===t.nodeType&&!os(t)},Nn.isEmpty=function(t){if(null==t)return!0;if(qa(t)&&(Ya(t)||"string"==typeof t||"function"==typeof t.splice||Xa(t)||cs(t)||Wa(t)))return!t.length;var e=fo(t);if(e==b||e==S)return!t.size;if(wo(t))return!jr(t).length;for(var n in t)if(Dt.call(t,n))return!1;return!0},Nn.isEqual=function(t,e){return Mr(t,e)},Nn.isEqualWith=function(e,n,r){var i=(r="function"==typeof r?r:t)?r(e,n):t;return i===t?Mr(e,n,t,r):!!i},Nn.isError=Ja,Nn.isFinite=function(t){return"number"==typeof t&&hn(t)},Nn.isFunction=Ka,Nn.isInteger=Qa,Nn.isLength=ts,Nn.isMap=rs,Nn.isMatch=function(t,e){return t===e||Br(t,e,so(e))},Nn.isMatchWith=function(e,n,r){return r="function"==typeof r?r:t,Br(e,n,so(n),r)},Nn.isNaN=function(t){return is(t)&&t!=+t},Nn.isNative=function(t){if(vo(t))throw new wt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Er(t)},Nn.isNil=function(t){return null==t},Nn.isNull=function(t){return null===t},Nn.isNumber=is,Nn.isObject=es,Nn.isObjectLike=ns,Nn.isPlainObject=os,Nn.isRegExp=as,Nn.isSafeInteger=function(t){return Qa(t)&&t>=-9007199254740991&&t<=s},Nn.isSet=ss,Nn.isString=ls,Nn.isSymbol=us,Nn.isTypedArray=cs,Nn.isUndefined=function(e){return e===t},Nn.isWeakMap=function(t){return ns(t)&&fo(t)==k},Nn.isWeakSet=function(t){return ns(t)&&"[object WeakSet]"==Sr(t)},Nn.join=function(t,e){return null==t?"":pn.call(t,e)},Nn.kebabCase=Ys,Nn.last=Jo,Nn.lastIndexOf=function(e,n,r){var i=null==e?0:e.length;if(!i)return-1;var o=i;return r!==t&&(o=(o=_s(r))<0?mn(i+o,0):yn(o,i-1)),n==n?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(e,n,o):je(e,Fe,o,!0)},Nn.lowerCase=Gs,Nn.lowerFirst=qs,Nn.lt=fs,Nn.lte=ds,Nn.max=function(e){return e&&e.length?hr(e,il,Ar):t},Nn.maxBy=function(e,n){return e&&e.length?hr(e,oo(n,2),Ar):t},Nn.mean=function(t){return Ne(t,il)},Nn.meanBy=function(t,e){return Ne(t,oo(e,2))},Nn.min=function(e){return e&&e.length?hr(e,il,zr):t},Nn.minBy=function(e,n){return e&&e.length?hr(e,oo(n,2),zr):t},Nn.stubArray=ml,Nn.stubFalse=yl,Nn.stubObject=function(){return{}},Nn.stubString=function(){return""},Nn.stubTrue=function(){return!0},Nn.multiply=Sl,Nn.nth=function(e,n){return e&&e.length?Ur(e,_s(n)):t},Nn.noConflict=function(){return se._===this&&(se._=Nt),this},Nn.noop=ul,Nn.now=Oa,Nn.pad=function(t,e,n){t=gs(t);var r=(e=_s(e))?an(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Pi(Ue(i),n)+t+Pi(Ee(i),n)},Nn.padEnd=function(t,e,n){t=gs(t);var r=(e=_s(e))?an(t):0;return e&&r<e?t+Pi(e-r,n):t},Nn.padStart=function(t,e,n){t=gs(t);var r=(e=_s(e))?an(t):0;return e&&r<e?Pi(e-r,n)+t:t},Nn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),gn(gs(t).replace(Q,""),e||0)},Nn.random=function(e,n,r){if(r&&"boolean"!=typeof r&&yo(e,n,r)&&(n=r=t),r===t&&("boolean"==typeof n?(r=n,n=t):"boolean"==typeof e&&(r=e,e=t)),e===t&&n===t?(e=0,n=1):(e=ps(e),n===t?(n=e,e=0):n=ps(n)),e>n){var i=e;e=n,n=i}if(r||e%1||n%1){var o=vn();return yn(e+o*(n-e+re("1e-"+((o+"").length-1))),n)}return Yr(e,n)},Nn.reduce=function(t,e,n){var r=Ya(t)?Le:Pe,i=arguments.length<3;return r(t,oo(e,4),n,i,cr)},Nn.reduceRight=function(t,e,n){var r=Ya(t)?Me:Pe,i=arguments.length<3;return r(t,oo(e,4),n,i,fr)},Nn.repeat=function(e,n,r){return n=(r?yo(e,n,r):n===t)?1:_s(n),Gr(gs(e),n)},Nn.replace=function(){var t=arguments,e=gs(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Nn.result=function(e,n,r){var i=-1,o=(n=mi(n,e)).length;for(o||(o=1,e=t);++i<o;){var a=null==e?t:e[No(n[i])];a===t&&(i=o,a=r),e=Ka(a)?a.call(e):a}return e},Nn.round=Al,Nn.runInContext=tt,Nn.sample=function(t){return(Ya(t)?Xn:Hr)(t)},Nn.size=function(t){if(null==t)return 0;if(qa(t))return ls(t)?an(t):t.length;var e=fo(t);return e==b||e==S?t.size:jr(t).length},Nn.snakeCase=Hs,Nn.some=function(e,n,r){var i=Ya(e)?Be:ei;return r&&yo(e,n,r)&&(n=t),i(e,oo(n,3))},Nn.sortedIndex=function(t,e){return ni(t,e)},Nn.sortedIndexBy=function(t,e,n){return ri(t,e,oo(n,2))},Nn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=ni(t,e);if(r<n&&Pa(t[r],e))return r}return-1},Nn.sortedLastIndex=function(t,e){return ni(t,e,!0)},Nn.sortedLastIndexBy=function(t,e,n){return ri(t,e,oo(n,2),!0)},Nn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=ni(t,e,!0)-1;if(Pa(t[n],e))return n}return-1},Nn.startCase=Xs,Nn.startsWith=function(t,e,n){return t=gs(t),n=null==n?0:or(_s(n),0,t.length),e=ai(e),t.slice(n,n+e.length)==e},Nn.subtract=Il,Nn.sum=function(t){return t&&t.length?Ve(t,il):0},Nn.sumBy=function(t,e){return t&&t.length?Ve(t,oo(e,2)):0},Nn.template=function(e,n,r){var i=Nn.templateSettings;r&&yo(e,n,r)&&(n=t),e=gs(e),n=xs({},n,i,Xi);var o,a,s=xs({},n.imports,i.imports,Xi),l=Es(s),u=Ge(s,l),c=0,f=n.interpolate||_t,d="__p += '",h=It((n.escape||_t).source+"|"+f.source+"|"+(f===q?st:_t).source+"|"+(n.evaluate||_t).source+"|$","g"),p="//# sourceURL="+(Dt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Qt+"]")+"\n";e.replace(h,(function(t,n,r,i,s,l){return r||(r=i),d+=e.slice(c,l).replace(mt,Qe),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t})),d+="';\n";var _=Dt.call(n,"variable")&&n.variable;if(_){if(ot.test(_))throw new wt("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(a?d.replace(N,""):d).replace(R,"$1").replace(U,"$1;"),d="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Qs((function(){return xt(l,p+"return "+d).apply(t,u)}));if(m.source=d,Ja(m))throw m;return m},Nn.times=function(t,e){if((t=_s(t))<1||t>s)return[];var n=u,r=yn(t,u);e=oo(e),t-=u;for(var i=$e(r,e);++n<t;)e(n);return i},Nn.toFinite=ps,Nn.toInteger=_s,Nn.toLength=ms,Nn.toLower=function(t){return gs(t).toLowerCase()},Nn.toNumber=ys,Nn.toSafeInteger=function(t){return t?or(_s(t),-9007199254740991,s):0===t?t:0},Nn.toString=gs,Nn.toUpper=function(t){return gs(t).toUpperCase()},Nn.trim=function(e,n,r){if((e=gs(e))&&(r||n===t))return We(e);if(!e||!(n=ai(n)))return e;var i=sn(e),o=sn(n);return bi(i,He(i,o),Xe(i,o)+1).join("")},Nn.trimEnd=function(e,n,r){if((e=gs(e))&&(r||n===t))return e.slice(0,ln(e)+1);if(!e||!(n=ai(n)))return e;var i=sn(e);return bi(i,0,Xe(i,sn(n))+1).join("")},Nn.trimStart=function(e,n,r){if((e=gs(e))&&(r||n===t))return e.replace(Q,"");if(!e||!(n=ai(n)))return e;var i=sn(e);return bi(i,He(i,sn(n))).join("")},Nn.truncate=function(e,n){var r=30,i="...";if(es(n)){var o="separator"in n?n.separator:o;r="length"in n?_s(n.length):r,i="omission"in n?ai(n.omission):i}var a=(e=gs(e)).length;if(tn(e)){var s=sn(e);a=s.length}if(r>=a)return e;var l=r-an(i);if(l<1)return i;var u=s?bi(s,0,l).join(""):e.slice(0,l);if(o===t)return u+i;if(s&&(l+=u.length-l),as(o)){if(e.slice(l).search(o)){var c,f=u;for(o.global||(o=It(o.source,gs(lt.exec(o))+"g")),o.lastIndex=0;c=o.exec(f);)var d=c.index;u=u.slice(0,d===t?l:d)}}else if(e.indexOf(ai(o),l)!=l){var h=u.lastIndexOf(o);h>-1&&(u=u.slice(0,h))}return u+i},Nn.unescape=function(t){return(t=gs(t))&&$.test(t)?t.replace(P,un):t},Nn.uniqueId=function(t){var e=++jt;return gs(t)+e},Nn.upperCase=Zs,Nn.upperFirst=Js,Nn.each=ga,Nn.eachRight=va,Nn.first=qo,ll(Nn,(bl={},br(Nn,(function(t,e){Dt.call(Nn.prototype,e)||(bl[e]=t)})),bl),{chain:!1}),Nn.VERSION="4.17.21",we(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Nn[t].placeholder=Nn})),we(["drop","take"],(function(e,n){Vn.prototype[e]=function(r){r=r===t?1:mn(_s(r),0);var i=this.__filtered__&&!n?new Vn(this):this.clone();return i.__filtered__?i.__takeCount__=yn(r,i.__takeCount__):i.__views__.push({size:yn(r,u),type:e+(i.__dir__<0?"Right":"")}),i},Vn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),we(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Vn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:oo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),we(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Vn.prototype[t]=function(){return this[n](1).value()[0]}})),we(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Vn.prototype[t]=function(){return this.__filtered__?new Vn(this):this[n](1)}})),Vn.prototype.compact=function(){return this.filter(il)},Vn.prototype.find=function(t){return this.filter(t).head()},Vn.prototype.findLast=function(t){return this.reverse().find(t)},Vn.prototype.invokeMap=qr((function(t,e){return"function"==typeof t?new Vn(this):this.map((function(n){return Tr(n,t,e)}))})),Vn.prototype.reject=function(t){return this.filter(Ca(oo(t)))},Vn.prototype.slice=function(e,n){e=_s(e);var r=this;return r.__filtered__&&(e>0||n<0)?new Vn(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),n!==t&&(r=(n=_s(n))<0?r.dropRight(-n):r.take(n-e)),r)},Vn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Vn.prototype.toArray=function(){return this.take(u)},br(Vn.prototype,(function(e,n){var r=/^(?:filter|find|map|reject)|While$/.test(n),i=/^(?:head|last)$/.test(n),o=Nn[i?"take"+("last"==n?"Right":""):n],a=i||/^find/.test(n);o&&(Nn.prototype[n]=function(){var n=this.__wrapped__,s=i?[1]:arguments,l=n instanceof Vn,u=s[0],c=l||Ya(n),f=function(t){var e=o.apply(Nn,Te([t],s));return i&&d?e[0]:e};c&&r&&"function"==typeof u&&1!=u.length&&(l=c=!1);var d=this.__chain__,h=!!this.__actions__.length,p=a&&!d,_=l&&!h;if(!a&&c){n=_?n:new Vn(this);var m=e.apply(n,s);return m.__actions__.push({func:pa,args:[f],thisArg:t}),new Pn(m,d)}return p&&_?e.apply(this,s):(m=this.thru(f),p?i?m.value()[0]:m.value():m)})})),we(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Tt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Nn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Ya(i)?i:[],t)}return this[n]((function(n){return e.apply(Ya(n)?n:[],t)}))}})),br(Vn.prototype,(function(t,e){var n=Nn[e];if(n){var r=n.name+"";Dt.call(Ln,r)||(Ln[r]=[]),Ln[r].push({name:e,func:n})}})),Ln[Fi(t,2).name]=[{name:"wrapper",func:t}],Vn.prototype.clone=function(){var t=new Vn(this.__wrapped__);return t.__actions__=ki(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ki(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ki(this.__views__),t},Vn.prototype.reverse=function(){if(this.__filtered__){var t=new Vn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Vn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ya(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=yn(e,t+a);break;case"takeRight":t=mn(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,u=r?s:a-1,c=this.__iteratees__,f=c.length,d=0,h=yn(l,this.__takeCount__);if(!n||!r&&i==l&&h==l)return fi(t,this.__actions__);var p=[];t:for(;l--&&d<h;){for(var _=-1,m=t[u+=e];++_<f;){var y=c[_],b=y.iteratee,g=y.type,v=b(m);if(2==g)m=v;else if(!v){if(1==g)continue t;break t}}p[d++]=m}return p},Nn.prototype.at=_a,Nn.prototype.chain=function(){return ha(this)},Nn.prototype.commit=function(){return new Pn(this.value(),this.__chain__)},Nn.prototype.next=function(){this.__values__===t&&(this.__values__=hs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?t:this.__values__[this.__index__++]}},Nn.prototype.plant=function(e){for(var n,r=this;r instanceof Un;){var i=Uo(r);i.__index__=0,i.__values__=t,n?o.__wrapped__=i:n=i;var o=i;r=r.__wrapped__}return o.__wrapped__=e,n},Nn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Vn){var n=e;return this.__actions__.length&&(n=new Vn(this)),(n=n.reverse()).__actions__.push({func:pa,args:[ea],thisArg:t}),new Pn(n,this.__chain__)}return this.thru(ea)},Nn.prototype.toJSON=Nn.prototype.valueOf=Nn.prototype.value=function(){return fi(this.__wrapped__,this.__actions__)},Nn.prototype.first=Nn.prototype.head,oe&&(Nn.prototype[oe]=function(){return this}),Nn}();ue?((ue.exports=cn)._=cn,le._=cn):se._=cn}.call(On);const za={sqrt:function(){return ma.apply(null,arguments).exponent(.5)},log:function t(){const e=fa(Po()).domain([1,10]);return e.copy=()=>Uo(e,t()).base(e.base()),Mo.apply(e,arguments),e},linear:ia,literal:function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,jo),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,jo):[0,1],ra(r)}};class Ca{constructor(t,e,n,r){if(this.field=null,this._texture_buffer=null,this.partner=null,this._textures={},this.current_encoding=null,this.aesthetic_map=r,void 0===this.aesthetic_map)throw new Error("Aesthetic map is undefined");this.scatterplot=t,this.regl=e,this._range=[0,1],this.dataset=n,this.id=Math.random().toString()}apply(t){return void 0===this.scale?this.default_constant:this.scale(this.value_for(t))}get transform(){return this._transform?this._transform:this.default_transform}set transform(t){this._transform=t}get scale(){if(this._scale)return this._scale;if(this.is_dictionary()){console.warn("Dictionary scales only supported for colors");const t=Do().domain(this.domain);return this._scale=t.range(this.range)}const t=za[this.transform]();return t.domain(this.domain).range(this.range),this._scale=t}get column(){if(null===this.field)throw new Error("Can't retrieve column for aesthetic without a field");if(this.dataset.root_tile.record_batch){const t=this.dataset.root_tile.record_batch.getChild(this.field);if(null==t)throw new Error("Can't find column "+this.field);return t}throw new Error("Table is null")}get default_domain(){var t;if(null==this.field)return[1,1];if(!this.scatterplot._root._schema)return[1,1];const{column:e}=this;return e?void 0!==(null==(t=e.type)?void 0:t.dictionary)?[-2047,Math.floor(this.aesthetic_map.texture_size/2)-1]:(this.dataset.domain(this.field),this.dataset.domain(this.field)):[1,1]}default_data(){const t=this.toGLType(this.default_constant);return Array(this.aesthetic_map.texture_size).fill(t)}get webGLDomain(){return this.is_dictionary()?[-2047,2047]:this.domain}get domain(){return void 0===this._domain&&(this._domain=this.default_domain),this._domain||this.default_domain}get range(){return this._range||this.default_range}value_for(t){return this.field&&t[this.field]?t[this.field]:null}get map_position(){return 0===this.use_map_on_regl?0:this.aesthetic_map.get_position(this.id)}get texture_buffer(){return this._texture_buffer||(this._texture_buffer=new Float32Array(this.aesthetic_map.texture_size),this._texture_buffer.set(this.default_data())),this._texture_buffer}post_to_regl_buffer(){this.aesthetic_map.set_one_d(this.id,this.texture_buffer)}convert_string_encoding(t){return{field:t,domain:this.default_domain,range:this.default_range}}complete_domain(t){return t.domain=t.domain||this.default_domain,t}reset_to_defaults(){this._domain=this.default_domain,this._range=[0,1],this._transform=void 0,this._constant=this.default_constant,this.field=null,this.current_encoding=null,this._scale=void 0}update(t){if(void 0!==t){if(null===t||"null"===t)return this.current_encoding=null,void this.reset_to_defaults();if(this._scale=void 0,"string"==typeof t&&(t=this.convert_string_encoding(t)),ja.isNumber(t)){const e={constant:t};this.current_encoding=e}else{if(0===Object.keys(t).length)return console.warn("Resetting parameters with an empty object is deprecated: use 'null'"),void this.reset_to_defaults();if(this.current_encoding=t,!Ba(t)&&(this.field=t.field,!La(t)))if(Ma(t)){const{lambda:e,field:n}=t;e&&(this.apply_function_for_textures(n,this.domain,e),this.post_to_regl_buffer())}else void 0===t.domain&&(t.domain=this.default_domain),t.range&&(this._domain=t.domain,this._range=t.range),this._transform=t.transform||void 0}}else console.warn("Should never be calling update with undefined.")}encode_for_textures(t){const{texture_size:e}=this.aesthetic_map,n=Array(e),r=za[this.transform]().range(t).domain([0,e-1]);for(let t=0;t<e;t+=1)n[t]=r(t)}arrow_column(){if(null===this.field)throw new Error("Can't retrieve column for aesthetic without a field");const t=this.dataset.root_tile.record_batch.getChild(this.field);if(null===t)throw`No column ${this.field} on arrow table for aesthetic`;return t}is_dictionary(){var t,e;return null!==this.field&&void 0!==this.field&&void 0!==(null==(e=null==(t=this.arrow_column())?void 0:t.type)?void 0:e.dictionary)}get constant(){return null!==this.current_encoding&&Ba(this.current_encoding)?this.toGLType(this.current_encoding.constant):this.toGLType(this.default_constant)}get use_map_on_regl(){return this.is_dictionary()?1:0}materialize_function(t){const e="string"==typeof t?function(t){if("function"==typeof t.lambda)throw"Must pass a string to lambda, not a function.";const{lambda:e,field:n}=t;if(void 0===n)throw"Must pass a field to lambda.";const r=$a(e).lambda,[i,o]=r.split("=>",2).map((t=>t.trim()));return new Function(i,o)}($a(t)):t;return this._func=e,e}apply_function_for_textures(t,e,n){var r;const{texture_size:i}=this.aesthetic_map,o=this.materialize_function(n);let a=Gt(i);if(void 0===t||void 0===this.dataset.root_tile.record_batch)return void 0===t&&console.warn("SETTING EMPTY FIELD"),void 0===this.dataset.root_tile.record_batch&&console.warn("SETTING EMPTY TABLE"),void this.texture_buffer.set(Gt(i).map((t=>1)));const{column:s}=this;if(!s)throw new Error(`Column ${t} does not exist on table.`);if(null==(r=null==s?void 0:s.type)?void 0:r.dictionary){a.fill("");const t=s.data[0].dictionary.toArray();for(const[e,n]of t.entries())a[e]=n}else a=a.map((t=>this.scale(t)));const l=a.map((t=>o(t)));this.texture_buffer.set(l)}}class Fa extends Ca{constructor(t,e,n,r){super(t,e,n,r),this.current_encoding=null}toGLType(t){return t}static get_default_domain(){return[0,1]}get default_domain(){return[0,1]}}class Na extends Fa{constructor(t,e,n,r){super(t,e,n,r),this.default_range=[-1,1],this.default_constant=0,this.default_transform="literal",this._constant=0,this._transform="literal"}get range(){return this._range?this._range:this.dataset.extent&&this.field&&this.dataset.extent[this.field]?this.dataset.extent[this.field]:this.default_range}static get default_constant(){return 0}}class Ra extends Na{constructor(){super(...arguments),this.field="x"}}class Ua extends Na{constructor(){super(...arguments),this.field="y"}}class Pa extends Ca{constructor(t,e,n,r){super(t,e,n,r)}toGLType(t){return t?1:0}update(t){super.update(t),null!==this.current_encoding&&0===Object.keys(this.current_encoding).length&&(this.current_encoding=null)}ops_to_array(){const t=this.current_encoding;return null==t?[0,0,0]:La(t)?"within"===t.op?[4,t.a,t.b]:[[null,"lt","gt","eq"].indexOf(t.op),t.a,0]:[0,0,0]}apply(t){const e=this.current_encoding;if(null==e)return!0;if(La(e))return this.apply_op(t,e);if(Ba(e))return 0!==e.constant;if(Ma(e)){if(void 0===this._func)throw new Error("_func should have been bound"+JSON.stringify(this.current_encoding));const e=this.value_for(t);return null!==e&&!!this._func(e)}return!0}apply_op(t,e){const{op:n,a:r}=e,i=this.value_for(t);if(null===i)return!1;if("eq"===n)return i==r;if("gt"===n)return i>r;if("lt"===n)return i<r;if("within"===n)return Math.abs(i-e.b)<r;if("between"===n){const t=(e.a+e.b)/2,n=Math.abs(e.a-e.b)/2;return Math.abs(i-t)<n}return!1}get default_domain(){return[0,1]}}class Va extends Pa{constructor(){super(...arguments),this.current_encoding=null,this._constant=1,this.default_constant=1,this.default_transform="literal",this.default_range=[0,1]}}function $a(t){let[e,n]=t.split("=>").map((t=>t.trim()));if(void 0===n)throw new Error(`Couldn't parse ${t} into a function`);return"{"!==n.slice(0,1)&&"return"!==n.slice(0,6)&&(n=`return ${n}`),{field:e,lambda:`${e} => ${n}`}}function Wa(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}const Ya=Wa("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Ga=Wa("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),qa=Wa("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Ha=Wa("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Xa=Wa("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Za=Wa("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Ja=Wa("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Ka=Wa("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Qa=Wa("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),ts=Wa("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),es=t=>ci(t[t.length-1]);var ns=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Wa);const rs=es(ns);var is=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Wa);const os=es(is);var as=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Wa);const ss=es(as);var ls=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Wa);const us=es(ls);var cs=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Wa);const fs=es(cs);var ds=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Wa);const hs=es(ds);var ps=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Wa);const _s=es(ps);var ms=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Wa);const ys=es(ms);var bs=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Wa);const gs=es(bs);var vs=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Wa);const ws=es(vs);var xs=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Wa);const Ss=es(xs);var As=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Wa);const Is=es(As);var ks=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Wa);const Os=es(ks);var Ts=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Wa);const Ls=es(Ts);var Ms=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Wa);const Bs=es(Ms);var Es=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Wa);const Ds=es(Es);var js=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Wa);const zs=es(js);var Cs=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Wa);const Fs=es(Cs);var Ns=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Wa);const Rs=es(Ns);var Us=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Wa);const Ps=es(Us);var Vs=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Wa);const $s=es(Vs);var Ws=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Wa);const Ys=es(Ws);var Gs=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Wa);const qs=es(Gs);var Hs=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Wa);const Xs=es(Hs);var Zs=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Wa);const Js=es(Zs);var Ks=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Wa);const Qs=es(Ks);var tl=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Wa);const el=es(tl),nl=Bi(ri(300,.5,0),ri(-240,.5,1));var rl=Bi(ri(-100,.75,.35),ri(80,1.5,.8)),il=Bi(ri(260,.75,.35),ri(80,1.5,.8)),ol=ri(),al=Dr(),sl=Math.PI/3,ll=2*Math.PI/3;function ul(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const cl=ul(Wa("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var fl=ul(Wa("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),dl=ul(Wa("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),hl=ul(Wa("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));const pl=Object.freeze(Object.defineProperty({__proto__:null,interpolateBlues:Ys,interpolateBrBG:rs,interpolateBuGn:ws,interpolateBuPu:Ss,interpolateCividis:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},interpolateCool:il,interpolateCubehelixDefault:nl,interpolateGnBu:Is,interpolateGreens:qs,interpolateGreys:Xs,interpolateInferno:dl,interpolateMagma:fl,interpolateOrRd:Os,interpolateOranges:el,interpolatePRGn:os,interpolatePiYG:ss,interpolatePlasma:hl,interpolatePuBu:Bs,interpolatePuBuGn:Ls,interpolatePuOr:us,interpolatePuRd:Ds,interpolatePurples:Js,interpolateRainbow:function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return ol.h=360*t-100,ol.s=1.5-1.5*e,ol.l=.8-.9*e,ol+""},interpolateRdBu:fs,interpolateRdGy:hs,interpolateRdPu:zs,interpolateRdYlBu:_s,interpolateRdYlGn:ys,interpolateReds:Qs,interpolateSinebow:function(t){var e;return t=(.5-t)*Math.PI,al.r=255*(e=Math.sin(t))*e,al.g=255*(e=Math.sin(t+sl))*e,al.b=255*(e=Math.sin(t+ll))*e,al+""},interpolateSpectral:gs,interpolateTurbo:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},interpolateViridis:cl,interpolateWarm:rl,interpolateYlGn:Rs,interpolateYlGnBu:Fs,interpolateYlOrBr:Ps,interpolateYlOrRd:$s,schemeAccent:Ga,schemeBlues:Ws,schemeBrBG:ns,schemeBuGn:vs,schemeBuPu:xs,schemeCategory10:Ya,schemeDark2:qa,schemeGnBu:As,schemeGreens:Gs,schemeGreys:Hs,schemeOrRd:ks,schemeOranges:tl,schemePRGn:is,schemePaired:Ha,schemePastel1:Xa,schemePastel2:Za,schemePiYG:as,schemePuBu:Ms,schemePuBuGn:Ts,schemePuOr:ls,schemePuRd:Es,schemePurples:Zs,schemeRdBu:cs,schemeRdGy:ds,schemeRdPu:js,schemeRdYlBu:ps,schemeRdYlGn:ms,schemeReds:Ks,schemeSet1:Ja,schemeSet2:Ka,schemeSet3:Qa,schemeSpectral:bs,schemeTableau10:ts,schemeYlGn:Ns,schemeYlGnBu:Cs,schemeYlOrBr:Us,schemeYlOrRd:Vs},Symbol.toStringTag,{value:"Module"})),_l=1/4294967296;function ml(t=Math.random()){let e=0|(0<=t&&t<1?t/_l:Math.abs(t));return()=>(e=1664525*e+1013904223|0,_l*(e>>>0))}const yl=4096;function bl(t){const e=new Uint8Array(16384);return Gt(yl).forEach((n=>{const r=Dr(t(n/yl));e.set([r.r,r.g,r.b,255],4*n)})),e}const gl={white:new Uint8Array(16384).fill(255)},vl={};function wl(t){const e=t.map((t=>{const e=Dr(t);return[e.r,e.g,e.b,255]})),n=new Uint8Array(16384);for(let r=0;r<yl;r++)n.set(e[r%t.length],4*r);return n}for(const t of["schemeAccent","schemeCategory10","schemeDark2","schemePaired","schemePastel1","schemePastel2","schemeSet1","schemeSet2","schemeSet3","schemeTableau10"]){const e=pl[t],n=t.replace("scheme","").toLowerCase();gl[n]=wl(e),vl[n]=e}for(const t of["interpolateBlues","interpolateBrBG","interpolateBuGn","interpolateBuPu","interpolateCividis","interpolateCool","interpolateCubehelixDefault","interpolateGnBu","interpolateGreens","interpolateGreys","interpolateInferno","interpolateMagma","interpolateOrRd","interpolateOranges","interpolatePRGn","interpolatePiYG","interpolatePlasma","interpolatePuBu","interpolatePuBuGn","interpolatePuOr","interpolatePuRd","interpolatePurples","interpolateRainbow","interpolateRdBu","interpolateRdGy","interpolateRdPu","interpolateRdYlBu","interpolateRdYlGn","interpolateReds","interpolateSinebow","interpolateSpectral","interpolateTurbo","interpolateViridis","interpolateWarm","interpolateYlGn","interpolateYlGnBu","interpolateYlOrBr","interpolateYlOrRd"]){const e=t.replace("interpolate","").toLowerCase(),n=pl[t];if(gl[e]=bl(n),"rainbow"===e){const t=qt(ml(1));gl.shufbow=t(gl[e])}}!function(){const t=["#E69F00","#CC79A7","#56B4E9","#009E73","#0072B2","#D55E00","#F0E442"];gl.okabe=wl(t),vl.okabe=t}();const xl={size:class extends Fa{constructor(){super(...arguments),this._constant=1,this.default_constant=1,this.default_transform="sqrt"}static get default_constant(){return 1.5}get default_range(){return[0,1]}},jitter_speed:class extends Fa{constructor(){super(...arguments),this.default_transform="linear",this.default_range=[0,1],this.default_constant=.5,this._constant=0}},jitter_radius:class extends Ca{constructor(){super(...arguments),this._constant=0,this.jitter_int_formatted=0,this.default_transform="linear",this._method="None"}toGLType(t){return t}get default_constant(){return 0}get default_range(){return[0,1]}get method(){var t,e;return null!=(e=null==(t=this.current_encoding)?void 0:t.method)?e:"None"}set method(t){this._method=t}get jitter_int_format(){return"spiral"===(t=this.method)?1:"uniform"===t?2:"normal"===t?3:"circle"===t?4:"time"===t?5:0;var t}},color:class extends Ca{constructor(){super(...arguments),this._constant="#CC5500",this.texture_type="uint8",this.default_constant="#CC5500",this.default_transform="linear",this.current_encoding=null}get default_range(){return[0,1]}default_data(){return gl.viridis}get use_map_on_regl(){return 1}get scale(){if(this._scale)return this._scale;za[this.transform]().domain(this.domain).range(this.range);const t=this.range;if(this.is_dictionary()){const e=Do().domain(this.domain);if("string"==typeof t&&vl[t]){if(null===this.column.data[0].dictionary)throw new Error("Dictionary is null");return this._scale=e.range(vl[t]).domain(this.column.data[0].dictionary.toArray())}return this._scale=e.range(this.range)}if("string"==typeof t){const n=pl["interpolate"+(e=t,"ylorrd"===e?"YlOrRd":e.charAt(0).toUpperCase()+e.slice(1))];if(void 0!==n)return"sqrt"===this.transform?this._scale=wa(n).exponent(.5).domain(this.domain):"log"===this.transform?this._scale=va(n).domain(this.domain):this._scale=ga(n).domain(this.domain)}var e}get texture_buffer(){return this._texture_buffer||(this._texture_buffer=new Uint8Array(4*this.aesthetic_map.texture_size),this._texture_buffer.set(this.default_data())),this._texture_buffer}post_to_regl_buffer(){this.aesthetic_map.set_color(this.id,this.texture_buffer)}update(t){super.update(t),this.current_encoding=t,null===t&&(t={constant:this.default_constant}),Ba(t)||(t.range&&"string"==typeof t.range[0]?(this.encode_for_textures(t.range),this.post_to_regl_buffer()):t.range&&this.post_to_regl_buffer())}toGLType(t){const{r:e,g:n,b:r}=Dr(t);return[e/255,n/255,r/255]}encode_for_textures(t){if(Array.isArray(t)){const e=t.join("/");if(gl[e])return void this.texture_buffer.set(gl[e]);{let e;if(this.is_dictionary()){const n=Object.fromEntries(this.column.data[0].dictionary.toArray().map(((t,e)=>[t,e]))),r=[];for(const e of this.domain)n[e]?r.push(t[n[e]]):r.push("gray");e=wl(r)}else e=wl(t);return void this.texture_buffer.set(e)}}gl[t]?this.texture_buffer.set(gl[t]):(t.length===4*this.aesthetic_map.texture_size&&(console.warn("SETTING FULL RANGE IS DEPRECATED,"),this.texture_buffer.set(t)),console.error(`request range of ${t} for color ${this.field} unknown`))}},filter:Va,filter2:Va,x:Ra,y:Ua,x0:class extends Ra{},y0:class extends Ua{},foreground:class extends Pa{constructor(){super(...arguments),this.current_encoding=null,this._constant=1,this.default_constant=1,this.default_range=[0,1],this.default_transform="literal"}get active(){return null!==this.current_encoding&&!Ba(this.current_encoding)}}};class Sl{constructor(t,e,n,r,i){if(this.needs_transitions=!1,void 0===r)throw new Error("Aesthetic map is undefined.");this.scatterplot=t,this.regl=e,this.dataset=n,this.aesthetic_map=r,this.states=[new i(this.scatterplot,this.regl,this.dataset,this.aesthetic_map),new i(this.scatterplot,this.regl,this.dataset,this.aesthetic_map)]}get current(){return this.states[0]}get last(){return this.states[1]}update(t){JSON.stringify(t)===JSON.stringify(this.states[0].current_encoding)||void 0===t?(this.needs_transitions&&this.states[1].update(this.states[0].current_encoding),this.needs_transitions=!1):(this.states.reverse(),this.states[0].update(t),this.needs_transitions=!0)}}class Al{constructor(t,e,n){return this.encoding={},this.scatterplot=t,this.store={},this.regl=e,this.tileSet=n,this.position_interpolation=!1,this.aesthetic_map=new Il(this.regl),this}dim(t){if(this.store[t])return this.store[t];if(!xl[t])throw new Error(`Unknown aesthetic ${t}`);const e=xl[t],n=this.scatterplot,r=this.regl,i=this.aesthetic_map,o=new Sl(n,r,this.tileSet,i,e);return this.store[t]=o,o}*[Symbol.iterator](){for(const[t,e]of Object.entries(this.store))yield[t,e]}interpret_position(t){if(t){t.x0||t.position0?this.position_interpolation=!0:(t.x||t.position)&&(this.position_interpolation=!1);for(const e of["position","position0"]){const n=e.replace("position","");if(t[e]){if("literal"===t[e])t[`x${n}`]={field:"x",transform:"literal"},t[`y${n}`]={field:"y",transform:"literal"};else{const r=t[e];t[`x${n}`]={field:`${r}.x`,transform:"literal"},t[`y${n}`]={field:`${r}.y`,transform:"literal"}}delete t[e]}}}delete t.position,delete t.position0}apply_encoding(t){if(void 0===t&&(t={}),t.filter1)throw new Error('filter1 is not supported; just say "filter"');this.interpret_position(t);for(const e of Object.keys(xl))this.dim(e).update(t[e])}}class Il{constructor(t,e=4096){this.id_locs={},this.offsets={},this.texture_size=e,this.texture_widths=32,this.regl=t,this._one_d_position=1,this._color_position=-1}get_position(t){return this.offsets[t]||0}set_one_d(t,e){let n;const{offsets:r}=this;r[t]?n=r[t]:(n=this._one_d_position++,r[t]=n),this.one_d_texture.subimage({data:e,width:1,height:this.texture_size},n,0)}set_color(t,e){let n;const{offsets:r}=this;r[t]?n=r[t]:(n=this._color_position--,r[t]=n),this.color_texture.subimage({data:e,width:1,height:this.texture_size},-n-1,0)}get one_d_texture(){if(this._one_d_texture)return this._one_d_texture;const t=this.regl.hasExtension("OES_texture_float")?"float":this.regl.hasExtension("OES_texture_half_float")?"half float":"uint8",e="uint8"===t?"rgba":"alpha",n={width:this.texture_widths,height:this.texture_size,type:t,format:e};return this._one_d_texture=this.regl.texture(n),this._one_d_texture}get color_texture(){return this._color_texture||(this._color_texture=this.regl.texture({width:this.texture_widths,height:this.texture_size,type:"uint8",format:"rgba"})),this._color_texture}}class kl extends Ta{constructor(t,e,n){super(t,e,n),this.buffer_size=67108864,this._use_scale_to_download_tiles=!0,this.fbos={},this.textures={};const r=this.canvas;if(void 0===this.canvas)throw new Error("No canvas found");this.regl=Sa({optionalExtensions:["OES_standard_derivatives","OES_element_index_uint","OES_texture_float","OES_texture_half_float"],canvas:r}),this.tileSet=e,this.aes=new Al(n,this.regl,e),this.initialize_textures(),this._initializations=[this.tileSet.promise.then((()=>{this.remake_renderer(),this._webgl_scale_history=[this.default_webgl_scale,this.default_webgl_scale]}))],this.initialize(),this._buffers=new Tl(this.regl,this.buffer_size)}get buffers(){return this._buffers=this._buffers||new Tl(this.regl,this.buffer_size),this._buffers}data(t){return void 0===t?this.tileSet:(this.tileSet=t,this)}get props(){this.allocate_aesthetic_buffers();const{prefs:t,aes_to_buffer_num:e,buffer_num_to_variable:n,variable_to_buffer_num:r}=this,{transform:i}=this.zoom,o={aes:{encoding:this.aes.encoding},colors_as_grid:0,corners:this.zoom.current_corners(),zoom_balance:t.zoom_balance,transform:i,max_ix:this.max_ix,point_size:this.point_size,alpha:this.optimal_alpha,time:Date.now()-this.zoom._start,update_time:Date.now()-this.most_recent_restart,relative_time:(Date.now()-this.most_recent_restart)/t.duration,string_index:0,prefs:JSON.parse(JSON.stringify(t)),color_type:void 0,start_time:this.most_recent_restart,webgl_scale:this._webgl_scale_history[0],last_webgl_scale:this._webgl_scale_history[1],use_scale_for_tiles:this._use_scale_to_download_tiles,grid_mode:0,buffer_num_to_variable:n,aes_to_buffer_num:e,variable_to_buffer_num:r,color_picker_mode:0,zoom_matrix:[[i.k,0,i.x],[0,i.k,i.y],[0,0,1]].flat()};return JSON.parse(JSON.stringify(o))}get default_webgl_scale(){return this._default_webgl_scale||(this._default_webgl_scale=this.zoom.webgl_scale()),this._default_webgl_scale}render_points(t){const e=[];let n=0;const r=this.aes.store.foreground.states[0].active||this.aes.store.foreground.states[1].active;for(const i of this.visible_tiles()){if(i._buffer_manager=i._buffer_manager||new Ol(this.regl,i,this),!i._buffer_manager.ready(t.block_for_buffers))continue;const o={manager:i._buffer_manager,number:n++,foreground:r?1:-1,tile_id:i.numeric_id,sprites:this.sprites};if(Object.assign(o,t),e.push(o),r){const t={...o,foreground:0};e.push(t)}}e.sort(((t,e)=>1e3*(3+t.foreground)-1e3*(3+e.foreground)+e.number-t.number)),this._renderer(e)}tick(){const{prefs:t}=this,{regl:e,tileSet:n}=this,{props:r}=this;this.tick_num=this.tick_num||0,this.tick_num++,this._use_scale_to_download_tiles?n.download_most_needed_tiles(this.zoom.current_corners(),this.props.max_ix,5):n.download_most_needed_tiles(t.max_points,this.max_ix,5),e.clear({color:[.9,.9,.93,0],depth:1});const i=Date.now();!async function(t){for(;Date.now()-i<10&&t.length>0;){const e=t.shift();if(void 0!==e)try{await e()}catch(t){console.warn(t,e)}}}(this.deferred_functions);try{this.render_all(r)}catch(t){throw console.warn("ERROR NOTED"),this.reglframe.cancel(),t}}single_blur_pass(t,e,n){const{regl:r}=this;e.use((()=>{r.clear({color:[0,0,0,0]}),r({frag:"precision mediump float;\n#define GLSLIFY 1\n\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.411764705882353) * direction;\n  vec2 off2 = vec2(3.2941176470588234) * direction;\n  vec2 off3 = vec2(5.176470588235294) * direction;\n  color += texture2D(image, uv) * 0.1964825501511404;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n  color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n  color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n  return color;\n}\n\nuniform vec2 iResolution;\nuniform sampler2D iChannel0;\nuniform vec2 direction;\n\nvoid main() {\n  vec2 uv = vec2(gl_FragCoord.xy / iResolution.xy);\n  gl_FragColor = blur13(iChannel0, uv, iResolution.xy, direction);\n}\n",uniforms:{iResolution:({viewportWidth:t,viewportHeight:e})=>[t,e],iChannel0:t,direction:n},vert:"\n        precision mediump float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n          uv = 0.5 * (position + 1.0);\n          gl_Position = vec4(position, 0, 1);\n        }",attributes:{position:[-4,-4,4,-4,0,4]},depth:{enable:!1},count:3})()}))}blur(t,e,n=3){let r=n-1;for(;r>-1;)this.single_blur_pass(t,e,[2**r,0]),this.single_blur_pass(e,t,[0,2**r]),r-=1}render_all(t){const{regl:e}=this;this.fbos.points.use((()=>{e.clear({color:[0,0,0,0]}),this.render_points(t)})),e.clear({color:[0,0,0,0]}),this.fbos.lines.use((()=>e.clear({color:[0,0,0,0]}))),this.scatterplot.trimap&&this.fbos.lines.use((()=>{this.scatterplot.trimap.zoom=this.zoom,this.scatterplot.trimap.tick("polygon")}));for(const t of[this.fbos.lines,this.fbos.points])e({profile:!0,blend:{enable:!0,func:{srcRGB:"one",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},frag:"\n        precision mediump float;\n        varying vec2 uv;\n        uniform sampler2D tex;\n        uniform float wRcp, hRcp;\n        void main() {\n          gl_FragColor = texture2D(tex, uv);\n        }\n      ",vert:"\n        precision mediump float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n          uv = 0.5 * (position + 1.0);\n          gl_Position = vec4(position, 0., 1.);\n        }\n      ",attributes:{position:this.fill_buffer},depth:{enable:!1},count:3,uniforms:{tex:()=>t,wRcp:({viewportWidth:t})=>1/t,hRcp:({viewportHeight:t})=>1/t}})()}initialize_textures(){const{regl:t}=this;this.fbos=this.fbos||{},this.textures=this.textures||{},this.textures.empty_texture=t.texture(Gt(128).map((t=>Gt(128).map((t=>[0,0,0]))))),this.fbos.minicounter=t.framebuffer({width:512,height:512,depth:!1}),this.fbos.lines=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.points=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.ping=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.pong=t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.contour=this.fbos.contour||t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.colorpicker=this.fbos.colorpicker||t.framebuffer({width:this.width,height:this.height,depth:!1}),this.fbos.dummy=this.fbos.dummy||t.framebuffer({width:1,height:1,depth:!1})}get_image_texture(t){const{regl:e}=this;if(this.textures=this.textures||{},this.textures[t])return this.textures[t];const n=new Image;return n.src=t,n.addEventListener("load",(()=>{this.textures[t]=e.texture(n)})),this.textures[t]}n_visible(t=-1){let{width:e,height:n}=this;e=Math.floor(e),n=Math.floor(n),void 0===this.contour_vals&&(this.contour_vals=new Uint8Array(e*n*4));const{props:r}=this;let i;return r.only_color=t,this.fbos.contour.use((()=>{this.regl.clear({color:[0,0,0,0]}),this.render_points(r),this.regl.read(this.contour_vals),i=Ht(this.contour_vals)})),i}get integer_buffer(){if(void 0===this._integer_buffer){const t=new Float32Array(65536);for(let e=0;e<65536;e++)t[e]=e;this._integer_buffer=this.regl.buffer(t)}return this._integer_buffer}color_pick(t,e){if(0===e)return null;const n=this.color_pick_single(t,e,"tile_id");if(-1==n)return null;const r=this.color_pick_single(t,e,"ix_in_tile");if(-1===r)return null;for(const t of this.visible_tiles())if(t.numeric_id===n)return t.record_batch.get(r);return null}color_pick_single(t,e,n="tile_id"){const{props:r,height:i}=this;r.color_picker_mode=["ix","tile_id","ix_in_tile"].indexOf(n)+1;let o=[0,0,0,0];this.fbos.colorpicker.use((()=>{this.regl.clear({color:[0,0,0,0]}),this.render_points(r);try{o=this.regl.read({x:t,y:i-e,width:1,height:1})}catch{console.warn("Read bad data from",{x:t,y:e,height:i,attempted:i-e})}}));const a=function(t,e,n,r){return Aa[0]=r,Aa[1]=n,Aa[2]=e,Aa[3]=t,Ia[0]}(...o)-1;return Math.round(a)}get fill_buffer(){if(!this._fill_buffer){const{regl:t}=this;this._fill_buffer=t.buffer({data:[-4,-4,4,-4,0,4]})}return this._fill_buffer}draw_contour_buffer(t,e){let{width:n,height:r}=this;n=Math.floor(n),r=Math.floor(r),this.contour_vals=this.contour_vals||new Uint8Array(4*n*r),this.contour_alpha_vals=this.contour_alpha_vals||new Uint16Array(n*r);const{props:i}=this;i.aes.encoding.color={field:t},i.only_color=e,this.fbos.contour.use((()=>{this.regl.clear({color:[0,0,0,0]}),this.render_points(i),this.regl.read(this.contour_vals)})),this.blur(this.fbos.contour,this.fbos.ping,3),this.fbos.contour.use((()=>{this.regl.read(this.contour_vals)}));let o=0;for(;o<n*r*4;)this.contour_alpha_vals[o/4]=255*this.contour_vals[o+3],o+=4;return this.contour_alpha_vals}remake_renderer(){const{regl:t}=this,e={depth:{enable:!1},stencil:{enable:!1},blend:{enable:(t,{color_picker_mode:e})=>e<.5,func:{srcRGB:"one",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},primitive:"points",frag:"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\nprecision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fill;\nvarying vec2 letter_pos;\nvarying float point_size;\n\nuniform float u_only_color;\nuniform float u_color_picker_mode;\n//uniform float u_use_glyphset;\n//uniform sampler2D u_glyphset;\n\nfloat delta = 0.0, alpha = 1.0;\n\nbool out_of_circle(in vec2 coord) {\n  vec2 cxy = 2.0 * coord - 1.0;\n  float r_sq = dot(cxy, cxy);\n  if (r_sq > 1.03) {return true;}\n  return false;\n}\n\nbool out_of_hollow_circle(in vec2 coord) {\n  vec2 cxy = 2.0 * coord - 1.0;\n  float r_sq = dot(cxy, cxy);\n  if (r_sq > 1.01) {return true;}\n  float distance_from_edge = (1.0 - r_sq) * point_size;\n  if (distance_from_edge > 4.0) {return true;}\n  return false;\n}\n\nbool out_of_triangle(in vec2 coord) {\n  if (coord.y > (2. * abs(coord.x - .5))) {\n    return false;\n  }\n  return true;\n}\n\nvoid main() {\n  if (u_only_color >= -1.5) {\n    gl_FragColor = vec4(0., 0., 0., 1./255.);\n    return;\n  }\n\n  float alpha = fill.a;\n//  if (u_use_glyphset == 0. || point_size < 5.0) {\n    if (out_of_circle(gl_PointCoord)) {\n      discard;\n      return;\n    }\n    vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n    float r = dot(cxy, cxy);\n    #ifdef GL_OES_standard_derivatives\n      delta = fwidth(r);\n      alpha *= (1.0 - smoothstep(1.0 - delta, 1.0 + delta, r));\n    #endif\n/*  } else {\n    vec2 coords = letter_pos + gl_PointCoord/8.;\n//    vec2 coords = vec2(.2, .2);\n    vec4 sprite = texture2D(u_glyphset, coords);\n    alpha *= (sprite.a);  \n//    fill = vec4(1.0, 1.0, 1.0, alpha);  \n    if (alpha <= 0.03) discard;\n  }*/\n  // Pre-blend the alpha channel.\n  if (u_color_picker_mode >= 1.) {\n    // no alpha when color picking; we use all four channels for that.\n    gl_FragColor = fill;\n  } else {\n    gl_FragColor = vec4(fill.rgb * alpha, alpha);\n  }\n\n}\n",vert:'precision mediump float;\n#define GLSLIFY 1\n\nuniform float u_zoom_balance;\nuniform float u_tile_id;\nuniform float u_update_time;\nuniform float u_transition_duration;\n\n// Type of jitter.\nuniform float u_jitter;\nuniform float u_last_jitter;\n\n// Whether to plot only a single category.\nuniform float u_only_color;\nuniform float u_grid_mode;\n\nuniform vec3 u_filter_numeric; // An override for simple numeric operations.\nuniform vec3 u_last_filter_numeric; // An override for simple numeric operations.\n\nuniform vec3 u_filter2_numeric; // An override for simple numeric operations.\nuniform vec3 u_last_filter2_numeric; // An override for simple numeric operations.\n\nuniform vec3 u_foreground_numeric; // An override for simple numeric operations.\nuniform vec3 u_last_foreground_numeric; // An override for simple numeric operations.\n\n// Transform from data space to the open window.\nuniform mat3 u_window_scale;\nuniform mat3 u_last_window_scale;\n// Transform from the open window to the d3-zoom.\nuniform mat3 u_zoom;\n\nuniform float u_width;\nuniform float u_height;\nuniform float u_use_glyphset;\nvarying vec2 letter_pos; // store which letter to use.\n\nuniform float u_maxix;           // The maximum index to plot.\nuniform float u_time;            // The current time.\nuniform float u_k;               // The d3-scale factor.\nuniform float u_color_picker_mode;\nuniform float u_base_size;\nuniform float u_alpha;\nuniform float u_foreground_number; // -1 -- everything is foreground; 0 -- background; 1 -- foreground.\nuniform vec4 u_background_rgba;\nuniform float u_foreground_alpha;\nuniform float u_background_mouseover;\nuniform float u_foreground_size;\nuniform float u_background_size;\n\nuniform sampler2D u_one_d_aesthetic_map;\nuniform sampler2D u_color_aesthetic_map;\n\n// The same set of items for a variety of aesthetics.\n\n// whether to continuously interpolate between\n// x0 and x, y0 and y.\nuniform float u_position_interpolation_mode;\n\nfloat a_color;\nfloat a_last_color;\n\nuniform float u_color_buffer_num;\nuniform float u_last_color_buffer_num;\n\nuniform vec3 u_color_constant;\nuniform vec3 u_last_color_constant;\n\nuniform float u_color_transform;\nuniform float u_last_color_transform;\nuniform vec2 u_color_domain;\nuniform vec2 u_last_color_domain;\nuniform float u_last_color_map_position;\nuniform float u_color_map_position;\n\nbool a_color_is_constant;\nbool a_last_color_is_constant;\n\n/*\npython code to generate what follows.\ndef autogenerate_code():\n  ks = ["x", "y", "jitter_radius", "jitter_speed", "size", "filter", "filter2", "x0", "y0", "foreground"]\n  times = ["", "last_"]\n  print("""\n  //  BEGIN AUTOGENERATED. DO NOT EDIT. \n  // ------------------------------------------------    \n  """)\n  for k in ks:\n    for time in times:\n      timek = time + k\n      print(f"""\n  uniform float u_{timek}_buffer_num;\n  uniform float u_{timek}_constant;\n  uniform float u_{timek}_transform;\n  uniform vec2 u_{timek}_domain;\n  uniform vec2 u_{timek}_range;\n  uniform float u_{timek}_map_position;\n  float a_{timek};\n  bool a_{timek}_is_constant;\n      """)\n  for i in range(0, 16):\n    print(f"attribute float buffer_{i};")\n  for k in ks:\n    for time in times:\n      timek = time + k\n      print(f"""\n    if (u_{timek}_buffer_num > -0.5) {{\n      a_{timek} = get_buffer(u_{timek}_buffer_num);\n      a_{timek}_is_constant = false;\n    }} else {{\n      a_{timek} = u_{timek}_constant;\n      a_{timek}_is_constant = true;\n    }}""")\n  print("""\n//  END AUTOGENERATED. DO NOT EDIT ABOVE. \n// ------------------------------------------------    \n  """)\n\nautogenerate_code()\n*/\n\n  //  BEGIN AUTOGENERATED. DO NOT EDIT. \n  // ------------------------------------------------    \n  \n\n  uniform float u_x_buffer_num;\n  uniform float u_x_constant;\n  uniform float u_x_transform;\n  uniform vec2 u_x_domain;\n  uniform vec2 u_x_range;\n  uniform float u_x_map_position;\n  float a_x;\n  bool a_x_is_constant;\n      \n\n  uniform float u_last_x_buffer_num;\n  uniform float u_last_x_constant;\n  uniform float u_last_x_transform;\n  uniform vec2 u_last_x_domain;\n  uniform vec2 u_last_x_range;\n  uniform float u_last_x_map_position;\n  float a_last_x;\n  bool a_last_x_is_constant;\n      \n\n  uniform float u_y_buffer_num;\n  uniform float u_y_constant;\n  uniform float u_y_transform;\n  uniform vec2 u_y_domain;\n  uniform vec2 u_y_range;\n  uniform float u_y_map_position;\n  float a_y;\n  bool a_y_is_constant;\n      \n\n  uniform float u_last_y_buffer_num;\n  uniform float u_last_y_constant;\n  uniform float u_last_y_transform;\n  uniform vec2 u_last_y_domain;\n  uniform vec2 u_last_y_range;\n  uniform float u_last_y_map_position;\n  float a_last_y;\n  bool a_last_y_is_constant;\n      \n\n  uniform float u_jitter_radius_buffer_num;\n  uniform float u_jitter_radius_constant;\n  uniform float u_jitter_radius_transform;\n  uniform vec2 u_jitter_radius_domain;\n  uniform vec2 u_jitter_radius_range;\n  uniform float u_jitter_radius_map_position;\n  float a_jitter_radius;\n  bool a_jitter_radius_is_constant;\n      \n\n  uniform float u_last_jitter_radius_buffer_num;\n  uniform float u_last_jitter_radius_constant;\n  uniform float u_last_jitter_radius_transform;\n  uniform vec2 u_last_jitter_radius_domain;\n  uniform vec2 u_last_jitter_radius_range;\n  uniform float u_last_jitter_radius_map_position;\n  float a_last_jitter_radius;\n  bool a_last_jitter_radius_is_constant;\n      \n\n  uniform float u_jitter_speed_buffer_num;\n  uniform float u_jitter_speed_constant;\n  uniform float u_jitter_speed_transform;\n  uniform vec2 u_jitter_speed_domain;\n  uniform vec2 u_jitter_speed_range;\n  uniform float u_jitter_speed_map_position;\n  float a_jitter_speed;\n  bool a_jitter_speed_is_constant;\n      \n\n  uniform float u_last_jitter_speed_buffer_num;\n  uniform float u_last_jitter_speed_constant;\n  uniform float u_last_jitter_speed_transform;\n  uniform vec2 u_last_jitter_speed_domain;\n  uniform vec2 u_last_jitter_speed_range;\n  uniform float u_last_jitter_speed_map_position;\n  float a_last_jitter_speed;\n  bool a_last_jitter_speed_is_constant;\n      \n\n  uniform float u_size_buffer_num;\n  uniform float u_size_constant;\n  uniform float u_size_transform;\n  uniform vec2 u_size_domain;\n  uniform vec2 u_size_range;\n  uniform float u_size_map_position;\n  float a_size;\n  bool a_size_is_constant;\n      \n\n  uniform float u_last_size_buffer_num;\n  uniform float u_last_size_constant;\n  uniform float u_last_size_transform;\n  uniform vec2 u_last_size_domain;\n  uniform vec2 u_last_size_range;\n  uniform float u_last_size_map_position;\n  float a_last_size;\n  bool a_last_size_is_constant;\n      \n\n  uniform float u_filter_buffer_num;\n  uniform float u_filter_constant;\n  uniform float u_filter_transform;\n  uniform vec2 u_filter_domain;\n  uniform vec2 u_filter_range;\n  uniform float u_filter_map_position;\n  float a_filter;\n  bool a_filter_is_constant;\n      \n\n  uniform float u_last_filter_buffer_num;\n  uniform float u_last_filter_constant;\n  uniform float u_last_filter_transform;\n  uniform vec2 u_last_filter_domain;\n  uniform vec2 u_last_filter_range;\n  uniform float u_last_filter_map_position;\n  float a_last_filter;\n  bool a_last_filter_is_constant;\n      \n\n  uniform float u_filter2_buffer_num;\n  uniform float u_filter2_constant;\n  uniform float u_filter2_transform;\n  uniform vec2 u_filter2_domain;\n  uniform vec2 u_filter2_range;\n  uniform float u_filter2_map_position;\n  float a_filter2;\n  bool a_filter2_is_constant;\n      \n\n  uniform float u_last_filter2_buffer_num;\n  uniform float u_last_filter2_constant;\n  uniform float u_last_filter2_transform;\n  uniform vec2 u_last_filter2_domain;\n  uniform vec2 u_last_filter2_range;\n  uniform float u_last_filter2_map_position;\n  float a_last_filter2;\n  bool a_last_filter2_is_constant;\n      \n\n  uniform float u_x0_buffer_num;\n  uniform float u_x0_constant;\n  uniform float u_x0_transform;\n  uniform vec2 u_x0_domain;\n  uniform vec2 u_x0_range;\n  uniform float u_x0_map_position;\n  float a_x0;\n  bool a_x0_is_constant;\n      \n\n  uniform float u_last_x0_buffer_num;\n  uniform float u_last_x0_constant;\n  uniform float u_last_x0_transform;\n  uniform vec2 u_last_x0_domain;\n  uniform vec2 u_last_x0_range;\n  uniform float u_last_x0_map_position;\n  float a_last_x0;\n  bool a_last_x0_is_constant;\n      \n\n  uniform float u_y0_buffer_num;\n  uniform float u_y0_constant;\n  uniform float u_y0_transform;\n  uniform vec2 u_y0_domain;\n  uniform vec2 u_y0_range;\n  uniform float u_y0_map_position;\n  float a_y0;\n  bool a_y0_is_constant;\n      \n\n  uniform float u_last_y0_buffer_num;\n  uniform float u_last_y0_constant;\n  uniform float u_last_y0_transform;\n  uniform vec2 u_last_y0_domain;\n  uniform vec2 u_last_y0_range;\n  uniform float u_last_y0_map_position;\n  float a_last_y0;\n  bool a_last_y0_is_constant;\n      \n\n  uniform float u_foreground_buffer_num;\n  uniform float u_foreground_constant;\n  uniform float u_foreground_transform;\n  uniform vec2 u_foreground_domain;\n  uniform vec2 u_foreground_range;\n  uniform float u_foreground_map_position;\n  float a_foreground;\n  bool a_foreground_is_constant;\n      \n\n  uniform float u_last_foreground_buffer_num;\n  uniform float u_last_foreground_constant;\n  uniform float u_last_foreground_transform;\n  uniform vec2 u_last_foreground_domain;\n  uniform vec2 u_last_foreground_range;\n  uniform float u_last_foreground_map_position;\n  float a_last_foreground;\n  bool a_last_foreground_is_constant;\n      \nattribute float buffer_0;\nattribute float buffer_1;\nattribute float buffer_2;\nattribute float buffer_3;\nattribute float buffer_4;\nattribute float buffer_5;\nattribute float buffer_6;\nattribute float buffer_7;\nattribute float buffer_8;\nattribute float buffer_9;\nattribute float buffer_10;\nattribute float buffer_11;\nattribute float buffer_12;\nattribute float buffer_13;\nattribute float buffer_14;\nattribute float buffer_15;\n\n//  END AUTOGENERATED. DO NOT EDIT ABOVE. \n// ------------------------------------------------    \n\nhighp float ix_to_random(in float ix, in float seed) {\n  // For high numbers, taking the log avoids coincidence.\n  highp float seed2 = log(ix + 2.) + 1.;\n  vec2 co = vec2(seed2, seed);\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float dt = dot(co.xy, vec2(a, b));\n  highp float sn = mod(dt, 3.14);\n  return fract(sin(sn) * c);\n}\n\n// The fill color.\nvarying vec4 fill;\nvarying float point_size;\n\nuniform float u_jitter_radius_lookup;\nuniform float u_jitter_radius_lookup_y_constant;\nuniform vec2 u_jitter_radius_lookup_x_domain;\nuniform vec2 u_jitter_radius_lookup_y_domain;\n\nfloat point_size_adjust;\n\n// A coordinate to throw away a vertex point.\nvec4 discard_me = vec4(100.0, 100.0, 1.0, 1.0);\n\n// Initialized in the main loop\n// mat3 from_coord_to_gl;\n\nconst float e = 1.618282;\n// I\'ve been convinced.\nconst float tau = 2. * 3.14159265359;\n\nfloat interpolate_raw(in float x, in float min, in float max) {\n  if (x < min) {return 0.;}\n  if (x > max) {return 1.;}\n  return (x - min)/(max - min);\n}\n\nfloat interpolate(in float x, in float min, in float max) {\n  if (max < min) {\n    return 1. - interpolate_raw(x, max, min);\n  } else {\n    return interpolate_raw(x, min, max);\n  }\n}\n\n/*\n\nThe following glsl code was written in python.\n\nbuffers = [*range(16)]\n\ndef write_buffs(buffs):\n    if len(buffs) == 1:\n        return[f"return buffer_{buffs[0]}"]\n    condition_1 = ["  " + line for line in write_buffs(buffs[:len(buffs)//2])]\n    condition_2 = ["" + line for line in write_buffs(buffs[len(buffs)//2:])]\n\n    args = [\n        f"if (i < {buffs[len(buffs) // 2 - 1]}.5) {{",\n        *condition_1,\n        "}",\n        *condition_2\n    ]\n    return args\n\nprint("\\n".join(write_buffs(buffers)))\n*/\n\nfloat get_buffer(in float i) {\n  //given an index, returns the appropriate buffer.\n  if (i < 7.5) {\n    if (i < 3.5) {\n      if (i < 1.5) {\n        if (i < 0.5) {\n          return buffer_0;\n        }\n        return buffer_1;\n      }\n      if (i < 2.5) {\n        return buffer_2;\n      }\n      return buffer_3;\n    }\n    if (i < 5.5) {\n      if (i < 4.5) {\n        return buffer_4;\n      }\n      return buffer_5;\n    }\n    if (i < 6.5) {\n      return buffer_6;\n    }\n    return buffer_7;\n  }\n  if (i < 11.5) {\n    if (i < 9.5) {\n      if (i < 8.5) {\n        return buffer_8;\n      }\n      return buffer_9;\n    }\n    if (i < 10.5) {\n      return buffer_10;\n    }\n    return buffer_11;\n  }\n  if (i < 13.5) {\n    if (i < 12.5) {\n      return buffer_12;\n    }\n    return buffer_13;\n  }\n  if (i < 14.5) {\n    return buffer_14;\n  }\n  return buffer_15;\n}\n\nfloat linstep(in vec2 range, in float x) {\n  return interpolate(x, range.x, range.y);\n  float scale_size = range.y - range.x;\n  float from_left = x - range.x;\n  return clamp(from_left / scale_size, 0.0, 1.0);\n}\n\nfloat linscale(in vec2 range, in float x) {\n  float scale_size = range.y - range.x;\n  float from_left = x - range.x;\n  return from_left / scale_size;\n}\n\nvec2 box_muller(in float ix, in float seed) {\n  // Box-Muller transform gives you two gaussian randoms for two uniforms.\n  highp float U = ix_to_random(ix, seed);\n  highp float V = ix_to_random(ix, seed + 17.123123);\n  return vec2(sqrt(-2. * log(U)) * cos(tau * V),\n              sqrt(-2. * log(U)) * sin(tau * V));\n}\n\n/*************** END COLOR SCALES *******************************/\n\nfloat domainify(in vec2 domain, in float transform, in float attr, in bool clamped) {\n\n  // Clamp an attribute into a domain, with an optional log or sqrt transform.\n  if (transform == 2.) {\n    domain = sqrt(domain);\n    attr = sqrt(attr);\n  }\n  if (transform == 3.) {\n    domain = log(domain);\n    attr = log(attr);\n  }\n  if (clamped) {\n    return linstep(domain, attr);\n  } else {\n    return linscale(domain, attr);\n  }\n}\n\nmat3 pixelspace_to_glspace;\n\nfloat run_numeric_filter (in float a_filter,\n  in float u_filter_op, in float u_filter_param_1,\n  in float u_filter_param_2) {\n  bool truthy;\n  if (u_filter_op < 1.5) {\n    truthy = a_filter < u_filter_param_1;\n  } else if (u_filter_op < 2.5) {\n    truthy = a_filter > u_filter_param_1;\n  } else if (u_filter_op < 3.5) {\n    truthy = a_filter == u_filter_param_1;\n  } else if (u_filter_op < 4.5) {\n    truthy = abs(a_filter - u_filter_param_2) < u_filter_param_1;\n  }\n  if (truthy) {return 1.;} else {return 0.;}\n}\n\nfloat choose_and_run_filter(\n  in vec3 u_filter_numeric,\n  in float a_filter,\n  in float map_location,\n  in bool filter_is_constant\n  ) {\n    if (filter_is_constant) {\n      return 1.;\n    }\n    if (u_filter_numeric.r < 0.5) {\n      // Must be on a dictionary. Unreasonable assumption, maybe?\n      float frac_filter = linstep(vec2(-2047., 2047), a_filter);\n      float map_coords = (map_location + .5) / 32.;\n      return texture2D(u_one_d_aesthetic_map, vec2(map_coords, frac_filter)).a;\n    } else {\n      return run_numeric_filter(a_filter,\n        u_filter_numeric.r, u_filter_numeric.g, u_filter_numeric.b);\n    }\n}\n\nconst float tau_0 = 2. * 3.14159265359;\n\nhighp float ix_to_random_1540259130(in float ix, in float seed) {\n  // For high numbers, taking the log avoids coincidence.\n  highp float seed2 = log(ix) + 1.;\n  vec2 co = vec2(seed2, seed);\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float dt= dot(co.xy ,vec2(a,b));\n  highp float sn= mod(dt,3.14);\n  return fract(sin(sn) * c);\n}\n\nhighp vec2 box_muller_1540259130(in float ix, in float seed) {\n  // Box-Muller transform gives you two gaussian randoms for two uniforms.\n  highp float U = ix_to_random_1540259130(ix, seed);\n  highp float V = ix_to_random_1540259130(ix, seed + 17.123123);\n  return vec2(\n    sqrt(-2.*log(U))*cos(tau_0*V),\n    sqrt(-2.*log(U))*sin(tau_0*V)\n  );\n}\n\nvec2 logarithmic_spiral_jitter_1540259130(\n  in float ix, // a random seed.\n  in float a, // offset\n  in float angle_parameter_1540259130, // angle parameter\n  in float randomize_angle_1540259130, // sd radians\n  in float max_r_1540259130, // Maximum radius of spiral.\n  in float randomize_rotation_max_radians_1540259130, // in standard deviations to the log-multiplier.\n  in float randomize_radius_1540259130, // in standard deviation percentage points.\n  in float hole, // donut hole size.\n  in float speed_0, // webgl units per second.\n  in float time_0,// The time, in seconds, to plot at. Generally passed as a uniform or something.\n  in float acceleration,\n  in float n_spirals_1540259130,\n  in float shear,\n  in float aspect_ratio_1540259130\n  ) {\n  // Each point starts at a different place on the spiral.\n  vec2 two_gaussians_1540259130 = box_muller_1540259130(ix, 55.1);\n\n  highp float calculated_angle = angle_parameter_1540259130 + two_gaussians_1540259130.x * randomize_angle_1540259130;\n  float k = 1. / tan(calculated_angle);\n  if (k > 100000.) {\n    k = 0.;\n  }\n\n  // The length of the segment to be traversed.\n  float arc_length =  sqrt((1. + k*k)/k) * (max_r_1540259130 - a);\n  float period = arc_length / speed_0;\n\n  // Every point needs to start at a different place along the curve.\n  float stagger_time = ix_to_random_1540259130(ix, 3.);\n\n  // How long does a circuit take? Add some random noise.\n  float time_period = period * exp(box_muller_1540259130(ix, 0.031).x / 6.);\n\n  // Adjust u_time from the clock to our current spot.\n  float varying_time = time_0 + stagger_time * time_period;\n\n  // Adjust that time by raising to a power to set the speed along the curve.\n  // Not sure if this is the soundest way to parametrize.\n  float relative_time = pow(1. - mod(varying_time, time_period)/time_period, acceleration);\n\n  // Calculate the radius at this time point.\n  float radius = max_r_1540259130 * relative_time + a;\n\n  // The angle implied by that radius.\n  float theta  = 1./k * log(radius / a);\n\n  /* A different way to calculate radius from the theta. Not used\n  float max_theta = 1. / k * log(max_r / a);\n  float theta2 = max_theta * relative_time;\n  vec2 pos_theta_style = vec2(a * exp(k * theta2), theta2);\n  radius = pos_theta_style.x;\n  theta = pos_theta_style.y;\n  */\n\n  // If multiple spirals, the theta needs to be rotated for which spiral we\'re in.\n  // Choose it based on a new random seed.\n  float which_spiral = floor(ix_to_random_1540259130(ix, 13.13) * n_spirals_1540259130);\n  float which_spiral_adjust = which_spiral / n_spirals_1540259130 * tau_0;\n  theta = theta + which_spiral_adjust;\n\n  // Add some gaussian jitter to the polar coordinates.\n  vec2 polar_jitter = box_muller_1540259130(ix, 24.);\n\n  highp float radius_adjust = 1. + polar_jitter.x * randomize_radius_1540259130;\n  highp float theta_adjust = polar_jitter.y * randomize_rotation_max_radians_1540259130;\n\n  vec2 shear_adjust = box_muller_1540259130(ix, 59.1) * shear;\n\n  mat3 shear_mat = mat3(\n    1., shear_adjust.x, 0.,\n    shear_adjust.y, 1., 0.,\n    0., 0., 1.);\n  // into euclidean space.\n  vec3 pos_spiral = vec3(\n   cos(theta + theta_adjust)*(radius * radius_adjust + hole),\n   sin(theta + theta_adjust)*(radius * radius_adjust + hole),\n   0.\n  );\n  mat3 adjust_to_viewport =\n         mat3(\n            1./aspect_ratio_1540259130, 0., 0.,\n            0., 1., 0.,\n            0., 0., 1.);\n\n  pos_spiral = pos_spiral * shear_mat * \n               adjust_to_viewport;\n  return pos_spiral.xy;\n}\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1604150559(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\n#ifndef PI\n#define PI 3.141592653589793\n#endif\n\nfloat sineInOut_0(float t) {\n  return -0.5 * (cos(PI * t) - 1.0);\n}\n\n#ifndef PI\n#define PI 3.141592653589793\n#endif\n\nvec2 bezier_interpolate(vec2 p1, vec2 p2, float frac, float ix) {\n  // Interpolates between two points on a Bezier curve around a jittered middle.\n  // Makes animations look cooler.\n    vec2 midpoint = box_muller(ix, 3.) * .05 *\n         dot(p2 - p1, p2 - p1)\n         + p2 / 2. + p1 / 2.;\n\n      return mix(\n        mix(p2, midpoint, frac),\n        mix(midpoint, p1, frac),\n      frac);\n}\n\nfloat sineInOut(float t) {\n  return -0.5 * (cos(PI * t) - 1.0);\n}\n\nconst vec4 decoder = vec4(1./256./256./256., 1. / 256. / 256., 1. / 256., 1.);\n\nfloat RGBAtoFloat(in vec4 floater) {\n  // Scale values up by 256.\n  return dot(floater, decoder);\n}\n\nfloat texture_float_lookup(in vec2 domain,\n                           in vec2 range,\n                           in float transform,\n                           in float attr,\n                           in float texture_position) {\n  if (transform == 4.0) {\n    // Literal transforms aren\'t looked up, just returned as is.\n    return attr;\n  }\n  float inrange = domainify(domain, transform, attr, true);\n  if (texture_position > 0.5) {\n    float y_pos = texture_position / 32. - 0.5 / 32.;\n    vec4 encoded = texture2D(u_one_d_aesthetic_map, vec2(y_pos, inrange));\n    return encoded.a;\n    return RGBAtoFloat(encoded); // unreachable.\n  } else {\n    return mix(range.x, range.y, inrange);\n  }\n}\n\nvec2 calculate_position(in vec2 position, in float x_scale_type,\n                        in vec2 x_domain, in vec2 x_range, in float y_scale_type,\n                        in vec2 y_domain, in vec2 y_range, in mat3 window_scale,\n                        in mat3 zoom, in float x_map_position,\n                        in float y_map_position\n                        ) {\n    float x;\n    float y;\n\n    if (x_scale_type < 4.0) {\n      float x_ = linscale(u_color_domain, a_color);\n      x = texture_float_lookup(x_domain, x_range,\n        x_scale_type,\n        position.x, 0. // ymap position 0 means never use a texture lookup.\n        );\n    } else {\n      x = position.x;\n    }\n\n    if (y_scale_type < 4.0) {\n      y = texture_float_lookup(y_domain, y_range, y_scale_type,\n        position.y, 0. // ymap position 0 means never use a texture lookup.\n        );\n    } else {\n      y = position.y;\n    }\n    vec3 pos2d = vec3(x, y, 1.0) * window_scale * zoom * pixelspace_to_glspace;\n    return pos2d.xy;\n}\n\nfloat cubicInOut(float t) {\n  return t < 0.5\n    ? 4.0 * t * t * t\n    : 1. - 4.0 * pow(1. - t, 3.0);\n}\n\nvec4 ixToRGBA(in float ix)  {\n  float min = fract(ix / 256.);\n  float mid = fract((ix - min) / 256.);\n  float high = fract((ix - min - mid * 256.) / (256.) / 256.);\n  return vec4(min, mid, high, 1.);\n}\n\nvec2 circle_jitter(in float ix, in float aspect_ratio, in float time,\n                   in float radius, in float speed) {\n  vec2 two_gaussians = box_muller(ix, 12.);\n\n  float stagger_time = two_gaussians.y * tau;\n\n  // How long does a circuit take?\n\n  float units_per_period = radius * tau;\n  float units_per_second = speed;\n  float seconds_per_period = units_per_period / units_per_second;\n  float time_period = seconds_per_period;\n  if (time_period > 1e4) {\n    return vec2(0., 0.);\n  }\n\n  // Adjust time from the clock to our current spot.\n  float varying_time = time + stagger_time * time_period;\n  // Where are we from 0 to 1 relative to the time period\n\n  float relative_time = 1. - mod(varying_time, time_period) / time_period;\n\n  float theta = relative_time * tau;\n  // Problem--should it lie on a disk, or on a circle?\n  float r_mult = 1.;//(sqrt(ix_to_random(ix, 7.)));\n\n  return vec2(cos(theta) * r_mult, aspect_ratio * sin(theta) * r_mult) *\n         radius;\n}\n\nvec2 calculate_jitter(\n  in float jitter_type,\n  in float ix, // distinguishing index\n  in vec2 jitter_radius_domain,\n  in vec2 jitter_radius_range,\n  in float jitter_radius_transform,\n  in float jitter_radius,\n  in float jitter_radius_map_position,\n  in bool jitter_radius_is_constant,\n  in vec2 jitter_speed_domain,\n  in vec2 jitter_speed_range,\n  in float jitter_speed_transform,\n  in float jitter_speed,\n  in float jitter_speed_map_position,\n  in bool jitter_speed_is_constant\n) {\n\n  // Jitter is calculated based on speed, so requires two full maps in.\n  if (jitter_type == 0.) {\n    // No jitter\n    return vec2(0., 0.);\n  }\n\n  if (jitter_type == 5.) {\n    // Temporal jitter--should be broken out into a separate channel/channels.\n    float time_period = 60.;\n    float share = 1./4.;\n    float offset = ix_to_random(ix, 12.);\n    float fractional = fract((offset * time_period + u_time)/time_period);\n    if (fractional > share) {\n      return vec2(0., 0.);\n    }\n    float size = 0.5 * (1. - cos(2. * 3.1415926 * min(fractional/share, 1. - fractional/share)));\n    size = clamp(size, 0., 1.);\n    return vec2(size, 0.);\n  }\n  float jitter_r;  \n  if (jitter_radius_is_constant) {\n    jitter_r = jitter_radius;\n  } else {\n    jitter_r = texture_float_lookup(\n    jitter_radius_domain,\n    jitter_radius_range,\n    jitter_radius_transform,\n    jitter_radius,\n    0.);\n  }\n  if (jitter_type == 3.) {\n    float r = box_muller(ix, 1.).r * jitter_r;\n    r = r * point_size_adjust;\n    float theta = ix_to_random(ix, 15.) * tau;\n    return vec2(cos(theta) * r, sin(theta) * r * u_width / u_height);\n  }\n\n  if (jitter_type == 2.) {\n    // uniform in the circle.\n    float theta = ix_to_random(ix, 15.) * tau;\n    float r = jitter_r * sqrt(ix_to_random(ix, 115.));\n    r = r * point_size_adjust;\n    return vec2(cos(theta) * r, sin(theta) * r * u_width / u_height);\n  }\n\n  /* Jittering that includes motion) */\n\n  float p_jitter_speed =\n      texture_float_lookup(jitter_speed_domain,\n                          jitter_speed_range,\n                          jitter_speed_transform, jitter_speed,\n                          jitter_speed_map_position);\n\n  if (jitter_type == 1.) {\n    return logarithmic_spiral_jitter_1540259130(\n                ix,\n                0.005 * jitter_r,                     // a\n                1.3302036,                       // angle parameter\n                0.005,                                 // angle random\n                jitter_r,                             // max radius\n                0.03,                                 // random_rotation\n                0.06,                                 // random radius\n                0.003 * point_size_adjust * jitter_r, // donut.\n                .5 * p_jitter_speed * jitter_r / point_size_adjust, // speed\n                u_time,                                           // time\n                0.8,                                              // acceleration\n                2.0,                                              // n_spirals\n                .09, //shear\n                u_width/u_height         // shear\n            );\n  }\n\n  if (jitter_type == 4.) {\n    // circle\n    return circle_jitter(ix, u_width/u_height, u_time, jitter_r, p_jitter_speed);\n  }\n}\n\nvoid run_color_fill(in float ease) {\n  float alpha = min(u_alpha, 1.0);\n  if (u_only_color >= -1.5) {\n    if (u_only_color > -.5 && a_color != u_only_color) {\n      gl_Position = discard_me;\n      return;\n    } else {\n      // -1 is a special value meaning \'plot everything\'.\n      fill = vec4(0., 0., 0., 1. / 255.);\n      gl_PointSize = 1.;\n    }\n  } else {\n    if (a_color_is_constant) {\n      fill = vec4(u_color_constant.rgb, alpha);\n    } else {\n      float fractional_color = linstep(u_color_domain, a_color);\n      float color_pos = (u_color_map_position * -1. - 1.) / 32. + 0.5 / 32.;\n      fractional_color = domainify(u_color_domain, u_color_transform, a_color, true);\n      fill = texture2D(u_color_aesthetic_map , vec2(color_pos, fractional_color));\n      fill = vec4(fill.rgb, alpha);\n    }\n    if (ease < 1.) {\n      vec4 last_fill;\n      if (a_last_color_is_constant) {\n        last_fill = vec4(u_last_color_constant.rgb, alpha);\n      } else {\n        float last_fractional = linstep(u_last_color_domain, a_last_color);\n        float color_pos = (u_last_color_map_position * -1. - 1.) / 32. + 0.5 / 32.;\n        last_fractional = domainify(u_last_color_domain, u_last_color_transform, a_last_color, true);\n        last_fill = texture2D(u_color_aesthetic_map, vec2(color_pos, last_fractional));\n        // Alpha channel interpolation already happened.\n        last_fill = vec4(last_fill.rgb, alpha);\n      }\n      // RGB blending is bad--maybe use https://www.shadertoy.com/view/lsdGzN\n      // instead?\n      fill = mix(last_fill, fill, ease);\n    }\n  }\n}\n\nvec2 calc_and_interpolate_positions(\n  inout vec2 old_position,\n  in float u_last_x_transform,\n  in vec2 u_last_x_domain,\n  in vec2 u_last_x_range,\n  in float u_last_y_transform,\n  in vec2 u_last_y_domain,\n  in vec2 u_last_y_range,\n  in mat3 u_last_window_scale,\n  in mat3 u_zoom,\n  in float u_last_x_map_position,\n  in float u_last_y_map_position,\n  inout vec2 position,\n  in float u_x_transform,\n  in vec2 u_x_domain,\n  in vec2 u_x_range,\n  in float u_y_transform,\n  in vec2 u_y_domain,\n  in vec2 u_y_range,\n  in mat3 u_window_scale,\n  in float u_x_map_position,\n  in float u_y_map_position,\n  in float interpolation,\n  in float u_grid_mode, \n  in float ix) {\n\n  old_position = calculate_position(old_position, u_last_x_transform,\n    u_last_x_domain, u_last_x_range,\n    u_last_y_transform, u_last_y_domain, u_last_y_range,\n    u_last_window_scale,\n    u_zoom, u_last_x_map_position,      \n    u_last_y_map_position);\n    \n  bool plot_actual_position = u_grid_mode < .5;\n\n  if (plot_actual_position) {\n    position = calculate_position(position, \n      u_x_transform,\n      u_x_domain, u_x_range,\n      u_y_transform, u_y_domain, \n      u_y_range, u_window_scale, u_zoom, \n      u_x_map_position, u_y_map_position);\n    float xpos = clamp((1. + position.x) / 2., 0., 1.);\n    float randy = ix_to_random(ix, 13.76);\n    float delay = xpos + randy * .1;\n    delay = delay * 3.;\n\n    float frac = interpolate(\n      u_update_time,\n      delay,\n      u_transition_duration + delay\n    );\n\n    frac = sineInOut_0(frac);\n\n    if (frac <= 0.) {\n      position = old_position;\n    } else if (frac < 1.) {\n      frac = fract(frac);\n      position = bezier_interpolate(position, old_position, frac, ix);\n    }\n  } else {\n    position.x = -1. + 2. * linscale(u_x_domain, position.x);\n    //position.y = -1.0;\n    vec2 jitterspec = vec2(\n      (ix_to_random(ix, 3.) * a_jitter_radius ) * 2.,\n      (ix_to_random(ix, 1.5) * a_jitter_speed ) * 2.\n    );\n    position = position + jitterspec;\n  }\n  return position;\n}\n\nvoid main() {\n  float debug_mode = 0.;\n  float ix = buffer_0;\n  float ix_in_tile = buffer_1;\n  if (ix > u_maxix) {\n    // throw away points that are too low.\n    gl_Position = discard_me;\n    return;\n  }\n\n  if (debug_mode > 1.5) {\n    // Debug mode.\n    gl_PointSize = 2.;\n    gl_Position = vec4(box_muller(ix, 2.).xy * .33, 0., 1.);\n    return;\n  }\n\n // Autogenerated below this point\n\n    if (u_x_buffer_num > -0.5) {\n      a_x = get_buffer(u_x_buffer_num);\n      a_x_is_constant = false;\n    } else {\n      a_x = u_x_constant;\n      a_x_is_constant = true;\n    }\n\n    if (u_last_x_buffer_num > -0.5) {\n      a_last_x = get_buffer(u_last_x_buffer_num);\n      a_last_x_is_constant = false;\n    } else {\n      a_last_x = u_last_x_constant;\n      a_last_x_is_constant = true;\n    }\n\n    if (u_y_buffer_num > -0.5) {\n      a_y = get_buffer(u_y_buffer_num);\n      a_y_is_constant = false;\n    } else {\n      a_y = u_y_constant;\n      a_y_is_constant = true;\n    }\n\n    if (u_last_y_buffer_num > -0.5) {\n      a_last_y = get_buffer(u_last_y_buffer_num);\n      a_last_y_is_constant = false;\n    } else {\n      a_last_y = u_last_y_constant;\n      a_last_y_is_constant = true;\n    }\n\n    if (u_jitter_radius_buffer_num > -0.5) {\n      a_jitter_radius = get_buffer(u_jitter_radius_buffer_num);\n      a_jitter_radius_is_constant = false;\n    } else {\n      a_jitter_radius = u_jitter_radius_constant;\n      a_jitter_radius_is_constant = true;\n    }\n\n    if (u_last_jitter_radius_buffer_num > -0.5) {\n      a_last_jitter_radius = get_buffer(u_last_jitter_radius_buffer_num);\n      a_last_jitter_radius_is_constant = false;\n    } else {\n      a_last_jitter_radius = u_last_jitter_radius_constant;\n      a_last_jitter_radius_is_constant = true;\n    }\n\n    if (u_jitter_speed_buffer_num > -0.5) {\n      a_jitter_speed = get_buffer(u_jitter_speed_buffer_num);\n      a_jitter_speed_is_constant = false;\n    } else {\n      a_jitter_speed = u_jitter_speed_constant;\n      a_jitter_speed_is_constant = true;\n    }\n\n    if (u_last_jitter_speed_buffer_num > -0.5) {\n      a_last_jitter_speed = get_buffer(u_last_jitter_speed_buffer_num);\n      a_last_jitter_speed_is_constant = false;\n    } else {\n      a_last_jitter_speed = u_last_jitter_speed_constant;\n      a_last_jitter_speed_is_constant = true;\n    }\n\n    if (u_size_buffer_num > -0.5) {\n      a_size = get_buffer(u_size_buffer_num);\n      a_size_is_constant = false;\n    } else {\n      a_size = u_size_constant;\n      a_size_is_constant = true;\n    }\n\n    if (u_last_size_buffer_num > -0.5) {\n      a_last_size = get_buffer(u_last_size_buffer_num);\n      a_last_size_is_constant = false;\n    } else {\n      a_last_size = u_last_size_constant;\n      a_last_size_is_constant = true;\n    }\n\n    if (u_filter_buffer_num > -0.5) {\n      a_filter = get_buffer(u_filter_buffer_num);\n      a_filter_is_constant = false;\n    } else {\n      a_filter = u_filter_constant;\n      a_filter_is_constant = true;\n    }\n\n    if (u_last_filter_buffer_num > -0.5) {\n      a_last_filter = get_buffer(u_last_filter_buffer_num);\n      a_last_filter_is_constant = false;\n    } else {\n      a_last_filter = u_last_filter_constant;\n      a_last_filter_is_constant = true;\n    }\n\n    if (u_filter2_buffer_num > -0.5) {\n      a_filter2 = get_buffer(u_filter2_buffer_num);\n      a_filter2_is_constant = false;\n    } else {\n      a_filter2 = u_filter2_constant;\n      a_filter2_is_constant = true;\n    }\n\n    if (u_last_filter2_buffer_num > -0.5) {\n      a_last_filter2 = get_buffer(u_last_filter2_buffer_num);\n      a_last_filter2_is_constant = false;\n    } else {\n      a_last_filter2 = u_last_filter2_constant;\n      a_last_filter2_is_constant = true;\n    }\n\n    if (u_x0_buffer_num > -0.5) {\n      a_x0 = get_buffer(u_x0_buffer_num);\n      a_x0_is_constant = false;\n    } else {\n      a_x0 = u_x0_constant;\n      a_x0_is_constant = true;\n    }\n\n    if (u_last_x0_buffer_num > -0.5) {\n      a_last_x0 = get_buffer(u_last_x0_buffer_num);\n      a_last_x0_is_constant = false;\n    } else {\n      a_last_x0 = u_last_x0_constant;\n      a_last_x0_is_constant = true;\n    }\n\n    if (u_y0_buffer_num > -0.5) {\n      a_y0 = get_buffer(u_y0_buffer_num);\n      a_y0_is_constant = false;\n    } else {\n      a_y0 = u_y0_constant;\n      a_y0_is_constant = true;\n    }\n\n    if (u_last_y0_buffer_num > -0.5) {\n      a_last_y0 = get_buffer(u_last_y0_buffer_num);\n      a_last_y0_is_constant = false;\n    } else {\n      a_last_y0 = u_last_y0_constant;\n      a_last_y0_is_constant = true;\n    }\n\n    if (u_foreground_buffer_num > -0.5) {\n      a_foreground = get_buffer(u_foreground_buffer_num);\n      a_foreground_is_constant = false;\n    } else {\n      a_foreground = u_foreground_constant;\n      a_foreground_is_constant = true;\n    }\n\n    if (u_last_foreground_buffer_num > -0.5) {\n      a_last_foreground = get_buffer(u_last_foreground_buffer_num);\n      a_last_foreground_is_constant = false;\n    } else {\n      a_last_foreground = u_last_foreground_constant;\n      a_last_foreground_is_constant = true;\n    }\n\n//  END AUTOGENERATED. DO NOT EDIT ABOVE. \n// ------------------------------------------------    \n  gl_PointSize = 1.;\n\n  if (u_color_buffer_num > -0.5) {\n    a_color = get_buffer(u_color_buffer_num);\n    a_color_is_constant = false;\n  } else {\n    a_color = ix;\n    a_color_is_constant = true;\n  }\n\n  if (u_last_color_buffer_num > -0.5) {\n    a_last_color = get_buffer(u_last_color_buffer_num);\n    a_last_color_is_constant = false;\n  } else {\n    a_last_color = ix;\n    a_last_color_is_constant = true;\n  }\n\n  pixelspace_to_glspace = mat3(\n      2. / u_width, 0., -1.,\n      0., - 2. / u_height, 1.,\n      0., 0., 1.\n  );\n\n  float interpolation =\n    interpolate(u_update_time, 0., u_transition_duration);\n    \n  float ease = interpolation;\n\n  // I set this sometimes.\n\n  vec2 position = vec2(a_x, a_y);\n  vec2 old_position = vec2(a_last_x, a_last_y);\n\n  position = calc_and_interpolate_positions(\n    old_position,\n    u_last_x_transform,\n    u_last_x_domain, u_last_x_range,\n    u_last_y_transform,\n    u_last_y_domain, u_last_y_range,\n    u_last_window_scale,\n    u_zoom,\n    u_last_x_map_position,\n    u_last_y_map_position,\n    position,\n    u_x_transform,\n    u_x_domain, u_x_range,\n    u_y_transform,\n    u_y_domain, u_y_range,\n    u_window_scale,\n    u_x_map_position,\n    u_y_map_position,\n    interpolation,\n    u_grid_mode,\n    ix\n  );\n\n  if (u_x0_buffer_num > 0.) {\n    vec2 position0 = vec2(a_x0, a_y0);\n    vec2 old_position0 = vec2(a_last_x0, a_last_y0);\n\n    position0 = calc_and_interpolate_positions(\n      old_position0,\n      u_last_x0_transform,\n      u_last_x0_domain, u_last_x0_range,\n      u_last_y0_transform,\n      u_last_y0_domain, u_last_y0_range,\n      u_last_window_scale,\n      u_zoom,\n      u_last_x0_map_position,\n      u_last_y0_map_position,\n      position0,\n      u_x0_transform,\n      u_x0_domain, u_x0_range,\n      u_y0_transform,\n      u_y0_domain, u_y0_range,\n      u_window_scale,\n      u_x0_map_position,\n      u_y0_map_position,\n      interpolation,\n      u_grid_mode,\n      ix\n    );\n\n    if (u_position_interpolation_mode > 0.) {\n      float rand2 = ix_to_random(ix, 11.76);\n\n      // If it\'s a continuous loop, just choose a random point along that loop.\n      float rand_offset = fract(u_update_time/u_transition_duration / 10. + rand2);\n      position = mix(position0, position, rand_offset);\n    }\n  }\n\n  bool plot_actual_position = u_grid_mode < .5;\n\n  if (u_position_interpolation_mode > 0.) {\n    float rand2 = ix_to_random(ix, 11.76);\n\n    // If it\'s a continuous loop, just choose a random point along that loop.\n    float rand_offset = fract(u_update_time/u_transition_duration + rand2);\n    \n  }\n\n/*  position = vec2(\n    ix_to_random(ix, .1),\n    ix_to_random(ix, .2)\n  );*/\n  /* FILTERING */\n\n  float filter_status = choose_and_run_filter(\n    u_filter_numeric,\n    a_filter,\n    u_filter_map_position,\n    a_filter_is_constant\n  );\n\n  float last_filter_status = choose_and_run_filter(\n    u_last_filter_numeric,\n    a_last_filter,\n    u_last_filter_map_position,\n    a_last_filter_is_constant\n  );\n\n  float filter2_status = choose_and_run_filter(\n    u_filter2_numeric,\n    a_filter2,\n    u_filter2_map_position,\n    a_filter2_is_constant\n  );\n\n  float last_filter2_status = choose_and_run_filter(\n    u_last_filter2_numeric,\n    a_last_filter2,\n    u_last_filter2_map_position,\n    a_last_filter2_is_constant\n  );\n\n  float foreground_status = choose_and_run_filter(\n    u_foreground_numeric,\n    a_foreground,\n    u_foreground_map_position,\n    a_foreground_is_constant\n  );\n\n  float last_foreground_status = choose_and_run_filter(\n    u_last_foreground_numeric,\n    a_last_foreground,\n    u_last_foreground_map_position,\n    a_last_foreground_is_constant\n  );\n  float fg_ease = mix(last_foreground_status, foreground_status, ease);\n  if (ease < ix_to_random(ix, 1.)) {\n    foreground_status = last_foreground_status;\n  }\n\n  /*if (a_foreground_is_constant) {\n    foreground_status = 1.;\n  }*/\n\n  bool was_filtered = last_filter2_status < .5 || last_filter_status < .5;\n  bool will_be_filtered = filter2_status < .5 || filter_status < .5;\n\n  bool overall_filter_status = will_be_filtered;\n\n  if (ease < ix_to_random(ix, 1.)) {\n    overall_filter_status = was_filtered;\n  }\n\n  if (overall_filter_status == true) {\n    gl_Position = discard_me;\n    return;\n  }\n\n  float size_multiplier = texture_float_lookup(\n    u_size_domain,\n    u_size_range,\n    u_size_transform, a_size,\n    u_size_map_position);\n\n  float last_size_multiplier = texture_float_lookup(\n    u_last_size_domain, u_last_size_range, u_last_size_transform, a_last_size,\n    u_last_size_map_position);\n\n  size_multiplier = u_base_size * \n     mix(last_size_multiplier, size_multiplier, ease);\n  \n  float depth_size_adjust = (1.0 - ix / (u_maxix));\n\n  // It\'s ugly on new macs when it jumps straight from one to two for a bunch of points at once.\n  float size_fuzz = exp(ix_to_random(ix, 3.1) * .5 - .25);\n\n  point_size_adjust = exp(log(u_k) * u_zoom_balance) * size_fuzz;// * depth_size_adjust;\n//  point_size_adjust = exp(log(u_k) * u_zoom_balance);\n  gl_PointSize = point_size_adjust * size_multiplier;\n  if (gl_PointSize <= 0.01) {\n    gl_Position = discard_me;\n    return;\n  }\n  vec2 jitter = vec2(0., 0.);\n//  \n\n  if (plot_actual_position && (u_jitter > 0. || u_last_jitter > 0.)) {\n    /* JITTER */\n    jitter = vec2(ix_to_random(ix, 2. + u_time), ix_to_random(ix, 3. + u_time)) * .01;\n    float jitter_radius_fraction;\n      jitter = calculate_jitter(\n        u_jitter, ix,\n        u_jitter_radius_domain,        u_jitter_radius_range,\n        u_jitter_radius_transform,        a_jitter_radius,\n        u_jitter_radius_map_position,        a_jitter_radius_is_constant,\n        u_jitter_speed_domain,\n        u_jitter_speed_range,\n        u_jitter_speed_transform, a_jitter_speed,\n        u_jitter_speed_map_position, a_jitter_speed_is_constant\n      );\n    vec2 last_jitter;\n    if (ease < 1.) {\n      last_jitter = calculate_jitter(\n        u_last_jitter, ix,\n        u_last_jitter_radius_domain,       \n        u_last_jitter_radius_range,\n        u_last_jitter_radius_transform,        \n        a_last_jitter_radius,\n        u_last_jitter_radius_map_position,\n        a_last_jitter_radius_is_constant,\n        u_last_jitter_speed_domain,\n        u_last_jitter_speed_range,\n        u_last_jitter_speed_transform,\n        a_last_jitter_speed,\n        u_last_jitter_speed_map_position,\n        a_last_jitter_speed_is_constant\n      );\n      jitter = mix(last_jitter, jitter, ease);\n    }\n    if (u_jitter == 5.) {\n      // temporal jitter: rescale the point from the first dimension\n      gl_PointSize *= jitter.x;\n      jitter = vec2(0., 0.);\n      if (gl_PointSize < 0.05) {\n        gl_Position = discard_me;\n        return;\n      }\n    }\n    gl_Position = vec4(position + jitter, 0., 1.);\n  } else {\n    gl_Position = vec4(position + jitter, 0., 1.);\n  }  \n  if (u_color_picker_mode == 1.) {\n    // Add one so the first element is distinguishable.\n    fill = encode_float_1604150559(ix + 1.);\n  } else if (u_color_picker_mode == 2.) {\n    fill = encode_float_1604150559(u_tile_id + 1.);\n  } else if (u_color_picker_mode == 3.) {\n    fill = encode_float_1604150559(ix_in_tile + 1.);\n  } else {\n    run_color_fill(ease);\n  }\n\n  // Are we in a mode where we need to plot foreground and background?\n  if (u_foreground_number > -1.) {\n    // In that case, throw away points from the other half of the set.\n    if (u_foreground_number != foreground_status) {\n      gl_Position = discard_me;\n      return;\n    }\n    if (u_foreground_number == 1.) {\n      gl_PointSize *= u_foreground_size;\n      fill = vec4(fill.rgb, min(1., fill.a * u_foreground_alpha));\n    }\n    // If we\'re in background mode, got to change the points a bit.\n    if (u_foreground_number == 0.) { \n      gl_PointSize *= u_background_size;\n      // Should the color piker run?\n      if (u_color_picker_mode >= 1.) {\n        if (u_background_mouseover == 1.) {\n          // pass--keep the colors as are.\n        } else {\n          gl_Position = discard_me;\n          return;\n        }\n      } else {\n       float alpha = min(u_alpha * u_background_rgba.a, 1.);\n        if (alpha < 1./255.) {\n          // Very light alphas must be quantized. Only show an appropriate sample.\n          float seed = ix_to_random(ix, 38.6);\n          if (alpha * 255. < seed) {\n            gl_Position = discard_me;\n            return;\n          } else {\n            alpha = 1. / 255.;\n          }\n        }\n        fill = vec4(u_background_rgba.rgb, alpha);\n      }\n    }\n  }\n    \n  point_size = gl_PointSize;\n\n/*  if (u_use_glyphset > 0. && point_size > 5.0) {\n    float random_letter = floor(64. * ix_to_random(ix, 1.3));\n    letter_pos = vec2(\n      // start at a number between 0 and 7.\n      mod(random_letter, 8.) / 8.,\n      floor(random_letter / 8.) / 8.\n    );\n    gl_PointSize *= 3.0;\n  }*/\n}\n',count:(t,e)=>e.manager.count,attributes:{},uniforms:{u_update_time:t.prop("update_time"),u_transition_duration:(t,e)=>e.prefs.duration,u_only_color:(t,e)=>void 0!==e.only_color?e.only_color:-2,u_use_glyphset:(t,{prefs:e})=>e.glyph_set?1:0,u_glyphset:(t,{prefs:e})=>e.glyph_set?this.get_image_texture(e.glyph_set):this.textures.empty_texture,u_color_picker_mode:t.prop("color_picker_mode"),u_position_interpolation_mode(){return this.aes.position_interpolation?1:0},u_grid_mode:(t,{grid_mode:e})=>e,u_colors_as_grid:t.prop("colors_as_grid"),u_tile_id:(t,e)=>e.tile_id,u_width:({viewportWidth:t})=>t,u_height:({viewportHeight:t})=>t,u_one_d_aesthetic_map:this.aes.aesthetic_map.one_d_texture,u_color_aesthetic_map:this.aes.aesthetic_map.color_texture,u_aspect_ratio:({viewportWidth:t,viewportHeight:e})=>t/e,u_zoom_balance:t.prop("zoom_balance"),u_base_size:(t,{point_size:e})=>e,u_maxix:(t,{max_ix:e})=>e,u_alpha:(t,{alpha:e})=>e,u_foreground_number:(t,{foreground:e})=>e,u_foreground_alpha:()=>this.render_props.foreground_opacity,u_background_rgba:()=>{const t=this.prefs.background_options.color,{r:e,g:n,b:r}=Dr(t);return[e/255,n/255,r/255,this.prefs.background_options.opacity]},u_background_mouseover:()=>this.prefs.background_options.mouseover?1:0,u_background_size:()=>this.render_props.background_size,u_foreground_size:()=>this.render_props.foreground_size,u_k:(t,e)=>e.transform.k,u_window_scale:t.prop("webgl_scale"),u_last_window_scale:t.prop("last_webgl_scale"),u_time:({time:t})=>t,u_filter_numeric(){return this.aes.dim("filter").current.ops_to_array()},u_last_filter_numeric(){return this.aes.dim("filter").last.ops_to_array()},u_filter2_numeric(){return this.aes.dim("filter2").current.ops_to_array()},u_last_filter2_numeric(){return this.aes.dim("filter2").last.ops_to_array()},u_foreground_numeric(){return this.aes.dim("foreground").current.ops_to_array()},u_last_foreground_numeric(){return this.aes.dim("foreground").last.ops_to_array()},u_jitter:()=>this.aes.dim("jitter_radius").current.jitter_int_format,u_last_jitter:()=>this.aes.dim("jitter_radius").last.jitter_int_format,u_zoom:(t,e)=>e.zoom_matrix}};for(const t of Gt(0,16))e.attributes[`buffer_${t}`]=(e,{manager:n,buffer_num_to_variable:r})=>n.regl_elements.get(r[t])||{constant:0};for(const t of["x","y","color","jitter_radius","x0","y0","jitter_speed","size","filter","filter2","foreground"])for(const n of["current","last"]){const r="current"===n?"":"last_";e.uniforms[`u_${r}${t}_map_position`]=()=>this.aes.dim(t)[n].map_position,e.uniforms[`u_${r}${t}_buffer_num`]=(e,{aes_to_buffer_num:r})=>{const i=r[`${t}--${n}`];return void 0===i?-1:i},e.uniforms[`u_${r}${t}_domain`]=()=>this.aes.dim(t)[n].webGLDomain,e.uniforms[`u_${r}${t}_range`]=()=>this.aes.dim(t)[n].range,e.uniforms[`u_${r}${t}_transform`]=()=>{const e=this.aes.dim(t)[n].transform;if("linear"===e)return 1;if("sqrt"===e)return 2;if("log"===e)return 3;if("literal"===e)return 4;throw"Invalid transform"},e.uniforms[`u_${r}${t}_constant`]=()=>this.aes.dim(t)[n].constant}return this._renderer=t(e),this._renderer}allocate_aesthetic_buffers(){const t=[],e=["x","y","color","x0","y0","size","jitter_radius","jitter_speed","filter","filter2","foreground"];for(const n of e){const e=["current","last"];for(const r of e)try{this.aes.dim(n)[r].field&&t.push({aesthetic:n,time:r,field:this.aes.dim(n)[r].field})}catch(t){throw this.reglframe=void 0,t}}t.sort(((t,n)=>t.time<n.time?-1:n.time<t.time?1:e.indexOf(t.aesthetic)-e.indexOf(n.aesthetic)));const n={},r={ix:0,ix_in_tile:1};let i=1;for(const{aesthetic:e,time:o,field:a}of t){const t=`${e}--${o}`;void 0===r[a]?i++<16?(n[t]=i,r[a]=i):n[t]=n[`${e}--current`]:n[t]=r[a]}const o=[...Object.keys(r)];this.aes_to_buffer_num=n,this.variable_to_buffer_num=r,this.buffer_num_to_variable=o}get discard_share(){return 0}}class Ol{constructor(t,e,n){this.tile=e,this.regl=t,this.renderer=n,this.regl_elements=new Map([["ix_in_tile",{offset:0,stride:4,buffer:n.integer_buffer,byte_size:262144}]])}ready(){const{renderer:t}=this,e=new Set;for(const[n,r]of t.aes)for(const t of r.states)t.field&&e.add(t.field);for(const t of["ix","ix_in_tile",...e])if(!this.ready_or_not_here_it_comes(t).ready)return!1;return!0}ready_or_not_here_it_comes(t){const{renderer:e,regl_elements:n}=this,r=this.regl_elements.get(t);return null===r?{ready:!1,promise:null}:void 0===r?this.tile.ready?(n.set(t,null),{ready:!1,promise:new Promise((n=>{e.deferred_functions.push((async()=>{await this.create_regl_buffer(t),n()}))}))}):{ready:!1,promise:null}:{ready:!0,promise:Promise.resolve()}}release(t){let e;(e=this.regl_elements.get(t))&&this.renderer.buffers.free_block(e)}get count(){return this.tile.record_batch.numRows}async create_buffer_data(t){var e;const{tile:n}=this;if(!n.ready)throw new Error("Tile table not present.");let r=n.record_batch.getChild(t);if(!r){if(void 0===await n.dataset.transformations[t]){const e=n.record_batch.schema.fields.map((t=>t.name));throw new Error(`Requested ${t} but table only has columns ["${e.join('", "')}]"`)}if(await n.apply_transformation(t),r=n.record_batch.getChild(t),!r)throw new Error(`${t} was not created.`)}if(3!==r.type.typeId){const t=new Float32Array(n.record_batch.numRows),i=r.data[0];if(r.type.dictionary)for(let e=0;e<n.record_batch.numRows;e++)t[e]=i.values[e]-2047;else if(2===i.stride&&10===r.type.typeId){const o=new Int32Array(i.values).buffer,a=new BigInt64Array(o),s=null==(e=null==r?void 0:r.type)?void 0:e.unit,l=0===s?.001:1===s?1:2===s?1e3:3===s?1e6:42;if(42===l)throw new Error(`Unknown time type ${s}`);for(let e=0;e<n.record_batch.numRows;e++)t[e]=Number(a[e])/l}else for(let e=0;e<n.record_batch.numRows;e++)t[e]=Number(i.values[e]);return t}return r.data[0].values.constructor===Float64Array?new Float32Array(r.data[0].values):r.data[0].values}async create_regl_buffer(t){const{regl_elements:e,renderer:n}=this,r=await this.create_buffer_data(t);if(r.constructor!==Float32Array)throw console.warn(typeof r,r),new Error("Buffer data must be a Float32Array");const i=r.length,o=n.buffers.allocate_block(i,4);e.set(t,o),o.buffer.subdata(r,o.offset)}}class Tl{constructor(t,e){this.freed_buffers=[],this.regl=t,this.buffer_size=e,this.buffers=[],this.pointer=0,this.generate_new_buffer()}generate_new_buffer(){this.buffers.length&&this.buffer_size-this.pointer>128&&this.freed_buffers.push({buffer:this.buffers[0],offset:this.pointer,stride:4,byte_size:this.buffer_size-this.pointer}),this.pointer=0,this.buffers.unshift(this.regl.buffer({type:"float",length:this.buffer_size,usage:"dynamic"}))}free_block(t){this.freed_buffers.push(t)}allocate_block(t,e){const n=t*e;let r=0;for(const t of this.freed_buffers){if(t.byte_size===n)return this.freed_buffers.splice(r,1),{buffer:t.buffer,offset:t.offset,stride:e,byte_size:n};r+=1}this.pointer+t*e>this.buffer_size&&this.generate_new_buffer();const i={buffer:this.buffers[0],offset:this.pointer,stride:e,byte_size:t*e};return this.pointer+=t*e,i}}function Ll(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function Ml(t){return this instanceof Ml?(this.v=t,this):new Ml(t)}function Bl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof Ml?Promise.resolve(n.value.v).then(l,u):c(o[0][2],n)}catch(t){c(o[0][3],t)}var n}function l(t){s("next",t)}function u(t){s("throw",t)}function c(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function El(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:Ml(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function Dl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}const jl=new TextDecoder("utf-8"),zl=t=>jl.decode(t),Cl=new TextEncoder,Fl=t=>Cl.encode(t),[Nl,Rl]=(()=>{const t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},"undefined"!=typeof BigInt?[BigInt,!0]:[e,!1]})(),[Ul,Pl]=(()=>{const t=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!=typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),[Vl,$l]=(()=>{const t=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!=typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),Wl=t=>"boolean"==typeof t,Yl=t=>"function"==typeof t,Gl=t=>null!=t&&Object(t)===t,ql=t=>Gl(t)&&Yl(t.then),Hl=t=>Gl(t)&&Yl(t[Symbol.iterator]),Xl=t=>Gl(t)&&Yl(t[Symbol.asyncIterator]),Zl=t=>Gl(t)&&Gl(t.schema),Jl=t=>Gl(t)&&"done"in t&&"value"in t,Kl=t=>Gl(t)&&Yl(t.stat)&&(t=>"number"==typeof t)(t.fd),Ql=t=>Gl(t)&&eu(t.body),tu=t=>"_getDOMStream"in t&&"_getNodeStream"in t,eu=t=>Gl(t)&&Yl(t.cancel)&&Yl(t.getReader)&&!tu(t),nu=t=>Gl(t)&&Yl(t.read)&&Yl(t.pipe)&&Wl(t.readable)&&!tu(t),ru="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function iu(t,e,n=0,r=e.byteLength){const i=t.byteLength,o=new Uint8Array(t.buffer,t.byteOffset,i),a=new Uint8Array(e.buffer,e.byteOffset,Math.min(r,i));return o.set(a,n),t}function ou(t,e){const n=function(t){const e=t[0]?[t[0]]:[];let n,r,i,o;for(let a,s,l=0,u=0,c=t.length;++l<c;)a=e[u],s=t[l],!a||!s||a.buffer!==s.buffer||s.byteOffset<a.byteOffset?s&&(e[++u]=s):(({byteOffset:n,byteLength:i}=a),({byteOffset:r,byteLength:o}=s),n+i<r||r+o<n?s&&(e[++u]=s):e[u]=new Uint8Array(a.buffer,n,r-n+o));return e}(t),r=n.reduce(((t,e)=>t+e.byteLength),0);let i,o,a,s=0,l=-1;const u=Math.min(e||Number.POSITIVE_INFINITY,r);for(const t=n.length;++l<t;){if(i=n[l],o=i.subarray(0,Math.min(i.length,u-s)),u<=s+o.length){o.length<i.length?n[l]=i.subarray(o.length):o.length===i.length&&l++,a?iu(a,o,s):a=o;break}iu(a||(a=new Uint8Array(u)),o,s),s+=o.length}return[a||new Uint8Array(0),n.slice(l),r-(a?a.byteLength:0)]}function au(t,e){let n=Jl(e)?e.value:e;return n instanceof t?t===Uint8Array?new t(n.buffer,n.byteOffset,n.byteLength):n:n?("string"==typeof n&&(n=Fl(n)),n instanceof ArrayBuffer||n instanceof ru?new t(n):Gl(r=n)&&Yl(r.clear)&&Yl(r.bytes)&&Yl(r.position)&&Yl(r.setPosition)&&Yl(r.capacity)&&Yl(r.getBufferIdentifier)&&Yl(r.createLong)?au(t,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new t(0):new t(n.buffer,n.byteOffset,n.byteLength/t.BYTES_PER_ELEMENT):t.from(n)):new t(0);var r}const su=t=>au(Int32Array,t),lu=t=>au(Uint8Array,t),uu=t=>(t.next(),t);function*cu(t,e){const n=function*(t){yield t},r="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ru?n(e):Hl(e)?e:n(e);return yield*uu(function*(e){let n=null;do{n=e.next(yield au(t,n))}while(!n.done)}(r[Symbol.iterator]())),new t}const fu=t=>cu(Uint8Array,t);function du(t,e){return Bl(this,arguments,(function*(){if(ql(e))return yield Ml(yield Ml(yield*El(Dl(du(t,yield Ml(e))))));const n=function(t){return Bl(this,arguments,(function*(){yield yield Ml(yield Ml(t))}))},r="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ru?n(e):Hl(e)?function(t){return Bl(this,arguments,(function*(){yield Ml(yield*El(Dl(uu(function*(t){let e=null;do{e=t.next(yield null==e?void 0:e.value)}while(!e.done)}(t[Symbol.iterator]())))))}))}(e):Xl(e)?e:n(e);return yield Ml(yield*El(Dl(uu(function(e){return Bl(this,arguments,(function*(){let n=null;do{n=yield Ml(e.next(yield yield Ml(au(t,n))))}while(!n.done)}))}(r[Symbol.asyncIterator]()))))),yield Ml(new t)}))}const hu=t=>du(Uint8Array,t);function pu(t,e,n){if(0!==t){n=n.slice(0,e+1);for(let r=-1;++r<=e;)n[r]+=t}return n}function _u(t,e){let n=0;const r=t.length;if(r!==e.length)return!1;if(r>0)do{if(t[n]!==e[n])return!1}while(++n<r);return!0}const mu=Object.freeze(Object.defineProperty({__proto__:null,compareArrayLike:_u,joinUint8Arrays:ou,memcpy:iu,rebaseValueOffsets:pu,toArrayBufferView:au,toArrayBufferViewAsyncIterator:du,toArrayBufferViewIterator:cu,toBigInt64Array:t=>au(Ul,t),toBigUint64Array:t=>au(Vl,t),toFloat32Array:t=>au(Float32Array,t),toFloat32ArrayAsyncIterator:t=>du(Float32Array,t),toFloat32ArrayIterator:t=>cu(Float32Array,t),toFloat64Array:t=>au(Float64Array,t),toFloat64ArrayAsyncIterator:t=>du(Float64Array,t),toFloat64ArrayIterator:t=>cu(Float64Array,t),toInt16Array:t=>au(Int16Array,t),toInt16ArrayAsyncIterator:t=>du(Int16Array,t),toInt16ArrayIterator:t=>cu(Int16Array,t),toInt32Array:su,toInt32ArrayAsyncIterator:t=>du(Int32Array,t),toInt32ArrayIterator:t=>cu(Int32Array,t),toInt8Array:t=>au(Int8Array,t),toInt8ArrayAsyncIterator:t=>du(Int8Array,t),toInt8ArrayIterator:t=>cu(Int8Array,t),toUint16Array:t=>au(Uint16Array,t),toUint16ArrayAsyncIterator:t=>du(Uint16Array,t),toUint16ArrayIterator:t=>cu(Uint16Array,t),toUint32Array:t=>au(Uint32Array,t),toUint32ArrayAsyncIterator:t=>du(Uint32Array,t),toUint32ArrayIterator:t=>cu(Uint32Array,t),toUint8Array:lu,toUint8ArrayAsyncIterator:hu,toUint8ArrayIterator:fu,toUint8ClampedArray:t=>au(Uint8ClampedArray,t),toUint8ClampedArrayAsyncIterator:t=>du(Uint8ClampedArray,t),toUint8ClampedArrayIterator:t=>cu(Uint8ClampedArray,t)},Symbol.toStringTag,{value:"Module"})),yu={fromIterable:t=>bu(function*(t){let e,n,r,i,o=!1,a=[],s=0;({cmd:r,size:i}=yield null);const l=fu(t)[Symbol.iterator]();try{do{if(({done:e,value:n}=Number.isNaN(i-s)?l.next():l.next(i-s)),!e&&n.byteLength>0&&(a.push(n),s+=n.byteLength),e||i<=s)do{({cmd:r,size:i}=yield"peek"===r?ou(a,i)[0]:([n,a,s]=ou(a,i),n))}while(i<s)}while(!e)}catch(t){(o=!0)&&"function"==typeof l.throw&&l.throw(t)}finally{!1===o&&"function"==typeof l.return&&l.return(null)}return null}(t)),fromAsyncIterable:t=>bu(function(t){return Bl(this,arguments,(function*(){let e,n,r,i,o=!1,a=[],s=0;({cmd:r,size:i}=yield yield Ml(null));const l=hu(t)[Symbol.asyncIterator]();try{do{if(({done:e,value:n}=Number.isNaN(i-s)?yield Ml(l.next()):yield Ml(l.next(i-s))),!e&&n.byteLength>0&&(a.push(n),s+=n.byteLength),e||i<=s)do{({cmd:r,size:i}=yield yield Ml("peek"===r?ou(a,i)[0]:([n,a,s]=ou(a,i),n)))}while(i<s)}while(!e)}catch(t){(o=!0)&&"function"==typeof l.throw&&(yield Ml(l.throw(t)))}finally{!1===o&&"function"==typeof l.return&&(yield Ml(l.return(new Uint8Array(0))))}return yield Ml(null)}))}(t)),fromDOMStream:t=>bu(function(t){return Bl(this,arguments,(function*(){let e,n,r,i=!1,o=!1,a=[],s=0;({cmd:n,size:r}=yield yield Ml(null));const l=new gu(t);try{do{if(({done:i,value:e}=Number.isNaN(r-s)?yield Ml(l.read()):yield Ml(l.read(r-s))),!i&&e.byteLength>0&&(a.push(lu(e)),s+=e.byteLength),i||r<=s)do{({cmd:n,size:r}=yield yield Ml("peek"===n?ou(a,r)[0]:([e,a,s]=ou(a,r),e)))}while(r<s)}while(!i)}catch(t){(o=!0)&&(yield Ml(l.cancel(t)))}finally{!1===o?yield Ml(l.cancel()):t.locked&&l.releaseLock()}return yield Ml(null)}))}(t)),fromNodeStream:t=>bu(function(t){return Bl(this,arguments,(function*(){const e=[];let n,r,i,o="error",a=!1,s=null,l=0,u=[];if(({cmd:n,size:r}=yield yield Ml(null)),t.isTTY)return yield yield Ml(new Uint8Array(0)),yield Ml(null);try{e[0]=vu(t,"end"),e[1]=vu(t,"error");do{if(e[2]=vu(t,"readable"),[o,s]=yield Ml(Promise.race(e.map((t=>t[2])))),"error"===o)break;if((a="end"===o)||(Number.isFinite(r-l)?(i=lu(t.read(r-l)),i.byteLength<r-l&&(i=lu(t.read()))):i=lu(t.read()),i.byteLength>0&&(u.push(i),l+=i.byteLength)),a||r<=l)do{({cmd:n,size:r}=yield yield Ml("peek"===n?ou(u,r)[0]:([i,u,l]=ou(u,r),i)))}while(r<l)}while(!a)}finally{yield Ml((c=e,f="error"===o?s:null,i=u=null,new Promise(((e,n)=>{for(const[e,n]of c)t.off(e,n);try{const r=t.destroy;r&&r.call(t,f),f=void 0}catch(t){f=t||f}finally{null!=f?n(f):e()}}))))}var c,f;return yield Ml(null)}))}(t)),toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},bu=t=>(t.next(),t);class gu{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return Ll(this,void 0,void 0,(function*(){const{reader:e,source:n}=this;e&&(yield e.cancel(t).catch((()=>{}))),n&&n.locked&&this.releaseLock()}))}read(t){return Ll(this,void 0,void 0,(function*(){if(0===t)return{done:null==this.reader,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=lu(e)),e}))}}const vu=(t,e)=>{const n=t=>r([e,t]);let r;return[e,n,new Promise((i=>(r=i)&&t.once(e,n)))]};var wu,xu,Su,Au,Iu,ku,Ou,Tu,Lu,Mu,Bu,Eu,Du,ju,zu,Cu,Fu,Nu;function Ru(t){if(null===t)return"null";if(void 0===t)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"==typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof Ul||t instanceof Vl?`[${[...t].map((t=>Ru(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}`:e))}(xu=wu||(wu={}))[xu.V1=0]="V1",xu[xu.V2=1]="V2",xu[xu.V3=2]="V3",xu[xu.V4=3]="V4",xu[xu.V5=4]="V5",(Au=Su||(Su={}))[Au.Sparse=0]="Sparse",Au[Au.Dense=1]="Dense",(ku=Iu||(Iu={}))[ku.HALF=0]="HALF",ku[ku.SINGLE=1]="SINGLE",ku[ku.DOUBLE=2]="DOUBLE",(Tu=Ou||(Ou={}))[Tu.DAY=0]="DAY",Tu[Tu.MILLISECOND=1]="MILLISECOND",(Mu=Lu||(Lu={}))[Mu.SECOND=0]="SECOND",Mu[Mu.MILLISECOND=1]="MILLISECOND",Mu[Mu.MICROSECOND=2]="MICROSECOND",Mu[Mu.NANOSECOND=3]="NANOSECOND",(Eu=Bu||(Bu={}))[Eu.YEAR_MONTH=0]="YEAR_MONTH",Eu[Eu.DAY_TIME=1]="DAY_TIME",Eu[Eu.MONTH_DAY_NANO=2]="MONTH_DAY_NANO",(ju=Du||(Du={}))[ju.NONE=0]="NONE",ju[ju.Schema=1]="Schema",ju[ju.DictionaryBatch=2]="DictionaryBatch",ju[ju.RecordBatch=3]="RecordBatch",ju[ju.Tensor=4]="Tensor",ju[ju.SparseTensor=5]="SparseTensor",(Cu=zu||(zu={}))[Cu.NONE=0]="NONE",Cu[Cu.Null=1]="Null",Cu[Cu.Int=2]="Int",Cu[Cu.Float=3]="Float",Cu[Cu.Binary=4]="Binary",Cu[Cu.Utf8=5]="Utf8",Cu[Cu.Bool=6]="Bool",Cu[Cu.Decimal=7]="Decimal",Cu[Cu.Date=8]="Date",Cu[Cu.Time=9]="Time",Cu[Cu.Timestamp=10]="Timestamp",Cu[Cu.Interval=11]="Interval",Cu[Cu.List=12]="List",Cu[Cu.Struct=13]="Struct",Cu[Cu.Union=14]="Union",Cu[Cu.FixedSizeBinary=15]="FixedSizeBinary",Cu[Cu.FixedSizeList=16]="FixedSizeList",Cu[Cu.Map=17]="Map",Cu[Cu.Dictionary=-1]="Dictionary",Cu[Cu.Int8=-2]="Int8",Cu[Cu.Int16=-3]="Int16",Cu[Cu.Int32=-4]="Int32",Cu[Cu.Int64=-5]="Int64",Cu[Cu.Uint8=-6]="Uint8",Cu[Cu.Uint16=-7]="Uint16",Cu[Cu.Uint32=-8]="Uint32",Cu[Cu.Uint64=-9]="Uint64",Cu[Cu.Float16=-10]="Float16",Cu[Cu.Float32=-11]="Float32",Cu[Cu.Float64=-12]="Float64",Cu[Cu.DateDay=-13]="DateDay",Cu[Cu.DateMillisecond=-14]="DateMillisecond",Cu[Cu.TimestampSecond=-15]="TimestampSecond",Cu[Cu.TimestampMillisecond=-16]="TimestampMillisecond",Cu[Cu.TimestampMicrosecond=-17]="TimestampMicrosecond",Cu[Cu.TimestampNanosecond=-18]="TimestampNanosecond",Cu[Cu.TimeSecond=-19]="TimeSecond",Cu[Cu.TimeMillisecond=-20]="TimeMillisecond",Cu[Cu.TimeMicrosecond=-21]="TimeMicrosecond",Cu[Cu.TimeNanosecond=-22]="TimeNanosecond",Cu[Cu.DenseUnion=-23]="DenseUnion",Cu[Cu.SparseUnion=-24]="SparseUnion",Cu[Cu.IntervalDayTime=-25]="IntervalDayTime",Cu[Cu.IntervalYearMonth=-26]="IntervalYearMonth",(Nu=Fu||(Fu={}))[Nu.OFFSET=0]="OFFSET",Nu[Nu.DATA=1]="DATA",Nu[Nu.VALIDITY=2]="VALIDITY",Nu[Nu.TYPE=3]="TYPE";const Uu=Symbol.for("isArrowBigNum");function Pu(t,...e){return 0===e.length?Object.setPrototypeOf(au(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}function Vu(...t){return Pu.apply(this,t)}function $u(...t){return Pu.apply(this,t)}function Wu(...t){return Pu.apply(this,t)}function Yu(t){const{buffer:e,byteOffset:n,length:r,signed:i}=t,o=new Vl(e,n,r),a=i&&o[o.length-1]&BigInt(1)<<BigInt(63);let s=a?BigInt(1):BigInt(0),l=BigInt(0);if(a){for(const t of o)s+=~t*(BigInt(1)<<BigInt(32)*l++);s*=BigInt(-1)}else for(const t of o)s+=t*(BigInt(1)<<BigInt(32)*l++);return s}let Gu,qu;function Hu(t){let e="";const n=new Uint32Array(2);let r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const i=new Uint32Array((r=new Uint16Array(r).reverse()).buffer);let o=-1;const a=r.length-1;do{for(n[0]=r[o=0];o<a;)r[o++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+r[o];r[o]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],e=`${n[0]}${e}`}while(i[0]||i[1]||i[2]||i[3]);return null!=e?e:"0"}Pu.prototype[Uu]=!0,Pu.prototype.toJSON=function(){return`"${Gu(this)}"`},Pu.prototype.valueOf=function(){return Yu(this)},Pu.prototype.toString=function(){return Gu(this)},Pu.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return Yu(this);case"string":return Gu(this);case"default":return qu(this)}return Gu(this)},Object.setPrototypeOf(Vu.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf($u.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(Wu.prototype,Object.create(Uint32Array.prototype)),Object.assign(Vu.prototype,Pu.prototype,{constructor:Vu,signed:!0,TypedArray:Int32Array,BigIntArray:Ul}),Object.assign($u.prototype,Pu.prototype,{constructor:$u,signed:!1,TypedArray:Uint32Array,BigIntArray:Vl}),Object.assign(Wu.prototype,Pu.prototype,{constructor:Wu,signed:!0,TypedArray:Uint32Array,BigIntArray:Vl}),Rl?(qu=t=>8===t.byteLength?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:Hu(t),Gu=t=>8===t.byteLength?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:Hu(t)):(Gu=Hu,qu=Gu);class Xu{static new(t,e){switch(e){case!0:return new Vu(t);case!1:return new $u(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case Ul:return new Vu(t)}return 16===t.byteLength?new Wu(t):new $u(t)}static signed(t){return new Vu(t)}static unsigned(t){return new $u(t)}static decimal(t){return new Wu(t)}constructor(t,e){return Xu.new(t,e)}}const Zu=Object.freeze(Object.defineProperty({__proto__:null,BN:Xu,get bignumToBigInt(){return qu},get bignumToString(){return Gu},isArrowBigNumSymbol:Uu},Symbol.toStringTag,{value:"Module"}));var Ju,Ku,Qu,tc,ec,nc,rc,ic,oc,ac,sc,lc,uc,cc,fc,dc,hc,pc,_c,mc;class yc{static isNull(t){return(null==t?void 0:t.typeId)===zu.Null}static isInt(t){return(null==t?void 0:t.typeId)===zu.Int}static isFloat(t){return(null==t?void 0:t.typeId)===zu.Float}static isBinary(t){return(null==t?void 0:t.typeId)===zu.Binary}static isUtf8(t){return(null==t?void 0:t.typeId)===zu.Utf8}static isBool(t){return(null==t?void 0:t.typeId)===zu.Bool}static isDecimal(t){return(null==t?void 0:t.typeId)===zu.Decimal}static isDate(t){return(null==t?void 0:t.typeId)===zu.Date}static isTime(t){return(null==t?void 0:t.typeId)===zu.Time}static isTimestamp(t){return(null==t?void 0:t.typeId)===zu.Timestamp}static isInterval(t){return(null==t?void 0:t.typeId)===zu.Interval}static isList(t){return(null==t?void 0:t.typeId)===zu.List}static isStruct(t){return(null==t?void 0:t.typeId)===zu.Struct}static isUnion(t){return(null==t?void 0:t.typeId)===zu.Union}static isFixedSizeBinary(t){return(null==t?void 0:t.typeId)===zu.FixedSizeBinary}static isFixedSizeList(t){return(null==t?void 0:t.typeId)===zu.FixedSizeList}static isMap(t){return(null==t?void 0:t.typeId)===zu.Map}static isDictionary(t){return(null==t?void 0:t.typeId)===zu.Dictionary}static isDenseUnion(t){return yc.isUnion(t)&&t.mode===Su.Dense}static isSparseUnion(t){return yc.isUnion(t)&&t.mode===Su.Sparse}get typeId(){return zu.NONE}}Ju=Symbol.toStringTag,yc[Ju]=((mc=yc.prototype).children=null,mc.ArrayType=Array,mc[Symbol.toStringTag]="DataType");let bc=class extends yc{toString(){return"Null"}get typeId(){return zu.Null}};Ku=Symbol.toStringTag,bc[Ku]=(t=>t[Symbol.toStringTag]="Null")(bc.prototype);class gc extends yc{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return zu.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Ul:Vl}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Qu=Symbol.toStringTag,gc[Qu]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(gc.prototype);class vc extends gc{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class wc extends gc{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class xc extends gc{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}let Sc=class extends gc{constructor(){super(!0,64)}get ArrayType(){return Ul}};class Ac extends gc{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class Ic extends gc{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class kc extends gc{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}let Oc=class extends gc{constructor(){super(!1,64)}get ArrayType(){return Vl}};Object.defineProperty(vc.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(wc.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(xc.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(Sc.prototype,"ArrayType",{value:Ul}),Object.defineProperty(Ac.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(Ic.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(kc.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(Oc.prototype,"ArrayType",{value:Vl});class Tc extends yc{constructor(t){super(),this.precision=t}get typeId(){return zu.Float}get ArrayType(){switch(this.precision){case Iu.HALF:return Uint16Array;case Iu.SINGLE:return Float32Array;case Iu.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}tc=Symbol.toStringTag,Tc[tc]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(Tc.prototype);class Lc extends Tc{constructor(){super(Iu.HALF)}}class Mc extends Tc{constructor(){super(Iu.SINGLE)}}class Bc extends Tc{constructor(){super(Iu.DOUBLE)}}Object.defineProperty(Lc.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(Mc.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(Bc.prototype,"ArrayType",{value:Float64Array});let Ec=class extends yc{constructor(){super()}get typeId(){return zu.Binary}toString(){return"Binary"}};ec=Symbol.toStringTag,Ec[ec]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(Ec.prototype);let Dc=class extends yc{constructor(){super()}get typeId(){return zu.Utf8}toString(){return"Utf8"}};nc=Symbol.toStringTag,Dc[nc]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(Dc.prototype);let jc=class extends yc{constructor(){super()}get typeId(){return zu.Bool}toString(){return"Bool"}};rc=Symbol.toStringTag,jc[rc]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(jc.prototype);let zc=class extends yc{constructor(t,e,n=128){super(),this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return zu.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};ic=Symbol.toStringTag,zc[ic]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(zc.prototype);class Cc extends yc{constructor(t){super(),this.unit=t}get typeId(){return zu.Date}toString(){return`Date${32*(this.unit+1)}<${Ou[this.unit]}>`}}oc=Symbol.toStringTag,Cc[oc]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Cc.prototype);class Fc extends Cc{constructor(){super(Ou.MILLISECOND)}}class Nc extends yc{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return zu.Time}toString(){return`Time${this.bitWidth}<${Lu[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return Ul}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}ac=Symbol.toStringTag,Nc[ac]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Nc.prototype);class Rc extends yc{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return zu.Timestamp}toString(){return`Timestamp<${Lu[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}sc=Symbol.toStringTag,Rc[sc]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Rc.prototype);class Uc extends yc{constructor(t){super(),this.unit=t}get typeId(){return zu.Interval}toString(){return`Interval<${Bu[this.unit]}>`}}lc=Symbol.toStringTag,Uc[lc]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Uc.prototype);let Pc=class extends yc{constructor(t){super(),this.children=[t]}get typeId(){return zu.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};uc=Symbol.toStringTag,Pc[uc]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Pc.prototype);class Vc extends yc{constructor(t){super(),this.children=t}get typeId(){return zu.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}cc=Symbol.toStringTag,Vc[cc]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(Vc.prototype);class $c extends yc{constructor(t,e,n){super(),this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,n)=>(t[e]=n)&&t||t),Object.create(null))}get typeId(){return zu.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}fc=Symbol.toStringTag,$c[fc]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))($c.prototype);let Wc=class extends yc{constructor(t){super(),this.byteWidth=t}get typeId(){return zu.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};dc=Symbol.toStringTag,Wc[dc]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Wc.prototype);let Yc=class extends yc{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return zu.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};hc=Symbol.toStringTag,Yc[hc]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(Yc.prototype);class Gc extends yc{constructor(t,e=!1){super(),this.children=[t],this.keysSorted=e}get typeId(){return zu.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}pc=Symbol.toStringTag,Gc[pc]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(Gc.prototype);const qc=(Hc=-1,()=>++Hc);var Hc;class Xc extends yc{constructor(t,e,n,r){super(),this.indices=e,this.dictionary=t,this.isOrdered=r||!1,this.id=null==n?qc():"number"==typeof n?n:n.low}get typeId(){return zu.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function Zc(t){const e=t;switch(t.typeId){case zu.Decimal:return t.bitWidth/32;case zu.Timestamp:return 2;case zu.Date:case zu.Interval:return 1+e.unit;case zu.FixedSizeList:return e.listSize;case zu.FixedSizeBinary:return e.byteWidth;default:return 1}}_c=Symbol.toStringTag,Xc[_c]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Xc.prototype);class Jc{visitMany(t,...e){return t.map(((t,n)=>this.visit(t,...e.map((t=>t[n])))))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return function(t,e,n=!0){return"number"==typeof e?Kc(t,e,n):"string"==typeof e&&e in zu?Kc(t,zu[e],n):e&&e instanceof yc?Kc(t,Qc(e),n):(null==e?void 0:e.type)&&e.type instanceof yc?Kc(t,Qc(e.type),n):Kc(t,zu.NONE,n)}(this,t,e)}getVisitFnByTypeId(t,e=!0){return Kc(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function Kc(t,e,n=!0){let r=null;switch(e){case zu.Null:r=t.visitNull;break;case zu.Bool:r=t.visitBool;break;case zu.Int:r=t.visitInt;break;case zu.Int8:r=t.visitInt8||t.visitInt;break;case zu.Int16:r=t.visitInt16||t.visitInt;break;case zu.Int32:r=t.visitInt32||t.visitInt;break;case zu.Int64:r=t.visitInt64||t.visitInt;break;case zu.Uint8:r=t.visitUint8||t.visitInt;break;case zu.Uint16:r=t.visitUint16||t.visitInt;break;case zu.Uint32:r=t.visitUint32||t.visitInt;break;case zu.Uint64:r=t.visitUint64||t.visitInt;break;case zu.Float:r=t.visitFloat;break;case zu.Float16:r=t.visitFloat16||t.visitFloat;break;case zu.Float32:r=t.visitFloat32||t.visitFloat;break;case zu.Float64:r=t.visitFloat64||t.visitFloat;break;case zu.Utf8:r=t.visitUtf8;break;case zu.Binary:r=t.visitBinary;break;case zu.FixedSizeBinary:r=t.visitFixedSizeBinary;break;case zu.Date:r=t.visitDate;break;case zu.DateDay:r=t.visitDateDay||t.visitDate;break;case zu.DateMillisecond:r=t.visitDateMillisecond||t.visitDate;break;case zu.Timestamp:r=t.visitTimestamp;break;case zu.TimestampSecond:r=t.visitTimestampSecond||t.visitTimestamp;break;case zu.TimestampMillisecond:r=t.visitTimestampMillisecond||t.visitTimestamp;break;case zu.TimestampMicrosecond:r=t.visitTimestampMicrosecond||t.visitTimestamp;break;case zu.TimestampNanosecond:r=t.visitTimestampNanosecond||t.visitTimestamp;break;case zu.Time:r=t.visitTime;break;case zu.TimeSecond:r=t.visitTimeSecond||t.visitTime;break;case zu.TimeMillisecond:r=t.visitTimeMillisecond||t.visitTime;break;case zu.TimeMicrosecond:r=t.visitTimeMicrosecond||t.visitTime;break;case zu.TimeNanosecond:r=t.visitTimeNanosecond||t.visitTime;break;case zu.Decimal:r=t.visitDecimal;break;case zu.List:r=t.visitList;break;case zu.Struct:r=t.visitStruct;break;case zu.Union:r=t.visitUnion;break;case zu.DenseUnion:r=t.visitDenseUnion||t.visitUnion;break;case zu.SparseUnion:r=t.visitSparseUnion||t.visitUnion;break;case zu.Dictionary:r=t.visitDictionary;break;case zu.Interval:r=t.visitInterval;break;case zu.IntervalDayTime:r=t.visitIntervalDayTime||t.visitInterval;break;case zu.IntervalYearMonth:r=t.visitIntervalYearMonth||t.visitInterval;break;case zu.FixedSizeList:r=t.visitFixedSizeList;break;case zu.Map:r=t.visitMap}if("function"==typeof r)return r;if(!n)return()=>null;throw new Error(`Unrecognized type '${zu[e]}'`)}function Qc(t){switch(t.typeId){case zu.Null:return zu.Null;case zu.Int:{const{bitWidth:e,isSigned:n}=t;switch(e){case 8:return n?zu.Int8:zu.Uint8;case 16:return n?zu.Int16:zu.Uint16;case 32:return n?zu.Int32:zu.Uint32;case 64:return n?zu.Int64:zu.Uint64}return zu.Int}case zu.Float:switch(t.precision){case Iu.HALF:return zu.Float16;case Iu.SINGLE:return zu.Float32;case Iu.DOUBLE:return zu.Float64}return zu.Float;case zu.Binary:return zu.Binary;case zu.Utf8:return zu.Utf8;case zu.Bool:return zu.Bool;case zu.Decimal:return zu.Decimal;case zu.Time:switch(t.unit){case Lu.SECOND:return zu.TimeSecond;case Lu.MILLISECOND:return zu.TimeMillisecond;case Lu.MICROSECOND:return zu.TimeMicrosecond;case Lu.NANOSECOND:return zu.TimeNanosecond}return zu.Time;case zu.Timestamp:switch(t.unit){case Lu.SECOND:return zu.TimestampSecond;case Lu.MILLISECOND:return zu.TimestampMillisecond;case Lu.MICROSECOND:return zu.TimestampMicrosecond;case Lu.NANOSECOND:return zu.TimestampNanosecond}return zu.Timestamp;case zu.Date:switch(t.unit){case Ou.DAY:return zu.DateDay;case Ou.MILLISECOND:return zu.DateMillisecond}return zu.Date;case zu.Interval:switch(t.unit){case Bu.DAY_TIME:return zu.IntervalDayTime;case Bu.YEAR_MONTH:return zu.IntervalYearMonth}return zu.Interval;case zu.Map:return zu.Map;case zu.List:return zu.List;case zu.Struct:return zu.Struct;case zu.Union:switch(t.mode){case Su.Dense:return zu.DenseUnion;case Su.Sparse:return zu.SparseUnion}return zu.Union;case zu.FixedSizeBinary:return zu.FixedSizeBinary;case zu.FixedSizeList:return zu.FixedSizeList;case zu.Dictionary:return zu.Dictionary}throw new Error(`Unrecognized type '${zu[t.typeId]}'`)}Jc.prototype.visitInt8=null,Jc.prototype.visitInt16=null,Jc.prototype.visitInt32=null,Jc.prototype.visitInt64=null,Jc.prototype.visitUint8=null,Jc.prototype.visitUint16=null,Jc.prototype.visitUint32=null,Jc.prototype.visitUint64=null,Jc.prototype.visitFloat16=null,Jc.prototype.visitFloat32=null,Jc.prototype.visitFloat64=null,Jc.prototype.visitDateDay=null,Jc.prototype.visitDateMillisecond=null,Jc.prototype.visitTimestampSecond=null,Jc.prototype.visitTimestampMillisecond=null,Jc.prototype.visitTimestampMicrosecond=null,Jc.prototype.visitTimestampNanosecond=null,Jc.prototype.visitTimeSecond=null,Jc.prototype.visitTimeMillisecond=null,Jc.prototype.visitTimeMicrosecond=null,Jc.prototype.visitTimeNanosecond=null,Jc.prototype.visitDenseUnion=null,Jc.prototype.visitSparseUnion=null,Jc.prototype.visitIntervalDayTime=null,Jc.prototype.visitIntervalYearMonth=null;const tf=new Float64Array(1),ef=new Uint32Array(tf.buffer);function nf(t){const e=(31744&t)>>10,n=(1023&t)/1024,r=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return r*(n?Number.NaN:1/0);case 0:return r*(n?6103515625e-14*n:0)}return r*Math.pow(2,e-15)*(1+n)}function rf(t){if(t!=t)return 32256;tf[0]=t;const e=(2147483648&ef[1])>>16&65535;let n=2146435072&ef[1],r=0;return n>=1089470464?ef[0]>0?n=31744:(n=(2080374784&n)>>16,r=(1048575&ef[1])>>10):n<=1056964608?(r=1048576+(1048575&ef[1]),r=1048576+(r<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,r=512+(1048575&ef[1])>>10),e|n|65535&r}const of=Object.freeze(Object.defineProperty({__proto__:null,float64ToUint16:rf,uint16ToFloat64:nf},Symbol.toStringTag,{value:"Module"}));class af extends Jc{}function sf(t){return(e,n,r)=>{if(e.setValid(n,null!=r))return t(e,n,r)}}const lf=(t,e,n)=>{t[e]=Math.trunc(n%4294967296),t[e+1]=Math.trunc(n/4294967296)},uf=(t,e,n,r)=>{if(n+1<e.length){const{[n]:i,[n+1]:o}=e;t.set(r.subarray(0,o-i),i)}},cf=({values:t},e,n)=>{t[e]=n},ff=({values:t},e,n)=>{t[e]=n},df=({values:t},e,n)=>{t[e]=rf(n)},hf=({values:t},e,n)=>{((t,e,n)=>{t[e]=Math.trunc(n/864e5)})(t,e,n.valueOf())},pf=({values:t},e,n)=>{lf(t,2*e,n.valueOf())},_f=({stride:t,values:e},n,r)=>{e.set(r.subarray(0,t),t*n)},mf=(t,e,n)=>{t.type.unit===Ou.DAY?hf(t,e,n):pf(t,e,n)},yf=({values:t},e,n)=>lf(t,2*e,n/1e3),bf=({values:t},e,n)=>lf(t,2*e,n),gf=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e3*n%4294967296),t[e+1]=Math.trunc(1e3*n/4294967296)})(t,2*e,n),vf=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e6*n%4294967296),t[e+1]=Math.trunc(1e6*n/4294967296)})(t,2*e,n),wf=(t,e,n)=>{switch(t.type.unit){case Lu.SECOND:return yf(t,e,n);case Lu.MILLISECOND:return bf(t,e,n);case Lu.MICROSECOND:return gf(t,e,n);case Lu.NANOSECOND:return vf(t,e,n)}},xf=({values:t},e,n)=>{t[e]=n},Sf=({values:t},e,n)=>{t[e]=n},Af=({values:t},e,n)=>{t[e]=n},If=({values:t},e,n)=>{t[e]=n},kf=(t,e,n)=>{switch(t.type.unit){case Lu.SECOND:return xf(t,e,n);case Lu.MILLISECOND:return Sf(t,e,n);case Lu.MICROSECOND:return Af(t,e,n);case Lu.NANOSECOND:return If(t,e,n)}},Of=({values:t,stride:e},n,r)=>{t.set(r.subarray(0,e),e*n)},Tf=(t,e,n)=>{const r=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[r];Df.visit(i,t.valueOffsets[e],n)},Lf=(t,e,n)=>{const r=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[r];Df.visit(i,e,n)},Mf=(t,e,n)=>{t.type.unit===Bu.DAY_TIME?Bf(t,e,n):Ef(t,e,n)},Bf=({values:t},e,n)=>{t.set(n.subarray(0,2),2*e)},Ef=({values:t},e,n)=>{t[e]=12*n[0]+n[1]%12};af.prototype.visitBool=sf((({offset:t,values:e},n,r)=>{const i=t+n;r?e[i>>3]|=1<<i%8:e[i>>3]&=~(1<<i%8)})),af.prototype.visitInt=sf(cf),af.prototype.visitInt8=sf(cf),af.prototype.visitInt16=sf(cf),af.prototype.visitInt32=sf(cf),af.prototype.visitInt64=sf(cf),af.prototype.visitUint8=sf(cf),af.prototype.visitUint16=sf(cf),af.prototype.visitUint32=sf(cf),af.prototype.visitUint64=sf(cf),af.prototype.visitFloat=sf(((t,e,n)=>{switch(t.type.precision){case Iu.HALF:return df(t,e,n);case Iu.SINGLE:case Iu.DOUBLE:return ff(t,e,n)}})),af.prototype.visitFloat16=sf(df),af.prototype.visitFloat32=sf(ff),af.prototype.visitFloat64=sf(ff),af.prototype.visitUtf8=sf((({values:t,valueOffsets:e},n,r)=>{uf(t,e,n,Fl(r))})),af.prototype.visitBinary=sf((({values:t,valueOffsets:e},n,r)=>uf(t,e,n,r))),af.prototype.visitFixedSizeBinary=sf(_f),af.prototype.visitDate=sf(mf),af.prototype.visitDateDay=sf(hf),af.prototype.visitDateMillisecond=sf(pf),af.prototype.visitTimestamp=sf(wf),af.prototype.visitTimestampSecond=sf(yf),af.prototype.visitTimestampMillisecond=sf(bf),af.prototype.visitTimestampMicrosecond=sf(gf),af.prototype.visitTimestampNanosecond=sf(vf),af.prototype.visitTime=sf(kf),af.prototype.visitTimeSecond=sf(xf),af.prototype.visitTimeMillisecond=sf(Sf),af.prototype.visitTimeMicrosecond=sf(Af),af.prototype.visitTimeNanosecond=sf(If),af.prototype.visitDecimal=sf(Of),af.prototype.visitList=sf(((t,e,n)=>{const r=t.children[0],i=t.valueOffsets,o=Df.getVisitFn(r);if(Array.isArray(n))for(let t=-1,a=i[e],s=i[e+1];a<s;)o(r,a++,n[++t]);else for(let t=-1,a=i[e],s=i[e+1];a<s;)o(r,a++,n.get(++t))})),af.prototype.visitStruct=sf(((t,e,n)=>{const r=t.type.children.map((t=>Df.getVisitFn(t.type))),i=n instanceof Map?(o=e,a=n,(t,e,n,r)=>e&&t(e,o,a.get(n.name))):n instanceof nh?((t,e)=>(n,r,i,o)=>r&&n(r,t,e.get(o)))(e,n):Array.isArray(n)?((t,e)=>(n,r,i,o)=>r&&n(r,t,e[o]))(e,n):((t,e)=>(n,r,i,o)=>r&&n(r,t,e[i.name]))(e,n);var o,a;t.type.children.forEach(((e,n)=>i(r[n],t.children[n],e,n)))})),af.prototype.visitUnion=sf(((t,e,n)=>{t.type.mode===Su.Dense?Tf(t,e,n):Lf(t,e,n)})),af.prototype.visitDenseUnion=sf(Tf),af.prototype.visitSparseUnion=sf(Lf),af.prototype.visitDictionary=sf(((t,e,n)=>{var r;null===(r=t.dictionary)||void 0===r||r.set(t.values[e],n)})),af.prototype.visitInterval=sf(Mf),af.prototype.visitIntervalDayTime=sf(Bf),af.prototype.visitIntervalYearMonth=sf(Ef),af.prototype.visitFixedSizeList=sf(((t,e,n)=>{const{stride:r}=t,i=t.children[0],o=Df.getVisitFn(i);if(Array.isArray(n))for(let t=-1,a=e*r;++t<r;)o(i,a+t,n[t]);else for(let t=-1,a=e*r;++t<r;)o(i,a+t,n.get(t))})),af.prototype.visitMap=sf(((t,e,n)=>{const r=t.children[0],{valueOffsets:i}=t,o=Df.getVisitFn(r);let{[e]:a,[e+1]:s}=i;const l=n instanceof Map?n.entries():Object.entries(n);for(const t of l)if(o(r,a,t),++a>=s)break}));const Df=new af,jf=Symbol.for("parent"),zf=Symbol.for("rowIndex");class Cf{constructor(t,e){return this[jf]=t,this[zf]=e,new Proxy(this,new Nf)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[zf],e=this[jf],n=e.type.children,r={};for(let i=-1,o=n.length;++i<o;)r[n[i].name]=ad.visit(e.children[i],t);return r}toString(){return`{${[...this].map((([t,e])=>`${Ru(t)}: ${Ru(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Ff(this[jf],this[zf])}}class Ff{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,ad.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(Cf.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[jf]:{writable:!0,enumerable:!1,configurable:!1,value:null},[zf]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class Nf{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[jf].type.children.map((t=>t.name))}has(t,e){return-1!==t[jf].type.children.findIndex((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(-1!==t[jf].type.children.findIndex((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[jf].type.children.findIndex((t=>t.name===e));if(-1!==n){const r=ad.visit(t[jf].children[n],t[zf]);return Reflect.set(t,e,r),r}}set(t,e,n){const r=t[jf].type.children.findIndex((t=>t.name===e));return-1!==r?(Df.visit(t[jf].children[r],t[zf],n),Reflect.set(t,e,n)):!(!Reflect.has(t,e)&&"symbol"!=typeof e)&&Reflect.set(t,e,n)}}class Rf extends Jc{}function Uf(t){return(e,n)=>e.getValid(n)?t(e,n):null}const Pf=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),Vf=t=>new Date(t),$f=(t,e,n)=>{if(n+1>=e.length)return null;const r=e[n],i=e[n+1];return t.subarray(r,i)},Wf=({values:t},e)=>((t,e)=>Vf(((t,e)=>864e5*t[e])(t,e)))(t,e),Yf=({values:t},e)=>((t,e)=>Vf(Pf(t,e)))(t,2*e),Gf=({stride:t,values:e},n)=>e[t*n],qf=({values:t},e)=>t[e],Hf=({values:t},e)=>1e3*Pf(t,2*e),Xf=({values:t},e)=>Pf(t,2*e),Zf=({values:t},e)=>((t,e)=>t[e+1]/1e3*4294967296+(t[e]>>>0)/1e3)(t,2*e),Jf=({values:t},e)=>((t,e)=>t[e+1]/1e6*4294967296+(t[e]>>>0)/1e6)(t,2*e),Kf=({values:t},e)=>t[e],Qf=({values:t},e)=>t[e],td=({values:t},e)=>t[e],ed=({values:t},e)=>t[e],nd=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];return ad.visit(r,t.valueOffsets[e])},rd=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];return ad.visit(r,e)},id=({values:t},e)=>t.subarray(2*e,2*(e+1)),od=({values:t},e)=>{const n=t[e],r=new Int32Array(2);return r[0]=Math.trunc(n/12),r[1]=Math.trunc(n%12),r};Rf.prototype.visitNull=Uf(((t,e)=>null)),Rf.prototype.visitBool=Uf((({offset:t,values:e},n)=>{const r=t+n;return 0!=(e[r>>3]&1<<r%8)})),Rf.prototype.visitInt=Uf((({values:t},e)=>t[e])),Rf.prototype.visitInt8=Uf(Gf),Rf.prototype.visitInt16=Uf(Gf),Rf.prototype.visitInt32=Uf(Gf),Rf.prototype.visitInt64=Uf(qf),Rf.prototype.visitUint8=Uf(Gf),Rf.prototype.visitUint16=Uf(Gf),Rf.prototype.visitUint32=Uf(Gf),Rf.prototype.visitUint64=Uf(qf),Rf.prototype.visitFloat=Uf((({type:t,values:e},n)=>t.precision!==Iu.HALF?e[n]:nf(e[n]))),Rf.prototype.visitFloat16=Uf((({stride:t,values:e},n)=>nf(e[t*n]))),Rf.prototype.visitFloat32=Uf(Gf),Rf.prototype.visitFloat64=Uf(Gf),Rf.prototype.visitUtf8=Uf((({values:t,valueOffsets:e},n)=>{const r=$f(t,e,n);return null!==r?zl(r):null})),Rf.prototype.visitBinary=Uf((({values:t,valueOffsets:e},n)=>$f(t,e,n))),Rf.prototype.visitFixedSizeBinary=Uf((({stride:t,values:e},n)=>e.subarray(t*n,t*(n+1)))),Rf.prototype.visitDate=Uf(((t,e)=>t.type.unit===Ou.DAY?Wf(t,e):Yf(t,e))),Rf.prototype.visitDateDay=Uf(Wf),Rf.prototype.visitDateMillisecond=Uf(Yf),Rf.prototype.visitTimestamp=Uf(((t,e)=>{switch(t.type.unit){case Lu.SECOND:return Hf(t,e);case Lu.MILLISECOND:return Xf(t,e);case Lu.MICROSECOND:return Zf(t,e);case Lu.NANOSECOND:return Jf(t,e)}})),Rf.prototype.visitTimestampSecond=Uf(Hf),Rf.prototype.visitTimestampMillisecond=Uf(Xf),Rf.prototype.visitTimestampMicrosecond=Uf(Zf),Rf.prototype.visitTimestampNanosecond=Uf(Jf),Rf.prototype.visitTime=Uf(((t,e)=>{switch(t.type.unit){case Lu.SECOND:return Kf(t,e);case Lu.MILLISECOND:return Qf(t,e);case Lu.MICROSECOND:return td(t,e);case Lu.NANOSECOND:return ed(t,e)}})),Rf.prototype.visitTimeSecond=Uf(Kf),Rf.prototype.visitTimeMillisecond=Uf(Qf),Rf.prototype.visitTimeMicrosecond=Uf(td),Rf.prototype.visitTimeNanosecond=Uf(ed),Rf.prototype.visitDecimal=Uf((({values:t,stride:e},n)=>Xu.decimal(t.subarray(e*n,e*(n+1))))),Rf.prototype.visitList=Uf(((t,e)=>{const{valueOffsets:n,stride:r,children:i}=t,{[e*r]:o,[e*r+1]:a}=n,s=i[0].slice(o,a-o);return new nh([s])})),Rf.prototype.visitStruct=Uf(((t,e)=>new Cf(t,e))),Rf.prototype.visitUnion=Uf(((t,e)=>t.type.mode===Su.Dense?nd(t,e):rd(t,e))),Rf.prototype.visitDenseUnion=Uf(nd),Rf.prototype.visitSparseUnion=Uf(rd),Rf.prototype.visitDictionary=Uf(((t,e)=>{var n;return null===(n=t.dictionary)||void 0===n?void 0:n.get(t.values[e])})),Rf.prototype.visitInterval=Uf(((t,e)=>t.type.unit===Bu.DAY_TIME?id(t,e):od(t,e))),Rf.prototype.visitIntervalDayTime=Uf(id),Rf.prototype.visitIntervalYearMonth=Uf(od),Rf.prototype.visitFixedSizeList=Uf(((t,e)=>{const{stride:n,children:r}=t,i=r[0].slice(e*n,n);return new nh([i])})),Rf.prototype.visitMap=Uf(((t,e)=>{const{valueOffsets:n,children:r}=t,{[e]:i,[e+1]:o}=n,a=r[0];return new ud(a.slice(i,o-i))}));const ad=new Rf,sd=Symbol.for("keys"),ld=Symbol.for("vals");class ud{constructor(t){return this[sd]=new nh([t.children[0]]).memoize(),this[ld]=t.children[1],new Proxy(this,new fd)}[Symbol.iterator](){return new cd(this[sd],this[ld])}get size(){return this[sd].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[sd],e=this[ld],n={};for(let r=-1,i=t.length;++r<i;)n[t.get(r)]=ad.visit(e,r);return n}toString(){return`{${[...this].map((([t,e])=>`${Ru(t)}: ${Ru(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class cd{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),ad.visit(this.vals,t)]})}}class fd{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[sd].toArray().map(String)}has(t,e){return t[sd].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[sd].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[sd].indexOf(e);if(-1!==n){const r=ad.visit(Reflect.get(t,ld),n);return Reflect.set(t,e,r),r}}set(t,e,n){const r=t[sd].indexOf(e);return-1!==r?(Df.visit(Reflect.get(t,ld),r,n),Reflect.set(t,e,n)):!!Reflect.has(t,e)&&Reflect.set(t,e,n)}}let dd;function hd(t,e,n,r){const{length:i=0}=t;let o="number"!=typeof e?0:e,a="number"!=typeof n?i:n;return o<0&&(o=(o%i+i)%i),a<0&&(a=(a%i+i)%i),a<o&&(dd=o,o=a,a=dd),a>i&&(a=i),r?r(t,o,a):[o,a]}Object.defineProperties(ud.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[sd]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ld]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const pd=t=>t!=t;function _d(t){if("object"!=typeof t||null===t)return pd(t)?pd:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&_u(t,e):t instanceof Map?function(t){let e=-1;const n=[];for(const r of t.values())n[++e]=_d(r);return md(n)}(t):Array.isArray(t)?function(t){const e=[];for(let n=-1,r=t.length;++n<r;)e[n]=_d(t[n]);return md(e)}(t):t instanceof nh?function(t){const e=[];for(let n=-1,r=t.length;++n<r;)e[n]=_d(t.get(n));return md(e)}(t):function(t,e=!1){const n=Object.keys(t);if(!e&&0===n.length)return()=>!1;const r=[];for(let e=-1,i=n.length;++e<i;)r[e]=_d(t[n[e]]);return md(r,n)}(t,!0)}function md(t,e){return n=>{if(!n||"object"!=typeof n)return!1;switch(n.constructor){case Array:return function(t,e){const n=t.length;if(e.length!==n)return!1;for(let r=-1;++r<n;)if(!t[r](e[r]))return!1;return!0}(t,n);case Map:return yd(t,n,n.keys());case ud:case Cf:case Object:case void 0:return yd(t,n,e||Object.keys(n))}return n instanceof nh&&function(t,e){const n=t.length;if(e.length!==n)return!1;for(let r=-1;++r<n;)if(!t[r](e.get(r)))return!1;return!0}(t,n)}}function yd(t,e,n){const r=n[Symbol.iterator](),i=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),o=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let a=0;const s=t.length;let l=o.next(),u=r.next(),c=i.next();for(;a<s&&!u.done&&!c.done&&!l.done&&u.value===c.value&&t[a](l.value);++a,u=r.next(),c=i.next(),l=o.next());return!!(a===s&&u.done&&c.done&&l.done)||(r.return&&r.return(),i.return&&i.return(),o.return&&o.return(),!1)}const bd=Object.freeze(Object.defineProperty({__proto__:null,clampIndex:function(t,e,n){const r=t.length,i=e>-1?e:r+e%r;return n?n(t,i):i},clampRange:hd,createElementComparator:_d},Symbol.toStringTag,{value:"Module"}));function gd(t,e,n,r){return 0!=(n&1<<r)}function vd(t,e,n,r){return(n&1<<r)>>r}function wd(t,e,n){const r=n.byteLength+7&-8;if(t>0||n.byteLength<r){const i=new Uint8Array(r);return i.set(t%8==0?n.subarray(t>>3):xd(new Sd(n,t,e,null,gd)).subarray(0,r)),i}return n}function xd(t){const e=[];let n=0,r=0,i=0;for(const o of t)o&&(i|=1<<r),8==++r&&(e[n++]=i,i=r=0);(0===n||r>0)&&(e[n++]=i);const o=new Uint8Array(e.length+7&-8);return o.set(e),o}class Sd{constructor(t,e,n,r,i){this.bytes=t,this.length=n,this.context=r,this.get=i,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Ad(t,e,n){if(n-e<=0)return 0;if(n-e<8){let r=0;for(const i of new Sd(t,e,n-e,t,vd))r+=i;return r}const r=n>>3<<3,i=e+(e%8==0?0:8-e%8);return Ad(t,e,i)+Ad(t,r,n)+Id(t,i>>3,r-i>>3)}function Id(t,e,n){let r=0,i=Math.trunc(e);const o=new DataView(t.buffer,t.byteOffset,t.byteLength),a=void 0===n?t.byteLength:i+n;for(;a-i>=4;)r+=kd(o.getUint32(i)),i+=4;for(;a-i>=2;)r+=kd(o.getUint16(i)),i+=2;for(;a-i>=1;)r+=kd(o.getUint8(i)),i+=1;return r}function kd(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}const Od=Object.freeze(Object.defineProperty({__proto__:null,BitIterator:Sd,getBit:vd,getBool:gd,packBools:xd,popcnt_array:Id,popcnt_bit_range:Ad,popcnt_uint32:kd,setBool:function(t,e,n){return n?!!(t[e>>3]|=1<<e%8)||!0:!(t[e>>3]&=~(1<<e%8))&&!1},truncateBitmap:wd},Symbol.toStringTag,{value:"Module"}));class Td{constructor(t,e,n,r,i,o=[],a){let s;this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(r||0,-1)),i instanceof Td?(this.stride=i.stride,this.values=i.values,this.typeIds=i.typeIds,this.nullBitmap=i.nullBitmap,this.valueOffsets=i.valueOffsets):(this.stride=Zc(t),i&&((s=i[0])&&(this.valueOffsets=s),(s=i[1])&&(this.values=s),(s=i[2])&&(this.nullBitmap=s),(s=i[3])&&(this.typeIds=s))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:n,nullBitmap:r,typeIds:i}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),i&&(t+=i.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-Ad(t,this.offset,this.offset+this.length)),e}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return 0!=(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:t}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:t,_nullCount:0})}const{nullBitmap:n,offset:r}=this,i=r+t>>3,o=(r+t)%8,a=n[i]>>o&1;return e?0===a&&(n[i]|=1<<o,this._nullCount=this.nullCount+1):1===a&&(n[i]&=~(1<<o),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,n=this.length,r=this._nullCount,i=this,o=this.children){return new Td(t,e,n,r,i,o,this.dictionary)}slice(t,e){const{stride:n,typeId:r,children:i}=this,o=+(0===this._nullCount)-1,a=16===r?n:1,s=this._sliceBuffers(t,e,n,r);return this.clone(this.type,this.offset+t,e,o,s,0===i.length||this.valueOffsets?i:this._sliceChildren(i,a*t,a*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===zu.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:n}=this,r=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);r[e>>3]=(1<<e-(-8&e))-1,n>0&&r.set(wd(this.offset,e,this.nullBitmap),0);const i=this.buffers;return i[Fu.VALIDITY]=r,this.clone(this.type,0,t,n+(t-e),i)}_sliceBuffers(t,e,n,r){let i;const{buffers:o}=this;return(i=o[Fu.TYPE])&&(o[Fu.TYPE]=i.subarray(t,t+e)),(i=o[Fu.OFFSET])&&(o[Fu.OFFSET]=i.subarray(t,t+e+1))||(i=o[Fu.DATA])&&(o[Fu.DATA]=6===r?i:i.subarray(n*t,n*(t+e))),o}_sliceChildren(t,e,n){return t.map((t=>t.slice(e,n)))}}Td.prototype.children=Object.freeze([]);class Ld extends Jc{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:n=0,length:r=0}=t;return new Td(e,n,r,0)}visitBool(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length>>3,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitInt(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitFloat(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitUtf8(t){const{type:e,offset:n=0}=t,r=lu(t.data),i=lu(t.nullBitmap),o=su(t.valueOffsets),{length:a=o.length-1,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Td(e,n,a,s,[o,r,i])}visitBinary(t){const{type:e,offset:n=0}=t,r=lu(t.data),i=lu(t.nullBitmap),o=su(t.valueOffsets),{length:a=o.length-1,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Td(e,n,a,s,[o,r,i])}visitFixedSizeBinary(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length/Zc(e),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitDate(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length/Zc(e),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitTimestamp(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length/Zc(e),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitTime(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length/Zc(e),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitDecimal(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length/Zc(e),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitList(t){const{type:e,offset:n=0,child:r}=t,i=lu(t.nullBitmap),o=su(t.valueOffsets),{length:a=o.length-1,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Td(e,n,a,s,[o,void 0,i],[r])}visitStruct(t){const{type:e,offset:n=0,children:r=[]}=t,i=lu(t.nullBitmap),{length:o=r.reduce(((t,{length:e})=>Math.max(t,e)),0),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,void 0,i],r)}visitUnion(t){const{type:e,offset:n=0,children:r=[]}=t,i=lu(t.nullBitmap),o=au(e.ArrayType,t.typeIds),{length:a=o.length,nullCount:s=(t.nullBitmap?-1:0)}=t;if(yc.isSparseUnion(e))return new Td(e,n,a,s,[void 0,void 0,i,o],r);const l=su(t.valueOffsets);return new Td(e,n,a,s,[l,void 0,i,o],r)}visitDictionary(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.indices.ArrayType,t.data),{dictionary:o=new nh([(new Ld).visit({type:e.dictionary})])}=t,{length:a=i.length,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Td(e,n,a,s,[void 0,i,r],[],o)}visitInterval(t){const{type:e,offset:n=0}=t,r=lu(t.nullBitmap),i=au(e.ArrayType,t.data),{length:o=i.length/Zc(e),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,i,r])}visitFixedSizeList(t){const{type:e,offset:n=0,child:r=(new Ld).visit({type:e.valueType})}=t,i=lu(t.nullBitmap),{length:o=r.length/Zc(e),nullCount:a=(t.nullBitmap?-1:0)}=t;return new Td(e,n,o,a,[void 0,void 0,i],[r])}visitMap(t){const{type:e,offset:n=0,child:r=(new Ld).visit({type:e.childType})}=t,i=lu(t.nullBitmap),o=su(t.valueOffsets),{length:a=o.length-1,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Td(e,n,a,s,[o,void 0,i],[r])}}function Md(t){return(new Ld).visit(t)}class Bd{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function Ed(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function Dd(t){return t.reduce(((t,e,n)=>(t[n+1]=t[n]+e.length,t)),new Uint32Array(t.length+1))}function jd(t,e,n,r){const i=[];for(let o=-1,a=t.length;++o<a;){const a=t[o],s=e[o],{length:l}=a;if(s>=r)break;if(n>=s+l)continue;if(s>=n&&s+l<=r){i.push(a);continue}const u=Math.max(0,n-s),c=Math.min(r-s,l);i.push(a.slice(u,c-u))}return 0===i.length&&i.push(t[0].slice(0,0)),i}function zd(t,e,n,r){let i=0,o=0,a=e.length-1;do{if(i>=a-1)return n<e[a]?r(t,i,n-e[i]):null;o=i+Math.trunc(.5*(a-i)),n<e[o]?a=o:i=o}while(i<a)}function Cd(t,e){return t.getValid(e)}function Fd(t){function e(e,n,r){return t(e[n],r)}return function(t){return zd(this.data,this._offsets,t,e)}}function Nd(t){let e;function n(n,r,i){return t(n[r],i,e)}return function(t,r){const i=this.data;e=r;const o=zd(i,this._offsets,t,n);return e=void 0,o}}function Rd(t){let e;function n(n,r,i){let o=i,a=0,s=0;for(let i=r-1,l=n.length;++i<l;){const r=n[i];if(~(a=t(r,e,o)))return s+a;o=0,s+=r.length}return-1}return function(t,r){e=t;const i=this.data,o="number"!=typeof r?n(i,0,0):zd(i,this._offsets,r,n);return e=void 0,o}}class Ud extends Jc{}function Pd(t,e,n){if(void 0===e)return-1;if(null===e)return function(t,e){const{nullBitmap:n}=t;if(!n||t.nullCount<=0)return-1;let r=0;for(const i of new Sd(n,t.offset+(e||0),t.length,n,gd)){if(!i)return r;++r}return-1}(t,n);const r=ad.getVisitFn(t),i=_d(e);for(let e=(n||0)-1,o=t.length;++e<o;)if(i(r(t,e)))return e;return-1}function Vd(t,e,n){const r=ad.getVisitFn(t),i=_d(e);for(let e=(n||0)-1,o=t.length;++e<o;)if(i(r(t,e)))return e;return-1}Ud.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},Ud.prototype.visitBool=Pd,Ud.prototype.visitInt=Pd,Ud.prototype.visitInt8=Pd,Ud.prototype.visitInt16=Pd,Ud.prototype.visitInt32=Pd,Ud.prototype.visitInt64=Pd,Ud.prototype.visitUint8=Pd,Ud.prototype.visitUint16=Pd,Ud.prototype.visitUint32=Pd,Ud.prototype.visitUint64=Pd,Ud.prototype.visitFloat=Pd,Ud.prototype.visitFloat16=Pd,Ud.prototype.visitFloat32=Pd,Ud.prototype.visitFloat64=Pd,Ud.prototype.visitUtf8=Pd,Ud.prototype.visitBinary=Pd,Ud.prototype.visitFixedSizeBinary=Pd,Ud.prototype.visitDate=Pd,Ud.prototype.visitDateDay=Pd,Ud.prototype.visitDateMillisecond=Pd,Ud.prototype.visitTimestamp=Pd,Ud.prototype.visitTimestampSecond=Pd,Ud.prototype.visitTimestampMillisecond=Pd,Ud.prototype.visitTimestampMicrosecond=Pd,Ud.prototype.visitTimestampNanosecond=Pd,Ud.prototype.visitTime=Pd,Ud.prototype.visitTimeSecond=Pd,Ud.prototype.visitTimeMillisecond=Pd,Ud.prototype.visitTimeMicrosecond=Pd,Ud.prototype.visitTimeNanosecond=Pd,Ud.prototype.visitDecimal=Pd,Ud.prototype.visitList=Pd,Ud.prototype.visitStruct=Pd,Ud.prototype.visitUnion=Pd,Ud.prototype.visitDenseUnion=Vd,Ud.prototype.visitSparseUnion=Vd,Ud.prototype.visitDictionary=Pd,Ud.prototype.visitInterval=Pd,Ud.prototype.visitIntervalDayTime=Pd,Ud.prototype.visitIntervalYearMonth=Pd,Ud.prototype.visitFixedSizeList=Pd,Ud.prototype.visitMap=Pd;const $d=new Ud;class Wd extends Jc{}function Yd(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(e.typeId===zu.Timestamp||e instanceof gc&&64!==e.bitWidth||e instanceof Nc&&64!==e.bitWidth||e instanceof Tc&&e.precision!==Iu.HALF))return new Bd(t.data.length,(e=>{const n=t.data[e];return n.values.subarray(0,n.length)[Symbol.iterator]()}));let n=0;return new Bd(t.data.length,(e=>{const r=t.data[e].length,i=t.slice(n,n+r);return n+=r,new Gd(i)}))}class Gd{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Wd.prototype.visitNull=Yd,Wd.prototype.visitBool=Yd,Wd.prototype.visitInt=Yd,Wd.prototype.visitInt8=Yd,Wd.prototype.visitInt16=Yd,Wd.prototype.visitInt32=Yd,Wd.prototype.visitInt64=Yd,Wd.prototype.visitUint8=Yd,Wd.prototype.visitUint16=Yd,Wd.prototype.visitUint32=Yd,Wd.prototype.visitUint64=Yd,Wd.prototype.visitFloat=Yd,Wd.prototype.visitFloat16=Yd,Wd.prototype.visitFloat32=Yd,Wd.prototype.visitFloat64=Yd,Wd.prototype.visitUtf8=Yd,Wd.prototype.visitBinary=Yd,Wd.prototype.visitFixedSizeBinary=Yd,Wd.prototype.visitDate=Yd,Wd.prototype.visitDateDay=Yd,Wd.prototype.visitDateMillisecond=Yd,Wd.prototype.visitTimestamp=Yd,Wd.prototype.visitTimestampSecond=Yd,Wd.prototype.visitTimestampMillisecond=Yd,Wd.prototype.visitTimestampMicrosecond=Yd,Wd.prototype.visitTimestampNanosecond=Yd,Wd.prototype.visitTime=Yd,Wd.prototype.visitTimeSecond=Yd,Wd.prototype.visitTimeMillisecond=Yd,Wd.prototype.visitTimeMicrosecond=Yd,Wd.prototype.visitTimeNanosecond=Yd,Wd.prototype.visitDecimal=Yd,Wd.prototype.visitList=Yd,Wd.prototype.visitStruct=Yd,Wd.prototype.visitUnion=Yd,Wd.prototype.visitDenseUnion=Yd,Wd.prototype.visitSparseUnion=Yd,Wd.prototype.visitDictionary=Yd,Wd.prototype.visitInterval=Yd,Wd.prototype.visitIntervalDayTime=Yd,Wd.prototype.visitIntervalYearMonth=Yd,Wd.prototype.visitFixedSizeList=Yd,Wd.prototype.visitMap=Yd;const qd=new Wd,Hd=(t,e)=>t+e;class Xd extends Jc{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return t.type.bitWidth/8}visitDate(t,e){return 4*(t.type.unit+1)}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===Lu.SECOND?4:8}visitInterval(t,e){return 4*(t.type.unit+1)}visitStruct(t,e){return t.children.reduce(((t,n)=>t+Kd.visit(n,e)),0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return 8+t.children.reduce(((t,n)=>t+Kd.visit(n,e)),0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+((null===(n=t.dictionary)||void 0===n?void 0:n.getByteLength(t.values[e]))||0)}}const Zd=({type:t,children:e,typeIds:n,valueOffsets:r},i)=>{const o=t.typeIdToChildIndex[n[i]];return 8+Kd.visit(e[o],r[i])},Jd=({children:t},e)=>4+Kd.visitMany(t,t.map((()=>e))).reduce(Hd,0);Xd.prototype.visitUtf8=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Xd.prototype.visitBinary=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Xd.prototype.visitList=({valueOffsets:t,stride:e,children:n},r)=>{const i=n[0],{[r*e]:o}=t,{[r*e+1]:a}=t,s=Kd.getVisitFn(i.type),l=i.slice(o,a-o);let u=8;for(let t=-1,e=a-o;++t<e;)u+=s(l,t);return u},Xd.prototype.visitFixedSizeList=({stride:t,children:e},n)=>{const r=e[0],i=r.slice(n*t,t),o=Kd.getVisitFn(r.type);let a=0;for(let t=-1,e=i.length;++t<e;)a+=o(i,t);return a},Xd.prototype.visitUnion=(t,e)=>t.type.mode===Su.Dense?Zd(t,e):Jd(t,e),Xd.prototype.visitDenseUnion=Zd,Xd.prototype.visitSparseUnion=Jd;const Kd=new Xd;var Qd;const th={},eh={};class nh{constructor(t){var e,n,r;const i=t[0]instanceof nh?t.flatMap((t=>t.data)):t;if(0===i.length||i.some((t=>!(t instanceof Td))))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=null===(e=i[0])||void 0===e?void 0:e.type;switch(i.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:n,byteLength:r}=th[o.typeId],a=i[0];this.isValid=t=>Cd(a,t),this.get=e=>t(a,e),this.set=(t,n)=>e(a,t,n),this.indexOf=t=>n(a,t),this.getByteLength=t=>r(a,t),this._offsets=[0,a.length];break}default:Object.setPrototypeOf(this,eh[o.typeId]),this._offsets=Dd(i)}this.data=i,this.type=o,this.stride=Zc(o),this.numChildren=null!==(r=null===(n=o.children)||void 0===n?void 0:n.length)&&void 0!==r?r:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return-1===this._byteLength&&(this._byteLength=this.data.reduce(((t,e)=>t+e.byteLength),0)),this._byteLength}get nullCount(){return-1===this._nullCount&&(this._nullCount=Ed(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${zu[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return qd.visit(this)}concat(...t){return new nh(this.data.concat(t.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new nh(hd(this,t,e,(({data:t,_offsets:e},n,r)=>jd(t,e,n,r))))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:n,stride:r,ArrayType:i}=this;switch(t.typeId){case zu.Int:case zu.Float:case zu.Decimal:case zu.Time:case zu.Timestamp:switch(e.length){case 0:return new i;case 1:return e[0].values.subarray(0,n*r);default:return e.reduce(((t,{values:e,length:n})=>(t.array.set(e.subarray(0,n*r),t.offset),t.offset+=n*r,t)),{array:new i(n*r),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new nh(this.data.map((({children:e})=>e[t]))):null}get isMemoized(){return!!yc.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(yc.isDictionary(this.type)){const t=new rh(this.data[0].dictionary),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new nh(e)}return new rh(this)}unmemoize(){if(yc.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new nh(e)}return this}}Qd=Symbol.toStringTag,nh[Qd]=(t=>{t.type=yc.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._nullCount=-1,t._byteLength=-1,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(zu).map((t=>zu[t])).filter((t=>"number"==typeof t&&t!==zu.NONE));for(const n of e){const e=ad.getVisitFnByTypeId(n),r=Df.getVisitFnByTypeId(n),i=$d.getVisitFnByTypeId(n),o=Kd.getVisitFnByTypeId(n);th[n]={get:e,set:r,indexOf:i,byteLength:o},eh[n]=Object.create(t,{isValid:{value:Fd(Cd)},get:{value:Fd(ad.getVisitFnByTypeId(n))},set:{value:Nd(Df.getVisitFnByTypeId(n))},indexOf:{value:Rd($d.getVisitFnByTypeId(n))},getByteLength:{value:Fd(Kd.getVisitFnByTypeId(n))}})}return"Vector"})(nh.prototype);class rh extends nh{constructor(t){super(t.data);const e=this.get,n=this.set,r=this.slice,i=new Array(this.length);Object.defineProperty(this,"get",{value(t){const n=i[t];if(void 0!==n)return n;const r=e.call(this,t);return i[t]=r,r}}),Object.defineProperty(this,"set",{value(t,e){n.call(this,t,e),i[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new rh(r.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new nh(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}function ih(t){if(t){if(t instanceof Td)return new nh([t]);if(t instanceof nh)return new nh(t.data);if(t.type instanceof yc)return new nh([Md(t)]);if(Array.isArray(t))return new nh(t.flatMap((t=>{return(e=t)instanceof Td?[e]:e instanceof nh?e.data:ih(e).data;var e})));if(ArrayBuffer.isView(t)){t instanceof DataView&&(t=new Uint8Array(t.buffer));const e={offset:0,length:t.length,nullCount:0,data:t};if(t instanceof Int8Array)return new nh([Md(Object.assign(Object.assign({},e),{type:new vc}))]);if(t instanceof Int16Array)return new nh([Md(Object.assign(Object.assign({},e),{type:new wc}))]);if(t instanceof Int32Array)return new nh([Md(Object.assign(Object.assign({},e),{type:new xc}))]);if(t instanceof Ul)return new nh([Md(Object.assign(Object.assign({},e),{type:new Sc}))]);if(t instanceof Uint8Array||t instanceof Uint8ClampedArray)return new nh([Md(Object.assign(Object.assign({},e),{type:new Ac}))]);if(t instanceof Uint16Array)return new nh([Md(Object.assign(Object.assign({},e),{type:new Ic}))]);if(t instanceof Uint32Array)return new nh([Md(Object.assign(Object.assign({},e),{type:new kc}))]);if(t instanceof Vl)return new nh([Md(Object.assign(Object.assign({},e),{type:new Oc}))]);if(t instanceof Float32Array)return new nh([Md(Object.assign(Object.assign({},e),{type:new Mc}))]);if(t instanceof Float64Array)return new nh([Md(Object.assign(Object.assign({},e),{type:new Bc}))]);throw new Error("Unrecognized input")}}throw new Error("Unrecognized input")}const oh=(t,e)=>(Math.ceil(t)*e+63&-64||64)/e;class ah{constructor(t,e=1){this.buffer=t,this.stride=e,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=Math.ceil(t.length/e))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,e){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;const e=this.stride,n=this.length*e,r=this.buffer.length;n>=r&&this._resize(oh(0===r?1*n:2*n,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=oh(t*this.stride,this.BYTES_PER_ELEMENT);const e=((t,e=0)=>t.length>=e?t.subarray(0,e):iu(new t.constructor(e),t,0))(this.buffer,t);return this.clear(),e}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=iu(new this.ArrayType(t),this.buffer)}}ah.prototype.offset=0;class sh extends ah{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,e){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=e,this}}class lh extends sh{constructor(t=new Uint8Array(0)){super(t,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,e){const{buffer:n}=this.reserve(t-this.length+1),r=t>>3,i=t%8,o=n[r]>>i&1;return e?0===o&&(n[r]|=1<<i,++this.numValid):1===o&&(n[r]&=~(1<<i),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class uh extends sh{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,e){const n=this.length-1,r=this.reserve(t-n+1).buffer;return n<t++&&r.fill(r[n],n,t),r[t]=r[t-1]+e,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}}let ch=class{constructor({type:t,nullValues:e}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=e,this.stride=Zc(t),this._nulls=new lh,e&&e.length>0&&(this._isValid=function(t){if(!t||t.length<=0)return function(t){return!0};let e="";const n=t.filter((t=>t==t));return n.length>0&&(e=`\n    switch (x) {${n.map((t=>`\n        case ${function(t){return"bigint"!=typeof t?Ru(t):Rl?`${Ru(t)}n`:`"${Ru(t)}"`}(t)}:`)).join("")}\n            return false;\n    }`),t.length!==n.length&&(e=`if (x !== x) return false;\n${e}`),new Function("x",`${e}\nreturn true;`)}(e))}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}toVector(){return new nh([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0;const{_offsets:e,_values:n,_nulls:r,_typeIds:i,children:o}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),i&&(t+=i.byteLength),o.reduce(((t,e)=>t+e.byteLength),t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce(((t,e)=>t+e.reservedByteLength),t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,e){return this.setValid(t,this.isValid(e))&&this.setValue(t,e),this}setValue(t,e){this._setValue(this,t,e)}setValid(t,e){return this.length=this._nulls.set(t,+e).length,e}addChild(t,e=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,e,n,r;const{type:i,length:o,nullCount:a,_typeIds:s,_offsets:l,_values:u,_nulls:c}=this;(e=null==s?void 0:s.flush(o))?r=null==l?void 0:l.flush(o):t=(r=null==l?void 0:l.flush(o))?null==u?void 0:u.flush(l.last()):null==u?void 0:u.flush(o),a>0&&(n=null==c?void 0:c.flush(o));const f=this.children.map((t=>t.flush()));return this.clear(),Md({type:i,length:o,nullCount:a,children:f,child:f[0],data:t,typeIds:e,nullBitmap:n,valueOffsets:r})}finish(){this.finished=!0;for(const t of this.children)t.finish();return this}clear(){var t,e,n,r;this.length=0,null===(t=this._nulls)||void 0===t||t.clear(),null===(e=this._values)||void 0===e||e.clear(),null===(n=this._offsets)||void 0===n||n.clear(),null===(r=this._typeIds)||void 0===r||r.clear();for(const t of this.children)t.clear();return this}};ch.prototype.length=1,ch.prototype.stride=1,ch.prototype.children=null,ch.prototype.finished=!1,ch.prototype.nullValues=null,ch.prototype._isValid=()=>!0;class fh extends ch{constructor(t){super(t),this._values=new sh(new this.ArrayType(0),this.stride)}setValue(t,e){const n=this._values;return n.reserve(t-n.length+1),super.setValue(t,e)}}class dh extends ch{constructor(t){super(t),this._pendingLength=0,this._offsets=new uh}setValue(t,e){const n=this._pending||(this._pending=new Map),r=n.get(t);r&&(this._pendingLength-=r.length),this._pendingLength+=e instanceof ud?e[sd].length:e.length,n.set(t,e)}setValid(t,e){return!!super.setValid(t,e)||((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const t=this._pending,e=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,e),this}}class hh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,r){return t.prep(8,24),t.writeInt64(r),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}}const ph=new Int32Array(2),_h=new Float32Array(ph.buffer),mh=new Float64Array(ph.buffer),yh=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];let bh=class t{constructor(t,e){this.low=0|t,this.high=0|e}static create(e,n){return 0==e&&0==n?t.ZERO:new t(e,n)}toFloat64(){return(this.low>>>0)+4294967296*this.high}equals(t){return this.low==t.low&&this.high==t.high}};var gh,vh;bh.ZERO=new bh(0,0),(vh=gh||(gh={}))[vh.UTF8_BYTES=1]="UTF8_BYTES",vh[vh.UTF16_STRING=2]="UTF16_STRING";let wh=class t{constructor(t){this.bytes_=t,this.position_=0}static allocate(e){return new t(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new bh(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new bh(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return ph[0]=this.readInt32(t),_h[0]}readFloat64(t){return ph[yh?0:1]=this.readInt32(t),ph[yh?1:0]=this.readInt32(t+4),mh[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){_h[0]=e,this.writeInt32(t,ph[0])}writeFloat64(t,e){mh[0]=e,this.writeInt32(t,ph[yh?0:1]),this.writeInt32(t+4,ph[yh?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);let r="",i=0;if(t+=4,e===gh.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;i<n;){let e;const n=this.readUint8(t+i++);if(n<192)e=n;else{const r=this.readUint8(t+i++);if(n<224)e=(31&n)<<6|63&r;else{const o=this.readUint8(t+i++);e=n<240?(15&n)<<12|(63&r)<<6|63&o:(7&n)<<18|(63&r)<<12|(63&o)<<6|63&this.readUint8(t+i++)}}e<65536?r+=String.fromCharCode(e):(e-=65536,r+=String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return r}__union_with_string(t,e){return"string"==typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return bh.create(t,e)}createScalarList(t,e){const n=[];for(let r=0;r<e;++r)null!==t(r)&&n.push(t(r));return n}createObjList(t,e){const n=[];for(let r=0;r<e;++r){const e=t(r);null!==e&&n.push(e.unpack())}return n}},xh=class t{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,e=t||1024,this.bb=wh.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(e,n){e>this.minalign&&(this.minalign=e);const r=1+~(this.bb.capacity()-this.space+n)&e-1;for(;this.space<r+e+n;){const e=this.bb.capacity();this.bb=t.growByteBuffer(this.bb),this.space+=this.bb.capacity()-e}this.pad(r)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){!this.force_defaults&&e.equals(n)||(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,r=wh.allocate(n);return r.setPosition(n-e),r.bytes().set(t.bytes(),n-e),r}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const n=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const r=2*(n+2);this.addInt16(r);let i=0;const o=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(r==this.bb.readInt16(t)){for(let e=2;e<r;e+=2)if(this.bb.readInt16(o+e)!=this.bb.readInt16(t+e))continue t;i=this.vtables[e];break}}return i?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,i-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const r=n?4:0;if(e){const t=e;if(this.prep(this.minalign,8+r),4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=3;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,4+r),this.addOffset(t),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,r=n-this.bb.readInt32(n);if(0==this.bb.readInt16(r+e))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let r;const i=t.charCodeAt(n++);r=i<55296||i>=56320?i:(i<<10)+t.charCodeAt(n++)+-56613888,r<128?e.push(r):(r<2048?e.push(r>>6&31|192):(r<65536?e.push(r>>12&15|224):e.push(r>>18&7|240,r>>12&63|128),e.push(r>>6&63|128)),e.push(63&r|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let t=0,n=this.space,r=this.bb.bytes();t<e.length;t++)r[n++]=e[t];return this.endVector()}createLong(t,e){return bh.create(t,e)}createObjectOffset(t){return null===t?0:"string"==typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n];if(null===r)throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(r))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}};class Sh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return Sh.startKeyValue(t),Sh.addKey(t,e),Sh.addValue(t,n),Sh.endKeyValue(t)}}var Ah,Ih,kh,Oh,Th,Lh;!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(Ah||(Ah={})),(kh=Ih||(Ih={}))[kh.Little=0]="Little",kh[kh.Big=1]="Big",(Th=Oh||(Oh={}))[Th.DenseArray=0]="DenseArray";class Mh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new Mh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new Mh).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return Mh.startInt(t),Mh.addBitWidth(t,e),Mh.addIsSigned(t,n),Mh.endInt(t)}}class Bh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new Bh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new Bh).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Mh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Oh.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,Oh.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class Eh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new Eh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new Eh).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return Eh.startBinary(t),Eh.endBinary(t)}}class Dh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new Dh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new Dh).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Dh.startBool(t),Dh.endBool(t)}}!function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(Lh||(Lh={}));let jh=class t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDate(e,n){return e.setPosition(e.position()+4),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Lh.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Lh.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(e,n){return t.startDate(e),t.addUnit(e,n),t.endDate(e)}};class zh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new zh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new zh).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,r){return zh.startDecimal(t),zh.addPrecision(t,e),zh.addScale(t,n),zh.addBitWidth(t,r),zh.endDecimal(t)}}var Ch,Fh,Nh;!function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(Ch||(Ch={}));class Rh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new Rh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new Rh).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return Rh.startFixedSizeBinary(t),Rh.addByteWidth(t,e),Rh.endFixedSizeBinary(t)}}class Uh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new Uh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new Uh).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return Uh.startFixedSizeList(t),Uh.addListSize(t,e),Uh.endFixedSizeList(t)}}!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(Fh||(Fh={}));class Ph{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new Ph).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new Ph).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Fh.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,Fh.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return Ph.startFloatingPoint(t),Ph.addPrecision(t,e),Ph.endFloatingPoint(t)}}!function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(Nh||(Nh={}));class Vh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new Vh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new Vh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Nh.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Nh.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return Vh.startInterval(t),Vh.addUnit(t,e),Vh.endInterval(t)}}class $h{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new $h).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new $h).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return $h.startList(t),$h.endList(t)}}let Wh=class t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMap(e,n){return e.setPosition(e.position()+4),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(e,n){return t.startMap(e),t.addKeysSorted(e,n),t.endMap(e)}};class Yh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new Yh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new Yh).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return Yh.startNull(t),Yh.endNull(t)}}class Gh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new Gh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new Gh).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Gh.startStruct_(t),Gh.endStruct_(t)}}class qh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new qh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new qh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ch.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Ch.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return qh.startTime(t),qh.addUnit(t,e),qh.addBitWidth(t,n),qh.endTime(t)}}class Hh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Hh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new Hh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ch.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Ch.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return Hh.startTimestamp(t),Hh.addUnit(t,e),Hh.addTimezone(t,n),Hh.endTimestamp(t)}}var Xh,Zh;!function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(Xh||(Xh={}));class Jh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new Jh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new Jh).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Xh.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*t):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,Xh.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return Jh.startUnion(t),Jh.addMode(t,e),Jh.addTypeIds(t,n),Jh.endUnion(t)}}class Kh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new Kh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new Kh).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Kh.startUtf8(t),Kh.endUtf8(t)}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList"}(Zh||(Zh={}));let Qh=class t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsField(e,n){return e.setPosition(e.position()+4),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):Zh.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new Bh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(e,n){const r=this.bb.__offset(this.bb_pos,14);return r?(n||new t).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*e),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,16);return n?(e||new Sh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,Zh.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}},tp=class t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSchema(e,n){return e.setPosition(e.position()+4),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ih.Little}fields(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Qh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Sh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,Ih.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(e,n,r,i,o){return t.startSchema(e),t.addEndianness(e,n),t.addFields(e,r),t.addCustomMetadata(e,i),t.addFeatures(e,o),t.endSchema(e)}};class ep{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new ep).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new ep).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ah.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new tp).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new hh).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new hh).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new Sh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Ah.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}class np{constructor(t=[],e,n){this.fields=t||[],this.metadata=e||new Map,n||(n=op(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),n=this.fields.filter((t=>e.has(t.name)));return new np(n,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new np(e,this.metadata)}assign(...t){const e=t[0]instanceof np?t[0]:Array.isArray(t[0])?new np(t[0]):new np(t),n=[...this.fields],r=ip(ip(new Map,this.metadata),e.metadata),i=e.fields.filter((t=>{const e=n.findIndex((e=>e.name===t.name));return!~e||(n[e]=t.clone({metadata:ip(ip(new Map,n[e].metadata),t.metadata)}))&&!1})),o=op(i,new Map);return new np([...n,...i],r,new Map([...this.dictionaries,...o]))}}np.prototype.fields=null,np.prototype.metadata=null,np.prototype.dictionaries=null;class rp{constructor(t,e,n=!1,r){this.name=t,this.type=e,this.nullable=n,this.metadata=r||new Map}static new(...t){let[e,n,r,i]=t;return t[0]&&"object"==typeof t[0]&&(({name:e}=t[0]),void 0===n&&(n=t[0].type),void 0===r&&(r=t[0].nullable),void 0===i&&(i=t[0].metadata)),new rp(`${e}`,n,r,i)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,r,i]=t;return t[0]&&"object"==typeof t[0]?({name:e=this.name,type:n=this.type,nullable:r=this.nullable,metadata:i=this.metadata}=t[0]):[e=this.name,n=this.type,r=this.nullable,i=this.metadata]=t,rp.new(e,n,r,i)}}function ip(t,e){return new Map([...t||new Map,...e||new Map])}function op(t,e=new Map){for(let n=-1,r=t.length;++n<r;){const r=t[n].type;if(yc.isDictionary(r))if(e.has(r.id)){if(e.get(r.id)!==r.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(r.id,r.dictionary);r.children&&r.children.length>0&&op(r.children,e)}return e}rp.prototype.type=null,rp.prototype.name=null,rp.prototype.nullable=null,rp.prototype.metadata=null;var ap=bh,sp=xh,lp=wh;class up{constructor(t,e=wu.V4,n,r){this.schema=t,this.version=e,n&&(this._recordBatches=n),r&&(this._dictionaryBatches=r)}static decode(t){t=new lp(lu(t));const e=ep.getRootAsFooter(t),n=np.decode(e.schema());return new cp(n,e)}static encode(t){const e=new sp,n=np.encode(e,t.schema);ep.startRecordBatchesVector(e,t.numRecordBatches);for(const n of[...t.recordBatches()].slice().reverse())fp.encode(e,n);const r=e.endVector();ep.startDictionariesVector(e,t.numDictionaries);for(const n of[...t.dictionaryBatches()].slice().reverse())fp.encode(e,n);const i=e.endVector();return ep.startFooter(e),ep.addSchema(e,n),ep.addVersion(e,wu.V4),ep.addRecordBatches(e,r),ep.addDictionaries(e,i),ep.finishFooterBuffer(e,ep.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class cp extends up{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return fp.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return fp.decode(e)}return null}}class fp{constructor(t,e,n){this.metaDataLength=t,this.offset="number"==typeof n?n:n.low,this.bodyLength="number"==typeof e?e:e.low}static decode(t){return new fp(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:n}=e,r=new ap(e.offset,0),i=new ap(e.bodyLength,0);return hh.createBlock(t,r,n,i)}}const dp=Object.freeze({done:!0,value:void 0});class hp{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class pp{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class _p extends pp{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}get closed(){return this._closedPromise}cancel(t){return Ll(this,void 0,void 0,(function*(){yield this.return(t)}))}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(dp);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return yu.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return yu.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return Ll(this,void 0,void 0,(function*(){return yield this.abort(t),dp}))}return(t){return Ll(this,void 0,void 0,(function*(){return yield this.close(),dp}))}read(t){return Ll(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return Ll(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((t,e)=>{this.resolvers.push({resolve:t,reject:e})})):Promise.resolve(dp)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class mp extends _p{write(t){if((t=lu(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?zl(this.toUint8Array(!0)):this.toUint8Array(!1).then(zl)}toUint8Array(t=!1){return t?ou(this._values)[0]:(()=>Ll(this,void 0,void 0,(function*(){var t,e;const n=[];let r=0;try{for(var i,o=Dl(this);!(i=yield o.next()).done;){const t=i.value;n.push(t),r+=t.byteLength}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=o.return)&&(yield e.call(o))}finally{if(t)throw t.error}}return ou(n,r)[0]})))()}}class yp{constructor(t){t&&(this.source=new gp(yu.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class bp{constructor(t){t instanceof bp?this.source=t.source:t instanceof mp?this.source=new vp(yu.fromAsyncIterable(t)):nu(t)?this.source=new vp(yu.fromNodeStream(t)):eu(t)?this.source=new vp(yu.fromDOMStream(t)):Ql(t)?this.source=new vp(yu.fromDOMStream(t.body)):Hl(t)?this.source=new vp(yu.fromIterable(t)):(ql(t)||Xl(t))&&(this.source=new vp(yu.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class gp{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||dp)}return(t){return Object.create(this.source.return&&this.source.return(t)||dp)}}class vp{constructor(t){this.source=t,this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}cancel(t){return Ll(this,void 0,void 0,(function*(){yield this.return(t)}))}get closed(){return this._closedPromise}read(t){return Ll(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return Ll(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(t,e="read"){return Ll(this,void 0,void 0,(function*(){return yield this.source.next({cmd:e,size:t})}))}throw(t){return Ll(this,void 0,void 0,(function*(){const e=this.source.throw&&(yield this.source.throw(t))||dp;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}return(t){return Ll(this,void 0,void 0,(function*(){const e=this.source.return&&(yield this.source.return(t))||dp;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}}class wp extends yp{constructor(t,e){super(),this.position=0,this.buffer=lu(t),this.size=void 0===e?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:n,position:r}=this;return e&&r<n?("number"!=typeof t&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,r+Math.min(n-r,t)),e.subarray(r,this.position)):null}readAt(t,e){const n=this.buffer,r=Math.min(this.size,t+e);return n?n.subarray(t,r):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class xp extends bp{constructor(t,e){super(),this.position=0,this._handle=t,"number"==typeof e?this.size=e:this._pending=(()=>Ll(this,void 0,void 0,(function*(){this.size=(yield t.stat()).size,delete this._pending})))()}readInt32(t){return Ll(this,void 0,void 0,(function*(){const{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}))}seek(t){return Ll(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size}))}read(t){return Ll(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:e,size:n,position:r}=this;if(e&&r<n){"number"!=typeof t&&(t=Number.POSITIVE_INFINITY);let i=r,o=0,a=0;const s=Math.min(n,i+Math.min(n-i,t)),l=new Uint8Array(Math.max(0,(this.position=s)-i));for(;(i+=a)<s&&(o+=a)<l.byteLength;)({bytesRead:a}=yield e.read(l,o,l.byteLength-o,i));return l}return null}))}readAt(t,e){return Ll(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:n,size:r}=this;if(n&&t+e<r){const i=Math.min(r,t+e),o=new Uint8Array(i-t);return(yield n.read(o,0,e,t)).buffer}return new Uint8Array(e)}))}close(){return Ll(this,void 0,void 0,(function*(){const t=this._handle;this._handle=null,t&&(yield t.close())}))}throw(t){return Ll(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}return(t){return Ll(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}}function Sp(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const Ap=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class Ip{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([t.buffer[1]>>>16,65535&t.buffer[1],t.buffer[0]>>>16,65535&t.buffer[0]]);let r=e[3]*n[3];this.buffer[0]=65535&r;let i=r>>>16;return r=e[2]*n[3],i+=r,r=e[3]*n[2]>>>0,i+=r,this.buffer[0]+=i<<16,this.buffer[1]=i>>>0<r?65536:0,this.buffer[1]+=i>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Sp(this.buffer[1])} ${Sp(this.buffer[0])}`}}class kp extends Ip{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return kp.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return kp.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.length,r=new kp(e);for(let e=0;e<n;){const i=8<n-e?8:n-e,o=new kp(new Uint32Array([Number.parseInt(t.slice(e,e+i),10),0])),a=new kp(new Uint32Array([Ap[i],0]));r.times(a),r.plus(o),e+=i}return r}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,r=t.length;++n<r;)kp.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new kp(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new kp(new Uint32Array(t.buffer)).plus(e)}}class Op extends Ip{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]<<0,n=t.buffer[1]<<0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return Op.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return Op.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.startsWith("-"),r=t.length,i=new Op(e);for(let e=n?1:0;e<r;){const n=8<r-e?8:r-e,o=new Op(new Uint32Array([Number.parseInt(t.slice(e,e+n),10),0])),a=new Op(new Uint32Array([Ap[n],0]));i.times(a),i.plus(o),e+=n}return n?i.negate():i}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,r=t.length;++n<r;)Op.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new Op(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Op(new Uint32Array(t.buffer)).plus(e)}}class Tp{constructor(t){this.buffer=t}high(){return new Op(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Op(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(t){const e=new kp(new Uint32Array([this.buffer[3],0])),n=new kp(new Uint32Array([this.buffer[2],0])),r=new kp(new Uint32Array([this.buffer[1],0])),i=new kp(new Uint32Array([this.buffer[0],0])),o=new kp(new Uint32Array([t.buffer[3],0])),a=new kp(new Uint32Array([t.buffer[2],0])),s=new kp(new Uint32Array([t.buffer[1],0])),l=new kp(new Uint32Array([t.buffer[0],0]));let u=kp.multiply(i,l);this.buffer[0]=u.low();const c=new kp(new Uint32Array([u.high(),0]));return u=kp.multiply(r,l),c.plus(u),u=kp.multiply(i,s),c.plus(u),this.buffer[1]=c.low(),this.buffer[3]=c.lessThan(u)?1:0,this.buffer[2]=c.high(),new kp(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(kp.multiply(n,l)).plus(kp.multiply(r,s)).plus(kp.multiply(i,a)),this.buffer[3]+=kp.multiply(e,l).plus(kp.multiply(n,s)).plus(kp.multiply(r,a)).plus(kp.multiply(i,o)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${Sp(this.buffer[3])} ${Sp(this.buffer[2])} ${Sp(this.buffer[1])} ${Sp(this.buffer[0])}`}static multiply(t,e){return new Tp(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Tp(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return Tp.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return Tp.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const n=t.startsWith("-"),r=t.length,i=new Tp(e);for(let e=n?1:0;e<r;){const n=8<r-e?8:r-e,o=new Tp(new Uint32Array([Number.parseInt(t.slice(e,e+n),10),0,0,0])),a=new Tp(new Uint32Array([Ap[n],0,0,0]));i.times(a),i.plus(o),e+=n}return n?i.negate():i}static convertArray(t){const e=new Uint32Array(4*t.length);for(let n=-1,r=t.length;++n<r;)Tp.from(t[n],new Uint32Array(e.buffer,e.byteOffset+16*n,4));return e}}const Lp=Object.freeze(Object.defineProperty({__proto__:null,BaseInt64:Ip,Int128:Tp,Int64:Op,Uint64:kp},Symbol.toStringTag,{value:"Module"}));class Mp extends Jc{constructor(t,e,n,r){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=r}visit(t){return super.visit(t instanceof rp?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return Md({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===Su.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return Md({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class Bp extends Mp{constructor(t,e,n,r){super(new Uint8Array(0),e,n,r),this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):xd(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return au(Uint8Array,au(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return au(Uint8Array,au(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:n}=this;return yc.isTimestamp(t)||(yc.isInt(t)||yc.isTime(t))&&64===t.bitWidth||yc.isDate(t)&&t.unit===Ou.MILLISECOND?au(Uint8Array,Op.convertArray(n[e])):yc.isDecimal(t)?au(Uint8Array,Tp.convertArray(n[e])):yc.isBinary(t)||yc.isFixedSizeBinary(t)?function(t){const e=t.join(""),n=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2)n[t>>1]=Number.parseInt(e.slice(t,t+2),16);return n}(n[e]):yc.isBool(t)?xd(n[e]):yc.isUtf8(t)?Fl(n[e].join("")):au(Uint8Array,au(t.ArrayType,n[e].map((t=>+t))))}}class Ep extends dh{constructor(t){super(t),this._values=new ah(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+4*this.length;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,lu(e))}_flushPending(t,e){const n=this._offsets,r=this._values.reserve(e).buffer;let i=0;for(const[e,o]of t)if(void 0===o)n.set(e,0);else{const t=o.length;r.set(o,i),n.set(e,t),i+=t}}}class Dp extends ch{constructor(t){super(t),this._values=new lh}setValue(t,e){this._values.set(t,+e)}}class jp extends fh{}jp.prototype._setValue=mf;class zp extends jp{}zp.prototype._setValue=hf;class Cp extends jp{}Cp.prototype._setValue=pf;class Fp extends fh{}Fp.prototype._setValue=Of;class Np extends ch{constructor({type:t,nullValues:e,dictionaryHashFunction:n}){super({type:new Xc(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=z_({type:this.type.indices,nullValues:e}),this.dictionary=z_({type:this.type.dictionary,nullValues:null}),"function"==typeof n&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,e){const n=this.indices;return e=n.setValid(t,e),this.length=n.length,e}setValue(t,e){const n=this._keysToIndices,r=this.valueToKey(e);let i=n[r];return void 0===i&&(n[r]=i=this._dictionaryOffset+this.dictionary.append(e).length-1),this.indices.setValue(t,i)}flush(){const t=this.type,e=this._dictionary,n=this.dictionary.toVector(),r=this.indices.flush().clone(t);return r.dictionary=e?e.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=r.dictionary,this.clear(),r}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return"string"==typeof t?t:`${t}`}}class Rp extends fh{}Rp.prototype._setValue=_f;class Up extends ch{setValue(t,e){const[n]=this.children,r=t*this.stride;for(let t=-1,i=e.length;++t<i;)n.set(r+t,e[t])}addChild(t,e="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const n=this.children.push(t);return this.type=new Yc(this.type.listSize,new rp(e,t.type,!0)),n}}class Pp extends fh{setValue(t,e){this._values.set(t,e)}}class Vp extends Pp{setValue(t,e){super.setValue(t,rf(e))}}class $p extends Pp{}class Wp extends Pp{}class Yp extends fh{}Yp.prototype._setValue=Mf;class Gp extends Yp{}Gp.prototype._setValue=Bf;class qp extends Yp{}qp.prototype._setValue=Ef;class Hp extends fh{setValue(t,e){this._values.set(t,e)}}class Xp extends Hp{}class Zp extends Hp{}class Jp extends Hp{}class Kp extends Hp{}class Qp extends Hp{}class t_ extends Hp{}class e_ extends Hp{}class n_ extends Hp{}class r_ extends dh{constructor(t){super(t),this._offsets=new uh}addChild(t,e="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Pc(new rp(e,t.type,!0)),this.numChildren-1}_flushPending(t){const e=this._offsets,[n]=this.children;for(const[r,i]of t)if(void 0===i)e.set(r,0);else{const t=i.length,o=e.set(r,t).buffer[r];for(let e=-1;++e<t;)n.set(o+e,i[e])}}}class i_ extends dh{set(t,e){return super.set(t,e)}setValue(t,e){const n=e instanceof Map?e:new Map(Object.entries(e)),r=this._pending||(this._pending=new Map),i=r.get(t);i&&(this._pendingLength-=i.size),this._pendingLength+=n.size,r.set(t,n)}addChild(t,e=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Gc(new rp(e,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){const e=this._offsets,[n]=this.children;for(const[r,i]of t)if(void 0===i)e.set(r,0);else{let{[r]:t,[r+1]:o}=e.set(r,i.size).buffer;for(const e of i.entries())if(n.set(t,e),++t>=o)break}}}class o_ extends ch{setValue(t,e){}setValid(t,e){return this.length=Math.max(t+1,this.length),e}}class a_ extends ch{setValue(t,e){const{children:n,type:r}=this;switch(Array.isArray(e)||e.constructor){case!0:return r.children.forEach(((r,i)=>n[i].set(t,e[i])));case Map:return r.children.forEach(((r,i)=>n[i].set(t,e.get(r.name))));default:return r.children.forEach(((r,i)=>n[i].set(t,e[r.name])))}}setValid(t,e){return super.setValid(t,e)||this.children.forEach((n=>n.setValid(t,e))),e}addChild(t,e=`${this.numChildren}`){const n=this.children.push(t);return this.type=new Vc([...this.type.children,new rp(e,t.type,!0)]),n}}class s_ extends fh{}s_.prototype._setValue=wf;class l_ extends s_{}l_.prototype._setValue=yf;class u_ extends s_{}u_.prototype._setValue=bf;class c_ extends s_{}c_.prototype._setValue=gf;class f_ extends s_{}f_.prototype._setValue=vf;class d_ extends fh{}d_.prototype._setValue=kf;class h_ extends d_{}h_.prototype._setValue=xf;class p_ extends d_{}p_.prototype._setValue=Sf;class __ extends d_{}__.prototype._setValue=Af;class m_ extends d_{}m_.prototype._setValue=If;class y_ extends ch{constructor(t){super(t),this._typeIds=new sh(new Int8Array(0),1),"function"==typeof t.valueToChildTypeId&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,e){return this.set(this.length,t,e)}set(t,e,n){return void 0===n&&(n=this._valueToChildTypeId(this,e,t)),this.setValid(t,this.isValid(e))&&this.setValue(t,e,n),this}setValue(t,e,n){this._typeIds.set(t,n);const r=this.type.typeIdToChildIndex[n],i=this.children[r];null==i||i.set(t,e)}addChild(t,e=`${this.children.length}`){const n=this.children.push(t),{type:{children:r,mode:i,typeIds:o}}=this,a=[...r,new rp(e,t.type)];return this.type=new $c(i,[...o,n],a),n}_valueToChildTypeId(t,e,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class b_ extends y_{}class g_ extends y_{constructor(t){super(t),this._offsets=new sh(new Int32Array(0))}setValue(t,e,n){const r=this._typeIds.set(t,n).buffer[t],i=this.getChildAt(this.type.typeIdToChildIndex[r]),o=this._offsets.set(t,i.length).buffer[t];null==i||i.set(o,e)}}class v_ extends dh{constructor(t){super(t),this._values=new ah(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+4*this.length;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,Fl(e))}_flushPending(t,e){}}v_.prototype._flushPending=Ep.prototype._flushPending;const w_=new class extends Jc{visitNull(){return o_}visitBool(){return Dp}visitInt(){return Hp}visitInt8(){return Xp}visitInt16(){return Zp}visitInt32(){return Jp}visitInt64(){return Kp}visitUint8(){return Qp}visitUint16(){return t_}visitUint32(){return e_}visitUint64(){return n_}visitFloat(){return Pp}visitFloat16(){return Vp}visitFloat32(){return $p}visitFloat64(){return Wp}visitUtf8(){return v_}visitBinary(){return Ep}visitFixedSizeBinary(){return Rp}visitDate(){return jp}visitDateDay(){return zp}visitDateMillisecond(){return Cp}visitTimestamp(){return s_}visitTimestampSecond(){return l_}visitTimestampMillisecond(){return u_}visitTimestampMicrosecond(){return c_}visitTimestampNanosecond(){return f_}visitTime(){return d_}visitTimeSecond(){return h_}visitTimeMillisecond(){return p_}visitTimeMicrosecond(){return __}visitTimeNanosecond(){return m_}visitDecimal(){return Fp}visitList(){return r_}visitStruct(){return a_}visitUnion(){return y_}visitDenseUnion(){return g_}visitSparseUnion(){return b_}visitDictionary(){return Np}visitInterval(){return Yp}visitIntervalDayTime(){return Gp}visitIntervalYearMonth(){return qp}visitFixedSizeList(){return Up}visitMap(){return i_}};class x_ extends Jc{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,n)=>this.compareFields(t,e[n])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function S_(t,e){return e instanceof t.constructor}function A_(t,e){return t===e||S_(t,e)}function I_(t,e){return t===e||S_(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function k_(t,e){return t===e||S_(t,e)&&t.precision===e.precision}function O_(t,e){return t===e||S_(t,e)&&t.unit===e.unit}function T_(t,e){return t===e||S_(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function L_(t,e){return t===e||S_(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function M_(t,e){return t===e||S_(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,n)=>t===e.typeIds[n]))&&E_.compareManyFields(t.children,e.children)}function B_(t,e){return t===e||S_(t,e)&&t.unit===e.unit}x_.prototype.visitNull=A_,x_.prototype.visitBool=A_,x_.prototype.visitInt=I_,x_.prototype.visitInt8=I_,x_.prototype.visitInt16=I_,x_.prototype.visitInt32=I_,x_.prototype.visitInt64=I_,x_.prototype.visitUint8=I_,x_.prototype.visitUint16=I_,x_.prototype.visitUint32=I_,x_.prototype.visitUint64=I_,x_.prototype.visitFloat=k_,x_.prototype.visitFloat16=k_,x_.prototype.visitFloat32=k_,x_.prototype.visitFloat64=k_,x_.prototype.visitUtf8=A_,x_.prototype.visitBinary=A_,x_.prototype.visitFixedSizeBinary=function(t,e){return t===e||S_(t,e)&&t.byteWidth===e.byteWidth},x_.prototype.visitDate=O_,x_.prototype.visitDateDay=O_,x_.prototype.visitDateMillisecond=O_,x_.prototype.visitTimestamp=T_,x_.prototype.visitTimestampSecond=T_,x_.prototype.visitTimestampMillisecond=T_,x_.prototype.visitTimestampMicrosecond=T_,x_.prototype.visitTimestampNanosecond=T_,x_.prototype.visitTime=L_,x_.prototype.visitTimeSecond=L_,x_.prototype.visitTimeMillisecond=L_,x_.prototype.visitTimeMicrosecond=L_,x_.prototype.visitTimeNanosecond=L_,x_.prototype.visitDecimal=A_,x_.prototype.visitList=function(t,e){return t===e||S_(t,e)&&t.children.length===e.children.length&&E_.compareManyFields(t.children,e.children)},x_.prototype.visitStruct=function(t,e){return t===e||S_(t,e)&&t.children.length===e.children.length&&E_.compareManyFields(t.children,e.children)},x_.prototype.visitUnion=M_,x_.prototype.visitDenseUnion=M_,x_.prototype.visitSparseUnion=M_,x_.prototype.visitDictionary=function(t,e){return t===e||S_(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&E_.visit(t.indices,e.indices)&&E_.visit(t.dictionary,e.dictionary)},x_.prototype.visitInterval=B_,x_.prototype.visitIntervalDayTime=B_,x_.prototype.visitIntervalYearMonth=B_,x_.prototype.visitFixedSizeList=function(t,e){return t===e||S_(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&E_.compareManyFields(t.children,e.children)},x_.prototype.visitMap=function(t,e){return t===e||S_(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&E_.compareManyFields(t.children,e.children)};const E_=new x_;function D_(t,e){return E_.compareSchemas(t,e)}function j_(t,e){return E_.visit(t,e)}function z_(t){const e=t.type,n=new(w_.getVisitFn(e)())(t);if(e.children&&e.children.length>0){const r=t.children||[],i={nullValues:t.nullValues},o=Array.isArray(r)?(t,e)=>r[e]||i:({name:t})=>r[t]||i;for(const[t,r]of e.children.entries()){const{type:e}=r,i=o(r,t);n.children.push(z_(Object.assign(Object.assign({},i),{type:e})))}}return n}function C_(t,e){if(t instanceof Td||t instanceof nh||t.type instanceof yc||ArrayBuffer.isView(t))return ih(t);const n=[...N_({type:null!=e?e:F_(t),nullValues:[null]})(t)],r=1===n.length?n[0]:n.reduce(((t,e)=>t.concat(e)));return yc.isDictionary(r.type)?r.memoize():r}function F_(t){if(0===t.length)return new bc;let e=0,n=0,r=0,i=0,o=0,a=0,s=0,l=0;for(const u of t){if(null!=u){switch(typeof u){case"bigint":++a;continue;case"boolean":++s;continue;case"number":++i;continue;case"string":++o;continue;case"object":Array.isArray(u)?++n:"[object Date]"===Object.prototype.toString.call(u)?++l:++r;continue}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected")}++e}if(i+e===t.length)return new Bc;if(o+e===t.length)return new Xc(new Dc,new xc);if(a+e===t.length)return new Sc;if(s+e===t.length)return new jc;if(l+e===t.length)return new Fc;if(n+e===t.length){const e=t,n=F_(e[e.findIndex((t=>null!=t))]);if(e.every((t=>null==t||j_(n,F_(t)))))return new Pc(new rp("",n,!0))}else if(r+e===t.length){const e=new Map;for(const n of t)for(const t of Object.keys(n))e.has(t)||null==n[t]||e.set(t,new rp(t,F_([n[t]]),!0));return new Vc([...e.values()])}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected")}function N_(t){const{queueingStrategy:e="count"}=t,{highWaterMark:n=("bytes"!==e?Number.POSITIVE_INFINITY:Math.pow(2,14))}=t,r="bytes"!==e?"length":"byteLength";return function*(e){let i=0;const o=z_(t);for(const t of e)o.append(t)[r]>=n&&++i&&(yield o.toVector());(o.finish().length>0||0===i)&&(yield o.toVector())}}function R_(t,e){return function(t,e){const n=[...t.fields],r=[],i={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let o=0,a=0,s=-1;const l=e.length;let u,c=[];for(;i.numBatches-- >0;){for(a=Number.POSITIVE_INFINITY,s=-1;++s<l;)c[s]=u=e[s].shift(),a=Math.min(a,u?u.length:a);Number.isFinite(a)&&(c=U_(n,a,c,e,i),a>0&&(r[o++]=Md({type:new Vc(n),length:a,nullCount:0,children:c.slice()})))}return[t=t.assign(n),r.map((e=>new W_(t,e)))]}(t,e.map((t=>t.data.concat())))}function U_(t,e,n,r,i){var o;const a=(e+63&-64)>>3;for(let s=-1,l=r.length;++s<l;){const l=n[s],u=null==l?void 0:l.length;if(u>=e)u===e?n[s]=l:(n[s]=l.slice(0,e),i.numBatches=Math.max(i.numBatches,r[s].unshift(l.slice(e,u-e))));else{const r=t[s];t[s]=r.clone({nullable:!0}),n[s]=null!==(o=null==l?void 0:l._changeLengthAndBackfillNullBitmap(e))&&void 0!==o?o:Md({type:r.type,length:e,nullCount:e,nullBitmap:new Uint8Array(a)})}}return n}var P_,V_;class $_{constructor(...t){var e,n;if(0===t.length)return this.batches=[],this.schema=new np([]),this._offsets=[0],this;let r,i;t[0]instanceof np&&(r=t.shift()),t[t.length-1]instanceof Uint32Array&&(i=t.pop());const o=t=>{if(t){if(t instanceof W_)return[t];if(t instanceof $_)return t.batches;if(t instanceof Td){if(t.type instanceof Vc)return[new W_(new np(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>o(t)));if("function"==typeof t[Symbol.iterator])return[...t].flatMap((t=>o(t)));if("object"==typeof t){const e=Object.keys(t),n=e.map((e=>new nh([t[e]]))),r=new np(e.map(((t,e)=>new rp(String(t),n[e].type)))),[,i]=R_(r,n);return 0===i.length?[new W_(t)]:i}}}return[]},a=t.flatMap((t=>o(t)));if(r=null!==(n=null!=r?r:null===(e=a[0])||void 0===e?void 0:e.schema)&&void 0!==n?n:new np([]),!(r instanceof np))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const t of a){if(!(t instanceof W_))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!D_(r,t.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=r,this.batches=a,this._offsets=null!=i?i:Dd(this.data)}get data(){return this.batches.map((({data:t})=>t))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=Ed(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?qd.visit(new nh(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...t){const e=this.schema,n=this.data.concat(t.flatMap((({data:t})=>t)));return new $_(e,n.map((t=>new W_(e,t))))}slice(t,e){const n=this.schema;[t,e]=hd({length:this.numRows},t,e);const r=jd(this.data,this._offsets,t,e);return new $_(n,r.map((t=>new W_(n,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:n}=this.schema.fields[t],r=Md({type:n,length:0,nullCount:0});e.push(r._changeLengthAndBackfillNullBitmap(this.numRows))}return new nh(e)}return null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,r=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new nh([Md({type:new bc,length:this.numRows})]));const i=n.fields.slice(),o=i[t].clone({type:e.type}),a=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[i[t],a[t]]=[o,e],[n,r]=R_(n,a)}return new $_(n,r)}select(t){const e=this.schema.fields.reduce(((t,e,n)=>t.set(e.name,n)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),n=this.batches.map((e=>e.selectAt(t)));return new $_(e,n)}assign(t){const e=this.schema.fields,[n,r]=t.schema.fields.reduce(((t,n,r)=>{const[i,o]=t,a=e.findIndex((t=>t.name===n.name));return~a?o[a]=r:i.push(r),t}),[[],[]]),i=this.schema.assign(t.schema),o=[...e.map(((t,e)=>[e,r[e]])).map((([e,n])=>void 0===n?this.getChildAt(e):t.getChildAt(n))),...n.map((e=>t.getChildAt(e)))].filter(Boolean);return new $_(...R_(i,o))}}P_=Symbol.toStringTag,$_[P_]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=Fd(Cd),t.get=Fd(ad.getVisitFn(zu.Struct)),t.set=Nd(Df.getVisitFn(zu.Struct)),t.indexOf=Rd($d.getVisitFn(zu.Struct)),t.getByteLength=Fd(Kd.getVisitFn(zu.Struct)),"Table"))($_.prototype);let W_=class t{constructor(...t){switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof np))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Md({nullCount:0,type:new Vc(this.schema.fields),children:this.schema.fields.map((t=>Md({type:t.type,nullCount:0})))})]=t,!(this.data instanceof Td))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Y_(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:n,children:r,length:i}=Object.keys(e).reduce(((t,n,r)=>(t.children[r]=e[n],t.length=Math.max(t.length,e[n].length),t.fields[r]=rp.new({name:n,type:e[n].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),o=new np(n),a=Md({type:new Vc(n),length:i,children:r,nullCount:0});[this.schema,this.data]=Y_(o,a.children,i);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=G_(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return ad.visit(this.data,t)}set(t,e){return Df.visit(this.data,t,e)}indexOf(t,e){return $d.visit(this.data,t,e)}getByteLength(t){return Kd.visit(this.data,t)}[Symbol.iterator](){return qd.visit(new nh([this.data]))}toArray(){return[...this]}concat(...t){return new $_(this.schema,[this,...t])}slice(e,n){const[r]=new nh([this.data]).slice(e,n).data;return new t(this.schema,r)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new nh([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(e,n){let r=this.schema,i=this.data;if(e>-1&&e<this.numCols){n||(n=new nh([Md({type:new bc,length:this.numRows})]));const t=r.fields.slice(),o=i.children.slice(),a=t[e].clone({type:n.type});[t[e],o[e]]=[a,n.data[0]],r=new np(t,new Map(this.schema.metadata)),i=Md({type:new Vc(t),children:o})}return new t(r,i)}select(e){const n=this.schema.select(e),r=new Vc(n.fields),i=[];for(const t of e){const e=this.schema.fields.findIndex((e=>e.name===t));~e&&(i[e]=this.data.children[e])}return new t(n,Md({type:r,length:this.numRows,children:i}))}selectAt(e){const n=this.schema.selectAt(e),r=e.map((t=>this.data.children[t])).filter(Boolean),i=Md({type:new Vc(n.fields),length:this.numRows,children:r});return new t(n,i)}};function Y_(t,e,n=e.reduce(((t,e)=>Math.max(t,e.length)),0)){var r;const i=[...t.fields],o=[...e],a=(n+63&-64)>>3;for(const[s,l]of t.fields.entries()){const t=e[s];t&&t.length===n||(i[s]=l.clone({nullable:!0}),o[s]=null!==(r=null==t?void 0:t._changeLengthAndBackfillNullBitmap(n))&&void 0!==r?r:Md({type:l.type,length:n,nullCount:n,nullBitmap:new Uint8Array(a)}))}return[t.assign(i),Md({type:new Vc(i),length:n,children:o})]}function G_(t,e,n=new Map){for(let r=-1,i=t.length;++r<i;){const i=t[r].type,o=e[r];if(yc.isDictionary(i))if(n.has(i.id)){if(n.get(i.id)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else o.dictionary&&n.set(i.id,o.dictionary);i.children&&i.children.length>0&&G_(i.children,o.children,n)}return n}V_=Symbol.toStringTag,W_[V_]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(W_.prototype);class q_ extends W_{constructor(t){const e=t.fields.map((t=>Md({type:t.type})));super(t,Md({type:new Vc(t.fields),nullCount:0,children:e}))}}var H_,X_,Z_,J_;(X_=H_||(H_={}))[X_.BUFFER=0]="BUFFER",(J_=Z_||(Z_={}))[J_.LZ4_FRAME=0]="LZ4_FRAME",J_[J_.ZSTD=1]="ZSTD";class K_{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new K_).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new K_).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Z_.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):H_.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,Z_.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,H_.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return K_.startBodyCompression(t),K_.addCodec(t,e),K_.addMethod(t,n),K_.endBodyCompression(t)}}class Q_{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}let tm=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}},em=class t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsRecordBatch(e,n){return e.setPosition(e.position()+4),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new tm).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Q_).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new K_).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}},nm=class t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryBatch(e,n){return e.setPosition(e.position()+4),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new em).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}};var rm;!function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(rm||(rm={}));let im=class t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(e,n){return(n||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMessage(e,n){return e.setPosition(e.position()+4),(n||new t).__init(e.readInt32(e.position())+e.position(),e)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ah.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):rm.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new Sh).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Ah.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,rm.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(e,n,r,i,o,a){return t.startMessage(e),t.addVersion(e,n),t.addHeaderType(e,r),t.addHeader(e,i),t.addBodyLength(e,o),t.addCustomMetadata(e,a),t.endMessage(e)}};var om=bh;const am=new class extends Jc{visit(t,e){return null==t||null==e?void 0:super.visit(t,e)}visitNull(t,e){return Yh.startNull(e),Yh.endNull(e)}visitInt(t,e){return Mh.startInt(e),Mh.addBitWidth(e,t.bitWidth),Mh.addIsSigned(e,t.isSigned),Mh.endInt(e)}visitFloat(t,e){return Ph.startFloatingPoint(e),Ph.addPrecision(e,t.precision),Ph.endFloatingPoint(e)}visitBinary(t,e){return Eh.startBinary(e),Eh.endBinary(e)}visitBool(t,e){return Dh.startBool(e),Dh.endBool(e)}visitUtf8(t,e){return Kh.startUtf8(e),Kh.endUtf8(e)}visitDecimal(t,e){return zh.startDecimal(e),zh.addScale(e,t.scale),zh.addPrecision(e,t.precision),zh.addBitWidth(e,t.bitWidth),zh.endDecimal(e)}visitDate(t,e){return jh.startDate(e),jh.addUnit(e,t.unit),jh.endDate(e)}visitTime(t,e){return qh.startTime(e),qh.addUnit(e,t.unit),qh.addBitWidth(e,t.bitWidth),qh.endTime(e)}visitTimestamp(t,e){const n=t.timezone&&e.createString(t.timezone)||void 0;return Hh.startTimestamp(e),Hh.addUnit(e,t.unit),void 0!==n&&Hh.addTimezone(e,n),Hh.endTimestamp(e)}visitInterval(t,e){return Vh.startInterval(e),Vh.addUnit(e,t.unit),Vh.endInterval(e)}visitList(t,e){return $h.startList(e),$h.endList(e)}visitStruct(t,e){return Gh.startStruct_(e),Gh.endStruct_(e)}visitUnion(t,e){Jh.startTypeIdsVector(e,t.typeIds.length);const n=Jh.createTypeIdsVector(e,t.typeIds);return Jh.startUnion(e),Jh.addMode(e,t.mode),Jh.addTypeIds(e,n),Jh.endUnion(e)}visitDictionary(t,e){const n=this.visit(t.indices,e);return Bh.startDictionaryEncoding(e),Bh.addId(e,new om(t.id,0)),Bh.addIsOrdered(e,t.isOrdered),void 0!==n&&Bh.addIndexType(e,n),Bh.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return Rh.startFixedSizeBinary(e),Rh.addByteWidth(e,t.byteWidth),Rh.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return Uh.startFixedSizeList(e),Uh.addListSize(e,t.listSize),Uh.endFixedSizeList(e)}visitMap(t,e){return Wh.startMap(e),Wh.addKeysSorted(e,t.keysSorted),Wh.endMap(e)}};function sm(t){return new bm(t.count,um(t.columns),cm(t.columns))}function lm(t,e){return(t.children||[]).filter(Boolean).map((t=>rp.fromJSON(t,e)))}function um(t){return(t||[]).reduce(((t,e)=>{return[...t,new wm(e.count,(n=e.VALIDITY,(n||[]).reduce(((t,e)=>t+ +(0===e)),0))),...um(e.children)];var n}),[])}function cm(t,e=[]){for(let n=-1,r=(t||[]).length;++n<r;){const r=t[n];r.VALIDITY&&e.push(new vm(e.length,r.VALIDITY.length)),r.TYPE&&e.push(new vm(e.length,r.TYPE.length)),r.OFFSET&&e.push(new vm(e.length,r.OFFSET.length)),r.DATA&&e.push(new vm(e.length,r.DATA.length)),e=cm(r.children,e)}return e}function fm(t){return new Map(Object.entries(t||{}))}function dm(t){return new gc(t.isSigned,t.bitWidth)}function hm(t,e){const n=t.type.name;switch(n){case"NONE":case"null":return new bc;case"binary":return new Ec;case"utf8":return new Dc;case"bool":return new jc;case"list":return new Pc((e||[])[0]);case"struct":case"struct_":return new Vc(e||[])}switch(n){case"int":{const e=t.type;return new gc(e.isSigned,e.bitWidth)}case"floatingpoint":{const e=t.type;return new Tc(Iu[e.precision])}case"decimal":{const e=t.type;return new zc(e.scale,e.precision,e.bitWidth)}case"date":{const e=t.type;return new Cc(Ou[e.unit])}case"time":{const e=t.type;return new Nc(Lu[e.unit],e.bitWidth)}case"timestamp":{const e=t.type;return new Rc(Lu[e.unit],e.timezone)}case"interval":{const e=t.type;return new Uc(Bu[e.unit])}case"union":{const n=t.type;return new $c(Su[n.mode],n.typeIds||[],e||[])}case"fixedsizebinary":{const e=t.type;return new Wc(e.byteWidth)}case"fixedsizelist":{const n=t.type;return new Yc(n.listSize,(e||[])[0])}case"map":{const n=t.type;return new Gc((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var pm=bh,_m=xh,mm=wh;class ym{constructor(t,e,n,r){this._version=e,this._headerType=n,this.body=new Uint8Array(0),r&&(this._createHeader=()=>r),this._bodyLength="number"==typeof t?t:t.low}static fromJSON(t,e){const n=new ym(0,wu.V4,e);return n._createHeader=function(t,e){return()=>{switch(e){case Du.Schema:return np.fromJSON(t);case Du.RecordBatch:return bm.fromJSON(t);case Du.DictionaryBatch:return gm.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${Du[e]}, type: ${e} }`)}}(t,e),n}static decode(t){t=new mm(lu(t));const e=im.getRootAsMessage(t),n=e.bodyLength(),r=e.version(),i=e.headerType(),o=new ym(n,r,i);return o._createHeader=function(t,e){return()=>{switch(e){case Du.Schema:return np.decode(t.header(new tp));case Du.RecordBatch:return bm.decode(t.header(new em),t.version());case Du.DictionaryBatch:return gm.decode(t.header(new nm),t.version())}throw new Error(`Unrecognized Message type: { name: ${Du[e]}, type: ${e} }`)}}(e,i),o}static encode(t){const e=new _m;let n=-1;return t.isSchema()?n=np.encode(e,t.header()):t.isRecordBatch()?n=bm.encode(e,t.header()):t.isDictionaryBatch()&&(n=gm.encode(e,t.header())),im.startMessage(e),im.addVersion(e,wu.V4),im.addHeader(e,n),im.addHeaderType(e,t.headerType),im.addBodyLength(e,new pm(t.bodyLength,0)),im.finishMessageBuffer(e,im.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof np)return new ym(0,wu.V4,Du.Schema,t);if(t instanceof bm)return new ym(e,wu.V4,Du.RecordBatch,t);if(t instanceof gm)return new ym(e,wu.V4,Du.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Du.Schema}isRecordBatch(){return this.headerType===Du.RecordBatch}isDictionaryBatch(){return this.headerType===Du.DictionaryBatch}}class bm{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length="number"==typeof t?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class gm{constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id="number"==typeof e?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class vm{constructor(t,e){this.offset="number"==typeof t?t:t.low,this.length="number"==typeof e?e:e.low}}class wm{constructor(t,e){this.length="number"==typeof t?t:t.low,this.nullCount="number"==typeof e?e:e.low}}function xm(t,e){const n=[];for(let r,i=-1,o=-1,a=t.childrenLength();++i<a;)(r=t.children(i))&&(n[++o]=rp.decode(r,e));return n}function Sm(t){const e=new Map;if(t)for(let n,r,i=-1,o=Math.trunc(t.customMetadataLength());++i<o;)(n=t.customMetadata(i))&&null!=(r=n.key())&&e.set(r,n.value());return e}function Am(t){return new gc(t.isSigned(),t.bitWidth())}function Im(t,e){const n=t.typeType();switch(n){case Zh.NONE:case Zh.Null:return new bc;case Zh.Binary:return new Ec;case Zh.Utf8:return new Dc;case Zh.Bool:return new jc;case Zh.List:return new Pc((e||[])[0]);case Zh.Struct_:return new Vc(e||[])}switch(n){case Zh.Int:{const e=t.type(new Mh);return new gc(e.isSigned(),e.bitWidth())}case Zh.FloatingPoint:{const e=t.type(new Ph);return new Tc(e.precision())}case Zh.Decimal:{const e=t.type(new zh);return new zc(e.scale(),e.precision(),e.bitWidth())}case Zh.Date:{const e=t.type(new jh);return new Cc(e.unit())}case Zh.Time:{const e=t.type(new qh);return new Nc(e.unit(),e.bitWidth())}case Zh.Timestamp:{const e=t.type(new Hh);return new Rc(e.unit(),e.timezone())}case Zh.Interval:{const e=t.type(new Vh);return new Uc(e.unit())}case Zh.Union:{const n=t.type(new Jh);return new $c(n.mode(),n.typeIdsArray()||[],e||[])}case Zh.FixedSizeBinary:{const e=t.type(new Rh);return new Wc(e.byteWidth())}case Zh.FixedSizeList:{const n=t.type(new Uh);return new Yc(n.listSize(),(e||[])[0])}case Zh.Map:{const n=t.type(new Wh);return new Gc((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${Zh[n]}" (${n})`)}rp.encode=function(t,e){let n=-1,r=-1,i=-1;const o=e.type;let a=e.typeId;yc.isDictionary(o)?(a=o.dictionary.typeId,i=am.visit(o,t),r=am.visit(o.dictionary,t)):r=am.visit(o,t);const s=(o.children||[]).map((e=>rp.encode(t,e))),l=Qh.createChildrenVector(t,s),u=e.metadata&&e.metadata.size>0?Qh.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const r=t.createString(`${e}`),i=t.createString(`${n}`);return Sh.startKeyValue(t),Sh.addKey(t,r),Sh.addValue(t,i),Sh.endKeyValue(t)}))):-1;return e.name&&(n=t.createString(e.name)),Qh.startField(t),Qh.addType(t,r),Qh.addTypeType(t,a),Qh.addChildren(t,l),Qh.addNullable(t,!!e.nullable),-1!==n&&Qh.addName(t,n),-1!==i&&Qh.addDictionary(t,i),-1!==u&&Qh.addCustomMetadata(t,u),Qh.endField(t)},rp.decode=function(t,e){let n,r,i,o,a,s;return e&&(s=t.dictionary())?e.has(n=s.id().low)?(o=(o=s.indexType())?Am(o):new xc,a=new Xc(e.get(n),o,n,s.isOrdered()),r=new rp(t.name(),a,t.nullable(),Sm(t))):(o=(o=s.indexType())?Am(o):new xc,e.set(n,i=Im(t,xm(t,e))),a=new Xc(i,o,n,s.isOrdered()),r=new rp(t.name(),a,t.nullable(),Sm(t))):(i=Im(t,xm(t,e)),r=new rp(t.name(),i,t.nullable(),Sm(t))),r||null},rp.fromJSON=function(t,e){let n,r,i,o,a,s;return e&&(o=t.dictionary)?e.has(n=o.id)?(r=(r=o.indexType)?dm(r):new xc,s=new Xc(e.get(n),r,n,o.isOrdered),i=new rp(t.name,s,t.nullable,fm(t.customMetadata))):(r=(r=o.indexType)?dm(r):new xc,e.set(n,a=hm(t,lm(t,e))),s=new Xc(a,r,n,o.isOrdered),i=new rp(t.name,s,t.nullable,fm(t.customMetadata))):(a=hm(t,lm(t,e)),i=new rp(t.name,a,t.nullable,fm(t.customMetadata))),i||null},np.encode=function(t,e){const n=e.fields.map((e=>rp.encode(t,e)));tp.startFieldsVector(t,n.length);const r=tp.createFieldsVector(t,n),i=e.metadata&&e.metadata.size>0?tp.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const r=t.createString(`${e}`),i=t.createString(`${n}`);return Sh.startKeyValue(t),Sh.addKey(t,r),Sh.addValue(t,i),Sh.endKeyValue(t)}))):-1;return tp.startSchema(t),tp.addFields(t,r),tp.addEndianness(t,km?Ih.Little:Ih.Big),-1!==i&&tp.addCustomMetadata(t,i),tp.endSchema(t)},np.decode=function(t,e=new Map){const n=function(t,e){const n=[];for(let r,i=-1,o=-1,a=t.fieldsLength();++i<a;)(r=t.fields(i))&&(n[++o]=rp.decode(r,e));return n}(t,e);return new np(n,Sm(t),e)},np.fromJSON=function(t,e=new Map){return new np(function(t,e){return(t.fields||[]).filter(Boolean).map((t=>rp.fromJSON(t,e)))}(t,e),fm(t.customMetadata),e)},bm.encode=function(t,e){const n=e.nodes||[],r=e.buffers||[];em.startNodesVector(t,n.length);for(const e of n.slice().reverse())wm.encode(t,e);const i=t.endVector();em.startBuffersVector(t,r.length);for(const e of r.slice().reverse())vm.encode(t,e);const o=t.endVector();return em.startRecordBatch(t),em.addLength(t,new pm(e.length,0)),em.addNodes(t,i),em.addBuffers(t,o),em.endRecordBatch(t)},bm.decode=function(t,e=wu.V4){if(null!==t.compression())throw new Error("Record batch compression not implemented");return new bm(t.length(),function(t){const e=[];for(let n,r=-1,i=-1,o=t.nodesLength();++r<o;)(n=t.nodes(r))&&(e[++i]=wm.decode(n));return e}(t),function(t,e){const n=[];for(let r,i=-1,o=-1,a=t.buffersLength();++i<a;)(r=t.buffers(i))&&(e<wu.V4&&(r.bb_pos+=8*(i+1)),n[++o]=vm.decode(r));return n}(t,e))},bm.fromJSON=sm,gm.encode=function(t,e){const n=bm.encode(t,e.data);return nm.startDictionaryBatch(t),nm.addId(t,new pm(e.id,0)),nm.addIsDelta(t,e.isDelta),nm.addData(t,n),nm.endDictionaryBatch(t)},gm.decode=function(t,e=wu.V4){return new gm(bm.decode(t.data(),e),t.id(),t.isDelta())},gm.fromJSON=function(t){return new gm(sm(t.data),t.id,t.isDelta)},wm.encode=function(t,e){return tm.createFieldNode(t,new pm(e.length,0),new pm(e.nullCount,0))},wm.decode=function(t){return new wm(t.length(),t.nullCount())},vm.encode=function(t,e){return Q_.createBuffer(t,new pm(e.offset,0),new pm(e.length,0))},vm.decode=function(t){return new vm(t.offset(),t.length())};const km=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]})(),Om=t=>`Expected ${Du[t]} Message in stream, but was null or length 0.`,Tm=t=>`Header pointer of flatbuffer-encoded ${Du[t]} Message is null or length 0.`,Lm=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,Mm=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class Bm{constructor(t){this.source=t instanceof yp?t:new yp(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||-1===t.value&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?dp:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Om(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=lu(this.source.read(t));if(e.byteLength<t)throw new Error(Mm(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=Du.Schema,n=this.readMessage(e),r=null==n?void 0:n.header();if(t&&!r)throw new Error(Tm(e));return r}readMetadataLength(){const t=this.source.read(jm),e=t&&new wh(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return dp;if(e.byteLength<t)throw new Error(Lm(t,e.byteLength));return{done:!1,value:ym.decode(e)}}}class Em{constructor(t,e){this.source=t instanceof bp?t:Kl(t)?new xp(t,e):new bp(t)}[Symbol.asyncIterator](){return this}next(){return Ll(this,void 0,void 0,(function*(){let t;return(t=yield this.readMetadataLength()).done||-1===t.value&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?dp:t}))}throw(t){return Ll(this,void 0,void 0,(function*(){return yield this.source.throw(t)}))}return(t){return Ll(this,void 0,void 0,(function*(){return yield this.source.return(t)}))}readMessage(t){return Ll(this,void 0,void 0,(function*(){let e;if((e=yield this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Om(t));return e.value}))}readMessageBody(t){return Ll(this,void 0,void 0,(function*(){if(t<=0)return new Uint8Array(0);const e=lu(yield this.source.read(t));if(e.byteLength<t)throw new Error(Mm(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}))}readSchema(t=!1){return Ll(this,void 0,void 0,(function*(){const e=Du.Schema,n=yield this.readMessage(e),r=null==n?void 0:n.header();if(t&&!r)throw new Error(Tm(e));return r}))}readMetadataLength(){return Ll(this,void 0,void 0,(function*(){const t=yield this.source.read(jm),e=t&&new wh(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}))}readMetadata(t){return Ll(this,void 0,void 0,(function*(){const e=yield this.source.read(t);if(!e)return dp;if(e.byteLength<t)throw new Error(Lm(t,e.byteLength));return{done:!1,value:ym.decode(e)}}))}}class Dm extends Bm{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof hp?t:new hp(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:ym.fromJSON(t.schema,Du.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];return this._body=e.data.columns,{done:!1,value:ym.fromJSON(e,Du.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];return this._body=e.columns,{done:!1,value:ym.fromJSON(e,Du.RecordBatch)}}return this._body=[],dp}readMessageBody(t){return function t(e){return(e||[]).reduce(((e,n)=>[...e,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE&&[n.TYPE]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...t(n.children)]),[])}(this._body)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Om(t));return e.value}readSchema(){const t=Du.Schema,e=this.readMessage(t),n=null==e?void 0:e.header();if(!e||!n)throw new Error(Tm(t));return n}}const jm=4,zm="ARROW1",Cm=new Uint8Array(zm.length);for(let t=0;t<zm.length;t+=1)Cm[t]=zm.codePointAt(t);function Fm(t,e=0){for(let n=-1,r=Cm.length;++n<r;)if(Cm[n]!==t[e+n])return!1;return!0}const Nm=Cm.length,Rm=Nm+jm,Um=2*Nm+jm;class Pm extends pp{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return ql(e)?e.then((()=>this)):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return yu.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return yu.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Pm?t:Zl(t)?function(t){return new Vm(new Jm(t))}(t):Kl(t)?function(t){return Ll(this,void 0,void 0,(function*(){const{size:e}=yield t.stat(),n=new xp(t,e);return e>=Um&&Fm(yield n.readAt(0,Nm+7&-8))?new Ym(new Zm(n)):new $m(new Hm(n))}))}(t):ql(t)?(()=>Ll(this,void 0,void 0,(function*(){return yield Pm.from(yield t)})))():Ql(t)||eu(t)||nu(t)||Xl(t)?function(t){return Ll(this,void 0,void 0,(function*(){const e=yield t.peek(Nm+7&-8);return e&&e.byteLength>=4?Fm(e)?new Wm(new Xm(yield t.read())):new $m(new Hm(t)):new $m(new Hm(function(){return Bl(this,arguments,(function*(){}))}()))}))}(new bp(t)):function(t){const e=t.peek(Nm+7&-8);return e&&e.byteLength>=4?Fm(e)?new Wm(new Xm(t.read())):new Vm(new qm(t)):new Vm(new qm(function*(){}()))}(new yp(t))}static readAll(t){return t instanceof Pm?t.isSync()?Qm(t):ty(t):Zl(t)||ArrayBuffer.isView(t)||Hl(t)||Jl(t)?Qm(t):ty(t)}}class Vm extends Pm{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Bl(this,arguments,(function*(){yield Ml(yield*El(Dl(this[Symbol.iterator]())))}))}}class $m extends Pm{constructor(t){super(t),this._impl=t}readAll(){var t,e;return Ll(this,void 0,void 0,(function*(){const n=new Array;try{for(var r,i=Dl(this);!(r=yield i.next()).done;){const t=r.value;n.push(t)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&(yield e.call(i))}finally{if(t)throw t.error}}return n}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class Wm extends Vm{constructor(t){super(t),this._impl=t}}class Ym extends $m{constructor(t){super(t),this._impl=t}}class Gm{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const n=this._loadVectors(t,e,this.schema.fields),r=Md({type:new Vc(this.schema.fields),length:t.length,children:n});return new W_(this.schema,r)}_loadDictionaryBatch(t,e){const{id:n,isDelta:r}=t,{dictionaries:i,schema:o}=this,a=i.get(n);if(r||!a){const i=o.dictionaries.get(n),s=this._loadVectors(t.data,e,[i]);return(a&&r?a.concat(new nh(s)):new nh(s)).memoize()}return a.memoize()}_loadVectors(t,e,n){return new Mp(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}class qm extends Gm{constructor(t,e){super(e),this._reader=Zl(t)?new Dm(this._handle=t):new Bm(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Km(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):dp}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):dp}next(){if(this.closed)return dp;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),r=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),r=e.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new q_(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Hm extends Gm{constructor(t,e){super(e),this._reader=new Em(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return Ll(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(t){return Ll(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=Km(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(t){return Ll(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):dp}))}return(t){return Ll(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):dp}))}next(){return Ll(this,void 0,void 0,(function*(){if(this.closed)return dp;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),r=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),r=yield e.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new q_(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(t){return Ll(this,void 0,void 0,(function*(){return yield this._reader.readMessage(t)}))}}class Xm extends qm{constructor(t,e){super(t instanceof wp?t:new wp(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(Du.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}_readDictionaryBatch(t){var e;const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(Du.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,r)}}}_readFooter(){const{_handle:t}=this,e=t.size-Rm,n=t.readInt32(e),r=t.readAt(e-n,n);return up.decode(r)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}}class Zm extends Hm{constructor(t,...e){const n="number"!=typeof e[0]?e.shift():void 0,r=e[0]instanceof Map?e.shift():void 0;super(t instanceof xp?t:new xp(t,n),r)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return Ll(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)}))}readRecordBatch(t){var e;return Ll(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(Du.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}))}_readDictionaryBatch(t){var e;return Ll(this,void 0,void 0,(function*(){const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(Du.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,r)}}}))}_readFooter(){return Ll(this,void 0,void 0,(function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-Rm,n=yield t.readInt32(e),r=yield t.readAt(e-n,n);return up.decode(r)}))}_readNextMessageAndValidate(t){return Ll(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null}))}}class Jm extends qm{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new Bp(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}function Km(t,e){return e&&"boolean"==typeof e.autoDestroy?e.autoDestroy:t.autoDestroy}function*Qm(t){const e=Pm.from(t);try{if(!e.open({autoDestroy:!1}).closed)do{yield e}while(!e.reset().open().closed)}finally{e.cancel()}}function ty(t){return Bl(this,arguments,(function*(){const e=yield Ml(Pm.from(t));try{if(!(yield Ml(e.open({autoDestroy:!1}))).closed)do{yield yield Ml(e)}while(!(yield Ml(e.reset().open())).closed)}finally{yield Ml(e.cancel())}}))}class ey extends Jc{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){const e=t=>t.flatMap((t=>Array.isArray(t)?e(t):t instanceof W_?t.data.children:t.data)),n=new ey;return n.visitMany(e(t)),n}visit(t){if(t instanceof nh)return this.visitMany(t.data),this;const{type:e}=t;if(!yc.isDictionary(e)){const{length:n,nullCount:r}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");yc.isNull(e)||ny.call(this,r<=0?new Uint8Array(0):wd(t.offset,n,t.nullBitmap)),this.nodes.push(new wm(n,r))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function ny(t){const e=t.byteLength+7&-8;return this.buffers.push(t),this.bufferRegions.push(new vm(this._byteLength,e)),this._byteLength+=e,this}function ry(t){return ny.call(this,t.values.subarray(0,t.length*t.stride))}function iy(t){const{length:e,values:n,valueOffsets:r}=t,i=r[0],o=r[e],a=Math.min(o-i,n.byteLength-i);return ny.call(this,pu(-r[0],e,r)),ny.call(this,n.subarray(i,i+a)),this}function oy(t){const{length:e,valueOffsets:n}=t;return n&&ny.call(this,pu(n[0],e,n)),this.visit(t.children[0])}function ay(t){return this.visitMany(t.type.children.map(((e,n)=>t.children[n])).filter(Boolean))[0]}ey.prototype.visitBool=function(t){let e;return t.nullCount>=t.length?ny.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?ny.call(this,wd(t.offset,t.length,e)):ny.call(this,xd(t.values))},ey.prototype.visitInt=ry,ey.prototype.visitFloat=ry,ey.prototype.visitUtf8=iy,ey.prototype.visitBinary=iy,ey.prototype.visitFixedSizeBinary=ry,ey.prototype.visitDate=ry,ey.prototype.visitTimestamp=ry,ey.prototype.visitTime=ry,ey.prototype.visitDecimal=ry,ey.prototype.visitList=oy,ey.prototype.visitStruct=ay,ey.prototype.visitUnion=function(t){const{type:e,length:n,typeIds:r,valueOffsets:i}=t;if(ny.call(this,r),e.mode===Su.Sparse)return ay.call(this,t);if(e.mode===Su.Dense){if(t.offset<=0)return ny.call(this,i),ay.call(this,t);{const o=r.reduce(((t,e)=>Math.max(t,e)),r[0]),a=new Int32Array(o+1),s=new Int32Array(o+1).fill(-1),l=new Int32Array(n),u=pu(-i[0],n,i);for(let t,e,i=-1;++i<n;)-1===(e=s[t=r[i]])&&(e=s[t]=u[t]),l[i]=u[i]-e,++a[t];ny.call(this,l);for(let r,i=-1,o=e.children.length;++i<o;)if(r=t.children[i]){const t=e.typeIds[i],o=Math.min(n,a[t]);this.visit(r.slice(s[t],o))}}}return this},ey.prototype.visitInterval=ry,ey.prototype.visitFixedSizeList=oy,ey.prototype.visitMap=oy;class sy extends Jc{visit(t){return null==t?void 0:super.visit(t)}visitNull({typeId:t}){return{name:Zh[t].toLowerCase()}}visitInt({typeId:t,bitWidth:e,isSigned:n}){return{name:Zh[t].toLowerCase(),bitWidth:e,isSigned:n}}visitFloat({typeId:t,precision:e}){return{name:Zh[t].toLowerCase(),precision:Iu[e]}}visitBinary({typeId:t}){return{name:Zh[t].toLowerCase()}}visitBool({typeId:t}){return{name:Zh[t].toLowerCase()}}visitUtf8({typeId:t}){return{name:Zh[t].toLowerCase()}}visitDecimal({typeId:t,scale:e,precision:n,bitWidth:r}){return{name:Zh[t].toLowerCase(),scale:e,precision:n,bitWidth:r}}visitDate({typeId:t,unit:e}){return{name:Zh[t].toLowerCase(),unit:Ou[e]}}visitTime({typeId:t,unit:e,bitWidth:n}){return{name:Zh[t].toLowerCase(),unit:Lu[e],bitWidth:n}}visitTimestamp({typeId:t,timezone:e,unit:n}){return{name:Zh[t].toLowerCase(),unit:Lu[n],timezone:e}}visitInterval({typeId:t,unit:e}){return{name:Zh[t].toLowerCase(),unit:Bu[e]}}visitList({typeId:t}){return{name:Zh[t].toLowerCase()}}visitStruct({typeId:t}){return{name:Zh[t].toLowerCase()}}visitUnion({typeId:t,mode:e,typeIds:n}){return{name:Zh[t].toLowerCase(),mode:Su[e],typeIds:[...n]}}visitDictionary(t){return this.visit(t.dictionary)}visitFixedSizeBinary({typeId:t,byteWidth:e}){return{name:Zh[t].toLowerCase(),byteWidth:e}}visitFixedSizeList({typeId:t,listSize:e}){return{name:Zh[t].toLowerCase(),listSize:e}}visitMap({typeId:t,keysSorted:e}){return{name:Zh[t].toLowerCase(),keysSorted:e}}}class ly extends Jc{static assemble(...t){const e=new ly;return t.map((({schema:t,data:n})=>e.visitMany(t.fields,n.children)))}visit({name:t},e){const{length:n}=e,{offset:r,nullCount:i,nullBitmap:o}=e,a=yc.isDictionary(e.type)?e.type.indices:e.type,s=Object.assign([],e.buffers,{[Fu.VALIDITY]:void 0});return Object.assign({name:t,count:n,VALIDITY:yc.isNull(a)?void 0:i<=0?Array.from({length:n},(()=>1)):[...new Sd(o,r,n,null,vd)]},super.visit(e.clone(a,r,n,0,s)))}visitNull(){return{}}visitBool({values:t,offset:e,length:n}){return{DATA:[...new Sd(t,e,n,null,gd)]}}visitInt(t){return{DATA:t.type.bitWidth<64?[...t.values]:[...cy(t.values,2)]}}visitFloat(t){return{DATA:[...t.values]}}visitUtf8(t){return{DATA:[...new nh([t])],OFFSET:[...t.valueOffsets]}}visitBinary(t){return{DATA:[...uy(new nh([t]))],OFFSET:[...t.valueOffsets]}}visitFixedSizeBinary(t){return{DATA:[...uy(new nh([t]))]}}visitDate(t){return{DATA:t.type.unit===Ou.DAY?[...t.values]:[...cy(t.values,2)]}}visitTimestamp(t){return{DATA:[...cy(t.values,2)]}}visitTime(t){return{DATA:t.type.unit<Lu.MICROSECOND?[...t.values]:[...cy(t.values,2)]}}visitDecimal(t){return{DATA:[...cy(t.values,4)]}}visitList(t){return{OFFSET:[...t.valueOffsets],children:this.visitMany(t.type.children,t.children)}}visitStruct(t){return{children:this.visitMany(t.type.children,t.children)}}visitUnion(t){return{TYPE:[...t.typeIds],OFFSET:t.type.mode===Su.Dense?[...t.valueOffsets]:void 0,children:this.visitMany(t.type.children,t.children)}}visitInterval(t){return{DATA:[...t.values]}}visitFixedSizeList(t){return{children:this.visitMany(t.type.children,t.children)}}visitMap(t){return{OFFSET:[...t.valueOffsets],children:this.visitMany(t.type.children,t.children)}}}function*uy(t){for(const e of t)yield e.reduce(((t,e)=>`${t}${("0"+(255&e).toString(16)).slice(-2)}`),"").toUpperCase()}function*cy(t,e){const n=new Uint32Array(t.buffer);for(let t=-1,r=n.length/e;++t<r;)yield`${Xu.new(n.subarray((t+0)*e,(t+1)*e),!1)}`}class fy extends pp{constructor(t){super(),this._position=0,this._started=!1,this._sink=new mp,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,Gl(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!=typeof t.autoDestroy||t.autoDestroy,this._writeLegacyIpcFormat="boolean"==typeof t.writeLegacyIpcFormat&&t.writeLegacyIpcFormat}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return ql(t)?t.then((t=>this.writeAll(t))):Xl(t)?my(this,t):_y(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,e=null){var n;return t===this._sink||t instanceof mp?this._sink=t:(this._sink=new mp,t&&Gl(n=t)&&Yl(n.abort)&&Yl(n.getWriter)&&!tu(n)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&(t=>Gl(t)&&Yl(t.end)&&Yl(t.write)&&Wl(t.writable)&&!tu(t))(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,e&&D_(e,this._schema)||(null==e?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(!this._sink)throw new Error("RecordBatchWriter is closed");if(null==t)return this.finish()&&void 0;if(t instanceof $_&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof W_&&!(e=t.schema))return this.finish()&&void 0;if(e&&!D_(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof W_?t instanceof q_||this._writeRecordBatch(t):t instanceof $_?this.writeAll(t.batches):Hl(t)&&this.writeAll(t)}_writeMessage(t,e=8){const n=e-1,r=ym.encode(t),i=r.byteLength,o=this._writeLegacyIpcFormat?4:8,a=i+o+n&~n,s=a-i-o;return t.headerType===Du.RecordBatch?this._recordBatchBlocks.push(new fp(a,t.bodyLength,this._position)):t.headerType===Du.DictionaryBatch&&this._dictionaryBlocks.push(new fp(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-o)),i>0&&this._write(r),this._writePadding(s)}_write(t){if(this._started){const e=lu(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(ym.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Cm)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:e,nodes:n,bufferRegions:r,buffers:i}=ey.assemble(t),o=new bm(t.numRows,n,r),a=ym.from(o,e);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(i)}_writeDictionaryBatch(t,e,n=!1){this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));const{byteLength:r,nodes:i,bufferRegions:o,buffers:a}=ey.assemble(new nh([t])),s=new bm(t.length,i,o),l=new gm(s,e,n),u=ym.from(l,r);return this._writeMessage(u)._writeBodyBuffers(a)}_writeBodyBuffers(t){let e,n,r;for(let i=-1,o=t.length;++i<o;)(e=t[i])&&(n=e.byteLength)>0&&(this._write(e),(r=(n+7&-8)-n)>0&&this._writePadding(r));return this}_writeDictionaries(t){for(let[e,n]of t.dictionaries){let t=this._dictionaryDeltaOffsets.get(e)||0;if(0===t||(n=null==n?void 0:n.slice(t)).length>0)for(const r of n.data)this._writeDictionaryBatch(r,e,t>0),t+=r.length}return this}}class dy extends fy{static writeAll(t,e){const n=new dy(e);return ql(t)?t.then((t=>n.writeAll(t))):Xl(t)?my(n,t):_y(n,t)}}class hy extends fy{static writeAll(t){const e=new hy;return ql(t)?t.then((t=>e.writeAll(t))):Xl(t)?my(e,t):_y(e,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){const e=up.encode(new up(t,wu.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}}class py extends fy{constructor(){super(),this._autoDestroy=!0,this._recordBatches=[],this._dictionaries=[]}static writeAll(t){return(new py).writeAll(t)}_writeMessage(){return this}_writeFooter(t){return this}_writeSchema(t){return this._write(`{\n  "schema": ${JSON.stringify({fields:t.fields.map((t=>yy(t)))},null,2)}`)}_writeDictionaries(t){return t.dictionaries.size>0&&this._dictionaries.push(t),this}_writeDictionaryBatch(t,e,n=!1){return this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0)),this._write(0===this._dictionaryBlocks.length?"    ":",\n    "),this._write(`${function(t,e,n=!1){const[r]=ly.assemble(new W_({[e]:t}));return JSON.stringify({id:e,isDelta:n,data:{count:t.length,columns:r}},null,2)}(t,e,n)}`),this._dictionaryBlocks.push(new fp(0,0,0)),this}_writeRecordBatch(t){return this._writeDictionaries(t),this._recordBatches.push(t),this}close(){if(this._dictionaries.length>0){this._write(',\n  "dictionaries": [\n');for(const t of this._dictionaries)super._writeDictionaries(t);this._write("\n  ]")}if(this._recordBatches.length>0){for(let t=-1,e=this._recordBatches.length;++t<e;)this._write(0===t?',\n  "batches": [\n    ':",\n    "),this._write(`${by(this._recordBatches[t])}`),this._recordBatchBlocks.push(new fp(0,0,0));this._write("\n  ]")}return this._schema&&this._write("\n}"),this._dictionaries=[],this._recordBatches=[],super.close()}}function _y(t,e){let n=e;e instanceof $_&&(n=e.batches,t.reset(void 0,e.schema));for(const e of n)t.write(e);return t.finish()}function my(t,e){var n,r,i,o;return Ll(this,void 0,void 0,(function*(){try{for(n=Dl(e);!(r=yield n.next()).done;){const e=r.value;t.write(e)}}catch(t){i={error:t}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}return t.finish()}))}function yy({name:t,type:e,nullable:n}){const r=new sy;return{name:t,nullable:n,type:r.visit(e),children:(e.children||[]).map((t=>yy(t))),dictionary:yc.isDictionary(e)?{id:e.id,isOrdered:e.isOrdered,indexType:r.visit(e.indices)}:void 0}}function by(t){const[e]=ly.assemble(t);return JSON.stringify({count:t.numRows,columns:e},null,2)}class gy{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;const{readableStrategy:e,writableStrategy:n,queueingStrategy:r="count"}=t,i=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=z_(i),this._getSize="bytes"!==r?vy:wy;const{highWaterMark:o=("bytes"===r?Math.pow(2,14):1e3)}=Object.assign({},e),{highWaterMark:a=("bytes"===r?Math.pow(2,14):1e3)}=Object.assign({},n);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:t=>{this._maybeFlush(this._builder,this._controller=t)},start:t=>{this._maybeFlush(this._builder,this._controller=t)}},{highWaterMark:o,size:"bytes"!==r?vy:wy}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:a,size:t=>this._writeValueAndReturnChunkSize(t)})}_writeValueAndReturnChunkSize(t){const e=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-e}_maybeFlush(t,e){null!=e&&(this._bufferedSize>=e.desiredSize&&++this._numChunks&&this._enqueue(e,t.toVector()),t.finished&&((t.length>0||0===this._numChunks)&&++this._numChunks&&this._enqueue(e,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(e,null)))}_enqueue(t,e){this._bufferedSize=0,this._controller=null,null==e?t.close():t.enqueue(e)}}const vy=t=>{var e;return null!==(e=null==t?void 0:t.length)&&void 0!==e?e:0},wy=t=>{var e;return null!==(e=null==t?void 0:t.byteLength)&&void 0!==e?e:0};function xy(t,e){const n=new mp;let r=null;const i=new ReadableStream({cancel(){return Ll(this,void 0,void 0,(function*(){yield n.close()}))},start(t){return Ll(this,void 0,void 0,(function*(){yield o(t,r||(r=yield function(){return Ll(this,void 0,void 0,(function*(){return yield(yield Pm.from(n)).open(e)}))}()))}))},pull(t){return Ll(this,void 0,void 0,(function*(){r?yield o(t,r):t.close()}))}});return{writable:new WritableStream(n,Object.assign({highWaterMark:Math.pow(2,14)},t)),readable:i};function o(t,e){return Ll(this,void 0,void 0,(function*(){let n=t.desiredSize,r=null;for(;!(r=yield e.next()).done;)if(t.enqueue(r.value),null!=n&&--n<=0)return;t.close()}))}}function Sy(t,e){const n=new this(t),r=new bp(n),i=new ReadableStream({cancel(){return Ll(this,void 0,void 0,(function*(){yield r.cancel()}))},pull(t){return Ll(this,void 0,void 0,(function*(){yield o(t)}))},start(t){return Ll(this,void 0,void 0,(function*(){yield o(t)}))}},Object.assign({highWaterMark:Math.pow(2,14)},e));return{writable:new WritableStream(n,t),readable:i};function o(t){return Ll(this,void 0,void 0,(function*(){let e=null,n=t.desiredSize;for(;e=yield r.read(n||null);)if(t.enqueue(e),null!=n&&(n-=e.byteLength)<=0)return;t.close()}))}}function Ay(t){const e=Pm.from(t);return ql(e)?e.then((t=>Ay(t))):e.isAsync()?e.readAll().then((t=>new $_(t))):new $_(e.readAll())}const Iy=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Zu),Lp),Od),of),mu),bd),{compareSchemas:D_,compareFields:function(t,e){return E_.compareFields(t,e)},compareTypes:j_});yu.toDOMStream=function(t,e){if(Xl(t))return function(t,e){let n=null;const r="bytes"===(null==e?void 0:e.type)||!1,i=(null==e?void 0:e.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},e),{start(e){return Ll(this,void 0,void 0,(function*(){yield o(e,n||(n=t[Symbol.asyncIterator]()))}))},pull(t){return Ll(this,void 0,void 0,(function*(){n?yield o(t,n):t.close()}))},cancel(){return Ll(this,void 0,void 0,(function*(){(null==n?void 0:n.return)&&(yield n.return()),n=null}))}}),Object.assign({highWaterMark:r?i:void 0},e));function o(t,e){return Ll(this,void 0,void 0,(function*(){let n,i=null,o=t.desiredSize||null;for(;!(i=yield e.next(r?o:null)).done;)if(ArrayBuffer.isView(i.value)&&(n=lu(i.value))&&(null!=o&&r&&(o=o-n.byteLength+1),i.value=n),t.enqueue(i.value),null!=o&&--o<=0)return;t.close()}))}}(t,e);if(Hl(t))return function(t,e){let n=null;const r="bytes"===(null==e?void 0:e.type)||!1,i=(null==e?void 0:e.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},e),{start(e){o(e,n||(n=t[Symbol.iterator]()))},pull(t){n?o(t,n):t.close()},cancel(){(null==n?void 0:n.return)&&n.return(),n=null}}),Object.assign({highWaterMark:r?i:void 0},e));function o(t,e){let n,i=null,o=t.desiredSize||null;for(;!(i=e.next(r?o:null)).done;)if(ArrayBuffer.isView(i.value)&&(n=lu(i.value))&&(null!=o&&r&&(o=o-n.byteLength+1),i.value=n),t.enqueue(i.value),null!=o&&--o<=0)return;t.close()}}(t,e);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")},ch.throughDOM=function(t){return new gy(t)},Pm.throughDOM=xy,Wm.throughDOM=xy,Vm.throughDOM=xy,fy.throughDOM=Sy,hy.throughDOM=Sy,dy.throughDOM=Sy;const ky=Object.freeze(Object.defineProperty({__proto__:null,AsyncByteQueue:mp,AsyncByteStream:bp,AsyncMessageReader:Em,AsyncRecordBatchFileReader:Ym,AsyncRecordBatchStreamReader:$m,Binary:Ec,BinaryBuilder:Ep,Bool:jc,BoolBuilder:Dp,get BufferType(){return Fu},Builder:ch,ByteStream:yp,Data:Td,DataType:yc,DateBuilder:jp,DateDay:class extends Cc{constructor(){super(Ou.DAY)}},DateDayBuilder:zp,DateMillisecond:Fc,DateMillisecondBuilder:Cp,get DateUnit(){return Ou},Date_:Cc,Decimal:zc,DecimalBuilder:Fp,DenseUnion:class extends $c{constructor(t,e){super(Su.Dense,t,e)}},DenseUnionBuilder:g_,Dictionary:Xc,DictionaryBuilder:Np,Field:rp,FixedSizeBinary:Wc,FixedSizeBinaryBuilder:Rp,FixedSizeList:Yc,FixedSizeListBuilder:Up,Float:Tc,Float16:Lc,Float16Builder:Vp,Float32:Mc,Float32Builder:$p,Float64:Bc,Float64Builder:Wp,FloatBuilder:Pp,Int:gc,Int16:wc,Int16Builder:Zp,Int32:xc,Int32Builder:Jp,Int64:Sc,Int64Builder:Kp,Int8:vc,Int8Builder:Xp,IntBuilder:Hp,Interval:Uc,IntervalBuilder:Yp,IntervalDayTime:class extends Uc{constructor(){super(Bu.DAY_TIME)}},IntervalDayTimeBuilder:Gp,get IntervalUnit(){return Bu},IntervalYearMonth:class extends Uc{constructor(){super(Bu.YEAR_MONTH)}},IntervalYearMonthBuilder:qp,JSONMessageReader:Dm,List:Pc,ListBuilder:r_,MapBuilder:i_,MapRow:ud,Map_:Gc,Message:ym,get MessageHeader(){return rm},MessageReader:Bm,get MetadataVersion(){return wu},Null:bc,NullBuilder:o_,get Precision(){return Iu},RecordBatch:W_,RecordBatchFileReader:Wm,RecordBatchFileWriter:hy,RecordBatchJSONWriter:py,RecordBatchReader:Pm,RecordBatchStreamReader:Vm,RecordBatchStreamWriter:dy,RecordBatchWriter:fy,Schema:np,SparseUnion:class extends $c{constructor(t,e){super(Su.Sparse,t,e)}},SparseUnionBuilder:b_,Struct:Vc,StructBuilder:a_,StructRow:Cf,Table:$_,Time:Nc,TimeBuilder:d_,TimeMicrosecond:class extends Nc{constructor(){super(Lu.MICROSECOND,64)}},TimeMicrosecondBuilder:__,TimeMillisecond:class extends Nc{constructor(){super(Lu.MILLISECOND,32)}},TimeMillisecondBuilder:p_,TimeNanosecond:class extends Nc{constructor(){super(Lu.NANOSECOND,64)}},TimeNanosecondBuilder:m_,TimeSecond:class extends Nc{constructor(){super(Lu.SECOND,32)}},TimeSecondBuilder:h_,get TimeUnit(){return Lu},Timestamp:Rc,TimestampBuilder:s_,TimestampMicrosecond:class extends Rc{constructor(t){super(Lu.MICROSECOND,t)}},TimestampMicrosecondBuilder:c_,TimestampMillisecond:class extends Rc{constructor(t){super(Lu.MILLISECOND,t)}},TimestampMillisecondBuilder:u_,TimestampNanosecond:class extends Rc{constructor(t){super(Lu.NANOSECOND,t)}},TimestampNanosecondBuilder:f_,TimestampSecond:class extends Rc{constructor(t){super(Lu.SECOND,t)}},TimestampSecondBuilder:l_,get Type(){return zu},Uint16:Ic,Uint16Builder:t_,Uint32:kc,Uint32Builder:e_,Uint64:Oc,Uint64Builder:n_,Uint8:Ac,Uint8Builder:Qp,Union:$c,UnionBuilder:y_,get UnionMode(){return Su},Utf8:Dc,Utf8Builder:v_,Vector:nh,Visitor:Jc,builderThroughAsyncIterable:function(t){const{queueingStrategy:e="count"}=t,{highWaterMark:n=("bytes"!==e?Number.POSITIVE_INFINITY:Math.pow(2,14))}=t,r="bytes"!==e?"length":"byteLength";return function(e){return Bl(this,arguments,(function*(){var i,o;let a=0;const s=z_(t);try{for(var l,u=Dl(e);!(l=yield Ml(u.next())).done;){const t=l.value;s.append(t)[r]>=n&&++a&&(yield yield Ml(s.toVector()))}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=u.return)&&(yield Ml(o.call(u)))}finally{if(i)throw i.error}}(s.finish().length>0||0===a)&&(yield yield Ml(s.toVector()))}))}},builderThroughIterable:N_,makeBuilder:z_,makeData:Md,makeTable:function(t){const e={},n=Object.entries(t);for(const[t,r]of n)e[t]=ih(r);return new $_(e)},makeVector:ih,tableFromArrays:function(t){const e={},n=Object.entries(t);for(const[t,r]of n)e[t]=C_(r);return new $_(e)},tableFromIPC:Ay,tableFromJSON:function(t){const e=C_(t),n=new W_(new np(e.type.children),e.data[0]);return new $_(n)},tableToIPC:function(t,e="stream"){return("stream"===e?dy:hy).writeAll(t).toUint8Array(!0)},util:Iy,vectorFromArray:C_},Symbol.toStringTag,{value:"Module"}));let Oy=0;class Ty{constructor(t){if(this.max_ix=-1,this._children=[],this.promise=Promise.resolve(),this.download_state="Unattempted",this.key=String(Math.random()),this.parent=null,this.dataset=t,void 0===t)throw new Error("No dataset provided");this.numeric_id=Oy++}get children(){return this._children}get dictionary_lookups(){return this.dataset.dictionary_lookups}download(){throw new Error("Not implemented")}delete_column_if_exists(t){var e;this._batch&&(null==(e=this._buffer_manager)||e.release(t),this._batch=Uy(this.record_batch,t,null))}async apply_transformation(t){const e=this.dataset.transformations[t];if(void 0===e)throw new Error(`Transformation ${t} is not defined`);const n=await e(this);if(void 0===n)throw new Error(`Transformation ${t} failed`);this._batch=Uy(this.record_batch,t,n)}add_column(t,e){return this._batch=Uy(this.record_batch,t,e),this._batch}is_visible(t,e){if(void 0===this.min_ix)return!1;if(this.min_ix>t)return!1;if(void 0===e)return!0;const n=this.extent;return!(n.x[0]>e.x[1]||n.x[1]<e.x[0]||n.y[0]>e.y[1]||n.y[1]<e.y[0])}*points(t,e=!1){for(const e of this)By([e.x,e.y],t)&&(yield e);if(!1===e){for(const n of this.children)if(n.ready&&(!t||n.is_visible(1e100,t)))for(const r of n.points(t,e))By([r.x,r.y],t)&&(yield r)}else{let n=this.children.map((n=>{const r={t:n,iterator:n.points(t,e),next:void 0};return r.next=r.iterator.next(),r}));for(n=n.filter((t=>{var e;return null==(e=null==t?void 0:t.next)?void 0:e.value}));n.length>0;){let t=0;for(let e=1;e<n.length;e++)n[e].next.value.ix<n[t].next.value.ix&&(t=e);yield n[t].next.value,n[t].next=n[t].iterator.next(),n[t].next.done&&(n=n.splice(t,1))}}}forEach(t){for(const e of this.points(void 0,!1))void 0!==e&&t(e)}set highest_known_ix(t){(null==this._highest_known_ix||this._highest_known_ix<t)&&(this._highest_known_ix=t,this.parent&&(this.parent.highest_known_ix=t))}get highest_known_ix(){return this._highest_known_ix||-1}get record_batch(){if(this._batch)return this._batch;if(this._table_buffer&&this._table_buffer.byteLength>0)return this._batch=Ay(this._table_buffer).batches[0];throw new Error("Attempted to access table on tile without table buffer.")}get min_ix(){return void 0!==this._min_ix?this._min_ix:this.parent?this.parent.max_ix+1:0}async schema(){return await this.download(),this._schema}extend_promise(t){return this.promise=this.promise.then((()=>t())),this.promise}get ready(){return void 0!==this._table_buffer&&this._table_buffer.byteLength>0}get _schema(){if(this.__schema)return this.__schema;const t=[];for(const e of this.record_batch.schema.fields){const{name:n,type:r}=e;if(5==(null==r?void 0:r.typeId)&&t.push({name:n,type:"string",extent:[]}),r&&r.dictionary&&t.push({name:n,type:"dictionary",keys:this.record_batch.getChild(n).data[0].dictionary.toArray(),extent:[-2047,this.record_batch.getChild(n).data[0].dictionary.length-2047]}),r&&8==r.typeId&&t.push({name:n,type:"date",extent:Et(this.record_batch.getChild(n).data[0].values)}),10===(null==r?void 0:r.typeId))return[10,100];r&&3==r.typeId&&t.push({name:n,type:"float",extent:Et(this.record_batch.getChild(n).data[0].values)})}return this.__schema=t,t}*yielder(){for(const t of this.record_batch)t&&(yield t)}get extent(){return this._extent?this._extent:{x:[Number.MIN_VALUE,Number.MAX_VALUE],y:[Number.MIN_VALUE,Number.MAX_VALUE]}}[Symbol.iterator](){return this.yielder()}get root_extent(){return null===this.parent?{x:[Number.MIN_VALUE,Number.MAX_VALUE],y:[Number.MIN_VALUE,Number.MAX_VALUE]}:this.parent.root_extent}}class Ly extends Ty{constructor(t,e,n,r,i){var o;super(r),this.bearer_token="",this._children=[],this._already_called=!1,this.child_locations=[],this.url=t,this.bearer_token=null!=(o=null==i?void 0:i.bearer_token)?o:"",this.parent=n,this.key=e;const[a,s,l]=e.split("/").map((t=>Number.parseInt(t)));this.codes=[a,s,l]}get extent(){return this._extent?this._extent:this.theoretical_extent}async download_to_depth(t){await this.download();let e=[];this.max_ix<t&&(e=this.children.map((e=>e.download_to_depth(t)))),await Promise.all(e)}async download(){if(this._download)return this._download;if(this._already_called)throw"Illegally attempting to download twice";this._already_called=!0;let t=`${this.url}/${this.key}.feather`;this.download_state="In progress",this.bearer_token&&(t=t.replace("/public",""));const e=this.bearer_token?{method:"GET",headers:{Authorization:"Bearer "+this.bearer_token}}:void 0;return this._download=fetch(t,e).then((async t=>{const e=await t.arrayBuffer();this.download_state="Complete",this._table_buffer=e,this._batch=Ay(e).batches[0];const n=this._batch.schema.metadata,r=n.get("extent");r&&(this._extent=JSON.parse(r));const i=n.get("children");i&&(this.child_locations=JSON.parse(i));const o=this._batch.getChild("ix");if(null===o)throw"No ix column in table";this._min_ix=Number(o.get(0)),this.max_ix=Number(o.get(o.length-1)),this._min_ix>this.max_ix&&(this.max_ix=this._min_ix+1e5,this._min_ix=0),this.highest_known_ix=this.max_ix})).catch((t=>{throw this.download_state="Failed",console.error(`Error: Remote Tile at ${this.url}/${this.key}.feather not found.\n        `),console.warn(t),t})),this._download}get macrotile(){return Ey(this.key)}get macro_siblings(){return function(t,e=2,n=2){return function(t,e=2,n=2){if(Dy.has(t))return Dy.get(t);const r=[[t]];for(;r.length<n;)r.unshift(r[0].map(jy).flat());const i=[r[0].map(jy).flat()];for(;i.length<e;)i.unshift(i[0].map(jy).flat());i.reverse();const o=i.flat();return Dy.set(t,o),o}(Ey(t,e,n),e,n)}(this.key)}get children(){if("Complete"!==this.download_state)return[];const t=this.constructor;if(this._children.length<this.child_locations.length)for(const e of this.child_locations){const n=new t(this.url,e,this,this.dataset,{bearer_token:this.bearer_token});this._children.push(n)}return this._children}get theoretical_extent(){const t=this.dataset.extent,[e,n,r]=this.codes,i=(t.x[1]-t.x[0])/2**e,o=(t.y[1]-t.y[0])/2**e;return{x:[t.x[0]+n*i,t.x[0]+(n+1)*i],y:[t.y[0]+r*o,t.y[0]+(r+1)*o]}}}class My extends Ty{constructor(t,e,n,r=null){if(super(e),this.full_tab=t,this._batch=t.batches[n],this.download_state="Complete",this.batch_num=n,null===this._batch.getChild("ix")){console.warn("Manually setting ix");const t=this._batch,e=new Float32Array(t.numRows),n=this.dataset._ix_seed;this.dataset._ix_seed+=t.numRows;for(let r=0;r<t.numRows;r++)e[r]=r+n;this._min_ix=n,this._max_ix=n+t.numRows,this.highest_known_ix=this._max_ix,this._batch=Uy(this.record_batch,"ix",e)}this._extent={x:Et(this._batch.getChild("x")),y:Et(this._batch.getChild("y"))},this.parent=r;const i=this._batch.get(this._batch.numRows-1);if(null===i)throw"No rows in table";this.max_ix=Number(i.ix),this.highest_known_ix=Number(this.max_ix);const o=this._batch.get(0);if(null===o)throw"No rows in table";this._min_ix=Number(o.ix),this.highest_known_ix=Number(this.max_ix),this.create_children()}create_children(){let t=4*this.batch_num;for(;++t<=4*this.batch_num+4;)t<this.full_tab.batches.length&&this._children.push(new My(this.full_tab,this.dataset,t,this));for(const t of this._children)for(const e of["x","y"])this._extent[e][0]=Math.min(this._extent[e][0],t._extent[e][0]),this._extent[e][1]=Math.max(this._extent[e][1],t._extent[e][1])}download(){return Promise.resolve(this._batch)}get ready(){return!0}}function By(t,e){return void 0===e||t[0]<e.x[1]&&t[0]>e.x[0]&&t[1]<e.y[1]&&t[1]>e.y[0]}function Ey(t,e=2,n=2){let[r,i,o]=t.split("/").map((t=>parseInt(t))),a=0;for(;!(a>=n&&r%e==0);)i=Math.floor(i/2),o=Math.floor(o/2),r-=1,a++;return`${r}/${i}/${o}`}const Dy=new Map;function jy(t){const[e,n,r]=t.split("/").map((t=>parseInt(t))),i=[];for(let t=0;t<4;t++)i.push(`${e+1}/${2*n+t%2}/${2*r+Math.floor(t/2)}`);return i}function zy(){}class Cy{constructor(t){this.transformations={},this.extents={},this._ix_seed=0,this.plot=t}get highest_known_ix(){return this.root_tile.highest_known_ix}get table(){return new $_(this.map((t=>t)).filter((t=>t.ready)).map((t=>t.record_batch)))}static from_quadfeather(t,e,n){return new Ny(t,e,n)}static from_arrow_table(t,e,n){return new Fy(t,e,n)}delete_column_if_exists(t){this.map((e=>e.delete_column_if_exists(t))),delete this.transformations[t]}domain(t,e=1e6){var n;if(this.extents[t])return this.extents[t];const r=null==(n=this._schema)?void 0:n.fields.find((e=>e.name===t));if(void 0!==r){let e,n;const i=r.metadata.get("extent");i&&([e,n]=JSON.parse(i));const o=r.metadata.get("min");o&&(e=JSON.parse(o));const a=r.metadata.get("max");if(a&&(n=JSON.parse(a)),10==r.type.typeId&&"string"==typeof e&&(e=Number(new Date(e))),10==r.type.typeId&&"string"==typeof n&&(n=Number(new Date(n))),"string"==typeof n)throw new Error("Failed to parse min-max as numbers");if(void 0!==e)return this.extents[t]=[e,n]}return this.extents[t]=Et([...this.table.getChild(t)])}*points(t,e=1e99){const n=[this.root_tile];let r;for(;r=n.shift();)if("Complete"==r.download_state&&(void 0===t||r.is_visible(e,t))){for(const n of r)By([n.x,n.y],t)&&n.ix<=e&&(yield n);n.push(...r.children)}}map(t,e=!1){const n=[];return this.visit((e=>{n.push(t(e))}),e),n}visit(t,e=!1,n=(t=>!0)){const r=[this.root_tile],i=[];let o;for(;o=r.shift();)e?i.push(o):t(o),n(o)&&"Complete"==o.download_state&&r.push(...o.children);if(e)for(;o=i.pop();)t(o)}async schema(){return await this.ready,this._schema?this._schema:(this._schema=this.root_tile.record_batch.schema,this.root_tile.record_batch.schema)}add_tiled_column(t,e){const n=Ay(e),r={};for(const t of n.batches){const e=t.getChild("data").data[0].valueOffsets,n=t.getChild("data").data[0].children[0];for(let i=0;i<t.data.length;i++){const o=t.getChild("_tile").get(i);r[o]=n.values.slice(e[i],e[i+1])}}this.transformations[t]=function(t){const{key:e}=t;return r[e]}}add_sparse_identifiers(t,e){this.transformations[t]=function(t){var n;const{key:r}=t,i=t.record_batch.numRows,o=new Float32Array(i),a=null!=(n=e.values[r])?n:[];for(const[t,e]of Object.entries(a))o[Number.parseInt(t)]=e;return o}}add_label_identifiers(t,e,n="_id"){if(this.transformations[e])throw new Error(`Can't overwrite existing transformation for ${e}`);this.transformations[e]=function(e){return function(t,e,n,r="_id"){const i=new Set;for(const t of Object.keys(e)){const e=[0,1,2,3].map((e=>t.charCodeAt(e)||"")).join("");i.add(e)}const o=new Float32Array(t.numRows),a=t.getChild(r);if(null===a)throw new Error(`Field ${r} not found in batch`);const s=a.data[0].valueOffsets,l=a.data[0].values;for(let n=0;n<t.numRows;n++){const t=l.slice(s[n],s[n+1]),r=t.slice(0,4).join("");if(i.has(r)){const r=String.fromCharCode(...t);void 0!==e[r]&&(o[n]=e[r])}}return o}(e.record_batch,t,0,n)}}findPoint(t){const e=[];return this.visit((n=>{if(!(n.ready&&n.record_batch&&n.min_ix<=t&&n.max_ix>=t))return;const r=Bt([...n.record_batch.getChild("ix").data[0].values],t),i=n.record_batch.get(r);i.ix===t&&e.push(i)})),e}}class Fy extends Cy{constructor(t,e,n){super(n),this.promise=Promise.resolve(),this.root_tile=new My(t,this,0,n)}get extent(){return this.root_tile.extent}get ready(){return Promise.resolve()}download_most_needed_tiles(t,e,n){}}class Ny extends Cy{constructor(t,e,n){super(n),this._download_queue=new Set,this.promise=new Promise(zy),this.root_tile=new Ly(t,"0/0/0",null,this,e),this.promise=this.root_tile.promise}get ready(){return this.root_tile.download()}get extent(){return this.root_tile.extent}async download_to_depth(t){await this.root_tile.download_to_depth(t)}download_most_needed_tiles(t,e,n=4){const r=this._download_queue;if(r.size>=n)return;const i=[];for(this.visit((function(e){if(void 0===t)return 1/e.codes[0];if("Unattempted"===e.download_state){const n=function(t,e){const n=t.extent;if(n.x[0]>e.x[1]||n.x[1]<e.x[0]||n.y[0]>e.y[1]||n.y[1]<e.y[0])return 0;const r={x:[$t([e.x[0],n.x[0]]),Wt([e.x[1],n.x[1]])],y:[$t([e.y[0],n.y[0]]),Wt([e.y[1],n.y[1]])]},{x:i,y:o}=r;let a=0;return i[0]>i[1]&&(a-=1),o[0]>o[1]&&(a-=2),a<0?a:Ry(r)/Ry(e)}(e,t);i.push([n,e,t])}})),i.sort(((t,e)=>Number(t[0])-Number(e[0])));i.length>0&&r.size<n;){const t=i.pop();if(void 0===t)throw new Error("Ran out of tiles unexpectedly");const[n,o,a]=t;o.min_ix&&o.min_ix>e||n<=0||(r.add(o.key),o.download().then((()=>r.delete(o.key))).catch((t=>{throw console.warn("Error on",o.key),r.delete(o.key),t})))}}add_macrotiled_column(t,e){const n={},r={};this.transformations[t]=async function(t){return await async function(t){const{key:i,macrotile:o}=t;return void 0!==n[o]?await n[o]:(n[o]=e(t.macro_siblings).then((t=>{const e=Ay(t);for(const t of e.batches){const e=t.getChild("data").data[0].valueOffsets,n=t.getChild("data").data[0].children[0];for(let i=0;i<t.data.length;i++){const o=t.getChild("_tile").get(i);r[o]=n.values.slice(e[i],e[i+1])}}})),n[o])}(t),r[t.key]}}}function Ry(t){return(t.x[1]-t.x[0])*(t.y[1]-t.y[0])}function Uy(t,e,n){const r={};for(const i of t.schema.fields){if(i.name===e){if(null===n)continue;throw new Error(`Name ${i.name} already exists, can't add.`)}r[i.name]=t.getChild(i.name).data[0]}if(void 0===n)throw new Error("Must pass data to bind_column");null!==n&&(n instanceof Float32Array?r[e]=ih(n).data[0]:r[e]=n.data[0]);const i=new W_(r);for(const[e,n]of t.schema.metadata)i.schema.metadata.set(e,n);for(const e of t.schema.fields){const t=i.schema.fields.find((t=>t.name===e.name));if(void 0!==t)for(const[n,r]of e.metadata)t.metadata.set(n,r);else if(null!==n)throw new Error("Error!")}if(null!==n){const t=i.schema.fields.find((t=>t.name===e));null==t||t.metadata.set("created by deepscatter",(new Date).toISOString())}return i}var Py={},Vy={};!function(t,e){t.exports=function(){function t(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-l*c/s+f)),Math.min(o,Math.floor(r+(s-l)*c/s+f)),a)}var d=n[r],h=i,p=o;for(e(n,i,r),a(n[o],d)>0&&e(n,i,o);h<p;){for(e(n,h,p),h++,p--;a(n[h],d)<0;)h++;for(;a(n[p],d)>0;)p--}0===a(n[i],d)?e(n,i,p):e(n,++p,o),p<=r&&(i=p+1),r<=p&&(o=p-1)}}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}return function(e,r,i,o,a){t(e,r,i||0,o||e.length-1,a||n)}}()}({get exports(){return Vy},set exports(t){Vy=t}}),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Vy,n=[],r=function(t){return n.push(t)},i=function(t){t&&(r(t),l(t)||t.children.forEach(i))},o=function(t){var e=n.pop();return e?(e.children=t,e.height=1,e.leaf=!0,e.minX=1/0,e.minY=1/0,e.minZ=1/0,e.maxX=-1/0,e.maxY=-1/0,e.maxZ=-1/0):e={children:t,height:1,leaf:!0,minX:1/0,minY:1/0,minZ:1/0,maxX:-1/0,maxY:-1/0,maxZ:-1/0},e},a=[],s=function(t,e){var n=a.pop();return n?(n.dist=t,n.node=e):n={dist:t,node:e},n},l=function(t){return t.leaf},u=function(t,e){return t.leaf},c=function(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1},f=function(t){d(t,0,t.children.length,t)},d=function(t,e,n,r){var i=r;i?(i.minX=1/0,i.minY=1/0,i.minZ=1/0,i.maxX=-1/0,i.maxY=-1/0,i.maxZ=-1/0):i=o([]);for(var a=e,s=void 0;a<n;a++)s=t.children[a],h(i,s);return i},h=function(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.minZ=Math.min(t.minZ,e.minZ),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t.maxZ=Math.max(t.maxZ,e.maxZ),t},p=function(t){return(t.maxX-t.minX)*(t.maxY-t.minY)*(t.maxZ-t.minZ)},_=function(t){return t.maxX-t.minX+(t.maxY-t.minY)+(t.maxZ-t.minZ)},m=function(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&t.minZ<=e.minZ&&e.maxX<=t.maxX&&e.maxY<=t.maxY&&e.maxZ<=t.maxZ};t.intersects=function(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.minZ<=t.maxZ&&e.maxX>=t.minX&&e.maxY>=t.minY&&e.maxZ>=t.minZ},t.boxRayIntersects=function(t,e,n,r,i,o,a){var s=(t.minX-e)*i,l=(t.maxX-e)*i,u=(t.minY-n)*o,c=(t.maxY-n)*o,f=(t.minZ-r)*a,d=(t.maxZ-r)*a,h=Math.min(f,d),p=Math.max(f,d),_=Math.min(u,c),m=Math.max(u,c),y=Math.min(s,l),b=Math.max(s,l),g=Math.max(0,y,_,h);return Math.min(b,m,p)>=g?g:1/0};var y=function(t,n,r,i,o){for(var a,s=[n,r];s.length;)(r=s.pop())-(n=s.pop())<=i||(a=n+Math.ceil((r-n)/i/2)*i,e(t,a,n,r,o),s.push(n,a,a,r))},b=function(t,e){return t.minX-e.minX},g=function(t,e){return t.minY-e.minY},v=function(t,e){return t.minZ-e.minZ},w=function(){function e(t){void 0===t&&(t=16),this.maxEntries=Math.max(t,8),this.minEntries=Math.max(4,Math.ceil(.4*this.maxEntries)),this.clear()}return e.alloc=function(){return this.pool.pop()||new this},e.free=function(t){t.clear(),this.pool.push(t)},e.prototype.search=function(e){var n=this.data,r=[];if(!t.intersects(e,n))return r;for(var i=[];n;){for(var o=0,a=n.children.length;o<a;o++){var s=n.children[o];t.intersects(e,s)&&(u(n)?r.push(s):m(e,s)?this._all(s,r):i.push(s))}n=i.pop()}return r},e.prototype.collides=function(e){var n=this.data;if(!t.intersects(e,n))return!1;for(var r=[];n;){for(var i=0,o=n.children.length;i<o;i++){var a=n.children[i];if(t.intersects(e,a)){if(u(n)||m(e,a))return!0;r.push(a)}}n=r.pop()}return!1},e.prototype.raycastInv=function(e,n,r,i,o,l,c){void 0===c&&(c=1/0);var f=this.data;if(i===1/0&&o===1/0&&l===1/0)return s(1/0,void 0);if(t.boxRayIntersects(f,e,n,r,i,o,l)===1/0)return s(1/0,void 0);for(var d,h=[s(0,f)],p=function(t,e){var n=h[t];h[t]=h[e],h[e]=n},_=function(){var t=h[0],e=h.length-1;h[0]=h[e],h.length=e;for(var n=0;;){var r=n<<1|1;if(r>=e)break;var i=r+1;if(i<e&&h[i].dist<h[r].dist&&(r=i),h[n].dist<h[r].dist)break;p(n,r),n=r}return function(t){a.push(t)}(t),t.node},m=function(t,e){var n=h.length;for(h.push(s(t,e));n>0;){var r=n-1>>1;if(h[r].dist<=h[n].dist)break;p(n,r),n=r}},y=c;h.length&&h[0].dist<y;)for(var b=0,g=(f=_()).children.length;b<g;b++){var v=f.children[b],w=t.boxRayIntersects(v,e,n,r,i,o,l);if(u(f)){if(w<y){if(0===w)return s(w,v);y=w,d=v}}else m(w,v)}return s(y<c?y:1/0,d)},e.prototype.raycast=function(t,e,n,r,i,o,a){return void 0===a&&(a=1/0),this.raycastInv(t,e,n,1/r,1/i,1/o,a)},e.prototype.all=function(){return this._all(this.data,[])},e.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this.minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this.build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this.splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},e.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},e.prototype.clear=function(){return this.data&&i(this.data),this.data=o([]),this},e.prototype.remove=function(t,e){if(!t)return this;for(var n,r,i=this.data,o=0,a=!1,s=[],u=[];i||s.length;){if(i||(i=s.pop(),o=u.pop(),r=s[s.length-1],a=!0),l(i)&&-1!==(n=c(t,i.children,e)))return i.children.splice(n,1),s.push(i),this.condense(s),this;a||l(i)||!m(i,t)?r?(o++,i=r.children[o],a=!1):i=void 0:(s.push(i),u.push(o),o=0,r=i,i=i.children[0])}return this},e.prototype.toJSON=function(){return this.data},e.prototype.fromJSON=function(t){return i(this.data),this.data=t,this},e.prototype.build=function(t,e,n,r){var i,a=n-e+1,s=this.maxEntries;if(a<=s)return i=o(t.slice(e,n+1)),f(i),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=o([])).leaf=!1,i.height=r;var l=Math.ceil(a/s),u=l*Math.ceil(Math.pow(s,2/3)),c=l*Math.ceil(Math.pow(s,1/3));y(t,e,n,c,b);for(var d=e;d<=n;d+=c){var h=Math.min(d+c-1,n);y(t,d,h,u,g);for(var p=d;p<=h;p+=u){var _=Math.min(p+u-1,h);y(t,p,_,l,v);for(var m=p;m<=_;m+=l){var w=Math.min(m+l-1,_);i.children.push(this.build(t,m,w,r-1))}}}return f(i),i},e.prototype._all=function(t,e){for(var n=[];t;)l(t)?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},e.prototype.chooseSubtree=function(t,e,n,r){for(var i,o,a,s,u,c,f,d;r.push(e),!l(e)&&r.length-1!==n;){i=o=1/0;for(var h=0,_=e.children.length;h<_;h++){var m=e.children[h],y=p(m),b=(s=t,u=m,void 0,void 0,void 0,c=Math.min(s.minX,u.minX),f=Math.min(s.minY,u.minY),d=Math.min(s.minZ,u.minZ),(Math.max(s.maxX,u.maxX)-c)*(Math.max(s.maxY,u.maxY)-f)*(Math.max(s.maxZ,u.maxZ)-d)-y);b<o?(o=b,i=y<i?y:i,a=m):b===o&&y<i&&(i=y,a=m)}e=a||e.children[0]}return e},e.prototype.split=function(t,e){var n=t[e],r=n.children.length,i=this.minEntries;this.chooseSplitAxis(n,i,r);var a=this.chooseSplitIndex(n,i,r),s=o(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,f(n),f(s),e?t[e-1].children.push(s):this.splitRoot(n,s)},e.prototype.splitRoot=function(t,e){this.data=o([t,e]),this.data.height=t.height+1,this.data.leaf=!1,f(this.data)},e.prototype.chooseSplitIndex=function(t,e,n){for(var r,i,o,a,s,l,u,c,f,h=1/0,_=1/0,m=e;m<=n-e;m++){var y=d(t,0,m),b=d(t,m,n),g=(i=y,o=b,void 0,void 0,void 0,void 0,void 0,void 0,a=Math.max(i.minX,o.minX),s=Math.max(i.minY,o.minY),l=Math.max(i.minZ,o.minZ),u=Math.min(i.maxX,o.maxX),c=Math.min(i.maxY,o.maxY),f=Math.min(i.maxZ,o.maxZ),Math.max(0,u-a)*Math.max(0,c-s)*Math.max(0,f-l)),v=p(y)+p(b);g<h?(h=g,r=m,_=v<_?v:_):g===h&&v<_&&(_=v,r=m)}return r},e.prototype.chooseSplitAxis=function(t,e,n){var r=this.allDistMargin(t,e,n,b),i=this.allDistMargin(t,e,n,g),o=this.allDistMargin(t,e,n,v);r<i&&r<o?t.children.sort(b):i<r&&i<o&&t.children.sort(g)},e.prototype.allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=d(t,0,e),o=d(t,n-e,n),a=_(i)+_(o),s=e;s<n-e;s++){var l=t.children[s];h(i,l),a+=_(i)}for(s=n-e-1;s>=e;s--)l=t.children[s],h(o,l),a+=_(o);return a},e.prototype.adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)h(e[r],t)},e.prototype.condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?((n=t[e-1].children).splice(n.indexOf(t[e]),1),r(t[e])):this.clear():f(t[e])},e.prototype._insert=function(t,e,n){var r=[],i=this.chooseSubtree(t,this.data,e,r);for(i.children.push(t),h(i,t);e>=0&&r[e].children.length>this.maxEntries;)this.split(r,e),e--;this.adjustParentBBoxes(t,r,e)},e.pool=[],e}();t.RBush3D=w}(Py);const $y=function(){var t,e,n,r,i=sr,o=lr,a=ur,s=cr,l={},u=Hn("start","drag","end"),c=0,f=0;function d(t){t.on("mousedown.drag",h).filter(s).on("touchstart.drag",m).on("touchmove.drag",y,Qn).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(a,s){if(!r&&i.call(this,a,s)){var l=g(this,o.call(this,a,s),a,s,"mouse");l&&(St(a.view).on("mousemove.drag",p,tr).on("mouseup.drag",_,tr),rr(a.view),er(a),n=!1,t=a.clientX,e=a.clientY,l("start",a))}}function p(r){if(nr(r),!n){var i=r.clientX-t,o=r.clientY-e;n=i*i+o*o>f}l.mouse("drag",r)}function _(t){St(t.view).on("mousemove.drag mouseup.drag",null),ir(t.view,n),nr(t),l.mouse("end",t)}function m(t,e){if(i.call(this,t,e)){var n,r,a=t.changedTouches,s=o.call(this,t,e),l=a.length;for(n=0;n<l;++n)(r=g(this,s,t,e,a[n].identifier,a[n]))&&(er(t),r("start",t,a[n]))}}function y(t){var e,n,r=t.changedTouches,i=r.length;for(e=0;e<i;++e)(n=l[r[e].identifier])&&(nr(t),n("drag",t,r[e]))}function b(t){var e,n,i=t.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),e=0;e<o;++e)(n=l[i[e].identifier])&&(er(t),n("end",t,i[e]))}function g(t,e,n,r,i,o){var s,f,h,p=u.copy(),_=At(o||n,e);if(null!=(h=a.call(t,new ar("beforestart",{sourceEvent:n,target:d,identifier:i,active:c,x:_[0],y:_[1],dx:0,dy:0,dispatch:p}),r)))return s=h.x-_[0]||0,f=h.y-_[1]||0,function n(o,a,u){var m,y=_;switch(o){case"start":l[i]=n,m=c++;break;case"end":delete l[i],--c;case"drag":_=At(u||a,e),m=c}p.call(o,t,new ar(o,{sourceEvent:a,subject:h,target:d,identifier:i,active:m,x:_[0]+s,y:_[1]+f,dx:_[0]-y[0],dy:_[1]-y[1],dispatch:p}),r)}}return d.filter=function(t){return arguments.length?(i="function"==typeof t?t:or(!!t),d):i},d.container=function(t){return arguments.length?(o="function"==typeof t?t:or(t),d):o},d.subject=function(t){return arguments.length?(a="function"==typeof t?t:or(t),d):a},d.touchable=function(t){return arguments.length?(s="function"==typeof t?t:or(!!t),d):s},d.on=function(){var t=u.on.apply(u,arguments);return t===u?d:t},d.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,d):Math.sqrt(f)},d}();class Wy extends Ta{constructor(t,e,n={}){super(t.div.node(),t._root,t),this.layers=[],this.options={},this.options=n,this.canvas=t.elements[2].selectAll("canvas").node();const r=t.elements[3].selectAll("svg").node(),i=e.replace(/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~]/g,"---"),o=r.querySelectorAll(`#${i}`);if(0===o.length?this.labelgroup=St(r).select("#labelrects").append("g").attr("id",i).node():this.labelgroup=o[1],void 0===this.canvas)throw new Error("WTF?");this.ctx=this.canvas.getContext("2d"),this.tree=new qy(this.ctx,function(t){const[e,n]=t._zoom.scales().x.range(),[r,i]=t._zoom.scales().x.domain();return(n-e)/(i-r)}(t),.5,[.5,1e6],void 0===n.margin?30:n.margin),this.bind_zoom(t._renderer.zoom)}start(t=1e9){this.timer&&this.timer.stop(),St(this.labelgroup).attr("display","inline"),this.timer=Vn((()=>{this.render(),(t-=1)<=0&&this.stop()}))}delete(){St(this.labelgroup).remove()}stop(){this.timer&&(this.timer.stop(),St(this.labelgroup).attr("display","none"),this.ctx.clearRect(0,0,4096,4096),this.timer=void 0)}update(t,e,n){var r;this.label_key=e;for(const i of t.features){const{properties:t,geometry:o}=i;if(null!==t&&"Point"===o.type){const i=null!=(r=t[n])?r:16;let a="";void 0!==t[e]&&null!==t[e]&&(a=t[e]);const s={x:o.coordinates[0]+.1*Math.random(),y:o.coordinates[1]+.1*Math.random(),text:a,height:i,properties:t};this.tree.insert_point(s)}}}render(){const t=this.ctx,{x_:e,y_:n}=this.zoom.scales(),{transform:r}=this.zoom,{width:i,height:o}=this;t.clearRect(0,0,i,o),t.textAlign="center",t.textBaseline="middle",t.globalAlpha=1;const a=this.zoom.current_corners(),s=this.tree.search({minX:a.x[0],minY:a.y[0],minZ:r.k,maxX:a.x[1],maxY:a.y[1],maxZ:r.k});t.clearRect(0,0,4096,4096);const l=this.scatterplot.dim("color"),u=St(this.labelgroup).selectAll("rect.labelbbox").data(s,(t=>""+t.minZ+t.minX)).join((t=>t.append("rect").attr("class","labellbox").style("opacity",0)));for(const r of s){const i=r.data,o=e(i.x),a=n(i.y);t.globalAlpha=1,t.fillStyle="white";let s=!1;for(const t of[this.scatterplot.dim("filter"),this.scatterplot.dim("filter2")])i.properties[t.field]&&(t.apply(i.properties)||(s=!0));if(s){i.properties.__display="none";continue}i.properties.__display="inline",!1===this.options.useColorScale||void 0===this.options.useColorScale?(t.shadowColor="#71797E",t.strokeStyle="#71797E"):i.properties[l.field]?l.scale.domain().indexOf(i.properties[l.field])>-1?(t.shadowColor=l.scale(i.properties[l.field]),t.strokeStyle=l.scale(i.properties[l.field])):(t.shadowColor="gray",t.strokeStyle="gray"):t.shadowColor="black";let u=0;this.hovered===""+r.minZ+r.minX&&(u+=2),t.font=`${1*i.height+u}pt verdana`,t.shadowBlur=12+3*u,t.lineWidth=3+u,t.strokeText(i.text,o,a),t.shadowBlur=0,t.lineWidth=4+u,t.fillStyle="white",t.fillText(i.text,o,a)}u.attr("class","labelbbox").attr("x",(t=>e(t.data.x)-t.data.pixel_width*this.tree.pixel_ratio/2)).attr("y",(t=>n(t.data.y)-t.data.pixel_height*this.tree.pixel_ratio/2-5)).attr("width",(t=>t.data.pixel_width*this.tree.pixel_ratio)).attr("stroke","red").attr("height",(t=>t.data.pixel_height*this.tree.pixel_ratio+10)).attr("display",(t=>t.data.properties.__display||"inline")).on("mouseover",((t,e)=>{St(t.target).style("opacity",0),this.hovered=""+e.minZ+e.minX,t.stopPropagation()})).on("mousemove",(function(t,e){t.stopPropagation()})).on("click",((t,e)=>{this.scatterplot.label_click(e.data,this.scatterplot,this)})).on("mouseout",((t,e)=>{this.hovered=void 0,t.stopPropagation()})),this.options.draggable_labels&&($y.on("drag",((t,r)=>{r.data.x=e.invert(t.x),r.data.y=n.invert(t.y)})),$y.on("end",((t,e)=>{})),u.call($y)),t.shadowColor="black",t.strokeStyle="black"}}let Yy=null;function Gy(t,e,n){const r=function(){if(null!==Yy)return Yy;const t=document.createElement("canvas");return t.width=500,t.height=400,Yy=t.getContext("2d"),Yy}();if(r.font=`${t.height}pt verdana`,""===t.text)return null;const i=r.measureText(t.text);let{actualBoundingBoxLeft:o,actualBoundingBoxRight:a,actualBoundingBoxAscent:s,actualBoundingBoxDescent:l}=i;return(Number.isNaN(o)||void 0===o)&&(o=0,a=i.width,s=t.height,l=0),{pixel_height:(s-l)/e+n/e,pixel_width:(a-o)/e+n/e}}class qy extends Py.RBush3D{constructor(t,e,n=.5,r=[.1,1e3],i=10){super(),this._accessor=t=>[t.x,t.y],this.scale_factor=n,this.mindepth=r[0],this.maxdepth=r[1],this.context=t,this.pixel_ratio=e,this.margin=i}max_collision_depth(t,e){const[n,r]=this._accessor(t),[i,o]=this._accessor(e),a=Math.abs(n-i),s=(t.pixel_width+e.pixel_width)/2/a,l=Math.abs(r-o),u=(t.pixel_height+e.pixel_height)/2/l;return Math.min(s,u)}set accessor(t){this._accessor=t}get accessor(){return this._accessor}to3d(t,e=1,n){const[r,i]=this.accessor(t),{pixel_height:o,pixel_width:a}=t,s={minX:r-a/e/2,maxX:r+a/e/2,minY:i-o/e/2,maxY:i+o/e/2,minZ:e,maxZ:n||this.maxdepth,data:t};if(Number.isNaN(r)||Number.isNaN(i))throw"Missing position"+JSON.stringify(t);if(Number.isNaN(a))throw"Missing Aspect Ratio"+JSON.stringify(t);return s}insert_point(t,e=1){if(void 0===t.text||""===t.text)return;let n;n=void 0===t.pixel_width?{...t,...Gy(t,this.pixel_ratio,this.margin)}:t;const r=this.to3d(n,e,this.maxdepth);this.collides(r)?this.insert_after_collisions(r):e<=this.mindepth?this.insert(r):this.insert_point(t,e/2)}insert_after_collisions(t){let e,n=-1;for(const r of this.search(t)){const i=this.max_collision_depth(t.data,r.data);i>n&&(n=i,e=r)}if(e&&n<this.maxdepth){const r=e.data,i=e.minZ,o=e.maxZ;if(i<n){this.remove(e);const t=this.to3d(r,i,n);this.insert(t);const a=this.to3d(r,n,o);this.insert(a)}const a=this.to3d(t.data,n,this.maxdepth);this.insert(a)}}}const Hy={zoom_balance:.35,duration:1e3,max_points:1e3,encoding:{},point_size:1,alpha:40,background_options:{color:"gray",opacity:[.2,1],size:[.66,1],mouseover:!1}},Xy=[{id:"canvas-2d-background",nodetype:"canvas"},{id:"webgl-canvas",nodetype:"canvas"},{id:"canvas-2d",nodetype:"canvas"},{id:"deepscatter-svg",nodetype:"svg"}];class Zy{constructor(t,e,n){this.secondary_renderers={},this.plot_queue=Promise.resolve(0),this.arrow=ky,this.hooks={},this.mark_ready=function(){},this.bound=!1,void 0!==t&&this.bind(t,e,n),this.width=e,this.height=n,this.ready=new Promise(((t,e)=>{this.mark_ready=t})),this.click_handler=new Qy(this),this.tooltip_handler=new tb(this),this.label_click_handler=new Ky(this),this.prefs={...Hy}}bind(t,e,n){if(this.div=St(t).selectAll("div.deepscatter_container").data([1]).join("div").attr("class","deepscatter_container").style("position","absolute"),this.div.empty())throw console.error(t),"Must pass a valid div selector";this.elements=[];for(const t of Xy){const r=this.div.append("div").attr("id",`container-for-${t.id}`).style("position","absolute").style("top",0).style("left",0).style("pointer-events","deepscatter-svg"===t.id?"auto":"none"),i=r.append(t.nodetype).attr("id",t.id).attr("width",e||window.innerWidth).attr("height",n||window.innerHeight);"svg"===t.nodetype&&(i.append("g").attr("id","mousepoints"),i.append("g").attr("id","labelrects")),this.elements.push(r)}this.bound=!0}add_identifier_column(t,e,n){const r=Array.isArray(e)?Object.fromEntries(e.map((t=>[t,1]))):e;console.log({true_codes:r}),this._root.add_label_identifiers(r,t,n)}async add_labels_from_url(t,e,n,r,i){return await this.ready,await this._root.promise,fetch(t).then((async t=>{const o=await t.json();this.add_labels(o,e,n,r,i)})).catch((t=>{console.error("Broken addition of ",e),console.log(t)}))}add_labels(t,e,n,r,i={}){const o=new Wy(this,e,i);o.update(t,n,r),this.secondary_renderers[e]=o,this.secondary_renderers[e].start()}async reinitialize(){const{prefs:t}=this;if(void 0!==t.source_url)this._root=Cy.from_quadfeather(t.source_url,t,this);else{if(void 0===t.arrow_table)throw new Error("No source_url or arrow_table specified");this._root=Cy.from_arrow_table(t.arrow_table,t,this)}await this._root.ready,this._renderer=new kl("#container-for-webgl-canvas",this._root,this),this._zoom=new xa("#deepscatter-svg",this.prefs,this),this._zoom.attach_tiles(this._root),this._zoom.attach_renderer("regl",this._renderer),this._zoom.initialize_zoom();const e=St("#container-for-canvas-2d-background").select("canvas").node().getContext("2d");return e.fillStyle=t.background_color||"rgba(133, 133, 111, .8)",e.fillRect(0,0,2*window.innerWidth,2*window.innerHeight),this._renderer.initialize(),this._root.promise.then((()=>this.mark_ready())),this.ready}visualize_tiles(){const t=this,e=t.elements[2].selectAll("canvas").node().getContext("2d");e.clearRect(0,0,1e4,1e4);const{x_:n,y_:r}=t._zoom.scales();e.strokeStyle="#888888";const i=t._root.map((t=>t));for(const t of Gt(13))setTimeout((()=>{for(const o of i){if(o.codes[0]!=t)continue;if(!o.extent)continue;const[i,a]=o.extent.x.map((t=>n(t))),[s,l]=o.extent.y.map((t=>r(t))),u=o.codes[0];e.lineWidth=8/Math.sqrt(u),e.globalAlpha=.33,e.strokeRect(i,s,a-i,l-s),"Unattempted"!==o.download_state&&e.fillRect(i,s,a-i,l-s),e.globalAlpha=1}}),400*t);setTimeout((()=>e.clearRect(0,0,1e4,1e4)),6800)}async make_big_png(t=3,e=1e7,n=100){await this._root.download_to_depth(e);const{width:r,height:i}=this._renderer;this.plotAPI({duration:0});const o=document.createElement("canvas");o.setAttribute("width",(t*r).toString()),o.setAttribute("height",(t*i).toString());const a=o.getContext("2d"),s=this._zoom.current_corners();this._zoom.transform.k;const l=(s.x[1]-s.x[0])/t,u=(s.y[1]-s.y[0])/t;new Promise(((e,o)=>{for(let o=0;o<t;o++)for(let c=0;c<t;c++)setTimeout((()=>{this._zoom.zoom_to_bbox({x:[s.x[0]+l*o,s.x[0]+l*(o+1)],y:[s.y[0]+u*c,s.y[0]+u*(c+1)]},n/5,1),setTimeout((()=>{this._renderer.fbos.colorpicker.use((()=>{this._renderer.render_all(this._renderer.props);const t=this._renderer.regl.read(0,0,r,i);console.log(o,c,Ht(t));const e=i/2|0,n=4*r;for(var s=new Uint8Array(4*r),l=0;l<e;++l){var u=l*n,f=(i-l-1)*n;s.set(t.subarray(u,u+n)),t.copyWithin(u,f,f+n),t.set(s,f)}const d=new ImageData(new Uint8ClampedArray(t),r);a.putImageData(d,r*o,i*c)})),o==t-1&&c===t-1&&e()}),n/2)}),o*n*t+c*n)})).then((()=>{const t=o.toDataURL(),e=document.createElement("a");e.href=t,e.style="position:fixed;top:40vh;left:40vw;z-index:999;",e.download="deepscatter",e.click(),e.remove()}))}destroy(){var t,e,n;null==(e=null==(t=this._renderer)?void 0:t.regl)||e.destroy(),null==(n=this.div)||n.node().parentElement.replaceChildren()}update_prefs(t){if(this.prefs.encoding&&t.encoding)for(const e of Object.keys(this.prefs.encoding))void 0!==t.encoding[e]&&(this.prefs.encoding[e]=t.encoding[e]);Tn(this.prefs,t)}add_hook(t,e,n=!1){if(void 0!==this.hooks[t]&&!n)throw new Error(`Hook ${t} already exists`);this.hooks[t]=e}remove_hook(t,e=!1){if(void 0===this.hooks[t]){if(e)return;throw new Error(`Hook ${t} does not exist`)}delete this.hooks[t]}stop_labellers(){for(const[t,e]of Object.entries(this.secondary_renderers))e&&void 0!==e.label_key&&(this.secondary_renderers[t].stop(),this.secondary_renderers[t].delete(),this.secondary_renderers[t]=void 0)}dim(t){return this._renderer.aes.dim(t).current}set tooltip_html(t){this.tooltip_handler.f=t}get tooltip_html(){return this.tooltip_handler.f}set label_click(t){this.label_click_handler.f=t}get label_click(){return this.label_click_handler.f.bind(this.label_click_handler)}set click_function(t){this.click_handler.f=t}get click_function(){return this.click_handler.f}async plotAPI(t){if(void 0!==t){await this.plot_queue,t&&await this.start_transformations(t),this.plot_queue=this.unsafe_plotAPI(t),await this.plot_queue;for(const[t,e]of Object.entries(this.hooks))e()}}async start_transformations(t,e=110){return new Promise((n=>{this.prefs.duration<e&&(e=this.prefs.duration);const r=new Set;t.encoding||n();for(const[e,n]of Object.entries(t.encoding))n&&"string"!=typeof n&&void 0!==n.field&&r.add(n.field);if(this._renderer){const t=[],i=[];for(const e of this._renderer.visible_tiles()){const n=e._buffer_manager;if(void 0!==n&&n.ready())for(const o of r){const{ready:r,promise:a}=n.ready_or_not_here_it_comes(o);r||null!==a&&(t.push(a),"0/0/0"===e.key&&i.push(a))}}if(0===t.length)n();else{const t=Date.now();Promise.all(i).then((()=>{const r=Date.now()-t;r<e?setTimeout((()=>{n()}),e-r):n()}))}}else n()}))}async unsafe_plotAPI(t){if(null===t)return;if(t.click_function&&(this.click_function=Function("datum",t.click_function)),t.tooltip_html&&(this.tooltip_html=Function("datum",t.tooltip_html)),t.background_options&&(t.background_options.opacity&&"number"==typeof t.background_options.opacity&&(t.background_options.opacity=[t.background_options.opacity,1]),t.background_options.size&&"number"==typeof t.background_options.size&&(t.background_options.size=[t.background_options.size,1])),t.labels){const{url:e,label_field:n,size_field:r}=t.labels,i=t.labels.name||e;this.secondary_renderers[i]||(this.stop_labellers(),this.add_labels_from_url(e,i,n,r).catch((t=>{console.error("Label addition failed."),console.error(t)})))}this.update_prefs(t),void 0===this._root&&await this.reinitialize(),t.basemap_gleofeather&&(t.polygons=[{file:t.basemap_gleofeather}]),await this._root.promise,this._renderer.render_props.apply_prefs(this.prefs);const{width:e,height:n}=this;this.update_prefs(t),void 0!==t.zoom&&(null===t.zoom?(this._zoom.zoom_to(1,e/2,n/2),t.zoom=void 0):t.zoom.bbox&&this._zoom.zoom_to_bbox(t.zoom.bbox,t.duration)),this._renderer.most_recent_restart=Date.now(),this._renderer.aes.apply_encoding(t.encoding),this._renderer.apply_webgl_scale&&this._renderer.apply_webgl_scale(t),this._renderer.reglframe&&(this._renderer.reglframe.cancel(),this._renderer.reglframe=void 0),this._renderer.reglframe=this._renderer.regl.frame((()=>{this._renderer.tick("Basic")})),this._zoom.restart_timer(6e4)}async root_table(){return!!this._root&&this._root.record_batch}get query(){const t=JSON.parse(JSON.stringify(this.prefs));return t.zoom={bbox:this._renderer.zoom.current_corners()},t}drawContours(t,e){const n=(e||St("body")).select("#canvas-2d").node().getContext("2d");for(const e of t){n.fillStyle="rgba(25, 25, 29, 1)",n.fillRect(0,0,2*window.innerWidth,2*window.innerHeight),n.strokeStyle="#8a0303",n.fillStyle="rgba(30, 30, 34, 1)",n.lineWidth=$t([.45,.25*Math.exp(Math.log(this._zoom.transform.k/2))]);const t=xn(kn().scale(this._zoom.transform.k).translate([this._zoom.transform.x,this._zoom.transform.y]),n);n.beginPath(),t(e),n.fill()}}sample_points(t=10){const e=[];for(const n of this._root.points(this._zoom.current_corners()))if(e.push({...n}),e.length>=3*t)break;return e.sort(((t,e)=>Number(t.ix)-Number(e.ix))),e.slice(0,t)}contours(t){const e=this._renderer.calculate_contours(t),{x:n,y:r,x_:i,y_:o}=this._zoom.scales();!function t(e){if(e){if(e.coordinates)return t(e.coordinates);if(0!==e.length){if(e[0].length>0)return e.map(t);e[0]=n(i.invert(e[0])),e[1]=r(o.invert(e[1]))}}}(e),this.drawContours(e)}}class Jy{constructor(t){this.string_rep="",this.plot=t}get f(){return void 0===this._f?this.default:this._f}set f(t){"string"==typeof t?this.string_rep!==t&&(this.string_rep=t,this._f=Function("datum","plot",t)):this._f=t}}class Ky extends Jy{default(t,e,n){let r;null!==t&&(1==t.__activated?(r=null,t.__activated=void 0):(t.__activated=!0,r={field:n.label_key,lambda:`d => d === '${t.properties[n.label_key]}'`}),this.plot.plotAPI({encoding:{filter:r}}))}}class Qy extends Jy{default(t,e){console.log({...t})}}class tb extends Jy{default(t,e){let n="<dl>";const r=new Set(["x","y","ix",null,"tile_key"]);for(const[e,i]of t)null!==i&&(r.has(e)||""!==i&&(n+=` <dt>${String(e)}</dt>\n`,n+=`   <dd>${String(i)}<dd>\n`));return`${n}</dl>\n`}}var eb,nb=n(635),rb="chart_debut_date_normalized_0_to_1",ib="generic_genre",ob="color",ab="near_neighbors_count",sb="num_before_song_avg",lb="song_id",ub={source_url:"".concat(window.location.href).concat("deepscatter-tiles"),max_points:5e5,zoom_balance:.7,point_size:1,background_color:"#ffffff",duration:1e3,encoding:(eb={x:{field:"x"},y:{field:"y"}},eb[ob]={field:ib,domain:[-2047,2047],range:"set1"},eb.filter=null,eb)},cb={x:"mixed",f:"female",m:"male"},fb=function(t){var e=new Date(t.chart_debut).getYear()+1900;return'\n    <div style="width: 400px; z-index: 1000;">\n      <span></span>\n      <h4>('.concat(e,") ").concat(t.lyric_line,"</h4>\n      \n      <div>").concat(t.song,"</div>\n      <div>").concat(t.performer,"</div>\n      <div>").concat(t.generic_genre,"</div>\n      <div>Gender: ").concat(cb[t.gender],"</div>\n      \n      <div>").concat(new Date(t.chart_debut).getFullYear(),"</div>\n    </div>\n")},db=function(t){var e,n,r="https://www.youtube.com/results?search_query=".concat(t.song,"+by+").concat(t.performer).replace(" ","+"),i='\n  {\n    label: "",\n    nearestLyric: "'.concat(t.lyric_line,'",\n    coordinates: [').concat(t.x,", ").concat(t.y,"],\n  },\n  ");console.log(i),e=i,(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),window.open(r,"_blank")},hb=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},pb=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},_b=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},mb=function(t,e,n,r){return hb(void 0,void 0,void 0,(function(){var e,i,o,a,s,l,u,c;return pb(this,(function(f){switch(f.label){case 0:return e=t.key,i=r.query("SELECT * FROM information_schema.tables WHERE table_name = '".concat(e,"'")).then((function(t){return t.numRows>0})),o=t.download,[4,Promise.all([i,o])];case 1:if(a=_b.apply(void 0,[f.sent(),2]),s=a[0],a[1],s)return[2,e];if(0===(l=new n.Table(t.record_batch.schema,t.record_batch)).length)throw new Error("humbug");return u=n.tableToIPC(l),c=e,[4,r.query('DROP TABLE IF EXISTS "'.concat(c,'"'))];case 2:return f.sent(),[4,r.insertArrowFromIPCStream(u,{name:c,schema:"main"})];case 3:return f.sent(),[2,e]}}))}))},yb=function(){return yb=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},yb.apply(this,arguments)},bb=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},gb=(0,r.createContext)({}),vb=function(t){var e=t.field,n=t.min,r=t.max;return{field:e,op:"within",a:(r-n)/2,b:(r+n)/2}},wb=function(t){var e=t.field,n=t.selectedValues;if(!n.length)return{};var r=n.map((function(t){return"".concat(e,' === "').concat(t,'"')})).join(" || ");return{field:e,lambda:"".concat(e," => ").concat(r)}},xb={position:"fixed",top:0,left:0,width:"100%",height:"100%"};const Sb=function(t){var e=t.plotRef,n=t.prefs,i=t.tooltipHTML,o=t.onClickDataPoint,a=t.labels,s=t.children,l=bb((0,r.useState)(!1),2),u=l[0],c=l[1],f=bb((0,r.useState)({searchtext:""}),2),d=f[0],h=f[1],p="deep-scatter-parent-element-id",_=(0,r.useRef)(null),m=function(t){var e=">>>>WRAPPER<<<<",n=nb.bW(),i=nb.LY(),o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(r.useState(void 0),2),a=o[0],s=o[1];return r.useEffect((function(){console.log("".concat(e," useEffect db.status"),n.status),n.status!==nb.RX.NONE&&n.status!==nb.RX.COMPLETED||(console.log(e),i().then((function(t){return null==t?void 0:t.connect()})).catch((function(t){console.warn(t)})).then((function(t){s(t),console.log("".concat(e," CONENCTION SET:"),t)})))}),[n,n.status]),{db:n,connection:a}}(),y=m.db,b=m.connection;(0,r.useEffect)((function(){y&&b&&e.current&&function(t,e,n,r){console.log("Running update from text search:",e),""!==e&&function(t,e,n,r){var i=t.arrow;t._root.transformations[e]=function(t){var n;return hb(this,void 0,void 0,(function(){var o,a;return pb(this,(function(s){switch(s.label){case 0:return[4,mb(t,0,i,r)];case 1:return s.sent(),o=t.key,[4,r.query("SELECT regexp_matches(".concat("lyric_line",", '").concat(e,"', 'i')::FLOAT AS \"").concat(e,'" FROM "').concat(o,'"'))];case 2:return a=s.sent(),[2,null===(n=null==a?void 0:a.getChild(e))||void 0===n?void 0:n.toArray()]}}))}))}}(t,e,0,r),function(t,e){t?e.plotAPI({background_options:{size:[.3,3]},encoding:{foreground:{field:t,op:"eq",a:1}}}):e.plotAPI({background_options:{size:[.3,1]},encoding:{foreground:null}})}(e,t)}(e.current,d.searchtext,0,b)}),[d.searchtext]),(0,r.useEffect)((function(){if(_.current&&!(null==e?void 0:e.current)){var t=new Zy("#".concat(p));i&&(t.tooltip_html=i),e.current=t,window.plot=t,console.log("created scatter..."),e.current.plotAPI(n).finally((function(){console.log("... initial prefs set"),c(!0),o&&(t.click_function=function(t){o(t),h((function(e){return yb(yb({},e),{clickedDataPoint:t})}))}),t.add_labels(a.features,a.name,a.labelKey,a.sizeKey)}))}}),[p,e,_,n,i,o,a.features,a.name,a.labelKey,a.sizeKey]);var g=(0,r.useMemo)((function(){return{initialLoadComplete:u,plotRef:e,interactionState:d,setInteractionState:h}}),[u,e,d,h]);return r.createElement(gb.Provider,{value:g},s,r.createElement("div",{style:xb,id:p,ref:_}))};var Ab=function(){return Ab=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ab.apply(this,arguments)},Ib=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},kb=function(t){var e=t.catagoricalEncoding,n=t.updateCatagoricalFilter,i=t.field,o=Ib((0,r.useState)([]),2),a=o[0],l=o[1],u=Ib((0,r.useState)(!1),2),c=u[0],f=u[1],d=(0,r.useContext)(gb).plotRef,h=function(t){var e,n,r=t.field,i=t.plot;return(null===(n=null===(e=null==i?void 0:i._renderer)||void 0===e?void 0:e.aes)||void 0===n?void 0:n.dim(r).current.scale.domain())||[]}({field:e,plot:d.current}),p=function(t){var e,n,r=t.field,i=t.plot;return(null===(n=null===(e=null==i?void 0:i._renderer)||void 0===e?void 0:e.aes)||void 0===n?void 0:n.dim(r).current.scale.range())||[]}({field:e,plot:d.current}),_=h.map((function(t,e){return{label:r.createElement("div",{style:{color:p[e%p.length]}},t),value:t}}));return r.createElement(r.Fragment,null,r.createElement("h2",null,r.createElement("label",{htmlFor:"multi-select"},"Filter to one or more genres")),r.createElement(s.Z,{isMulti:!0,options:_,placeholder:"Choose genres",value:a,onChange:function(t){l(t),n({field:i,selectedValues:t.map((function(t){return t.value}))})},menuIsOpen:c,onMenuOpen:function(){return f(!0)},onMenuClose:function(){return f(!1)}}))},Ob=function(t){var e=t.field,n=t.updateRangeFilter,i=t.lowerBound,o=t.upperBound,s=Ib((0,r.useState)(i),2),l=s[0],u=s[1],c=Ib((0,r.useState)(o),2),f=c[0],d=c[1];return r.createElement(r.Fragment,null,r.createElement("h2",null,"Slide either end to filter between 1958-2022"),r.createElement(a(),{min:i,max:o,step:1,minValue:l,maxValue:f,onInput:function(t){u(t.minValue),d(t.maxValue),n({field:e,min:t.minValue,max:t.maxValue})}}))},Tb=function(t){t.plotRef;var e=(0,r.useContext)(gb),n=(e.interactionState,e.setInteractionState),i=(0,l.y1)((function(t){var e=t.target.value||"";n((function(t){return Ab(Ab({},t),{searchtext:e})}))}),300);return r.createElement("div",{style:{paddingTop:24,paddingBottom:12}},r.createElement("h2",null,r.createElement("label",{htmlFor:"input"},"Search the lyrics")),r.createElement("input",{type:"text",placeholder:"eg 'never felt this way'",onChange:i}))},Lb=function(t){var e=t.plotRef;return r.createElement("button",{onClick:function(){var t,n,r,i;e.current&&(console.log("copied:",null===(n=null===(t=e.current)||void 0===t?void 0:t._zoom)||void 0===n?void 0:n.current_corners()),navigator.clipboard.writeText(JSON.stringify(null===(i=null===(r=e.current)||void 0===r?void 0:r._zoom)||void 0===i?void 0:i.current_corners())))}},"Click me get current bbox")};const Mb=function(t){var e=t.rangeSliderProps,n=t.catagoricalField,i=t.catagoricalEncoding,o=t.updateCatagoricalFilter,a=(0,r.useContext)(gb),s=a.initialLoadComplete,l=a.plotRef;return s?r.createElement("div",{style:{position:"fixed",zIndex:400,width:350,padding:24}},r.createElement(Lb,{plotRef:l}),r.createElement(Ob,Ab({},e)),r.createElement(Tb,{plotRef:l}),r.createElement(kb,{field:n,catagoricalEncoding:i,updateCatagoricalFilter:o})):null};var Bb=n(897),Eb=function(){return Eb=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Eb.apply(this,arguments)},Db={overview:{x:[0,100],y:[0,100]},onMyKnees:{x:[47.43005995767035,51.316108506336775],y:[47.358861131481135,49.56245169473797]}},jb={lyricCliche:{field:ab,domain:[-4,11],range:"blues"},gender:{field:"gender",range:"set1"},songCliche:{field:sb,domain:[-4,11],range:"blues"}},zb={noFilters:{encoding:{filter:{},filter2:{},jitter_radius:{}}},gender:{encoding:{color:jb.gender}},xyEncodingNoFilters:{encoding:{x:{field:"x"},y:{field:"y"},filter:null,filter2:null,jitter_radius:null}},xyWithClicheColorEncoded:{encoding:{x:{field:"x"},y:{field:"y"},color:jb.lyricCliche,filter:null,filter2:null,jitter_radius:null}},justOneJiraIssue:{encoding:{filter:{field:lb,lambda:"".concat(lb," => ").concat(lb,' === "').concat("MDS-7",'"')}}},timeOnTheXAndGenreBinOnY:{encoding:{y:{field:"genre_position_band"},x:{field:rb},jitter_radius:{constant:.01,method:"uniform"},jitter_speed:{constant:0}}},lyicClicheOverTime:{encoding:{y:{field:ab,domain:[0,14],range:[0,100]},x:{field:rb},color:jb.lyricCliche,jitter_radius:{constant:.01,method:"uniform"},jitter_speed:{constant:0}}},songClicheOverTime:{encoding:{y:{field:sb,domain:[0,14],range:[0,100]},x:{field:rb},color:jb.songCliche,jitter_radius:{},jitter_speed:{}}}},Cb={gender:{content:"Gender",zoomTo:Db.overview,prefsUpdate:zb.gender},zoomedOutMap:{content:"Welcome to the map: each dot is 1 of 166,000 lyric lines, arranged by topic via sentence embedding. Click a dot to view the cliche's for the song.",zoomTo:Db.overview,prefsUpdate:zb.xyEncodingNoFilters},onMyKnees:{content:"Some cliche's are quite clear: like 'I'm no my knees', frequently rhymed with 'please'",zoomTo:Db.onMyKnees,prefsUpdate:zb.xyEncodingNoFilters},xyWithClicheColorEncoded:{content:"Color each lyric how based on how many near neighbors it has in its higher higher dimensional embedding. A rough measure of 'cliche-ness.'",zoomTo:Db.overview,prefsUpdate:zb.xyWithClicheColorEncoded},lyicClicheOverTime:{content:"Now let's see how cliche individual lyrics havae been over time",prefsUpdate:zb.lyicClicheOverTime},songClicheOverTime:{content:"Now let's just look at the song level",prefsUpdate:zb.songClicheOverTime},timeOnTheXAndGenreBinOnY:{content:"Here the the X-axis is time, genre is on the Y.",zoomTo:Db.overview,prefsUpdate:zb.timeOnTheXAndGenreBinOnY}};const Fb=[Cb.gender,Cb.zoomedOutMap,Cb.timeOnTheXAndGenreBinOnY,Cb.onMyKnees,Cb.xyWithClicheColorEncoded].map((function(t,e){return Eb(Eb({},t),{index:e})}));var Nb=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};const Rb=function(t){var e=t.updatePlotOnStepChange,n=Nb((0,r.useState)(null),2),i=n[0],o=n[1],a=Nb((0,r.useState)(!0),2),s=a[0],l=a[1];return r.createElement("div",{style:{float:"right",zIndex:450,width:300,position:"relative",paddingTop:s?"25vh":0,paddingBottom:s?"25vh":0,height:s?void 0:0}},r.createElement("div",{style:{position:"fixed",top:0}},r.createElement("button",{onClick:function(){return l(!s)}},r.createElement("b",null,s?"Close":"Open")," scrollytelling guided tour")),r.createElement("div",{style:{visibility:s?"visible":"hidden"}},r.createElement(Bb.k,{offset:.5,onStepEnter:function(t){var n=t.data;o(n.index),e({storyStep:n})}},Fb.map((function(t,e){return r.createElement(Bb.h,{data:t,key:e},r.createElement("div",{style:{marginTop:"30vh",marginBottom:"30vh",opacity:i===e?1:.2,padding:10,fontSize:20,borderRadius:8,background:"blanchedalmond"}},t.content))})))))};var Ub=function(){return Ub=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ub.apply(this,arguments)},Pb=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Vb=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},$b=function(t,e){return void 0===e&&(e=1),(t||[]).reduce((function(t,n){var r=n.children,i=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(n,["children"]);return Vb(Vb(Vb([],Pb(t),!1),[Ub(Ub({},i),{level:e})],!1),Pb($b(r,e+1)),!1)}),[])},Wb=["nothing",16,10,8,6,5],Yb={type:"FeatureCollection",name:"lyric_viz_region_labels",features:$b([{label:" Trains",nearestLyric:"Gone catch me a train",coordinates:[34.531471252441406,44.52962875366211]},{label:"Gang & Crime",nearestLyric:"Let me show you what a thug got, born to die",coordinates:[40.17561340332031,46.484615325927734],children:[{label:"'thug'",nearestLyric:"My thug appeal?",coordinates:[40.16249084472656,46.4525032043457]},{label:"'gangstas'",nearestLyric:"Gangstas (gangstas)",coordinates:[40.870277404785156,46.029441833496094]}]},{label:"'Ghetto' & 'Hood'",nearestLyric:"It's an every day thing in the ghetto",coordinates:[41.69123458862305,45.15018844604492]},{label:"'dip'",nearestLyric:"Dip, baby, dip (Just dip, baby), dip, baby, dip (Just dip, baby)",coordinates:[39.5433349609375,49.53059387207031]},{label:"'whip'",nearestLyric:"Brand new whip got no keys",coordinates:[40.467369079589844,50.193580627441406]},{label:"'chain'",nearestLyric:"I'm added to your chain, chain, chain",coordinates:[39.93423843383789,51.98819351196289]},{label:"Rain ",nearestLyric:"Got rained on too",coordinates:[34.82866668701172,51.63480758666992]},{label:"'savage'",nearestLyric:"Bitch, I'm a savage, yeah",coordinates:[37.10366439819336,50.10759353637695]},{label:" Bling",nearestLyric:"And if that diamond ring won't shine",coordinates:[38.38007354736328,51.97138214111328],children:[{label:"Gold",nearestLyric:"He loves only gold",coordinates:[38.12843322753906,50.96171188354492]},{label:"'diamonds'",nearestLyric:"Boy stop, brimming with diamonds but that don't mean shit",coordinates:[38.443058013916016,51.701351165771484]},{label:"'wedding ring'",nearestLyric:"Thoughts of a wedding ring",coordinates:[38.31987380981445,52.277164459228516]}]},{label:" War",nearestLyric:"Win a battle you never fought",coordinates:[53.323795318603516,51.49806594848633]},{label:"Playing games",nearestLyric:"Baby, oh-oh, quit playing games",coordinates:[54.63346862792969,51.35596466064453]},{label:"Haters",nearestLyric:"When your fans become your haters",coordinates:[51.74882125854492,51.5303840637207]},{label:"'hold you'",nearestLyric:"If I could just hold you",coordinates:[52.28587341308594,51.44916534423828]},{label:" Hair",nearestLyric:"Well I like the way your hair falls in your face",coordinates:[48.106483459472656,50.366851806640625]},{label:"Hand holding",nearestLyric:"Take me by the hand, take me somewhere new",coordinates:[49.70836639404297,51.03889083862305]},{label:"Holding (in arms)",nearestLyric:"Better than my arms can hold you",coordinates:[50.50023651123047,52.12309646606445]},{label:"'touch me/you'",nearestLyric:"Touch me, touch me, touch me (This is the night)",coordinates:[49.567752838134766,54.59016799926758]},{label:"Brothers & Sisters",nearestLyric:"Brothers and sisters, they've always been there for me",coordinates:[49.022403717041016,56.32489013671875]},{label:"'you look' (nice)",nearestLyric:"You look so sweet",coordinates:[51.377723693847656,54.931495666503906]},{label:"Strength & Weakness",nearestLyric:"Starting right now, I'll be strong (I'll be strong)",coordinates:[52.647274017333984,55.87352752685547]},{label:"Fool",nearestLyric:"I'll be a fool for you",coordinates:[54.15382766723633,56.61220169067383]},{label:"Freedom",nearestLyric:"Be free, live free",coordinates:[50.27372360229492,58.32689666748047],children:[{label:"'set me free'",nearestLyric:"Set me free, uh",coordinates:[49.956085205078125,58.333457946777344]},{label:"'freedom'",nearestLyric:"Oh oh freedom (Freedom)",coordinates:[49.23148727416992,59.34634780883789]}]},{label:"'Fantasy' & 'Imagination'",nearestLyric:"When you fulfill my fantasy (Uh-huh)",coordinates:[58.39752197265625,66.8169937133789],children:[{label:"'illusion'",nearestLyric:"This is a life of illusion, wrapped up in trouble",coordinates:[58.07051086425781,67.25687408447266]},{label:"'fairytale'",nearestLyric:"Today was a fairytale, all that I can say",coordinates:[60.04313278198242,67.39440155029297]}]},{label:"Lies",nearestLyric:"I will never lie again (I will never lie again)",coordinates:[62.18107223510742,68.65020751953125]},{label:"'it is/can't be true'",nearestLyric:"Yes, it's true",coordinates:[63.34138107299805,70.32503509521484]},{label:"Believe",nearestLyric:"And you better believe",coordinates:[64.89691925048828,68.47879028320312],children:[{label:"'please believe me'",nearestLyric:"So please believe me",coordinates:[65.21016693115234,68.42491912841797]},{label:"'I can't belive'",nearestLyric:"I just can't believe",coordinates:[64.65770721435547,69.18167877197266]},{label:"'(have) faith'",nearestLyric:"Gotta have some faith in the sound",coordinates:[65.75682830810547,69.78514099121094]}]},{label:"Remember & Forget",nearestLyric:"Remember those who win the game",coordinates:[54.347328186035156,70.26811981201172],children:[{label:"'memories'",nearestLyric:"Brings back memories",coordinates:[53.49637222290039,69.60269165039062]}]},{label:"'miss you/me'",nearestLyric:"I'm gonna miss you",coordinates:[57.25995635986328,69.40413665771484]},{label:"Realness & Authenticity",nearestLyric:"Seemed so very real, it seemed so real to me",coordinates:[60.18147277832031,69.52727508544922]},{label:"Confession",nearestLyric:"But, darling, I've gotta confess",coordinates:[67.00687408447266,68.36579895019531]},{label:"Blame",nearestLyric:"I don't understand why you blame me",coordinates:[65.77816009521484,73.45915985107422]},{label:"'How deep is your love?'",nearestLyric:"How deep is your love for me (How deep, how deep)",coordinates:[58.45049285888672,65.11143493652344]},{label:"Saving",nearestLyric:"You're gonna be the one that saves me (That saves me)",coordinates:[57.65751647949219,64.74127960205078]},{label:"Shame & Disgrace",nearestLyric:"Everybody says it was a shame",coordinates:[56.842132568359375,65.36166381835938]},{label:"Pride",nearestLyric:"I'm going to swallow my pride (My pride)",coordinates:[56.27005386352539,66.51325988769531]},{label:"Surprise!",nearestLyric:"Sometimes it's all a big surprise",coordinates:[58.34808349609375,64.52204132080078]},{label:"'bad boy'",nearestLyric:"Bad Boy heat the place",coordinates:[56.341896057128906,55.04058837890625]},{label:"'my friends'",nearestLyric:"Listening to my friends talk about it all",coordinates:[58.539100646972656,54.37824249267578]},{label:"' 'Cause...'",nearestLyric:"'Cause baby, you're a firework",coordinates:[56.83268356323242,57.461524963378906]},{label:"Feel(ing)",nearestLyric:"I can feel the spirits all around me",coordinates:[53.70606231689453,60.369239807128906],children:[{label:"'you make me feel'",nearestLyric:"You make me feel like I am whole again",coordinates:[55.315364837646484,59.762210845947266]},{label:"'a/this feeling'",nearestLyric:"It's a feeling like this",coordinates:[54.783935546875,60.97815704345703]},{label:"'never felt this way before'",nearestLyric:"And I never felt this way before-fore",coordinates:[55.23740768432617,60.58941650390625]},{label:"'feels right'",nearestLyric:"Nothing has ever felt so right",coordinates:[55.009422302246094,60.739097595214844]},{label:"'feels so good'",nearestLyric:"Feels so good",coordinates:[55.71792984008789,61.19337844848633]},{label:"'feel it in (the air)'",nearestLyric:"Feel it comin' in the air (Yeah)",coordinates:[53.57101058959961,60.69075012207031]},{label:"'feels like the first time'",nearestLyric:"Feels like the first time",coordinates:[51.95426940917969,60.794559478759766]}]},{label:"Anger & Upsetness",nearestLyric:"You're mad I'm back, big mad",coordinates:[53.1955451965332,58.05927276611328]},{label:"'the power of love'",nearestLyric:"That's the power, that's the power of love",coordinates:[52.61435317993164,59.055145263671875]},{label:"'Deep (down)'",nearestLyric:"'Cause somewhere deep down inside",coordinates:[52.773826599121094,60.84505081176758]},{label:"Peacefulness",nearestLyric:"Peace of mind",coordinates:[51.69013214111328,59.21094512939453]},{label:"Loneliness",nearestLyric:"It's too lonesome down here below",coordinates:[48.7203369140625,61.89958953857422],children:[{label:"'leave me alone'",nearestLyric:"Aw, leave me alone",coordinates:[50.63786315917969,60.180599212646484]},{label:"'on my/your own'",nearestLyric:"Always on my own",coordinates:[49.804752349853516,60.914764404296875]},{label:"(don't want to be) 'lonely'",nearestLyric:"I don't wanna be lonely anymore",coordinates:[48.81162643432617,62.35134506225586]},{label:"(don't like being alone)",nearestLyric:"Nobody wants to be alone",coordinates:[49.14287185668945,61.73708724975586]}]},{label:"Mothers & Fathers",nearestLyric:"Hey Mama, won't you come here to Papa?",coordinates:[47.43101119995117,58.151588439941406],children:[{label:"I told Mamma",nearestLyric:"Mama, just killed a man",coordinates:[47.26866149902344,57.5297737121582]},{label:"'Mamma told me'",nearestLyric:"Mama told me, told me, ooh, yeah, yeah",coordinates:[47.564022064208984,57.675132751464844]},{label:"'dad/daddy'",nearestLyric:"My daddy was",coordinates:[48.24274826049805,58.09272003173828]},{label:"Daddy disaproval",nearestLyric:"And your Daddy don't approve",coordinates:[47.78211212158203,58.47633361816406]},{label:"Dad Influence",nearestLyric:"I let my father mold me",coordinates:[48.06008529663086,58.36526107788086]}]},{label:"Kiss ",nearestLyric:"If you give me just a one sweet kiss",coordinates:[44.549739837646484,59.666107177734375]},{label:"Magic ",nearestLyric:"Magic, magic, magic",coordinates:[45.62454605102539,63.12997055053711]},{label:"Heaven & Eternity",nearestLyric:"Well I'm in heaven (heaven)",coordinates:[42.750789642333984,64.0047836303711],children:[{label:"'paradise'",nearestLyric:"It's just a step up to paradise",coordinates:[42.26776885986328,64.26175689697266]},{label:"'heaven and earth",nearestLyric:"Move heaven and Earth",coordinates:[42.756309509277344,63.594844818115234]}]},{label:"Goodbye",nearestLyric:"How to tell you goodbye",coordinates:[43.70460510253906,68.87226867675781],children:[{label:"'say goodbye'",nearestLyric:"And if you should say goodbye",coordinates:[43.7729606628418,68.67640686035156]}]},{label:"Signs",nearestLyric:"And give me a sign",coordinates:[46.61939239501953,69.38007354736328]},{label:"Spanish Language",nearestLyric:"Soy capitn, soy capitn",coordinates:[36.1174430847168,67.46347045898438]},{label:"'I was born...'",nearestLyric:"I was born this way, yeah",coordinates:[50.884368896484375,56.82439041137695]},{label:"Smile ",nearestLyric:"I could smile for a while",coordinates:[50.80093765258789,57.388336181640625]},{label:"Money ",nearestLyric:"I got my money, let's spend it up (I feel-)",coordinates:[45.834529876708984,52.75274658203125]},{label:"Hunger",nearestLyric:"Gettin' kinda hungry",coordinates:[45.68716049194336,54.11912536621094]},{label:"Blood ",nearestLyric:"And taste the blood from my blade",coordinates:[45.81208419799805,55.36198806762695]},{label:"'sexy'",nearestLyric:"Ha ha! Sexy sexy, ha ha! Sexy sexy",coordinates:[47.702877044677734,54.87351989746094]},{label:"Respect",nearestLyric:"My respect for you immense",coordinates:[43.744529724121094,53.36800003051758]},{label:"Fame",nearestLyric:"Fame (Fame)",coordinates:[44.3107795715332,54.558231353759766]},{label:"Hot & Cold",nearestLyric:"Going hot, so hot, just like an oven",coordinates:[42.170555114746094,55.69506072998047],children:[{label:"(you make me) hot",nearestLyric:"You make my temperature rise (ooh, baby)",coordinates:[42.490623474121094,55.98553466796875]},{label:"Chills & shivers",nearestLyric:"Baby, ooh, I get chills",coordinates:[44.91657638549805,56.38071823120117]}]},{label:"Flowers & Candles",nearestLyric:"You don't bring me flowers",coordinates:[39.732078552246094,53.48253631591797],children:[{label:"(red) roses",nearestLyric:"Sunlight, red red roses",coordinates:[39.34678649902344,53.544437408447266]}]},{label:" Fire",nearestLyric:"You can't fight fire with fire",coordinates:[40.368186950683594,54.87909698486328],children:[{label:"'(let it) burn'",nearestLyric:"Let it burn (Let it burn, let it burn), let it burn, gotta let it burn",coordinates:[40.582340240478516,54.508880615234375]}]},{label:"Alcohol",nearestLyric:"Got a Hennessy in my hand",coordinates:[40.904476165771484,49.80786895751953],children:[{label:"'jin and juice'",nearestLyric:"The boys say they want some gin and juice",coordinates:[41.03731918334961,49.94264221191406]}]},{label:"Drugs",nearestLyric:"'Cause the codeine had a young nigga swervin'",coordinates:[41.600608825683594,50.34968185424805]},{label:"'shawty'",nearestLyric:"Shawty I was just playing",coordinates:[39.23554229736328,47.01697540283203],children:[{label:"'shorty' alt. spelling",nearestLyric:"Shorty all on me 'cause it's hard to resist the kid",coordinates:[39.58342742919922,47.9907112121582]}]},{label:"Kings & Queens",nearestLyric:"You're the king, baby, I'm your queen",coordinates:[37.96351623535156,47.98604965209961]},{label:"'ayy'",nearestLyric:"Woah, oh-oh (Ayy, ayy, ayy)",coordinates:[36.476505279541016,47.99565505981445]},{label:"Rap-centric",nearestLyric:"Knowing he could rap",coordinates:[40.10482406616211,44.57717514038086],children:[{label:"'flow'",nearestLyric:"Flow so smooth like its 93",coordinates:[39.98502731323242,44.14582061767578]},{label:"'rapper'",nearestLyric:"Best rapper alive",coordinates:[39.744510650634766,45.11393737792969]},{label:"'hip-hop'",nearestLyric:"Hip-Hop, I'm the heart of that",coordinates:[39.714839935302734,44.490081787109375]},{label:"Rap Icons",nearestLyric:"Na-na-na-na-na-na, Kid Cudi",coordinates:[39.11989212036133,45.52992248535156],children:[{label:"Slim Shady (Emminem)",nearestLyric:"In every single person theres a Slim Shady lurking",coordinates:[36.71052169799805,45.52849578857422]}]}]},{label:"n-word used as subject",nearestLyric:"Niggas can't take me, niggas can't guard me",coordinates:[42.0048828125,47.121498107910156]},{label:"",nearestLyric:"W-w-w-wet ass pussy",coordinates:[43.61240768432617,49.30723571777344]},{label:"'bad bitch'",nearestLyric:"You should want a bad bitch like this (Huh?)",coordinates:[45.087772369384766,49.07155227661133]},{label:"Guns ",nearestLyric:"Still'll shoot (Shoot up, brrt, shit)",coordinates:[45.09806823730469,46.64035415649414]},{label:" Police",nearestLyric:"High sheriff and police coming after me",coordinates:[46.49791717529297,46.05323028564453]},{label:"'bang'",nearestLyric:"Bang! Bang! Bang! (Bang, bang-bang-bang-bang)",coordinates:[45.693050384521484,45.24973678588867]},{label:"'hit me'",nearestLyric:"Hit me (Hit me!)",coordinates:[47.58660888671875,47.993770599365234]},{label:"Feet , Knees, Bodies",nearestLyric:"You think you'll knock me off my feet",coordinates:[49.231239318847656,47.9981689453125]},{label:"'get down'",nearestLyric:"I don't get down on the first night (I don't, I don't get down, baby)",coordinates:[49.6734504699707,44.29307556152344]},{label:"Falling",nearestLyric:"Falling back on m, falling back on me",coordinates:[50.945499420166016,46.0402717590332]},{label:"'shake it'",nearestLyric:"Tell 'em to shake it! (Shake it!) Shake it! (Shake it!)",coordinates:[40.65058898925781,43.083248138427734],children:[{label:"'wiggle'",nearestLyric:"Wiggle, wiggle, wiggle (Wiggle, wiggle, wiggle)",coordinates:[41.912845611572266,43.40365219116211]}]},{label:" Cars",nearestLyric:"You say you wanna get in my Benz?",coordinates:[44.964298248291016,43.43436050415039],children:[{label:"Cadillac",nearestLyric:"The Sheikh he drove his Cadillac",coordinates:[45.29256820678711,43.485172271728516]},{label:"Lambo",nearestLyric:"The Sheikh he drove his Cadillac",coordinates:[45.29256820678711,43.485172271728516]},{label:"Jag",nearestLyric:"And rolled down the window of his shiny new Jag",coordinates:[46.037925720214844,44.16994094848633]},{label:"Benz",nearestLyric:"The new Mercedes with black G-Wagon",coordinates:[44.90475845336914,43.760704040527344]},{label:"'the drive-in'",nearestLyric:"One night at the drive-in",coordinates:[47.442935943603516,41.84071731567383]},{label:"'riding' & car metaphors",nearestLyric:"She's riding, ain't no stopping me now",coordinates:[46.60078048706055,42.67316818237305]}]},{label:"Places (esp. USA)",nearestLyric:"Tulsa, Austin, Oklahoma City, Seattle, San Francisco too",coordinates:[41.646575927734375,42.24270248413086],children:[{label:"American South",nearestLyric:"Gettin' born in the state of Mississippi",coordinates:[40.71299743652344,41.144065856933594]},{label:"California",nearestLyric:"California girls, we're undeniable",coordinates:[41.631019592285156,41.854366302490234]},{label:"New York",nearestLyric:"New York (Yeah), New York (Uh)",coordinates:[41.28362274169922,42.677940368652344]},{label:"The Country",nearestLyric:"Thank God I'm a country boy",coordinates:[42.21088790893555,42.34172058105469]}]},{label:"La La Land",nearestLyric:"La da la da di da da, la da da da da",coordinates:[54.82959747314453,22.986899316310883]},{label:"'dig it'",nearestLyric:"You can dig it, and if you dig it",coordinates:[63.36491394042969,24.802574157714844]},{label:"'step (by step)'",nearestLyric:"(Step by step) Oh girl",coordinates:[62.137535095214844,29.840621948242188]},{label:"'shy'",nearestLyric:"So shy, so shy, so shy, so shy",coordinates:[61.3153076171875,30.990739822387695]},{label:"Dream Island",nearestLyric:"Everything That I've been dreaming of",coordinates:[55.99439740180969,27.92370021343231]},{label:"Music",nearestLyric:"'Cause there's music in the air",coordinates:[42.318546295166016,36.5294075012207],children:[{label:"Groove",nearestLyric:"You gotta get on the groove",coordinates:[36.529319763183594,37.39140701293945]},{label:"'bass'",nearestLyric:"You gotta get on the groove",coordinates:[36.529319763183594,37.39140701293945]},{label:"'poetry'",nearestLyric:"It's poetry in motion",coordinates:[39.18756866455078,40.34760284423828]},{label:"'rhyme'",nearestLyric:"Shout out the rhymes",coordinates:[39.105674743652344,40.88705062866211]},{label:" Drums & rhythm",nearestLyric:"Drums keep pounding a rhythm to the brain",coordinates:[39.69491958618164,38.74080276489258]},{label:"'rock and roll'",nearestLyric:"Rock and roll and roll (And roll) and rock",coordinates:[41.24711990356445,38.397682189941406]},{label:"'the beat'",nearestLyric:"Feel that beat",coordinates:[40.52006912231445,39.52698516845703]},{label:"'rock'",nearestLyric:"I wanna, I wanna rock",coordinates:[41.49299621582031,39.76905059814453]},{label:" 'the mic'",nearestLyric:"My mic sounds nice",coordinates:[42.40559005737305,39.769222259521484]},{label:"DJ",nearestLyric:"Hey Mr. DJ, put a record on",coordinates:[37.76091384887695,36.0947265625],children:[{label:"'DJ, keep playing'",nearestLyric:"Hey D.J. keep playing that song",coordinates:[37.96235656738281,36.226078033447266]}]},{label:" Dance",nearestLyric:"So just dance, dance, dance",coordinates:[39.80129623413086,34.674861907958984],children:[{label:"'[one] last dance'",nearestLyric:"Last chance for one last dance",coordinates:[40.152748107910156,34.02052307128906]}]},{label:" Singing",nearestLyric:"I'm singing, I'm singing",coordinates:[43.04058074951172,34.66792678833008]},{label:"'radio'",nearestLyric:"Music on the radio",coordinates:[43.111629486083984,37.0932502746582]}]},{label:"Party!",nearestLyric:"It's party time (Party time)",coordinates:[45.2708854675293,36.67374038696289]},{label:"'romance'",nearestLyric:"Reminding him of romance",coordinates:[46.34892654418945,31.696130752563477]},{label:" Bell",nearestLyric:"Ring out the bells again",coordinates:[48.14754867553711,31.715627670288086]},{label:"Heavenly Bodies",nearestLyric:"Let the sunshine (Let it shine)",coordinates:[48.36711883544922,34.33625411987305],children:[{label:" Stars",nearestLyric:"A thousand stars in the sky make me realize",coordinates:[47.30270004272461,35.15462112426758]},{label:" Moon",nearestLyric:"Moon out tonight",coordinates:[47.507957458496094,33.73540496826172]},{label:"Sunshine",nearestLyric:"Oh, my only sunshine (My only sunshine)",coordinates:[48.152587890625,33.816402435302734]},{label:"Sunset",nearestLyric:"It's quite a sunset",coordinates:[48.862945556640625,34.51715850830078]}]},{label:"Dark & Light",nearestLyric:"And the darkness inside you",coordinates:[50.07377243041992,35.090824127197266],children:[{label:"Shadows",nearestLyric:"Glimpse through the shadow, tear at the shadow",coordinates:[49.412208557128906,33.30867004394531]},{label:"Night",nearestLyric:"This is the night",coordinates:[51.59398651123047,33.99238204956055],children:[{label:"'day and night'",nearestLyric:"Day and night, night and day",coordinates:[51.13328170776367,32.735740661621094]},{label:"'all night long'",nearestLyric:"All night long",coordinates:[52.04818344116211,32.02931594848633]},{label:"'tonight'",nearestLyric:"Tonight, tonight, tonight, oh",coordinates:[53.52393341064453,33.746910095214844]},{label:"'one more night'",nearestLyric:"Give me one more night, give me just one more night",coordinates:[52.82344055175781,32.92210006713867]},{label:"'can't sleep'",nearestLyric:"Sometimes, I can't sleep at night and",coordinates:[52.44939041137695,35.56325912475586]}]},{label:"'the light'",nearestLyric:"When they both turn out the lights",coordinates:[49.96065902709961,35.80232238769531],children:[{label:"'you're my light'",nearestLyric:"You're my guiding light",coordinates:[50.0830192565918,36.13233947753906]},{label:"Street & city lights",nearestLyric:"Streetlights, people",coordinates:[49.556697845458984,36.71057891845703]}]}]},{label:"'twist'",nearestLyric:"They'll twist and I'll twist",coordinates:[44.62394332885742,28.47542381286621]},{label:" Supernatural beings",nearestLyric:"But if he's a ghost, then I can be a phantom",coordinates:[47.45479965209961,29.303726196289062],children:[{label:"'demons'",nearestLyric:"You gotta know your demons",coordinates:[46.85967254638672,29.641435623168945]},{label:"'angel'",nearestLyric:"You're an angel, baby",coordinates:[42.44424819946289,28.456645965576172],children:[{label:"'you're my angel'",nearestLyric:"Shorty, you're my angel, you're my darling angel (Ah)",coordinates:[42.37223815917969,28.210494995117188]}]}]},{label:" Monkey",nearestLyric:"Well, they gotta pet monkey",coordinates:[42.96371078491211,31.08963394165039]},{label:"Wildness",nearestLyric:"Then you love a little wild one",coordinates:[49.255706787109375,29.91173553466797],children:[{label:"'can't be tamed'",nearestLyric:"I can't be tamed, I can't be tamed (I can't be tamed)",coordinates:[49.1621208190918,29.483266830444336]}]},{label:"Glory",nearestLyric:"A little of the glory, yeah",coordinates:[52.50564193725586,30.439315795898438]},{label:"Dates",nearestLyric:"And on Thursday and Friday and Saturday, we chilled on Sunday",coordinates:[53.264652252197266,32.03626251220703]},{label:"'witness'",nearestLyric:"Can I get a witness? Yeah, yes",coordinates:[52.97869110107422,27.036386489868164]},{label:"Breathe (or lack of)",nearestLyric:"Breathing hard when I'm squeezin' your lungs",coordinates:[50.798648834228516,30.244338989257812]},{label:"Losing control",nearestLyric:"Got to make you lose control",coordinates:[52.29414367675781,28.684234619140625]},{label:"Crazy",nearestLyric:"Sure he's crazy",coordinates:[55.688453674316406,32.10649490356445],children:[{label:"'delirious'",nearestLyric:"To all your friends, you're delirious",coordinates:[56.09120559692383,31.38946533203125]},{label:"crazy for/about you",nearestLyric:"'Cause I'm crazy about you",coordinates:[55.705047607421875,31.791662216186523]},{label:"'drive me crazy'",nearestLyric:"Girl, you drive me crazy",coordinates:[55.47303009033203,32.477928161621094]}]},{label:"'are you ready?'",nearestLyric:"Oh, are you ready for it?",coordinates:[59.471534729003906,30.934249877929688]},{label:"'doctor'",nearestLyric:"Doctor, doctor, where ya at? Give me something",coordinates:[58.280757904052734,31.50971031188965]},{label:"'make a move'",nearestLyric:"Make a move, but be calm",coordinates:[57.894386291503906,32.50066375732422]},{label:"'every day'",nearestLyric:"Every day (Every day)",coordinates:[56.38615798950195,34.54317855834961]},{label:"Sight & Visibility",nearestLyric:"Take a look at yourself and",coordinates:[55.80326461791992,38.01304626464844],children:[{label:"Mirror",nearestLyric:"I'm starting with the man in the mirror (Man in the mirror, oh yeah)",coordinates:[55.2398681640625,36.121246337890625]},{label:"'can't you see?'",nearestLyric:"Can't you see",coordinates:[56.94762420654297,36.899349212646484]},{label:"'I see'",nearestLyric:"And now I see",coordinates:[56.914329528808594,38.57001876831055]},{label:"Eyes ",nearestLyric:"In your eyes",coordinates:[54.06130599975586,37.73246383666992],children:[{label:"'look into your eyes'",nearestLyric:"When I look into your eyes",coordinates:[54.57991027832031,37.458763122558594]},{label:"'open my/your eyes'",nearestLyric:"To open my eyes",coordinates:[54.03666687011719,37.11865997314453]},{label:"'close my eyes'",nearestLyric:"I close my eyes",coordinates:[53.421207427978516,37.03165054321289]}]},{label:"Watching you",nearestLyric:"Watching you, yeah",coordinates:[54.630855560302734,39.73262023925781]}]},{label:"'check (it)",nearestLyric:"(Check it)",coordinates:[57.439849853515625,36.68452453613281]},{label:"Voices",nearestLyric:"My voice isgone, my throat is sore",coordinates:[58.69257736206055,34.87816619873047],children:[{label:"'whisper in my/your ear'",nearestLyric:"Whisper in my ear, baby",coordinates:[58.244415283203125,35.029170989990234]},{label:"'your voice'",nearestLyric:"I still hear your voice in the traffic, we're laughing",coordinates:[58.87189865112305,35.004058837890625]}]},{label:"Silence",nearestLyric:"Silence like a cancer grows",coordinates:[58.72107696533203,36.748966217041016]},{label:" Time",nearestLyric:"Making the time",coordinates:[62.830928802490234,38.715213775634766],children:[{label:"'wasting time'",nearestLyric:"Now, don't go wasting my precious time",coordinates:[63.09548568725586,37.32266616821289]},{label:"'no matter how long it takes'",nearestLyric:"No matter how long it takes",coordinates:[62.77116775512695,37.76485824584961]},{label:"lack of time",nearestLyric:"And I haven't got time to do no studies",coordinates:[62.73259353637695,38.379600524902344]},{label:"'time flies/slows'",nearestLyric:"Time just seems to fly",coordinates:[63.01313400268555,38.832298278808594]},{label:"'time of my life'",nearestLyric:"I-I-I-I've had the time of my li-i-ife",coordinates:[62.94290542602539,38.85007858276367]},{label:"'wait a minute'",nearestLyric:"You better wait a minute, wait a minute",coordinates:[62.520870208740234,39.10578918457031]},{label:"'matter of time'",nearestLyric:"They say it's just a matter of time",coordinates:[63.24565887451172,39.92314147949219]},{label:"'right now'",nearestLyric:"Right now",coordinates:[62.86798858642578,40.56957244873047]},{label:"Time Past",nearestLyric:"From a long time ago",coordinates:[62.19633865356445,41.38031768798828],children:[{label:"'long ago'",nearestLyric:"A long, long time ago",coordinates:[62.289520263671875,41.425384521484375]}]},{label:"'all this time'",nearestLyric:"All this time",coordinates:[62.74906921386719,42.06657791137695]},{label:"'it's over'",nearestLyric:"It's over",coordinates:[63.2464714050293,42.276126861572266]},{label:"'too late'",nearestLyric:"You say it's too late to make it",coordinates:[60.93968963623047,37.52754211425781]},{label:"'future'",nearestLyric:"My future held in store",coordinates:[61.20341491699219,39.236167907714844]},{label:"today/tomorrow/day",nearestLyric:"Who knows what tomorrow brings",coordinates:[60.359954833984375,39.775997161865234]}]},{label:"'do it again'",nearestLyric:"Do it again (Do it)",coordinates:[64.67884063720703,40.27757263183594]},{label:" Calling",nearestLyric:"Though you don't call anymore",coordinates:[59.972808837890625,34.012420654296875],children:[{label:"Phone numbers",nearestLyric:"If you jot down ya number, you'll get mine in exchange, hey",coordinates:[60.548133850097656,33.00746536254883]},{label:"'call me'",nearestLyric:"Call me on the telephone",coordinates:[60.01302719116211,33.78444290161133]},{label:"'phone'",nearestLyric:"That expression when the phone rings",coordinates:[59.05304718017578,34.08769226074219]},{label:"'hang/pick up",nearestLyric:"Don't hang up",coordinates:[59.80107879638672,33.468448638916016]},{label:"'call my/your name'",nearestLyric:"Just call my name",coordinates:[60.8769416809082,34.583892822265625]},{label:"'what's your name?'",nearestLyric:"What's your name?",coordinates:[61.41692352294922,34.73121643066406]}]},{label:"Hope",nearestLyric:"You fill me with hope",coordinates:[64.26398468017578,34.30587387084961],children:[{label:"'hope is gone'",nearestLyric:"When all hope is gone (ooh)",coordinates:[64.09319305419922,34.58198928833008]},{label:"'count on [me]'",nearestLyric:"Ooh, baby, can always count on me",coordinates:[62.59121322631836,34.85354232788086]}]},{label:"1 Numbers",nearestLyric:"(One, two, three)",coordinates:[62.76431655883789,32.867942810058594]},{label:" Pray",nearestLyric:"I pray, pray, pray, everyday",coordinates:[64.59369659423828,32.316505432128906]},{label:"Thanks & Praise",nearestLyric:"Thank you baby thank you baby",coordinates:[66.654052734375,32.47395324707031],children:[{label:"'thank you'",nearestLyric:"Thank you, thank you",coordinates:[66.64142608642578,32.162994384765625]},{label:"'Hallelujah'",nearestLyric:"Glory Hallelujah (Hallelujah) right here, right now",coordinates:[66.73858642578125,32.595829010009766]},{label:"Gratitude & Luck ",nearestLyric:"I'd thank my lucky stars to be living here today",coordinates:[65.85155487060547,34.30009078979492]}]},{label:"'Lord' and 'God'",nearestLyric:"Lord, Lord",coordinates:[67.51588439941406,33.06519317626953]},{label:"Trust",nearestLyric:"There's boys you can trust",coordinates:[66.78952026367188,29.88368034362793]},{label:"'jerk'",nearestLyric:"Do the Jerk (Come on girl)",coordinates:[68.6462631225586,30.665224075317383]},{label:" Secrets",nearestLyric:"Secrets, secrets19",coordinates:[67.89022827148438,34.29466247558594],children:[{label:"'keep a secret'",nearestLyric:"I'm hoping you can keep a secret",coordinates:[67.73946380615234,34.40315628051758]},{label:"'keep it to yourself",nearestLyric:"I keep them to myself",coordinates:[67.40423583984375,35.04907989501953]},{label:"'want to know a secret?'",nearestLyric:"Do you want to know a secret?",coordinates:[67.8891372680664,34.21208190917969]}]},{label:"Non-words: 'oh', 'yeah' etc",nearestLyric:"Oh, oh-oh-oh-oh",coordinates:[74.3814697265625,34.246009826660156],children:[{label:"'hey'",nearestLyric:"Hey, hey, hey, hey",coordinates:[70.57931518554688,32.79389190673828],children:[{label:"'hey, baby'",nearestLyric:"Hey, baby",coordinates:[69.45189666748047,34.66490173339844]}]},{label:"'yo'",nearestLyric:"Yo, yo",coordinates:[71.41029357910156,34.6879768371582]},{label:"'ha ha'",nearestLyric:"Ha, ha, ha, ha, ha",coordinates:[76.06089782714844,36.956199645996094]},{label:"'oh, yeah'",nearestLyric:"Oh, oh, yeah",coordinates:[73.84672546386719,36.39401626586914]},{label:"'wooo'",nearestLyric:"Woooooo",coordinates:[72.78620147705078,36.007850646972656]},{label:"'mmm, yeah'",nearestLyric:"Mmm, yeah",coordinates:[75.3963623046875,38.41709899902344]},{label:"'na na na'",nearestLyric:"Na na na na",coordinates:[76.4487075805664,28.0050048828125]}]},{label:"Endearments",nearestLyric:"Yeah, baby baby baby baby baby, sweet sweet baby",coordinates:[69.55249786376953,38.19377136230469],children:[{label:"'(sweet) baby'",nearestLyric:"Sweet baby, sweet, baby sweet",coordinates:[69.52962493896484,38.289878845214844]},{label:"'Baby, baby, baby'",nearestLyric:"Baby, baby, baby",coordinates:[70.110595703125,38.24790573120117]},{label:"'Oh baby baby'",nearestLyric:"(Oh baby baby)",coordinates:[70.14073944091797,37.78351593017578]},{label:"'darling'",nearestLyric:"My darling",coordinates:[69.02749633789062,38.316261291503906]}]},{label:"'no' (repeating)",nearestLyric:"No-no, no, no-no, no-no-no-no",coordinates:[75.40251922607422,41.357086181640625]},{label:"'show me/you'",nearestLyric:"Show me how",coordinates:[66.32334899902344,44.248374938964844]},{label:"Say and Tell",nearestLyric:"Just one thing to say",coordinates:[69.08057403564453,41.838905334472656],children:[{label:"Conversation",nearestLyric:"But conversation couldn't make it through",coordinates:[66.99437713623047,39.814971923828125],children:[{label:"'listen'",nearestLyric:"Listen baby",coordinates:[66.36129760742188,38.42033386230469]},{label:"'talk to me'",nearestLyric:"Talk to me",coordinates:[67.65168762207031,38.83012390136719]}]},{label:"'nothing to say'",nearestLyric:"And I ain't got nothing to say",coordinates:[68.20171356201172,42.13831329345703]},{label:"'alright'",nearestLyric:"Alright (Alright)",coordinates:[73.85930633544922,42.94505310058594]},{label:"'what?'",nearestLyric:"(What?)",coordinates:[72.37736511230469,40.73339080810547]},{label:"'tell me'",nearestLyric:"Tell me",coordinates:[71.33364868164062,41.742061614990234]},{label:"'say no'",nearestLyric:"And don't say no, honey",coordinates:[72.18724822998047,41.9770393371582]},{label:"'words'",nearestLyric:"To say these words to you",coordinates:[68.03060150146484,41.103187561035156],children:[{label:"'word' metaphors & descriptions",nearestLyric:"After all your words of steel",coordinates:[67.89266967773438,41.21478271484375]}]}]},{label:"Chance & Risk",nearestLyric:"I'll take my share of chances",coordinates:[65.48275756835938,37.49410629272461],children:[{label:"'risk'",nearestLyric:"The risk that I'm takin'",coordinates:[65.2879638671875,37.3307991027832]},{label:"'take a chance'",nearestLyric:"(Take a chance, take a chance, take a chance on me)",coordinates:[65.6971435546875,37.244544982910156]},{label:"'one more chance'",nearestLyric:"Won't you just give me one chance?",coordinates:[65.77791595458984,37.15735626220703]},{label:"'second chance'",nearestLyric:"There ain't no second chance",coordinates:[65.94288635253906,36.92943572998047]}]},{label:"'You and I/me'",nearestLyric:"Just you and I",coordinates:[71.42050266265869,54.23489809036255]},{label:"Don't care",nearestLyric:"But you don't care",coordinates:[69.3930983543396,57.17419981956482]},{label:"'no limmit'",nearestLyric:"Told ya'll there wasn't no limit",coordinates:[76.40230560302734,47.48091125488281]},{label:"Understanding",nearestLyric:"Can you understand me",coordinates:[73.05299377441406,46.08429718017578],children:[{label:"'learn'",nearestLyric:"But I'm ready [ready] to learn (to learn)",coordinates:[68.038818359375,46.574951171875]},{label:"'you'll never know'",nearestLyric:"If you cut it down, then you'll never know",coordinates:[69.40914916992188,45.43326950073242]},{label:"'you should know'",nearestLyric:"You should know yeah",coordinates:[69.8878402709961,45.330413818359375]},{label:"questions & answers",nearestLyric:"All the answers to my questions, I have to find",coordinates:[71.3383560180664,45.04317092895508]},{label:"'don't know'",nearestLyric:"I just don't know, I don't know, I don't know-oh",coordinates:[72.0332260131836,44.49148941040039]},{label:"'I don't understand'",nearestLyric:"I don't understand",coordinates:[72.89093017578125,45.73036575317383]},{label:"'confused'",nearestLyric:"Has got me so confused",coordinates:[72.62840270996094,47.04587173461914]},{label:"'mystery'",nearestLyric:"I've been so into your mystery",coordinates:[73.9606704711914,46.31266403198242]}]},{label:"'no regrets'",nearestLyric:"No regrets, just love",coordinates:[73.31172180175781,44.63481903076172]},{label:" Reasoning Right from Wrong",nearestLyric:"I'm telling you baby, I made my mistakes",coordinates:[72.38224029541016,51.08867263793945],children:[{label:"'reason' & 'why'",nearestLyric:"There's always some reason",coordinates:[74.4483642578125,48.711910247802734],children:[{label:"'reasons why'",nearestLyric:"Don't give me no reasons why",coordinates:[74.37449645996094,48.60906219482422]},{label:"'tell me why'",nearestLyric:"Tell me why",coordinates:[74.07942962646484,48.44374465942383]},{label:"'don't know why'",nearestLyric:"And I don't know why",coordinates:[74.03987884521484,47.847999572753906]}]},{label:"'made a mistake'",nearestLyric:"We only humans, girl, we make mistakes",coordinates:[73.2662582397461,51.6363410949707]},{label:"'compromise'",nearestLyric:"Tryna compromise, but I cant win",coordinates:[73.04209899902344,52.568572998046875]},{label:"'intentions'",nearestLyric:"Yeah, these are my only intentions",coordinates:[72.36034393310547,52.01563262939453]},{label:"'(dis)agree",nearestLyric:"I'm sure all would agree",coordinates:[72.73835754394531,50.65395736694336]},{label:"'don't mean nothing'",nearestLyric:"(Don't mean nothing)",coordinates:[70.58865356445312,51.80863952636719]},{label:"'right' and 'wrong'",nearestLyric:"If you're wrong or if you're right",coordinates:[71.50531005859375,49.78706359863281],children:[{label:"'right or wrong'",nearestLyric:"Right or wrong (All day, every day, hey)",coordinates:[71.41566467285156,49.974796295166016]},{label:"'I was wrong'",nearestLyric:"Too proud to tell you I was wrong",coordinates:[71.68643951416016,49.739707946777344]},{label:"'Am I wrong?'",nearestLyric:"Am I wrong?",coordinates:[71.86373138427734,49.813262939453125]},{label:"something/nothing wrong",nearestLyric:"'Cause there's nothing wrong with me",coordinates:[70.31385803222656,49.78252410888672]}]},{label:"'prove it'",nearestLyric:"Prove it",coordinates:[71.6731185913086,50.276771545410156]}]},{label:" Letter writing",nearestLyric:"You wrote me in a letter",coordinates:[76.3427734375,51.66593933105469],children:[{label:"'love letter'",nearestLyric:"Pages brown from old love letter",coordinates:[76.04402923583984,51.90477752685547]},{label:" 'postman'",nearestLyric:"Please Mr. Postman, look and see (Postman, postman)",coordinates:[77.80908203125,51.983158111572266]}]},{label:"Apology Archipelago",nearestLyric:"But what I need to hear now, your sincere apology",coordinates:[75.58950185775757,54.82659935951233],children:[{label:"Sin",nearestLyric:"It's not even a fuckin' sin",coordinates:[73.85240197181702,54.69610095024109],children:[{label:"sinners & saints",nearestLyric:"I'm a sinner, I'm a saint",coordinates:[73.52529764175415,55.14400005340576]},{label:"Religion and sin",nearestLyric:"He washed my sins away lord, Oh, happy day",coordinates:[74.11649823188782,55.26859760284424]}]},{label:"Excuse me",nearestLyric:"Excuse me",coordinates:[75.04990100860596,54.71460223197937]},{label:"Too late to apologize?",nearestLyric:"It's too late to apologize, yeah (Too late) (Ayy, ayy, ayy)",coordinates:[75.62479972839355,54.578697681427]},{label:"'I'm sorry'",nearestLyric:"And I forgive you (I forgive you)",coordinates:[75.1882016658783,55.53529858589172]},{label:"Forgive",nearestLyric:"And I forgive you (I forgive you)",coordinates:[75.1882016658783,55.53529858589172]}]},{label:"'with you'",nearestLyric:"With you (With you)",coordinates:[72.6830005645752,55.32400012016296]},{label:"'the only one'",nearestLyric:"I know you are the only one",coordinates:[71.66510224342346,56.27779960632324]},{label:"'give it to me'",nearestLyric:"You'll give it to me now",coordinates:[64.80886840820312,54.37820053100586]},{label:"'thinking about you'",nearestLyric:"Yeah, I been thinking about you",coordinates:[62.91550827026367,55.686702728271484]},{label:"Need",nearestLyric:"Lady, you know just what I need",coordinates:[66.44870042800903,57.10960030555725],children:[{label:"I need you",nearestLyric:"Oh, I need you so",coordinates:[67.29580163955688,57.9239010810852]},{label:"all I need",nearestLyric:"Is all I need",coordinates:[66.88259840011597,56.19670152664185]},{label:"what you need",nearestLyric:"I got what you need (Oh)",coordinates:[67.2851026058197,55.92520236968994]}]},{label:"Waiting",nearestLyric:"Baby just waiting for you",coordinates:[65.67860245704651,59.01219844818115]},{label:"Love Lagoon",nearestLyric:"Would you be my love, my love?",coordinates:[64.2894983291626,61.79190278053284],children:[{label:"need/want love",nearestLyric:"I need your love",coordinates:[64.72730040550232,60.56450009346008]},{label:"The way you love",nearestLyric:"The way you love me",coordinates:[66.25329852104187,61.25869750976562]},{label:"Loving a man",nearestLyric:"I love him so",coordinates:[60.64509749412537,60.03710031509399]},{label:"Loving a woman",nearestLyric:"I'll ask my girl I know she only loves me",coordinates:[60.30139923095703,59.59939956665039]},{label:"Falling in love",nearestLyric:"Oh, I'm in love, baby",coordinates:[62.21920251846313,63.69680166244507]},{label:"Lasting love",nearestLyric:"Of everlasting love",coordinates:[61.27020120620728,63.08280229568481]},{label:"'our love'",nearestLyric:"We discovered a love that had never been found",coordinates:[61.45449876785278,62.24859952926636]},{label:"True love?",nearestLyric:"True love, oh baby, true love, oh baby",coordinates:[61.48620247840881,64.45779800415039]},{label:"Where is love?",nearestLyric:"Where did our love go?",coordinates:[60.00570058822632,64.86859917640686]},{label:"Love is blind",nearestLyric:"They tell me that love is blind",coordinates:[60.95979809761047,65.40510058403015]},{label:"'I love you'",nearestLyric:"You should let me love you",coordinates:[65.53199887275696,62.97420263290405],children:[{label:"I *still** love you",nearestLyric:"I still love you",coordinates:[67.26459860801697,63.02980184555054]},{label:"Who do you love?",nearestLyric:"Who do you love? Can I lounge with you?",coordinates:[64.89189863204956,64.89409804344177]},{label:"'in love with you'",nearestLyric:"I, I'm so in love with you",coordinates:[64.95739817619324,64.22880291938782]},{label:"Love me",nearestLyric:"Love me baby, (love me baby)",coordinates:[64.997398853302,63.25839757919312]}]}]},{label:"Pain/Hurt",nearestLyric:"And I don't wanna hurt him anymore",coordinates:[56.61603546142578,62.79591751098633],children:[{label:"'all the pain'",nearestLyric:"In spite of all the pain",coordinates:[55.78335952758789,63.31875991821289]},{label:"I won't hurt you/betrayal",nearestLyric:"(I'll never hurt you)",coordinates:[57.41193771362305,62.78031539916992]},{label:"Sorrow",nearestLyric:"Don't let it end in sorrow",coordinates:[54.73960876464844,63.03914260864258]}]},{label:"'nothing matters'",nearestLyric:"Nothing seems to matter",coordinates:[70.17344665527344,55.687557220458984]},{label:"'enough'",nearestLyric:"Is enough!",coordinates:[68.76097869873047,55.62284469604492],children:[{label:"'too much'",nearestLyric:"Too much of something is bad enough (bad enough)",coordinates:[68.61290740966797,55.784603118896484]}]},{label:"'independent woman' island",nearestLyric:"All the women who independent (Hey)",coordinates:[72.072998046875,60.41924285888672]},{label:"'the blues'",nearestLyric:"Feelin' the blues about it (Yeah)",coordinates:[74.31782531738281,63.118492126464844]},{label:"'bridge'",nearestLyric:"Underneath the bridge",coordinates:[78.03937530517578,63.07924270629883]},{label:"Promises",nearestLyric:"And all your promises",coordinates:[71.64732360839844,58.54658508300781],children:[{label:"'I swear'",nearestLyric:"I swear thatitwas somethin'",coordinates:[71.04540252685547,57.411354064941406]},{label:"'be true'",nearestLyric:"Promise, girl, that I'll be true",coordinates:[70.91548156738281,59.17201614379883]}]},{label:" Crying",nearestLyric:"Crying over you",coordinates:[49.363499879837036,65.27100205421448]},{label:" Heart",nearestLyric:"My heart is in your hands",coordinates:[53.51279973983765,65.30879735946655],children:[{label:"Broken heart",nearestLyric:"Heartbreak time (my heart is breaking)",coordinates:[53.45320105552673,64.71570134162903]},{label:"Soul",nearestLyric:"Somewhere I can rest my soul (rest my soul)",coordinates:[52.06210017204285,63.61569762229919],children:[{label:"Soul possession",nearestLyric:"As if someone else controls your very soul",coordinates:[52.17909812927246,63.68600130081177]}]},{label:"'heart beat(ing)'",nearestLyric:"Do you feel my heart beating?",coordinates:[52.229129791259766,66.03169250488281]}]},{label:"'without you'",nearestLyric:"Couldn't see me without you, babe",coordinates:[69.77459788322449,61.05719804763794],children:[{label:"'can't live without you'",nearestLyric:"I couldn't live without you",coordinates:[69.51349973678589,60.95970273017883]},{label:"'without your love'",nearestLyric:"Without your love, baby, I would die",coordinates:[69.21169757843018,61.63489818572998]},{label:"'living/dieing without you",nearestLyric:"Than to go on living without you",coordinates:[69.90150213241577,61.26959919929504]}]},{label:"'open/close/walk through the door'",nearestLyric:"Thinkin' no one could open the door",coordinates:[51.57910919189453,42.35673522949219]},{label:"Starting, ending",nearestLyric:"Let's start over",coordinates:[61.139732360839844,42.95952606201172]},{label:"Stay, leave, run?",nearestLyric:"If you leave tonight keep runnin'",coordinates:[57.647071838378906,46.17422866821289],children:[{label:"'go (now)'",nearestLyric:"Go now",coordinates:[58.3583984375,41.46441650390625]},{label:"'before you go'",nearestLyric:"So, before you go",coordinates:[59.804664611816406,41.7662467956543]},{label:"'I want (you) to stay'",nearestLyric:"I want you to stay (Want you to stay)",coordinates:[58.17368698120117,46.763023376464844]},{label:"Searching & finding",nearestLyric:"Tried to find myself (Tried to find myself)",coordinates:[59.81163024902344,44.26219177246094]},{label:"'leave' vs 'stay'",nearestLyric:"So I'm leaving, yes I am (I'm leaving, yes I am)",coordinates:[57.695289611816406,45.580718994140625]},{label:"Hiding ",nearestLyric:"As if I could ever hide",coordinates:[54.66998291015625,43.66585159301758]},{label:"Run & Escape",nearestLyric:"You better run, you better take cover",coordinates:[52.4169807434082,44.16438293457031]},{label:"'go(ing) home'",nearestLyric:"So, I'm going home",coordinates:[54.75404357910156,41.91556930541992]}]},{label:"'keep on [going]'",nearestLyric:"Keep on pushin'",coordinates:[55.8787727355957,47.45001220703125]},{label:"'what do/can I do?'",nearestLyric:"What else am I supposed to do?",coordinates:[69.27852630615234,49.01771926879883]},{label:"'done everything/nothing'",nearestLyric:"I've done everything I tried to do",coordinates:[66.99413299560547,50.4101676940918]},{label:"'nothing I can/can't do'",nearestLyric:"There's nothin' you can't do (Okay)",coordinates:[67.89753723144531,49.330623626708984]},{label:"'(not) easy'",nearestLyric:"Don't you know, it's not easy",coordinates:[63.642234802246094,47.9278564453125]},{label:"'(don't) stop'",nearestLyric:"Now you know you need to stop",coordinates:[60.17510986328125,47.50941848754883]},{label:"'(don't) give up'",nearestLyric:"Don't give up on us, baby",coordinates:[59.64838409423828,50.47840118408203]}]).map((function(t){var e=t.label,n=t.nearestLyric,r=t.level,i=t.coordinates;return{type:"Feature",properties:{label:e,level:r,nearestLyric:n,size:Wb[r||1]||16},geometry:{type:"Point",coordinates:i.map((function(t){return t}))}}}))};const Gb={features:Yb,name:"lyric_viz_region_labels",labelKey:"label",sizeKey:"size"};var qb=function(){return qb=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},qb.apply(this,arguments)};var Hb,Xb=n(655),Zb=n(250),Jb=n(186),Kb=n(413),Qb=n(514),tg=n(473),eg={mvp:{mainModule:Kb,mainWorker:new URL(n(123),n.b).toString()},eh:{mainModule:Qb,mainWorker:new URL(n(736),n.b).toString()},coi:{mainModule:tg,mainWorker:new URL(n(725),n.b).toString(),pthreadWorker:new URL(n(885),n.b).toString()}},ng=new Jb.kw(Jb.in.WARNING),rg=((null===(Hb=null===window||void 0===window?void 0:window.location)||void 0===Hb?void 0:Hb.pathname)||"").match(/(.*)(\/\/docs\/.*|\/)$/),ig="/";null!=rg&&rg.length>=2&&(ig=rg[1]);var og=document.getElementById("root");(0,i.s)(og).render(r.createElement(nb.f3,{logger:ng,bundles:eg},r.createElement(nb.Qk,null,r.createElement(nb.gZ,null,r.createElement(Xb.VK,{basename:ig},r.createElement(Zb.Z5,null,r.createElement(Zb.AW,{index:!0,element:r.createElement((function(){var t=(0,r.useRef)(),e={field:rb,updateRangeFilter:function(e){var n,r=e.field,i=e.min,o=e.max;null===(n=null==t?void 0:t.current)||void 0===n||n.plotAPI({encoding:{filter:vb({field:r,min:i,max:o})}})},lowerBound:0,upperBound:100};return r.createElement(r.Fragment,null,r.createElement("div",{style:{width:"100%",height:"100%"}},r.createElement(Sb,{plotRef:t,prefs:ub,tooltipHTML:fb,onClickDataPoint:db,labels:Gb},r.createElement(Mb,{rangeSliderProps:e,catagoricalField:ib,catagoricalEncoding:ob,updateCatagoricalFilter:function(e){var n,r=e.field,i=e.selectedValues;null===(n=null==t?void 0:t.current)||void 0===n||n.plotAPI({encoding:{filter2:wb({field:r,selectedValues:i})}})}}),r.createElement(Rb,{updatePlotOnStepChange:function(e){var n=e.storyStep,r=n.zoomTo,i=n.prefsUpdate;t.current&&(r||i)&&t.current.plotAPI(qb({zoom:{bbox:r}},i))}}))))}),null)}),r.createElement(Zb.AW,{path:"*",element:r.createElement(Zb.Fg,{to:"/"})})))))))}}]);